<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="è½»æ¾å…¥é—¨å­¦ä¹ rust, c rust c++">
    <meta name="description" content="ä¸ªäººç¬”è®°">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>è½»æ¾å…¥é—¨å­¦ä¹ rust | æˆ‘çš„ä¸ªäººåšå®¢</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">æˆ‘çš„ä¸ªäººåšå®¢</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>é¦–é¡µ</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>æ ‡ç­¾</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>åˆ†ç±»</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>å½’æ¡£</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>å…³äº</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>ç•™è¨€æ¿</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>å‹æƒ…é“¾æ¥</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">æˆ‘çš„ä¸ªäººåšå®¢</div>
        <div class="logo-desc">
            
            ä¸ªäººç¬”è®°
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			é¦–é¡µ
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			æ ‡ç­¾
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			åˆ†ç±»
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			å½’æ¡£
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			å…³äº
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			ç•™è¨€æ¿
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			å‹æƒ…é“¾æ¥
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/kabirz" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/kabirz" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/4.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">è½»æ¾å…¥é—¨å­¦ä¹ rust</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/rust/">
                                <span class="chip bg-color">rust</span>
                            </a>
                        
                            <a href="/tags/%E7%BC%96%E7%A8%8B/">
                                <span class="chip bg-color">ç¼–ç¨‹</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%AD%A6%E4%B9%A0/" class="post-category">
                                å­¦ä¹ 
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2021-03-24
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    92.6k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    418 åˆ†
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- æ˜¯å¦åŠ è½½ä½¿ç”¨è‡ªå¸¦çš„ prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>2021å¹´2æœˆ1æ—¥: <a target="_blank" rel="noopener" href="https://www.youtube.com/playlist?list=PLfllocyHVgsRwLkTAhG0E-2QxCf-ozBkk">Youtubeè§†é¢‘</a></p>
<p>2021å¹´1æœˆ4æ—¥: æ”¯æŒåœ¨çº¿æŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://kumakichi.github.io/easy_rust_chs">ç‚¹å‡»é˜…è¯»</a></p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Rustæ˜¯ä¸€ç§æ–°çš„è¯­è¨€ï¼Œå·²ç»æœ‰äº†å¾ˆå¥½çš„æ•™ç§‘ä¹¦ã€‚ä½†æ˜¯æœ‰æ—¶å€™å®ƒçš„æ•™æå¾ˆéš¾ï¼Œå› ä¸ºå®ƒçš„æ•™ææ˜¯ç»™ä»¥è‹±è¯­ä¸ºæ¯è¯­çš„äººçœ‹çš„ã€‚ç°åœ¨å¾ˆå¤šå…¬å¸å’Œäººå­¦ä¹ Rustï¼Œå¦‚æœæœ‰ä¸€æœ¬è‹±è¯­ç®€å•çš„ä¹¦ï¼Œä»–ä»¬å¯ä»¥å­¦å¾—æ›´å¿«ã€‚è¿™æœ¬æ•™æå°±æ˜¯ç»™è¿™äº›å…¬å¸å’Œäººç”¨ç®€å•çš„è‹±è¯­æ¥å­¦ä¹ Rustçš„ã€‚</p>
<p>Rustæ˜¯ä¸€é—¨å¾ˆæ–°çš„è¯­è¨€ï¼Œä½†å·²ç»éå¸¸æµè¡Œã€‚å®ƒä¹‹æ‰€ä»¥å—æ¬¢è¿ï¼Œæ˜¯å› ä¸ºå®ƒç»™ä½ æä¾›äº†Cæˆ–C++çš„é€Ÿåº¦å’Œæ§åˆ¶åŠ›ï¼Œä½†ä¹Ÿç»™ä½ æä¾›äº†Pythonç­‰å…¶ä»–è¾ƒæ–°è¯­è¨€çš„å†…å­˜å®‰å…¨ã€‚å®ƒç”¨ä¸€äº›æ–°çš„æƒ³æ³•æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè¿™äº›æƒ³æ³•æœ‰æ—¶ä¸å…¶ä»–è¯­è¨€ä¸åŒã€‚è¿™æ„å‘³ç€æœ‰ä¸€äº›æ–°çš„ä¸œè¥¿éœ€è¦å­¦ä¹ ï¼Œä½ ä¸èƒ½åªæ˜¯ â€œè¾¹èµ°è¾¹æƒ³â€ã€‚Rustæ˜¯ä¸€é—¨è¯­è¨€ï¼Œä½ å¿…é¡»æ€è€ƒä¸€æ®µæ—¶é—´æ‰èƒ½ç†è§£ã€‚ä½†å¦‚æœä½ æ‡‚å…¶ä»–è¯­è¨€çš„è¯ï¼Œå®ƒçœ‹èµ·æ¥è¿˜æ˜¯å¾ˆç†Ÿæ‚‰çš„ï¼Œå®ƒæ˜¯ä¸ºäº†å¸®åŠ©ä½ å†™å¥½ä»£ç è€Œç”Ÿçš„ã€‚</p>
<h2 id="æˆ‘æ˜¯è°ï¼Ÿ"><a href="#æˆ‘æ˜¯è°ï¼Ÿ" class="headerlink" title="æˆ‘æ˜¯è°ï¼Ÿ"></a>æˆ‘æ˜¯è°ï¼Ÿ</h2><p>æˆ‘æ˜¯ä¸€ä¸ªç”Ÿæ´»åœ¨éŸ©å›½çš„åŠ æ‹¿å¤§äººï¼Œæˆ‘åœ¨å†™Easy Rustçš„åŒæ—¶ï¼Œä¹Ÿåœ¨æ€è€ƒå¦‚ä½•è®©è¿™é‡Œçš„å…¬å¸å¼€å§‹ä½¿ç”¨å®ƒã€‚æˆ‘å¸Œæœ›å…¶ä»–ä¸ä»¥è‹±è¯­ä¸ºç¬¬ä¸€è¯­è¨€çš„å›½å®¶ä¹Ÿèƒ½ä½¿ç”¨å®ƒã€‚</p>
<h2 id="ç®€å•è‹±è¯­å­¦Rust"><a href="#ç®€å•è‹±è¯­å­¦Rust" class="headerlink" title="ç®€å•è‹±è¯­å­¦Rust"></a>ç®€å•è‹±è¯­å­¦Rust</h2><p><em>ç®€å•è‹±è¯­å­¦Rust</em>å†™äº2020å¹´7æœˆè‡³8æœˆï¼Œé•¿è¾¾400å¤šé¡µã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥åœ¨è¿™é‡Œæˆ–<a target="_blank" rel="noopener" href="https://www.linkedin.com/in/davemacleod">åœ¨LinkedInä¸Š</a>æˆ–<a target="_blank" rel="noopener" href="https://twitter.com/mithridates">åœ¨Twitterä¸Š</a>è”ç³»æˆ‘ã€‚å¦‚æœä½ å‘ç°æœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œæˆ–è€…è¦æå‡ºpull requestï¼Œè¯·ç»§ç»­ã€‚å·²ç»æœ‰è¶…è¿‡20äººå¸®åŠ©æˆ‘ä»¬ä¿®å¤äº†ä»£ç ä¸­çš„é”™åˆ«å­—å’Œé—®é¢˜ï¼Œæ‰€ä»¥ä½ ä¹Ÿå¯ä»¥ã€‚æˆ‘ä¸æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„Rustä¸“å®¶ï¼Œæ‰€ä»¥æˆ‘æ€»æ˜¯å–œæ¬¢å¬åˆ°æ–°çš„æƒ³æ³•ï¼Œæˆ–è€…çœ‹çœ‹å“ªé‡Œå¯ä»¥è®©è¿™æœ¬ä¹¦å˜å¾—æ›´å¥½ã€‚</p>
<h1 id="ç¬¬1éƒ¨åˆ†-æµè§ˆå™¨ä¸­çš„Rust"><a href="#ç¬¬1éƒ¨åˆ†-æµè§ˆå™¨ä¸­çš„Rust" class="headerlink" title="ç¬¬1éƒ¨åˆ† - æµè§ˆå™¨ä¸­çš„Rust"></a>ç¬¬1éƒ¨åˆ† - æµè§ˆå™¨ä¸­çš„Rust</h1><p>æœ¬ä¹¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ã€‚ç¬¬1éƒ¨åˆ†ï¼Œä½ å°†åœ¨æµè§ˆå™¨ä¸­å°±èƒ½å­¦åˆ°å°½å¯èƒ½å¤šçš„RustçŸ¥è¯†ã€‚å®é™…ä¸Šä½ å‡ ä¹å¯ä»¥åœ¨ä¸å®‰è£…Rustçš„æƒ…å†µä¸‹å­¦åˆ°æ‰€æœ‰ä½ éœ€è¦çŸ¥é“çš„ä¸œè¥¿ï¼Œæ‰€ä»¥ç¬¬1éƒ¨åˆ†éå¸¸é•¿ã€‚æœ€åæ˜¯ç¬¬äºŒéƒ¨åˆ†ã€‚å®ƒè¦çŸ­å¾—å¤šï¼Œæ˜¯å…³äºç”µè„‘ä¸Šçš„Rustã€‚åœ¨è¿™é‡Œï¼Œä½ å°†å­¦ä¹ åˆ°å…¶ä»–ä¸€åˆ‡ä½ éœ€è¦çŸ¥é“çš„ã€åªèƒ½åœ¨æµè§ˆå™¨ä¹‹å¤–è¿›è¡Œçš„äº‹æƒ…ã€‚ä¾‹å¦‚:å¤„ç†æ–‡ä»¶ã€æ¥å—ç”¨æˆ·è¾“å…¥ã€å›¾å½¢å’Œä¸ªäººè®¾ç½®ã€‚å¸Œæœ›åœ¨ç¬¬ä¸€éƒ¨åˆ†ç»“æŸæ—¶ï¼Œä½ ä¼šå–œæ¬¢Rustï¼Œä»¥è‡³äºä½ ä¼šå®‰è£…å®ƒã€‚å¦‚æœä½ ä¸å–œæ¬¢ï¼Œä¹Ÿæ²¡é—®é¢˜â€“ç¬¬ä¸€éƒ¨åˆ†æ•™äº†ä½ å¾ˆå¤šï¼Œä½ ä¸ä¼šä»‹æ„çš„ã€‚</p>
<h2 id="Rust-Playground"><a href="#Rust-Playground" class="headerlink" title="Rust Playground"></a>Rust Playground</h2><p>ä¹Ÿè®¸ä½ è¿˜ä¸æƒ³å®‰è£…Rustï¼Œè¿™ä¹Ÿæ²¡å…³ç³»ã€‚ä½ å¯ä»¥å»<a target="_blank" rel="noopener" href="https://play.rust-lang.org/">https://play.rust-lang.org/</a>ï¼Œåœ¨ä¸ç¦»å¼€æµè§ˆå™¨çš„æƒ…å†µä¸‹å¼€å§‹å†™Rustã€‚ä½ å¯ä»¥åœ¨é‚£é‡Œå†™ä¸‹ä½ çš„ä»£ç ï¼Œç„¶åç‚¹å‡»Runæ¥æŸ¥çœ‹ç»“æœã€‚ä½ å¯ä»¥åœ¨æµè§ˆå™¨çš„Playgroundé‡Œé¢è¿è¡Œæœ¬ä¹¦ä¸­çš„å¤§éƒ¨åˆ†ç¤ºä¾‹ã€‚åªæœ‰åœ¨æ¥è¿‘ç»“å°¾çš„æ—¶å€™ï¼Œä½ æ‰ä¼šçœ‹åˆ°æ— æ³•åœ¨Playgroundè¿è¡Œçš„ç¤ºä¾‹(æ¯”å¦‚æ‰“å¼€æ–‡ä»¶)ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä½¿ç”¨Rust Playgroundæ—¶çš„ä¸€äº›æç¤ºã€‚</p>
<ul>
<li><p>ç”¨â€Runâ€æ¥è¿è¡Œä½ çš„ä»£ç </p>
</li>
<li><p>å¦‚æœä½ æƒ³è®©ä½ çš„ä»£ç æ›´å¿«ï¼Œå°±æŠŠDebugæ”¹ä¸ºReleaseã€‚Debug:ç¼–è¯‘é€Ÿåº¦æ›´å¿«ï¼Œè¿è¡Œé€Ÿåº¦æ›´æ…¢ï¼ŒåŒ…å«è°ƒè¯•ä¿¡æ¯ã€‚Release:ç¼–è¯‘é€Ÿåº¦æ›´æ…¢ï¼Œè¿è¡Œé€Ÿåº¦æ›´å¿«ï¼Œåˆ é™¤è°ƒè¯•ä¿¡æ¯ã€‚</p>
</li>
<li><p>ç‚¹å‡»Shareï¼Œå¾—åˆ°ä¸€ä¸ªç½‘å€é“¾æ¥ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥åˆ†äº«ä½ çš„ä»£ç ã€‚å¦‚æœä½ éœ€è¦å¸®åŠ©ï¼Œå¯ä»¥ç”¨å®ƒæ¥åˆ†äº«ä½ çš„ä»£ç ã€‚ç‚¹å‡»åˆ†äº«åï¼Œä½ å¯ä»¥ç‚¹å‡»<code>Open a new thread in the Rust user forum</code>ï¼Œé©¬ä¸Šå‘é‚£é‡Œçš„äººå¯»æ±‚å¸®åŠ©ã€‚</p>
</li>
<li><p>Rustfmtå·¥å…·: Rustfmtä¼šå¾ˆå¥½åœ°æ ¼å¼åŒ–ä½ çš„ä»£ç ã€‚</p>
</li>
<li><p>TOOLS: Rustfmtä¼šå¾ˆå¥½åœ°æ ¼å¼åŒ–ä½ çš„ä»£ç ã€‚Clippyä¼šç»™ä½ é¢å¤–çš„ä¿¡æ¯ï¼Œå‘Šè¯‰ä½ å¦‚ä½•è®©ä½ çš„ä»£ç æ›´å¥½ã€‚</p>
</li>
<li><p>CONFIG: åœ¨è¿™é‡Œä½ å¯ä»¥æŠŠä½ çš„ä¸»é¢˜æ”¹æˆé»‘æš—æ¨¡å¼ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨æ™šä¸Šå·¥ä½œäº†ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–é…ç½®ã€‚</p>
</li>
</ul>
<p>å¦‚æœä½ æƒ³å®‰è£…Rustï¼Œè¯·åˆ°è¿™é‡Œ<a target="_blank" rel="noopener" href="https://www.rust-lang.org/tools/install">https://www.rust-lang.org/tools/install</a>ï¼Œç„¶åæŒ‰ç…§è¯´æ˜æ“ä½œã€‚é€šå¸¸ä½ ä¼šä½¿ç”¨<code>rustup</code>æ¥å®‰è£…å’Œæ›´æ–°Rustã€‚</p>
<h2 id="ğŸš§å’Œâš ï¸"><a href="#ğŸš§å’Œâš ï¸" class="headerlink" title="ğŸš§å’Œâš ï¸"></a>ğŸš§å’Œâš ï¸</h2><p>æœ‰æ—¶ä¹¦ä¸­çš„ä»£ç ä¾‹å­ä¸èƒ½ç”¨ã€‚å¦‚æœä¸€ä¸ªä¾‹å­ä¸å·¥ä½œï¼Œå®ƒå°†ä¼šæœ‰ä¸€ä¸ªğŸš§æˆ–âš ï¸åœ¨é‡Œé¢ã€‚ğŸš§å°±åƒ â€œæ­£åœ¨å»ºè®¾ä¸­â€ä¸€æ ·:å®ƒæ„å‘³ç€ä»£ç ä¸å®Œæ•´ã€‚Rustéœ€è¦ä¸€ä¸ª<code>fn main()</code>(ä¸€ä¸ªä¸»å‡½æ•°)æ¥è¿è¡Œï¼Œä½†æœ‰æ—¶æˆ‘ä»¬åªæ˜¯æƒ³çœ‹ä¸€äº›å°çš„ä»£ç ï¼Œæ‰€ä»¥å®ƒä¸ä¼šæœ‰<code>fn main()</code>ã€‚è¿™äº›ä¾‹å­æ˜¯æ­£ç¡®çš„ï¼Œä½†éœ€è¦ä¸€ä¸ª<code>fn main()</code>è®©ä½ è¿è¡Œã€‚è€Œæœ‰äº›ä»£ç ç¤ºä¾‹å‘ä½ å±•ç¤ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é‚£äº›å¯èƒ½æœ‰ä¸€ä¸ª<code>fn main()</code>ï¼Œä½†ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ï¼Œæ‰€ä»¥å®ƒä»¬ä¼šæœ‰ä¸€ä¸ªâš ï¸ã€‚</p>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>æ³¨é‡Šæ˜¯ç»™ç¨‹åºå‘˜çœ‹çš„ï¼Œè€Œä¸æ˜¯ç»™ç”µè„‘çœ‹çš„ã€‚å†™æ³¨é‡Šæ˜¯ä¸ºäº†å¸®åŠ©åˆ«äººç†è§£ä½ çš„ä»£ç ã€‚ è¿™ä¹Ÿæœ‰åˆ©äºå¸®åŠ©ä½ ä»¥åç†è§£ä½ çš„ä»£ç ã€‚ (å¾ˆå¤šäººå†™äº†å¾ˆå¥½çš„ä»£ç ï¼Œä½†åæ¥å´å¿˜è®°äº†ä»–ä»¬ä¸ºä»€ä¹ˆè¦å†™å®ƒã€‚)åœ¨Rustä¸­å†™æ³¨é‡Šï¼Œä½ é€šå¸¸ä½¿ç”¨ <code>//</code>ï¼</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Rust programs start with fn main()</span>
    <span class="token comment">// You put the code inside a block. It starts with { and ends with }</span>
    <span class="token keyword">let</span> some_number <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// We can write as much as we want here and the compiler won't look at it</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ è¿™æ ·åšæ—¶ï¼Œç¼–è¯‘å™¨ä¸ä¼šçœ‹<code>//</code>å³è¾¹çš„ä»»ä½•ä¸œè¥¿ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ³¨é‡Šï¼Œä½ ç”¨<code>/*</code>å¼€å§‹å†™ï¼Œ<code>*/</code>ç»“æŸå†™ã€‚è¿™ä¸ªå†™åœ¨ä½ çš„ä»£ç ä¸­é—´å¾ˆæœ‰ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_number<span class="token comment">/*: i16*/</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¯¹ç¼–è¯‘å™¨æ¥è¯´ï¼Œ<code>let some_number/*: i16*/ = 100;</code>çœ‹èµ·æ¥åƒ<code>let some_number = 100;</code>ã€‚</p>
<p><code>/* */</code>å½¢å¼å¯¹äºè¶…è¿‡ä¸€è¡Œçš„éå¸¸é•¿çš„æ³¨é‡Šä¹Ÿå¾ˆæœ‰ç”¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ä½ éœ€è¦ä¸ºæ¯ä¸€è¡Œå†™<code>//</code>ã€‚ä½†æ˜¯å¦‚æœæ‚¨è¾“å…¥ <code>/*</code>ï¼Œå®ƒä¸ä¼šåœæ­¢ï¼Œç›´åˆ°æ‚¨ç”¨ <code>*/</code> å®Œæˆå®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_number <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">/* Let me tell you
    a little about this number.
    It's 100, which is my favourite number.
    It's called some_number but actually I think that... */</span>

    <span class="token keyword">let</span> some_number <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// Let me tell you</span>
    <span class="token comment">// a little about this number.</span>
    <span class="token comment">// It's 100, which is my favourite number.</span>
    <span class="token comment">// It's called some_number but actually I think that...</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h2><p>Rustæœ‰å¾ˆå¤šç±»å‹ï¼Œè®©ä½ å¯ä»¥å¤„ç†æ•°å­—ã€å­—ç¬¦ç­‰ã€‚æœ‰äº›ç±»å‹å¾ˆç®€å•ï¼Œæœ‰äº›ç±»å‹æ¯”è¾ƒå¤æ‚ï¼Œä½ ç”šè‡³å¯ä»¥åˆ›å»ºè‡ªå·±çš„ç±»å‹ã€‚</p>
<h3 id="åŸå§‹ç±»å‹"><a href="#åŸå§‹ç±»å‹" class="headerlink" title="åŸå§‹ç±»å‹"></a>åŸå§‹ç±»å‹</h3><p>Rustæœ‰ç®€å•çš„ç±»å‹ï¼Œè¿™äº›ç±»å‹è¢«ç§°ä¸º<strong>åŸå§‹ç±»å‹</strong>(åŸå§‹=éå¸¸åŸºæœ¬)ã€‚æˆ‘ä»¬å°†ä»æ•´æ•°å’Œ<code>char</code>(å­—ç¬¦)å¼€å§‹ã€‚æ•´æ•°æ˜¯æ²¡æœ‰å°æ•°ç‚¹çš„æ•´æ•°ã€‚æ•´æ•°æœ‰ä¸¤ç§ç±»å‹ã€‚</p>
<ul>
<li>æœ‰ç¬¦å·çš„æ•´æ•°</li>
<li>æ— ç¬¦å·æ•´æ•°</li>
</ul>
<p>ç¬¦å·æ˜¯æŒ‡<code>+</code>(åŠ å·)å’Œ<code>-</code>(å‡å·)ï¼Œæ‰€ä»¥æœ‰ç¬¦å·çš„æ•´æ•°å¯ä»¥æ˜¯æ­£æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°(å¦‚+8ï¼Œ-8)ã€‚ä½†æ— ç¬¦å·æ•´æ•°åªèƒ½æ˜¯æ­£æ•°ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰ç¬¦å·ã€‚</p>
<p>æœ‰ç¬¦å·çš„æ•´æ•°æ˜¯ <code>i8</code>, <code>i16</code>, <code>i32</code>, <code>i64</code>, <code>i128</code>, å’Œ <code>isize</code>ã€‚</p>
<p>æ— ç¬¦å·çš„æ•´æ•°æ˜¯ <code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code>, <code>u128</code>, å’Œ <code>usize</code>ã€‚</p>
<p>iæˆ–uåé¢çš„æ•°å­—è¡¨ç¤ºè¯¥æ•°å­—çš„ä½æ•°ï¼Œæ‰€ä»¥ä½æ•°å¤šçš„æ•°å­—å¯ä»¥å¤§ä¸€äº›ã€‚8ä½=ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥<code>i8</code>æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œ<code>i64</code>æ˜¯8ä¸ªå­—èŠ‚ï¼Œä»¥æ­¤ç±»æ¨ã€‚å°ºå¯¸è¾ƒå¤§çš„æ•°å­—ç±»å‹å¯ä»¥å®¹çº³æ›´å¤§çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œ<code>u8</code>æœ€å¤šå¯ä»¥å®¹çº³255ï¼Œä½†<code>u16</code>æœ€å¤šå¯ä»¥å®¹çº³65535ã€‚è€Œ<code>u128</code>æœ€å¤šå¯ä»¥å®¹çº³340282366920938463463374607431768211455ã€‚</p>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯<code>isize</code>å’Œ<code>usize</code>å‘¢ï¼Ÿè¿™è¡¨ç¤ºä½ ç”µè„‘çš„ä½æ•°ã€‚(ä½ çš„ç”µè„‘ä¸Šçš„ä½æ•°å«åšä½ ç”µè„‘çš„<strong>æ¶æ„</strong>)ã€‚æ‰€ä»¥32ä½è®¡ç®—æœºä¸Šçš„<code>isize</code>å’Œ<code>usize</code>å°±åƒ<code>i32</code>å’Œ<code>u32</code>ï¼Œ64ä½è®¡ç®—æœºä¸Šçš„<code>isize</code>å’Œ<code>usize</code>å°±åƒ<code>i64</code>å’Œ<code>u64</code>ã€‚</p>
<p>æ•´æ•°ç±»å‹ä¸åŒçš„åŸå› æœ‰å¾ˆå¤šã€‚å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯è®¡ç®—æœºæ€§èƒ½:è¾ƒå°çš„å­—èŠ‚æ•°å¤„ç†é€Ÿåº¦æ›´å¿«ã€‚ä¾‹å¦‚ï¼Œæ•°å­—-10ä½œä¸º<code>i8</code>æ˜¯<code>11110110</code>ï¼Œä½†ä½œä¸º<code>i128</code>æ˜¯<code>11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110110</code>ã€‚ä½†è¿™é‡Œè¿˜æœ‰ä¸€äº›å…¶ä»–ç”¨æ³•ã€‚</p>
<p>Rustä¸­çš„å­—ç¬¦å«åš<code>char</code>. æ¯ä¸€ä¸ª<code>char</code>éƒ½æœ‰ä¸€ä¸ªæ•°å­—:å­—æ¯<code>A</code>æ˜¯æ•°å­—65ï¼Œè€Œå­—ç¬¦<code>å‹</code>(ä¸­æ–‡çš„ â€œæœ‹å‹â€)æ˜¯æ•°å­—21451ã€‚è¿™ä¸ªæ•°å­—åˆ—è¡¨è¢«ç§°ä¸º â€œUnicodeâ€ã€‚Unicodeå¯¹ä½¿ç”¨è¾ƒå¤šçš„å­—ç¬¦ä½¿ç”¨è¾ƒå°çš„æ•°å­—ï¼Œå¦‚Aåˆ°Zï¼Œæˆ–0åˆ°9çš„æ•°å­—ï¼Œæˆ–ç©ºæ ¼ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first_letter <span class="token operator">=</span> <span class="token char string">'A'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> space <span class="token operator">=</span> <span class="token char string">' '</span><span class="token punctuation">;</span> <span class="token comment">// A space inside ' ' is also a char</span>
    <span class="token keyword">let</span> other_language_char <span class="token operator">=</span> <span class="token char string">'á„'</span><span class="token punctuation">;</span> <span class="token comment">// Thanks to Unicode, other languages like Cherokee display just fine too</span>
    <span class="token keyword">let</span> cat_face <span class="token operator">=</span> 'ğŸ˜º'<span class="token punctuation">;</span> <span class="token comment">// Emojis are chars too</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨æœ€å¤šçš„å­—ç¬¦çš„æ•°å­—å°äº256ï¼Œå®ƒä»¬å¯ä»¥è£…è¿›<code>u8</code>ã€‚è®°ä½ï¼Œ<code>u8</code>æ˜¯0åŠ ä¸Š255ä»¥å†…çš„æ‰€æœ‰æ•°å­—ï¼Œæ€»å…±256ä¸ªã€‚è¿™æ„å‘³ç€ Rust å¯ä»¥ä½¿ç”¨ <code>as</code> å°† <code>u8</code> å®‰å…¨åœ° <strong>cast</strong>æˆ <code>char</code>ã€‚(â€œæŠŠ <code>u8</code> castæˆ <code>char</code>â€œæ„å‘³ç€ â€œæŠŠ <code>u8</code> å‡è£…æˆ <code>char</code>â€œ)</p>
<p>ç”¨ <code>as</code> castæ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸º Rust æ˜¯éå¸¸ä¸¥æ ¼çš„ã€‚å®ƒæ€»æ˜¯éœ€è¦çŸ¥é“ç±»å‹ã€‚<br> è€Œä¸ä¼šè®©ä½ åŒæ—¶ä½¿ç”¨ä¸¤ç§ä¸åŒçš„ç±»å‹ï¼Œå³ä½¿å®ƒä»¬éƒ½æ˜¯æ•´æ•°ã€‚ä¾‹å¦‚ï¼Œè¿™å°†æ— æ³•å·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// main() is where Rust programs start to run. Code goes inside {} (curly brackets)</span>

    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// We didn't write a type of integer,</span>
                         <span class="token comment">// so Rust chooses i32. Rust always</span>
                         <span class="token comment">// chooses i32 for integers if you don't</span>
                         <span class="token comment">// tell it to use a different type</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åŸå› æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0604]: only `u8` can be cast as `char`, not `i32`
 --&gt; src\main.rs:3:20
  |
3 |     println!("{}", my_number as char);
  |                    ^^^^^^^^^^^^^^^^^<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>as</code>è½»æ¾è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸èƒ½æŠŠ<code>i32</code>è½¬æˆ<code>char</code>ï¼Œä½†æˆ‘ä»¬å¯ä»¥æŠŠ<code>i32</code>è½¬æˆ<code>u8</code>ï¼Œç„¶åæŠŠ<code>u8</code>è½¬æ¢æˆ<code>char</code>ã€‚æ‰€ä»¥åœ¨ä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>as</code> å°† my_number å˜ä¸º <code>u8</code>ï¼Œå†å°†å…¶å˜ä¸º <code>char</code>ã€‚ç°åœ¨å¯ä»¥ç¼–è¯‘äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number <span class="token keyword">as</span> <span class="token keyword">u8</span> <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°çš„æ˜¯<code>d</code>ï¼Œå› ä¸ºé‚£æ˜¯100å¯¹åº”çš„<code>char</code>ã€‚</p>
<p>ç„¶è€Œï¼Œæ›´ç®€å•çš„æ–¹æ³•æ˜¯å‘Šè¯‰ Rust <code>my_number</code> æ˜¯ <code>u8</code>ã€‚ä¸‹é¢æ˜¯ä½ çš„åšæ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number<span class="token punctuation">:</span> <span class="token keyword">u8</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//  change my_number to my_number: u8</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number <span class="token keyword">as</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™å°±æ˜¯Rustä¸­æ‰€æœ‰ä¸åŒæ•°å­—ç±»å‹çš„ä¸¤ä¸ªåŸå› ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªåŸå› :<code>usize</code>æ˜¯Rustç”¨äº<em>ç´¢å¼•</em>çš„å¤§å°ã€‚(ç´¢å¼•çš„æ„æ€æ˜¯ â€œå“ªé¡¹æ˜¯ç¬¬ä¸€â€ï¼Œâ€å“ªé¡¹æ˜¯ç¬¬äºŒâ€ç­‰ç­‰)<code>usize</code>æ˜¯ç´¢å¼•çš„æœ€ä½³å¤§å°ï¼Œå› ä¸º:</p>
<ul>
<li>ç´¢å¼•ä¸èƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥å®ƒéœ€è¦æ˜¯ä¸€ä¸ªå¸¦uçš„æ•°å­—</li>
<li>å®ƒåº”è¯¥æ˜¯å¤§çš„ï¼Œå› ä¸ºæœ‰æ—¶ä½ éœ€è¦ç´¢å¼•å¾ˆå¤šä¸œè¥¿ï¼Œä½†ã€‚</li>
<li>ä¸å¯èƒ½æ˜¯u64ï¼Œå› ä¸º32ä½ç”µè„‘ä¸èƒ½ä½¿ç”¨u64ã€‚</li>
</ul>
<p>æ‰€ä»¥Rustä½¿ç”¨äº†<code>usize</code>ï¼Œè¿™æ ·ä½ çš„è®¡ç®—æœºå°±å¯ä»¥å¾—åˆ°å®ƒèƒ½è¯»åˆ°çš„æœ€å¤§çš„æ•°å­—è¿›è¡Œç´¢å¼•ã€‚</p>
<p>æˆ‘ä»¬å†æ¥äº†è§£ä¸€ä¸‹<code>char</code>ã€‚ä½ çœ‹åˆ°<code>char</code>æ€»æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ä½¿ç”¨<code>''</code>è€Œä¸æ˜¯<code>""</code>ã€‚</p>
<p>æ‰€æœ‰çš„å­—ç¬¦éƒ½æ˜¯4ä¸ªå­—èŠ‚ã€‚å®ƒä»¬æ˜¯4ä¸ªå­—èŠ‚ï¼Œå› ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦æ˜¯è¶…è¿‡ä¸€ä¸ªå­—èŠ‚çš„ã€‚è®¡ç®—æœºä¸Šçš„åŸºæœ¬å­—æ¯ä¸€ç›´æ˜¯1ä¸ªå­—èŠ‚ï¼Œåæ¥çš„å­—ç¬¦æ˜¯2ä¸ªå­—èŠ‚ï¼Œå…¶ä»–çš„æ˜¯3ä¸ªå­—èŠ‚å’Œ4ä¸ªå­—èŠ‚ã€‚<code>char</code>éœ€è¦4ä¸ªå­—èŠ‚ï¼Œè¿™æ ·æ‰èƒ½å®¹çº³ä»»ä½•ä¸€ç§å­—ç¬¦ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨<code>.len()</code>æ¥çœ‹ä¸€ä¸‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// .len() gives the size in bytes</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"ÃŸ"</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"å›½"</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token string">"ğ“…±"</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºæ¥ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">1
2
3
4<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>a</code>æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œå¾·æ–‡çš„<code>ÃŸ</code>æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œæ—¥æ–‡çš„<code>å›½</code>æ˜¯ä¸‰ä¸ªå­—èŠ‚ï¼Œå¤åŸƒåŠçš„<code>ğ“…±</code>æ˜¯4ä¸ªå­—èŠ‚ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token string">"Hello!"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Slice is {} bytes."</span><span class="token punctuation">,</span> slice<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token string">"ì•ˆë…•!"</span><span class="token punctuation">;</span> <span class="token comment">// Korean for "hi"</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Slice2 is {} bytes."</span><span class="token punctuation">,</span> slice2<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Slice is 6 bytes.
Slice2 is 7 bytes.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>slice</code>çš„é•¿åº¦æ˜¯6ä¸ªå­—ç¬¦ï¼Œ6ä¸ªå­—èŠ‚ï¼Œä½†<code>slice2</code>çš„é•¿åº¦æ˜¯3ä¸ªå­—ç¬¦ï¼Œ7ä¸ªå­—èŠ‚ã€‚</p>
<p>å¦‚æœ<code>.len()</code>ç»™å‡ºçš„æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„å¤§å°ï¼Œé‚£ä¹ˆä»¥å­—ç¬¦ä¸ºå•ä½çš„å¤§å°å‘¢ï¼Ÿè¿™äº›æ–¹æ³•æˆ‘ä»¬åé¢ä¼šå­¦ä¹ ï¼Œä½†ä½ åªè¦è®°ä½<code>.chars().count()</code>å°±å¯ä»¥äº†ã€‚<code>.chars().count()</code> å°†ä½ å†™çš„ä¸œè¥¿å˜æˆå­—ç¬¦ï¼Œç„¶åè®¡ç®—æœ‰å¤šå°‘ä¸ªå­—ç¬¦ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token string">"Hello!"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Slice is {} bytes and also {} characters."</span><span class="token punctuation">,</span> slice<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slice<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> slice2 <span class="token operator">=</span> <span class="token string">"ì•ˆë…•!"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Slice2 is {} bytes but only {} characters."</span><span class="token punctuation">,</span> slice2<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slice2<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡ºæ¥äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Slice is 6 bytes and also 6 characters.
Slice2 is 7 bytes but only 3 characters.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="ç±»å‹æ¨å¯¼"><a href="#ç±»å‹æ¨å¯¼" class="headerlink" title="ç±»å‹æ¨å¯¼"></a>ç±»å‹æ¨å¯¼</h2><p>ç±»å‹æ¨å¯¼çš„æ„æ€æ˜¯ï¼Œå¦‚æœä½ ä¸å‘Šè¯‰ç¼–è¯‘å™¨ç±»å‹ï¼Œä½†å®ƒå¯ä»¥è‡ªå·±å†³å®šï¼Œå®ƒå°±ä¼šå†³å®šã€‚ç¼–è¯‘å™¨æ€»æ˜¯éœ€è¦çŸ¥é“å˜é‡çš„ç±»å‹ï¼Œä½†ä½ å¹¶ä¸æ€»æ˜¯éœ€è¦å‘Šè¯‰å®ƒã€‚å®é™…ä¸Šï¼Œé€šå¸¸ä½ ä¸éœ€è¦å‘Šè¯‰å®ƒã€‚ä¾‹å¦‚ï¼Œå¯¹äº<code>let my_number = 8</code>ï¼Œ<code>my_number</code>å°†æ˜¯ä¸€ä¸ª<code>i32</code>ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœä½ ä¸å‘Šè¯‰å®ƒï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©i32ä½œä¸ºæ•´æ•°ã€‚ä½†æ˜¯å¦‚æœä½ è¯´<code>let my_number: u8 = 8</code>ï¼Œå®ƒå°±ä¼šæŠŠ<code>my_number</code>å˜æˆ<code>u8</code>ï¼Œå› ä¸ºä½ å‘Šè¯‰å®ƒ<code>u8</code>ã€‚</p>
<p>é€šå¸¸ç¼–è¯‘å™¨éƒ½èƒ½çŒœåˆ°ã€‚ä½†æœ‰æ—¶ä½ éœ€è¦å‘Šè¯‰å®ƒï¼ŒåŸå› æœ‰ä¸¤ä¸ªã€‚</p>
<ol>
<li>ä½ æ­£åœ¨åšä¸€äº›éå¸¸å¤æ‚çš„äº‹æƒ…ï¼Œè€Œç¼–è¯‘å™¨ä¸çŸ¥é“ä½ æƒ³è¦çš„ç±»å‹ã€‚</li>
<li>ä½ æƒ³è¦ä¸€ä¸ªä¸åŒçš„ç±»å‹(ä¾‹å¦‚ï¼Œä½ æƒ³è¦ä¸€ä¸ª<code>i128</code>ï¼Œè€Œä¸æ˜¯<code>i32</code>)ã€‚</li>
</ol>
<p>è¦æŒ‡å®šä¸€ä¸ªç±»å‹ï¼Œè¯·åœ¨å˜é‡ååæ·»åŠ ä¸€ä¸ªå†’å·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> small_number<span class="token punctuation">:</span> <span class="token keyword">u8</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¯¹äºæ•°å­—ï¼Œä½ å¯ä»¥åœ¨æ•°å­—åé¢è¯´ç±»å‹ã€‚ä½ ä¸éœ€è¦ç©ºæ ¼â€“åªéœ€è¦åœ¨æ•°å­—åé¢ç›´æ¥è¾“å…¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> small_number <span class="token operator">=</span> <span class="token number">10u8</span><span class="token punctuation">;</span> <span class="token comment">// 10u8 = 10 of type u8</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ æƒ³è®©æ•°å­—ä¾¿äºé˜…è¯»ï¼Œä¹Ÿå¯ä»¥åŠ ä¸Š<code>_</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> small_number <span class="token operator">=</span> <span class="token number">10_u8</span><span class="token punctuation">;</span> <span class="token comment">// This is easier to read</span>
    <span class="token keyword">let</span> big_number <span class="token operator">=</span> <span class="token number">100_000_000_i32</span><span class="token punctuation">;</span> <span class="token comment">// 100 million is easy to read with _</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>_</code>ä¸ä¼šæ”¹å˜æ•°å­—ã€‚å®ƒåªæ˜¯ä¸ºäº†è®©ä½ æ–¹ä¾¿é˜…è¯»ã€‚è€Œä¸”ä½ ç”¨å¤šå°‘ä¸ª<code>_</code>éƒ½æ²¡æœ‰å…³ç³»ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> 0________u8<span class="token punctuation">;</span>
    <span class="token keyword">let</span> number2 <span class="token operator">=</span> 1___6______2____4______i32<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> number2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºçš„æ˜¯<code>0, 1624</code>ã€‚</p>
<h3 id="æµ®ç‚¹æ•°"><a href="#æµ®ç‚¹æ•°" class="headerlink" title="æµ®ç‚¹æ•°"></a>æµ®ç‚¹æ•°</h3><p>æµ®ç‚¹æ•°æ˜¯å¸¦æœ‰å°æ•°ç‚¹çš„æ•°å­—ã€‚5.5æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œ6æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚5.0ä¹Ÿæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œç”šè‡³5.ä¹Ÿæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_float <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">.</span><span class="token punctuation">;</span> <span class="token comment">// Rust sees . and knows that it is a float</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½†ç±»å‹ä¸å«<code>float</code>ï¼Œå«<code>f32</code>å’Œ<code>f64</code>ã€‚è¿™å’Œæ•´æ•°ä¸€æ ·:<code>f</code>åé¢çš„æ•°å­—æ˜¾ç¤ºçš„æ˜¯ä½æ•°ã€‚å¦‚æœä½ ä¸å†™ç±»å‹ï¼ŒRustä¼šé€‰æ‹©<code>f64</code>ã€‚</p>
<p>å½“ç„¶ï¼Œåªæœ‰åŒä¸€ç±»å‹çš„æµ®ç‚¹æ•°å¯ä»¥ä¸€èµ·ä½¿ç”¨ã€‚æ‰€ä»¥ä½ ä¸èƒ½æŠŠ<code>f32</code>åŠ åˆ°<code>f64</code>ä¸Šã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span> <span class="token comment">// This is an f64</span>
    <span class="token keyword">let</span> my_other_float<span class="token punctuation">:</span> <span class="token keyword">f32</span> <span class="token operator">=</span> <span class="token number">8.5</span><span class="token punctuation">;</span> <span class="token comment">// This is an f32</span>

    <span class="token keyword">let</span> third_float <span class="token operator">=</span> my_float <span class="token operator">+</span> my_other_float<span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ å°è¯•è¿è¡Œè¿™ä¸ªæ—¶ï¼ŒRustä¼šè¯´ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0308]: mismatched types
 --&gt; src\main.rs:5:34
  |
5 |     let third_float = my_float + my_other_float;
  |                                  ^^^^^^^^^^^^^^ expected `f64`, found `f32`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ ä½¿ç”¨é”™è¯¯çš„ç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨ä¼šå†™ â€œexpected (type), found (type)â€ã€‚å®ƒè¿™æ ·è¯»å–ä½ çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span> <span class="token comment">// The compiler sees an f64</span>
    <span class="token keyword">let</span> my_other_float<span class="token punctuation">:</span> <span class="token keyword">f32</span> <span class="token operator">=</span> <span class="token number">8.5</span><span class="token punctuation">;</span> <span class="token comment">// The compiler sees an f32. It is a different type.</span>
    <span class="token keyword">let</span> third_float <span class="token operator">=</span> my_float <span class="token operator">+</span> <span class="token comment">// You want to add my_float to something, so it must be an f64 plus another f64. Now it expects an f64...</span>
    <span class="token keyword">let</span> third_float <span class="token operator">=</span> my_float <span class="token operator">+</span> my_other_float<span class="token punctuation">;</span>  <span class="token comment">// âš ï¸ but it found an f32. It can't add them.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œå½“ä½ çœ‹åˆ° â€œexpected(type)ï¼Œfound(type)â€æ—¶ï¼Œä½ å¿…é¡»æ‰¾åˆ°ä¸ºä»€ä¹ˆç¼–è¯‘å™¨é¢„æœŸçš„æ˜¯ä¸åŒçš„ç±»å‹ã€‚</p>
<p>å½“ç„¶ï¼Œç”¨ç®€å•çš„æ•°å­—å¾ˆå®¹æ˜“è§£å†³ã€‚ä½ å¯ä»¥ç”¨<code>as</code>æŠŠ<code>f32</code>è½¬æˆ<code>f64</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_other_float<span class="token punctuation">:</span> <span class="token keyword">f32</span> <span class="token operator">=</span> <span class="token number">8.5</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> third_float <span class="token operator">=</span> my_float <span class="token operator">+</span> my_other_float <span class="token keyword">as</span> <span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token comment">// my_other_float as f64 = use my_other_float like an f64</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ–è€…æ›´ç®€å•ï¼Œå»æ‰ç±»å‹å£°æ˜ã€‚(â€œå£°æ˜ä¸€ä¸ªç±»å‹â€=â€å‘Šè¯‰Rustä½¿ç”¨è¯¥ç±»å‹â€)Rustä¼šé€‰æ‹©å¯ä»¥åŠ åœ¨ä¸€èµ·çš„ç±»å‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_float <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span> <span class="token comment">// Rust will choose f64</span>
    <span class="token keyword">let</span> my_other_float <span class="token operator">=</span> <span class="token number">8.5</span><span class="token punctuation">;</span> <span class="token comment">// Here again it will choose f64</span>

    <span class="token keyword">let</span> third_float <span class="token operator">=</span> my_float <span class="token operator">+</span> my_other_float<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Rustç¼–è¯‘å™¨å¾ˆèªæ˜ï¼Œå¦‚æœä½ éœ€è¦f32ï¼Œå°±ä¸ä¼šé€‰æ‹©f64ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_float<span class="token punctuation">:</span> <span class="token keyword">f32</span> <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_other_float <span class="token operator">=</span> <span class="token number">8.5</span><span class="token punctuation">;</span> <span class="token comment">// Usually Rust would choose f64,</span>

    <span class="token keyword">let</span> third_float <span class="token operator">=</span> my_float <span class="token operator">+</span> my_other_float<span class="token punctuation">;</span> <span class="token comment">// but now it knows that you need to add it to an f32. So it chooses f32 for my_other_float too</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="æ‰“å°hello-world"><a href="#æ‰“å°hello-world" class="headerlink" title="æ‰“å°hello, world!"></a>æ‰“å°hello, world!</h2><p>å½“ä½ å¯åŠ¨ä¸€ä¸ªæ–°çš„Rustç¨‹åºæ—¶ï¼Œå®ƒæ€»æ˜¯æœ‰è¿™æ ·çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p><code>fn</code>çš„æ„æ€æ˜¯å‡½æ•°ã€‚</p>
</li>
<li><p><code>main</code>æ˜¯å¯åŠ¨ç¨‹åºçš„å‡½æ•°ã€‚</p>
</li>
<li><p><code>()</code>è¡¨ç¤ºæˆ‘ä»¬æ²¡æœ‰ç»™å‡½æ•°ä»»ä½•å˜é‡æ¥å¯åŠ¨ã€‚</p>
</li>
</ul>
<p><code>{}</code>è¢«ç§°ä¸º<strong>ä»£ç å—</strong>ã€‚è¿™æ˜¯ä»£ç æ‰€åœ¨çš„ç©ºé—´ã€‚</p>
<p><code>println!</code>æ˜¯ä¸€ä¸ª<strong>å®</strong>ï¼Œæ‰“å°åˆ°æ§åˆ¶å°ã€‚ä¸€ä¸ª<strong>å®</strong>å°±åƒä¸€ä¸ªå‡½æ•°ï¼Œä¸ºä½ å†™ä»£ç ã€‚å®åé¢æœ‰ä¸€ä¸ª<code>!</code>ã€‚æˆ‘ä»¬ä»¥åä¼šå­¦ä¹ å¦‚ä½•åˆ›å»ºå®ã€‚ç°åœ¨ï¼Œè¯·è®°ä½ï¼Œ<code>!</code>è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªå®ã€‚</p>
<p>ä¸ºäº†å­¦ä¹ <code>;</code>ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå¦ä¸€ä¸ªå‡½æ•°ã€‚é¦–å…ˆï¼Œåœ¨<code>main</code>ä¸­ï¼Œæˆ‘ä»¬å°†æ‰“å°ä¸€ä¸ªæ•°å­—8ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, world number {}!"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>println!</code>ä¸­çš„<code>{}</code>çš„æ„æ€æ˜¯ â€œæŠŠå˜é‡æ”¾åœ¨è¿™é‡Œé¢â€ã€‚è¿™æ ·å°±ä¼šæ‰“å°å‡º<code>Hello, world number 8!</code>ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åƒä¹‹å‰ä¸€æ ·ï¼Œæ”¾æ›´å¤šçš„ä¸œè¥¿è¿›å»ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, worlds number {} and {}!"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>Hello, worlds number 8 and 9!</code>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºå‡½æ•°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token number">8</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, world number {}!"</span><span class="token punctuation">,</span> <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¹Ÿä¼šæ‰“å°å‡º <code>Hello, world number 8!</code>ã€‚å½“RustæŸ¥çœ‹<code>number()</code>æ—¶ï¼Œå®ƒçœ‹åˆ°ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°:</p>
<ul>
<li>æ²¡æœ‰å‚æ•°(å› ä¸ºå®ƒæœ‰<code>()</code>)</li>
<li>è¿”å›ä¸€ä¸ª<code>i32</code>ã€‚<code>-&gt;</code>(ç§°ä¸º â€œç˜¦ç®­â€)æ˜¾ç¤ºäº†å‡½æ•°è¿”å›çš„å†…å®¹</li>
</ul>
<p>å‡½æ•°å†…éƒ¨åªæœ‰<code>8</code>ã€‚å› ä¸ºæ²¡æœ‰<code>;</code>ï¼Œæ‰€ä»¥è¿™å°±æ˜¯å®ƒè¿”å›çš„å€¼ã€‚å¦‚æœå®ƒæœ‰ä¸€ä¸ª<code>;</code>ï¼Œå®ƒå°†ä¸ä¼šè¿”å›ä»»ä½•ä¸œè¥¿(å®ƒä¼šè¿”å›ä¸€ä¸ª<code>()</code>)ã€‚å¦‚æœå®ƒæœ‰ <code>;</code>ï¼ŒRust ä¸ä¼šç¼–è¯‘é€šè¿‡ï¼Œå› ä¸ºéœ€è¦è¿”å›çš„æ˜¯ <code>i32</code>ï¼Œè€Œ <code>;</code> è¿”å› <code>()</code>ï¼Œä¸æ˜¯ <code>i32</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, world number {}"</span><span class="token punctuation">,</span> <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token number">8</span><span class="token punctuation">;</span>  <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-text" data-language="text"><code class="language-text">5 | fn number() -&gt; i32 {
  |    ------      ^^^ expected `i32`, found `()`
  |    |
  |    implicitly returns `()` as its body has no tail or `return` expression
6 |     8;
  |      - help: consider removing this semicolon<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ„å‘³ç€ â€œä½ å‘Šè¯‰æˆ‘<code>number()</code>è¿”å›çš„æ˜¯<code>i32</code>ï¼Œä½†ä½ åŠ äº†ä¸€ä¸ª<code>;</code>ï¼Œæ‰€ä»¥å®ƒä»€ä¹ˆéƒ½ä¸è¿”å›â€ã€‚æ‰€ä»¥ç¼–è¯‘å™¨å»ºè®®å»æ‰åˆ†å·ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥å†™<code>return 8;</code>ï¼Œä½†åœ¨Rustä¸­ï¼Œæ­£å¸¸æƒ…å†µä¸‹åªéœ€å°†<code>;</code>æ”¹ä¸º<code>return</code>å³å¯ã€‚</p>
<p>å½“ä½ æƒ³ç»™ä¸€ä¸ªå‡½æ•°èµ‹äºˆå˜é‡æ—¶ï¼ŒæŠŠå®ƒä»¬æ”¾åœ¨<code>()</code>é‡Œé¢ã€‚ä½ å¿…é¡»ç»™å®ƒä»¬èµ·ä¸ªåå­—ï¼Œå†™ä¸Šç±»å‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">multiply</span><span class="token punctuation">(</span>number_one<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> number_two<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Two i32s will enter the function. We will call them number_one and number_two.</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> number_one <span class="token operator">*</span> number_two<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} times {} is {}"</span><span class="token punctuation">,</span> number_one<span class="token punctuation">,</span> number_two<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We can give the numbers directly</span>
    <span class="token keyword">let</span> some_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// Or we can declare two variables</span>
    <span class="token keyword">let</span> some_other_number <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token function">multiply</span><span class="token punctuation">(</span>some_number<span class="token punctuation">,</span> some_other_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// and put them in the function</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª<code>i32</code>ã€‚åªè¦æŠŠæœ€åçš„åˆ†å·å»æ‰å°±å¯ä»¥äº†:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">multiply</span><span class="token punctuation">(</span>number_one<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> number_two<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> number_one <span class="token operator">*</span> number_two<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} times {} is {}"</span><span class="token punctuation">,</span> number_one<span class="token punctuation">,</span> number_two<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token comment">// this is the i32 that we return</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> multiply_result <span class="token operator">=</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We used multiply() to print and to give the result to multiply_result</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="å£°æ˜å˜é‡å’Œä»£ç å—"><a href="#å£°æ˜å˜é‡å’Œä»£ç å—" class="headerlink" title="å£°æ˜å˜é‡å’Œä»£ç å—"></a>å£°æ˜å˜é‡å’Œä»£ç å—</h3><p>ä½¿ç”¨<code>let</code>å£°æ˜ä¸€ä¸ªå˜é‡(å£°æ˜ä¸€ä¸ªå˜é‡=å‘Šè¯‰Ruståˆ›å»ºä¸€ä¸ªå˜é‡)ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, number {}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å˜é‡åœ¨ä»£ç å—<code>{}</code>å†…å¼€å§‹å’Œç»“æŸã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>my_number</code>åœ¨æˆ‘ä»¬è°ƒç”¨<code>println!</code>ä¹‹å‰ç»“æŸï¼Œå› ä¸ºå®ƒåœ¨è‡ªå·±çš„ä»£ç å—é‡Œé¢ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// my_number starts here</span>
                           <span class="token comment">// my_number ends here!</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Hello, number {}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸ there is no my_number and</span>
                                             <span class="token comment">// println!() can't find it</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥ä½¿ç”¨ä»£ç å—æ¥è¿”å›ä¸€ä¸ªå€¼ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> second_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
        second_number <span class="token operator">+</span> <span class="token number">9</span> <span class="token comment">// No semicolon, so the code block returns 8 + 9.</span>
                          <span class="token comment">// It works just like a function</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"My number is: {}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœåœ¨ä»£ç å—å†…éƒ¨æ·»åŠ åˆ†å·ï¼Œå®ƒå°†è¿”å› <code>()</code> (æ— )ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> second_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// declare second_number,</span>
        second_number <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">// add 9 to second_number</span>
                           <span class="token comment">// but we didn't return it!</span>
                           <span class="token comment">// second_number dies now</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"My number is: {:?}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// my_number is ()</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å†™<code>{:?}</code>è€Œä¸æ˜¯<code>{}</code>å‘¢ï¼Ÿæˆ‘ä»¬ç°åœ¨å°±æ¥è°ˆè°ˆè¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="æ˜¾ç¤ºå’Œè°ƒè¯•"><a href="#æ˜¾ç¤ºå’Œè°ƒè¯•" class="headerlink" title="æ˜¾ç¤ºå’Œè°ƒè¯•"></a>æ˜¾ç¤ºå’Œè°ƒè¯•</h2><p>Rustä¸­ç®€å•çš„å˜é‡å¯ä»¥ç”¨<code>{}</code>é‡Œé¢çš„<code>println!</code>æ‰“å°ã€‚ä½†æ˜¯æœ‰äº›å˜é‡ä¸èƒ½ï¼Œä½ éœ€è¦<strong>debug print</strong>ã€‚Debugæ‰“å°æ˜¯ç»™ç¨‹åºå‘˜æ‰“å°çš„ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¼šæ˜¾ç¤ºæ›´å¤šçš„ä¿¡æ¯ã€‚Debugæœ‰æ—¶çœ‹èµ·æ¥å¹¶ä¸æ¼‚äº®ï¼Œå› ä¸ºå®ƒæœ‰é¢å¤–çš„ä¿¡æ¯æ¥å¸®åŠ©ä½ ã€‚</p>
<p>ä½ æ€ä¹ˆçŸ¥é“ä½ æ˜¯å¦éœ€è¦<code>{:?}</code>è€Œä¸æ˜¯<code>{}</code>ï¼Ÿç¼–è¯‘å™¨ä¼šå‘Šè¯‰ä½ ã€‚æ¯”å¦‚è¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> doesnt_print <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This will not print: {}"</span><span class="token punctuation">,</span> doesnt_print<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“æˆ‘ä»¬è¿è¡Œè¿™ä¸ªæ—¶ï¼Œç¼–è¯‘å™¨ä¼šè¯´ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: `()` doesn't implement `std::fmt::Display`
 --&gt; src\main.rs:3:41
  |
3 |     println!("This will not print: {}", doesnt_print);
  |                                         ^^^^^^^^^^^^ `()` cannot be formatted with the default formatter
  |
  = help: the trait `std::fmt::Display` is not implemented for `()`
  = note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
  = note: required by `std::fmt::Display::fmt`
  = note: this error originates in a macro (in Nightly builds, run with -Z macro-backtrace for more info)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¿¡æ¯æ¯”è¾ƒå¤šï¼Œä½†é‡è¦çš„éƒ¨åˆ†æ˜¯ <code>you may be able to use {:?} (or {:#?} for pretty-print) instead</code>. è¿™æ„å‘³ç€ä½ å¯ä»¥è¯•è¯•<code>{:?}</code>ï¼Œä¹Ÿå¯ä»¥è¯•è¯•<code>{:#?}</code> <code>{:#?}</code>å«åš â€œæ¼‚äº®æ‰“å°â€ã€‚å®ƒå’Œ<code>{:?}</code>ä¸€æ ·ï¼Œä½†æ˜¯åœ¨æ›´å¤šçš„è¡Œä¸Šæ‰“å°å‡ºä¸åŒçš„æ ¼å¼ã€‚</p>
<p>æ‰€ä»¥Displayå°±æ˜¯ç”¨<code>{}</code>æ‰“å°ï¼ŒDebugå°±æ˜¯ç”¨<code>{:?}</code>æ‰“å°ã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹:å¦‚æœä½ ä¸æƒ³è¦æ–°çš„ä¸€è¡Œï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>print!</code>è€Œä¸ç”¨<code>ln</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"This will not print a new line"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">" so this will be on the same line"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°<code>This will not print a new line so this will be on the same line</code>ã€‚</p>
<h3 id="æœ€å°å’Œæœ€å¤§çš„æ•°"><a href="#æœ€å°å’Œæœ€å¤§çš„æ•°" class="headerlink" title="æœ€å°å’Œæœ€å¤§çš„æ•°"></a>æœ€å°å’Œæœ€å¤§çš„æ•°</h3><p>å¦‚æœä½ æƒ³çœ‹æœ€å°å’Œæœ€å¤§çš„æ•°å­—ï¼Œä½ å¯ä»¥ç”¨MINå’ŒMAXã€‚<code>std</code>çš„æ„æ€æ˜¯ â€œæ ‡å‡†åº“â€ï¼Œæ‹¥æœ‰Rustçš„æ‰€æœ‰ä¸»è¦å‡½æ•°ç­‰ã€‚æˆ‘ä»¬å°†åœ¨ä»¥åå­¦ä¹ æ ‡å‡†åº“ã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œä½ å¯ä»¥è®°ä½ï¼Œè¿™å°±æ˜¯ä½ å¦‚ä½•è·å¾—ä¸€ä¸ªç±»å‹çš„æœ€å°å’Œæœ€å¤§çš„æ•°å­—ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest i8 is {} and the biggest i8 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i8</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i8</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hint: printing std::i8::MIN means "print MIN inside of the i8 section in the standard library"</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest u8 is {} and the biggest u8 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u8</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u8</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest i16 is {} and the biggest i16 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i16</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i16</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest u16 is {} and the biggest u16 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u16</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u16</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest i32 is {} and the biggest i32 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i32</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i32</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest u32 is {} and the biggest u32 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u32</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u32</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest i64 is {} and the biggest i64 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i64</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i64</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest u64 is {} and the biggest u64 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u64</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u64</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest i128 is {} and the biggest i128 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i128</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">i128</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The smallest u128 is {} and the biggest u128 is {}."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u128</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u128</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†ä¼šæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The smallest i8 is -128 and the biggest i8 is 127.
The smallest u8 is 0 and the biggest u8 is 255.
The smallest i16 is -32768 and the biggest i16 is 32767.
The smallest u16 is 0 and the biggest u16 is 65535.
The smallest i32 is -2147483648 and the biggest i32 is 2147483647.
The smallest u32 is 0 and the biggest u32 is 4294967295.
The smallest i64 is -9223372036854775808 and the biggest i64 is 9223372036854775807.
The smallest u64 is 0 and the biggest u64 is 18446744073709551615.
The smallest i128 is -170141183460469231731687303715884105728 and the biggest i128 is 170141183460469231731687303715884105727.
The smallest u128 is 0 and the biggest u128 is 340282366920938463463374607431768211455.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å¯å˜æ€§"><a href="#å¯å˜æ€§" class="headerlink" title="å¯å˜æ€§"></a>å¯å˜æ€§</h2><p>å½“ä½ ç”¨<code>let</code>å£°æ˜ä¸€ä¸ªå˜é‡æ—¶ï¼Œå®ƒæ˜¯ä¸å¯æ”¹å˜çš„(ä¸èƒ½æ”¹å˜)ã€‚</p>
<p>è¿™å°†æ— æ³•å·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    my_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´:<code>error[E0384]: cannot assign twice to immutable variable my_number</code>ã€‚è¿™æ˜¯å› ä¸ºå¦‚æœä½ åªå†™<code>let</code>ï¼Œå˜é‡æ˜¯ä¸å¯å˜çš„ã€‚</p>
<p>ä½†æœ‰æ—¶ä½ æƒ³æ”¹å˜ä½ çš„å˜é‡ã€‚è¦åˆ›å»ºä¸€ä¸ªå¯ä»¥æ”¹å˜çš„å˜é‡ï¼Œå°±åœ¨<code>let</code>åé¢åŠ ä¸Š<code>mut</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    my_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æ²¡æœ‰é—®é¢˜äº†ã€‚</p>
<p>ä½†æ˜¯ï¼Œä½ ä¸èƒ½æ”¹å˜ç±»å‹:ç”šè‡³<code>mut</code>ä¹Ÿä¸èƒ½è®©ä½ è¿™æ ·åš:è¿™å°†æ— æ³•å·¥ä½œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_variable <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// it is now an i32. That can't be changed</span>
    my_variable <span class="token operator">=</span> <span class="token string">"Hello, world!"</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ ä¼šçœ‹åˆ°ç¼–è¯‘å™¨å‘å‡ºçš„åŒæ ·çš„ â€œé¢„æœŸâ€ä¿¡æ¯ã€‚<code>expected integer, found &amp;str</code>. <code>&amp;str</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šçŸ¥é“ã€‚</p>
<h3 id="é®è”½"><a href="#é®è”½" class="headerlink" title="é®è”½"></a>é®è”½</h3><p>shadowingæ˜¯æŒ‡ä½¿ç”¨<code>let</code>å£°æ˜ä¸€ä¸ªä¸å¦ä¸€ä¸ªå˜é‡åŒåçš„æ–°å˜é‡ã€‚å®ƒçœ‹èµ·æ¥åƒå¯å˜æ€§ï¼Œä½†å®Œå…¨ä¸åŒã€‚shadowingçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// This is an i32</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">9.2</span><span class="token punctuation">;</span> <span class="token comment">// This is an f64 with the same name. But it's not the first my_number - it is completely different!</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span> <span class="token comment">// Prints 9.2</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œæˆ‘ä»¬è¯´æˆ‘ä»¬ç”¨ä¸€ä¸ªæ–°çš„ â€œletç»‘å®šâ€å¯¹<code>my_number</code>è¿›è¡Œäº† â€œshadowingâ€ã€‚</p>
<p>é‚£ä¹ˆç¬¬ä¸€ä¸ª<code>my_number</code>æ˜¯å¦è¢«é”€æ¯äº†å‘¢ï¼Ÿæ²¡æœ‰ï¼Œä½†æ˜¯å½“æˆ‘ä»¬è°ƒç”¨<code>my_number</code>æ—¶ï¼Œæˆ‘ä»¬ç°åœ¨å¾—åˆ°<code>my_number</code>çš„<code>f64</code>ã€‚å› ä¸ºå®ƒä»¬åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå—ä¸­(åŒä¸€ä¸ª <code>{}</code>)ï¼Œæˆ‘ä»¬ä¸èƒ½å†çœ‹åˆ°ç¬¬ä¸€ä¸ª <code>my_number</code>ã€‚</p>
<p>ä½†å¦‚æœå®ƒä»¬åœ¨ä¸åŒçš„å—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶çœ‹åˆ°ä¸¤ä¸ªã€‚<br> ä¾‹å¦‚:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// This is an i32</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">9.2</span><span class="token punctuation">;</span> <span class="token comment">// This is an f64. It is not my_number - it is completely different!</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span> <span class="token comment">// Prints 9.2</span>
                                  <span class="token comment">// But the shadowed my_number only lives until here.</span>
                                  <span class="token comment">// The first my_number is still alive!</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› æ­¤ï¼Œå½“ä½ å¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œshadowingå¤„ç†æ—¶ï¼Œä½ ä¸ä¼šç ´åå®ƒã€‚ä½ <strong>å±è”½</strong>äº†å®ƒã€‚</p>
<p>é‚£ä¹ˆshadowingçš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå½“ä½ éœ€è¦ç»å¸¸æ”¹å˜ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œshadowingæ˜¯å¾ˆå¥½çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æƒ³ç”¨ä¸€ä¸ªå˜é‡åšå¾ˆå¤šç®€å•çš„æ•°å­¦è¿ç®—ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">times_two</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    number <span class="token operator">*</span> <span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> final_number <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">// x starts at 9</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">times_two</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// shadow with new x: 18</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token comment">// shadow with new x: 28</span>
        x <span class="token comment">// return x: final_number is now the value of x</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is now: {}"</span><span class="token punctuation">,</span> final_number<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæ²¡æœ‰shadowingï¼Œä½ å°†ä¸å¾—ä¸è€ƒè™‘ä¸åŒçš„åç§°ï¼Œå°½ç®¡ä½ å¹¶ä¸å…³å¿ƒxã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">times_two</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    number <span class="token operator">*</span> <span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Pretending we are using Rust without shadowing</span>
    <span class="token keyword">let</span> final_number <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span> <span class="token comment">// x starts at 9</span>
        <span class="token keyword">let</span> x_twice <span class="token operator">=</span> <span class="token function">times_two</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// second name for x</span>
        <span class="token keyword">let</span> x_twice_and_y <span class="token operator">=</span> x_twice <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token comment">// third name for x!</span>
        x_twice_and_y <span class="token comment">// too bad we didn't have shadowing - we could have just used x</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is now: {}"</span><span class="token punctuation">,</span> final_number<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€èˆ¬æ¥è¯´ï¼Œä½ åœ¨Rustä¸­çœ‹åˆ°çš„shadowingå°±æ˜¯è¿™ç§æƒ…å†µã€‚å®ƒå‘ç”Ÿåœ¨ä½ æƒ³å¿«é€Ÿå–ç”¨å˜é‡ï¼Œå¯¹å®ƒåšä¸€äº›äº‹æƒ…ï¼Œç„¶åå†åšå…¶ä»–äº‹æƒ…çš„åœ°æ–¹ã€‚è€Œä½ é€šå¸¸å°†å®ƒç”¨äºé‚£äº›ä½ ä¸å¤ªå…³å¿ƒçš„å¿«é€Ÿå˜é‡ã€‚</p>
<h2 id="æ ˆã€å †å’ŒæŒ‡é’ˆ"><a href="#æ ˆã€å †å’ŒæŒ‡é’ˆ" class="headerlink" title="æ ˆã€å †å’ŒæŒ‡é’ˆ"></a>æ ˆã€å †å’ŒæŒ‡é’ˆ</h2><p>æ ˆã€å †å’ŒæŒ‡é’ˆåœ¨Rustä¸­éå¸¸é‡è¦ã€‚</p>
<p>æ ˆå’Œå †æ˜¯è®¡ç®—æœºä¸­ä¿å­˜å†…å­˜çš„ä¸¤ä¸ªåœ°æ–¹ã€‚é‡è¦çš„åŒºåˆ«æ˜¯:</p>
<p>æ ˆçš„é€Ÿåº¦éå¸¸å¿«, ä½†å †çš„é€Ÿåº¦å°±ä¸é‚£ä¹ˆå¿«äº†. å®ƒä¹Ÿä¸æ˜¯è¶…æ…¢ï¼Œä½†æ ˆæ€»æ˜¯æ›´å¿«ã€‚ä½†æ˜¯ä½ ä¸èƒ½ä¸€ç›´ä½¿ç”¨æ ˆï¼Œå› ä¸º:</p>
<ul>
<li>Rustéœ€è¦åœ¨ç¼–è¯‘æ—¶çŸ¥é“ä¸€ä¸ªå˜é‡çš„å¤§å°ã€‚æ‰€ä»¥åƒ<code>i32</code>è¿™æ ·çš„ç®€å•å˜é‡å°±æ”¾åœ¨å †æ ˆä¸Šï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å®ƒä»¬çš„ç¡®åˆ‡å¤§å°ã€‚ä½ æ€»æ˜¯çŸ¥é“<code>i32</code>è¦4å­—èŠ‚ï¼Œå› ä¸º32ä½=4å­—èŠ‚ã€‚æ‰€ä»¥<code>i32</code>æ€»æ˜¯å¯ä»¥æ”¾åœ¨æ ˆä¸Šã€‚</li>
<li>ä½†æœ‰äº›ç±»å‹åœ¨ç¼–è¯‘æ—¶ä¸çŸ¥é“å¤§å°ã€‚ä½†æ˜¯æ ˆéœ€è¦çŸ¥é“ç¡®åˆ‡çš„å¤§å°ã€‚é‚£ä¹ˆä½ è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿé¦–å…ˆä½ æŠŠæ•°æ®æ”¾åœ¨å †ä¸­ï¼Œå› ä¸ºå †ä¸­å¯ä»¥æœ‰ä»»ä½•å¤§å°çš„æ•°æ®ã€‚ç„¶åä¸ºäº†æ‰¾åˆ°å®ƒï¼Œä¸€ä¸ªæŒ‡é’ˆå°±ä¼šè¿›å…¥æ ˆã€‚è¿™å¾ˆå¥½ï¼Œå› ä¸ºæˆ‘ä»¬æ€»æ˜¯çŸ¥é“æŒ‡é’ˆçš„å¤§å°ã€‚æ‰€ä»¥ï¼Œè®¡ç®—æœºå°±ä¼šå…ˆå»æ ˆï¼Œè¯»å–æŒ‡é’ˆï¼Œç„¶åè·Ÿç€æŒ‡é’ˆåˆ°æ•°æ®æ‰€åœ¨çš„å †ã€‚</li>
</ul>
<p>æŒ‡é’ˆå¬èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†å®ƒä»¬å¾ˆå®¹æ˜“ã€‚æŒ‡é’ˆå°±åƒä¸€æœ¬ä¹¦çš„ç›®å½•ã€‚æƒ³è±¡ä¸€ä¸‹è¿™æœ¬ä¹¦ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">MY BOOK

TABLE OF CONTENTS

Chapter                        Page
Chapter 1: My life              1
Chapter 2: My cat               15
Chapter 3: My job               23
Chapter 4: My family            30
Chapter 5: Future plans         43<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™å°±åƒäº”ä¸ªæŒ‡é’ˆã€‚ä½ å¯ä»¥é˜…è¯»å®ƒä»¬ï¼Œæ‰¾åˆ°å®ƒä»¬æ‰€è¯´çš„ä¿¡æ¯ã€‚â€æˆ‘çš„ç”Ÿæ´»â€è¿™ä¸€ç« åœ¨å“ªé‡Œï¼Ÿåœ¨ç¬¬1é¡µ(å®ƒ<em>æŒ‡å‘</em>ç¬¬1é¡µ)ã€‚â€æˆ‘çš„å·¥ä½œâ€è¿™ä¸€ç« åœ¨å“ªé‡Œï¼Ÿå®ƒåœ¨ç¬¬23é¡µã€‚</p>
<p>åœ¨Rustä¸­é€šå¸¸çœ‹åˆ°çš„æŒ‡é’ˆå«åš<strong>å¼•ç”¨</strong>ã€‚è¿™æ˜¯é‡è¦çš„éƒ¨åˆ†ï¼Œè¦çŸ¥é“:ä¸€ä¸ªå¼•ç”¨æŒ‡å‘å¦ä¸€ä¸ªå€¼çš„å†…å­˜ã€‚å¼•ç”¨æ„å‘³ç€ä½ <em>å€Ÿ</em>äº†è¿™ä¸ªå€¼ï¼Œä½†ä½ å¹¶ä¸æ‹¥æœ‰å®ƒã€‚è¿™å’Œæˆ‘ä»¬çš„ä¹¦ä¸€æ ·:ç›®å½•å¹¶ä¸æ‹¥æœ‰ä¿¡æ¯ã€‚ç« èŠ‚æ‰æ˜¯ä¿¡æ¯çš„ä¸»äººã€‚åœ¨Rustä¸­ï¼Œå¼•ç”¨æ–‡çŒ®çš„å‰é¢æœ‰ä¸€ä¸ª<code>&amp;</code>ã€‚æ‰€ä»¥:</p>
<ul>
<li><code>let my_variable = 8</code>æ˜¯ä¸€ä¸ªæ™®é€šçš„å˜é‡ï¼Œä½†æ˜¯:</li>
<li><code>let my_reference = &amp;my_variable</code>æ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚</li>
</ul>
<p>ä½ æŠŠ <code>my_reference = &amp;my_variable</code> è¯»æˆè¿™æ ·: â€œmy_referenceæ˜¯å¯¹my_variableçš„å¼•ç”¨â€. æˆ–è€…:â€my_referenceæ˜¯å¯¹my_variableçš„å¼•ç”¨â€ã€‚</p>
<p>è¿™æ„å‘³ç€<code>my_reference</code>åªçœ‹<code>my_variable</code>çš„æ•°æ®ã€‚<code>my_variable</code>ä»ç„¶æ‹¥æœ‰å®ƒçš„æ•°æ®ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ªå¼•ç”¨çš„å¼•ç”¨ï¼Œæˆ–è€…ä»»ä½•æ•°é‡çš„å¼•ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">// This is an i32</span>
    <span class="token keyword">let</span> single_reference <span class="token operator">=</span> <span class="token operator">&amp;</span>my_number<span class="token punctuation">;</span> <span class="token comment">//  This is a &amp;i32</span>
    <span class="token keyword">let</span> double_reference <span class="token operator">=</span> <span class="token operator">&amp;</span>single_reference<span class="token punctuation">;</span> <span class="token comment">// This is a &amp;&amp;i32</span>
    <span class="token keyword">let</span> five_references <span class="token operator">=</span> <span class="token operator">&amp;&amp;</span><span class="token operator">&amp;&amp;</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">;</span> <span class="token comment">// This is a &amp;&amp;&amp;&amp;&amp;i32</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™äº›éƒ½æ˜¯ä¸åŒçš„ç±»å‹ï¼Œå°±åƒ â€œæœ‹å‹çš„æœ‹å‹â€å’Œ â€œæœ‹å‹â€ä¸åŒä¸€æ ·ã€‚</p>
<h2 id="å…³äºæ‰“å°çš„æ›´å¤šä¿¡æ¯"><a href="#å…³äºæ‰“å°çš„æ›´å¤šä¿¡æ¯" class="headerlink" title="å…³äºæ‰“å°çš„æ›´å¤šä¿¡æ¯"></a>å…³äºæ‰“å°çš„æ›´å¤šä¿¡æ¯</h2><p>åœ¨Rustä¸­ï¼Œä½ å‡ ä¹å¯ä»¥ç”¨ä»»ä½•ä½ æƒ³è¦çš„æ–¹å¼æ‰“å°ä¸œè¥¿ã€‚è¿™é‡Œæœ‰ä¸€äº›å…³äºæ‰“å°çš„äº‹æƒ…éœ€è¦çŸ¥é“ã€‚</p>
<p>æ·»åŠ  <code>\n</code> å°†ä¼šäº§ç”Ÿä¸€ä¸ªæ–°è¡Œï¼Œè€Œ <code>\t</code> å°†ä¼šäº§ç”Ÿä¸€ä¸ªæ ‡ç­¾ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Note: this is print!, not println!</span>
    <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"\t Start with a tab\nand move to a new line"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">         Start with a tab
and move to a new line<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>""</code>é‡Œé¢å¯ä»¥å†™è¿‡å¾ˆå¤šè¡Œéƒ½æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯è¦æ³¨æ„é—´è·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Note: After the first line you have to start on the far left.</span>
    <span class="token comment">// If you write directly under println!, it will add the spaces</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Inside quotes
you can write over
many lines
and it will print just fine."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"If you forget to write
    on the left side, the spaces
    will be added when you print."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°å‡ºæ¥çš„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Inside quotes
you can write over
many lines
and it will print just fine.
If you forget to write
    on the left side, the spaces
    will be added when you print.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ æƒ³æ‰“å°<code>\n</code>è¿™æ ·çš„å­—ç¬¦(ç§°ä¸º â€œè½¬ä¹‰å­—ç¬¦â€)ï¼Œä½ å¯ä»¥å¤šåŠ ä¸€ä¸ª<code>\</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here are two escape characters: \\n and \\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Here are two escape characters: \n and \t<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æœ‰æ—¶ä½ æœ‰å¤ªå¤šçš„ <code>"</code> å’Œè½¬ä¹‰å­—ç¬¦ï¼Œå¹¶å¸Œæœ› Rust å¿½ç•¥æ‰€æœ‰çš„å­—ç¬¦ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥åœ¨å¼€å¤´æ·»åŠ  <code>r#</code>ï¼Œåœ¨ç»“å°¾æ·»åŠ  <code>#</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"He said, \"You can find the file at c:\\files\\my_documents\\file.txt.\" Then I found the file."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We used \ five times here</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">r#"He said, "You can find the file at c:\files\my_documents\file.txt." Then I found the file."#</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°çš„æ˜¯åŒæ ·çš„ä¸œè¥¿ï¼Œä½†ä½¿ç”¨ <code>r#</code> ä½¿äººç±»æ›´å®¹æ˜“é˜…è¯»ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">He said, "You can find the file at c:\files\my_documents\file.txt." Then I found the file.
He said, "You can find the file at c:\files\my_documents\file.txt." Then I found the file.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ éœ€è¦ç”¨<code>#</code>åœ¨é‡Œé¢æ‰“å°ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨<code>r##</code>å¼€å¤´ï¼Œç”¨<code>##</code>ç»“å°¾ã€‚è€Œå¦‚æœä½ éœ€è¦å¤šä¸ªï¼Œå¯ä»¥åœ¨æ¯è¾¹å¤šåŠ ä¸€ä¸ª#ã€‚</p>
<p>ä¸‹é¢æ˜¯å››ä¸ªä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token string">"'Ice to see you,' he said."</span><span class="token punctuation">;</span> <span class="token comment">// single quotes</span>
    <span class="token keyword">let</span> quote_string <span class="token operator">=</span> <span class="token string">r#""Ice to see you," he said."#</span><span class="token punctuation">;</span> <span class="token comment">// double quotes</span>
    <span class="token keyword">let</span> hashtag_string <span class="token operator">=</span> <span class="token string">r##"The hashtag #IceToSeeYou had become very popular."##</span><span class="token punctuation">;</span> <span class="token comment">// Has one # so we need at least ##</span>
    <span class="token keyword">let</span> many_hashtags <span class="token operator">=</span> <span class="token string">r####""You don't have to type ### to use a hashtag. You can just use #.""####</span><span class="token punctuation">;</span> <span class="token comment">// Has three ### so we need at least ####</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}\n{}\n{}\n{}\n"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">,</span> quote_string<span class="token punctuation">,</span> hashtag_string<span class="token punctuation">,</span> many_hashtags<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">'Ice to see you,' he said.
"Ice to see you," he said.
The hashtag #IceToSeeYou had become very popular.
"You don't have to type ### to use a hashtag. You can just use #."<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>r#</code>è¿˜æœ‰å¦ä¸€ä¸ªç”¨é€”:ä½¿ç”¨å®ƒï¼Œä½ å¯ä»¥ä½¿ç”¨å…³é”®å­—(å¦‚<code>let</code>ã€<code>fn</code>ç­‰)ä½œä¸ºå˜é‡åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> r#<span class="token keyword">let</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// The variable's name is let</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> r#<span class="token keyword">mut</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// This variable's name is mut</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>r#</code>ä¹‹æ‰€ä»¥æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œæ˜¯å› ä¸ºæ—§ç‰ˆæœ¬çš„Rustçš„å…³é”®å­—æ¯”ç°åœ¨çš„Rustå°‘ã€‚æ‰€ä»¥æœ‰äº†<code>r#</code>å°±å¯ä»¥é¿å…ä»¥å‰ä¸æ˜¯å…³é”®å­—çš„å˜é‡åçš„é”™è¯¯ã€‚</p>
<p>åˆæˆ–è€…å› ä¸ºæŸäº›åŸå› ï¼Œä½ <em>ç¡®å®</em>éœ€è¦ä¸€ä¸ªå‡½æ•°çš„åå­—ï¼Œæ¯”å¦‚<code>return</code>ã€‚é‚£ä¹ˆä½ å¯ä»¥è¿™æ ·å†™:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">r</span>#<span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u8</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token number">8</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> r#<span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Here is your number.
8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯èƒ½ä¸éœ€è¦å®ƒï¼Œä½†æ˜¯å¦‚æœä½ çœŸçš„éœ€è¦ä¸ºä¸€ä¸ªå˜é‡ä½¿ç”¨ä¸€ä¸ªå…³é”®å­—ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨<code>r#</code>ã€‚</p>
<p>å¦‚æœä½ æƒ³æ‰“å°<code>&amp;str</code>æˆ–<code>char</code>çš„å­—èŠ‚ï¼Œä½ å¯ä»¥åœ¨å­—ç¬¦ä¸²å‰å†™ä¸Š<code>b</code>å°±å¯ä»¥äº†ã€‚è¿™é€‚ç”¨äºæ‰€æœ‰ASCIIå­—ç¬¦ã€‚è¿™äº›æ˜¯æ‰€æœ‰çš„ASCIIå­—ç¬¦ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">â˜ºâ˜»â™¥â™¦â™£â™ â™«â˜¼â–ºâ—„â†•â€¼Â¶Â§â–¬â†¨â†‘â†“â†’âˆŸâ†”â–²â–¼123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œå½“ä½ æ‰“å°è¿™ä¸ª</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token string">b"This will look like numbers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ˜¯ç»“æœ:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[84, 104, 105, 115, 32, 119, 105, 108, 108, 32, 108, 111, 111, 107, 32, 108, 105, 107, 101, 32, 110, 117, 109, 98, 101, 114, 115]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯¹äº<code>char</code>æ¥è¯´ï¼Œè¿™å«åšä¸€ä¸ª<em>å­—èŠ‚</em>ï¼Œå¯¹äº<code>&amp;str</code>æ¥è¯´ï¼Œè¿™å«åšä¸€ä¸ª<em>å­—èŠ‚å­—ç¬¦ä¸²</em>ã€‚</p>
<p>å¦‚æœä½ éœ€è¦çš„è¯ï¼Œä¹Ÿå¯ä»¥æŠŠ<code>b</code>å’Œ<code>r</code>æ”¾åœ¨ä¸€èµ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token string">br##"I like to write "#"."##</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>[73, 32, 108, 105, 107, 101, 32, 116, 111, 32, 119, 114, 105, 116, 101, 32, 34, 35, 34, 46]</code>ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªUnicodeè½¬ä¹‰ï¼Œå¯ä»¥è®©ä½ åœ¨å­—ç¬¦ä¸²ä¸­æ‰“å°ä»»ä½•Unicodeå­—ç¬¦ã€‚<code>\u{}</code>. <code>{}</code>é‡Œé¢æœ‰ä¸€ä¸ªåå…­è¿›åˆ¶æ•°å­—å¯ä»¥æ‰“å°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­ï¼Œè¯´æ˜å¦‚ä½•è·å¾—Unicodeæ•°å­—ï¼Œä»¥åŠå¦‚ä½•å†æ¬¡æ‰“å°å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:X}"</span><span class="token punctuation">,</span> <span class="token char string">'í–‰'</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Cast char as u32 to get the hexadecimal value</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:X}"</span><span class="token punctuation">,</span> <span class="token char string">'H'</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:X}"</span><span class="token punctuation">,</span> <span class="token char string">'å±…'</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:X}"</span><span class="token punctuation">,</span> <span class="token char string">'ã„'</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"\u{D589}, \u{48}, \u{5C45}, \u{3044}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Try printing them with unicode escape \u</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>println!</code>å¯ä»¥å’Œ<code>{}</code>(ç”¨äºæ˜¾ç¤º)æˆ–<code>{:?}</code>(ç”¨äºè°ƒè¯•)ä¸€èµ·æ‰“å°ï¼Œå†åŠ ä¸Š<code>{:#?}</code>å°±å¯ä»¥è¿›è¡Œæ¼‚äº®çš„æ‰“å°ã€‚ä½†æ˜¯è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æ‰“å°æ–¹å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªå¼•ç”¨ï¼Œä½ å¯ä»¥ç”¨<code>{:p}</code>æ¥æ‰“å°<em>æŒ‡é’ˆåœ°å€</em>ã€‚æŒ‡é’ˆåœ°å€æŒ‡çš„æ˜¯ç”µè„‘å†…å­˜ä¸­çš„ä½ç½®ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> number_ref <span class="token operator">=</span> <span class="token operator">&amp;</span>number<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:p}"</span><span class="token punctuation">,</span> number_ref<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å¯ä»¥æ‰“å°<code>0xe2bc0ffcfc</code>æˆ–å…¶ä»–åœ°å€ã€‚æ¯æ¬¡å¯èƒ½éƒ½ä¸ä¸€æ ·ï¼Œè¿™å–å†³äºä½ çš„è®¡ç®—æœºå­˜å‚¨çš„ä½ç½®ã€‚</p>
<p>æˆ–è€…ä½ å¯ä»¥æ‰“å°äºŒè¿›åˆ¶ã€åå…­è¿›åˆ¶å’Œå…«è¿›åˆ¶ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token number">555</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Binary: {:b}, hexadecimal: {:x}, octal: {:o}"</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> number<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º<code>Binary: 1000101011, hexadecimal: 22b, octal: 1053</code>ã€‚</p>
<p>æˆ–è€…ä½ å¯ä»¥æ·»åŠ æ•°å­—æ¥æ”¹å˜é¡ºåºã€‚ç¬¬ä¸€ä¸ªå˜é‡å°†åœ¨ç´¢å¼•0ä¸­ï¼Œä¸‹ä¸€ä¸ªåœ¨ç´¢å¼•1ä¸­ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> father_name <span class="token operator">=</span> <span class="token string">"Vlad"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> son_name <span class="token operator">=</span> <span class="token string">"Adrian Fahrenheit"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> family_name <span class="token operator">=</span> <span class="token string">"ÈšepeÈ™"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This is {1} {2}, son of {0} {2}."</span><span class="token punctuation">,</span> father_name<span class="token punctuation">,</span> son_name<span class="token punctuation">,</span> family_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>father_name</code>åœ¨0ä½ï¼Œ<code>son_name</code>åœ¨1ä½ï¼Œ<code>family_name</code>åœ¨2ä½ã€‚æ‰€ä»¥å®ƒæ‰“å°çš„æ˜¯<code>This is Adrian Fahrenheit ÈšepeÈ™, son of Vlad ÈšepeÈ™</code>ã€‚</p>
<p>ä¹Ÿè®¸ä½ æœ‰ä¸€ä¸ªéå¸¸å¤æ‚çš„å­—ç¬¦ä¸²è¦æ‰“å°ï¼Œ<code>{}</code>å¤§æ‹¬å·å†…æœ‰å¤ªå¤šçš„å˜é‡ã€‚æˆ–è€…ä½ éœ€è¦ä¸æ­¢ä¸€æ¬¡çš„æ‰“å°ä¸€ä¸ªå˜é‡ã€‚é‚£ä¹ˆåœ¨<code>{}</code>ä¸­æ·»åŠ åç§°å°±ä¼šæœ‰å¸®åŠ©ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"{city1} is in {country} and {city2} is also in {country},
but {city3} is not in {country}."</span><span class="token punctuation">,</span>
        city1 <span class="token operator">=</span> <span class="token string">"Seoul"</span><span class="token punctuation">,</span>
        city2 <span class="token operator">=</span> <span class="token string">"Busan"</span><span class="token punctuation">,</span>
        city3 <span class="token operator">=</span> <span class="token string">"Tokyo"</span><span class="token punctuation">,</span>
        country <span class="token operator">=</span> <span class="token string">"Korea"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Seoul is in Korea and Busan is also in Korea,
but Tokyo is not in Korea.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>å¦‚æœä½ æƒ³ä½¿ç”¨Rustï¼Œåœ¨Rustä¸­ä¹Ÿå¯ä»¥è¿›è¡Œéå¸¸å¤æ‚çš„æ‰“å°ã€‚ä¸‹é¢æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>{variable:padding alignment minimum.maximum}</p>
<p>è¦ç†è§£è¿™ä¸€ç‚¹ï¼Œè¯·çœ‹</p>
<ol>
<li>ä½ æƒ³è¦ä¸€ä¸ªå˜é‡åå—ï¼Ÿå…ˆå†™å‡ºæ¥ï¼Œå°±åƒæˆ‘ä»¬ä¸Šé¢å†™{country}ä¸€æ ·ã€‚<br>(å¦‚æœä½ æƒ³åšæ›´å¤šçš„äº‹æƒ…ï¼Œå°±åœ¨åé¢åŠ ä¸€ä¸ª<code>:</code>)</li>
<li>ä½ æƒ³è¦ä¸€ä¸ªå¡«å……å­—ç¬¦å—ï¼Ÿä¾‹å¦‚ï¼Œ55åŠ ä¸Šä¸‰ä¸ª â€œå¡«å……é›¶â€å°±åƒ00055ã€‚</li>
<li>paddingçš„å¯¹é½æ–¹å¼(å·¦/ä¸­/å³)ï¼Ÿ</li>
<li>ä½ æƒ³è¦ä¸€ä¸ªæœ€å°é•¿åº¦å—ï¼Ÿ(å†™ä¸€ä¸ªæ•°å­—å°±å¯ä»¥äº†) </li>
<li>ä½ æƒ³è¦ä¸€ä¸ªæœ€å¤§é•¿åº¦å—ï¼Ÿ(å†™ä¸€ä¸ªæ•°å­—ï¼Œå‰é¢æœ‰ä¸€ä¸ª<code>.</code>)</li>
</ol>
<p>ä¾‹å¦‚ï¼Œæˆ‘æƒ³å†™ â€œaâ€ï¼Œå·¦è¾¹æœ‰äº”ä¸ªã…ï¼Œå³è¾¹æœ‰äº”ä¸ªã…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> letter <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:ã…^11}"</span><span class="token punctuation">,</span> letter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯<code>ã…ã…ã…ã…ã…aã…ã…ã…ã…ã…</code>ã€‚æˆ‘ä»¬çœ‹çœ‹1)åˆ°5)çš„è¿™ä¸ªæƒ…å†µï¼Œå°±èƒ½æ˜ç™½ç¼–è¯‘å™¨æ˜¯æ€ä¹ˆè¯»çš„ã€‚</p>
<ul>
<li>ä½ è¦ä¸è¦å˜é‡åï¼Ÿ<code>{:ã…^11}</code>æ²¡æœ‰å˜é‡åã€‚<code>:</code>ä¹‹å‰æ²¡æœ‰ä»»ä½•å†…å®¹ã€‚</li>
<li>ä½ éœ€è¦ä¸€ä¸ªå¡«å……å­—ç¬¦å—ï¼Ÿ<code>{:ã…^11}</code> æ˜¯çš„:ã…â€åœ¨<code>:</code>åé¢ï¼Œæœ‰ä¸€ä¸ª<code>^</code>ã€‚<code>&lt;</code>è¡¨ç¤ºå¡«å……å­—ç¬¦åœ¨å·¦è¾¹ï¼Œ<code>&gt;</code>è¡¨ç¤ºåœ¨å³è¾¹ï¼Œ<code>^</code>è¡¨ç¤ºåœ¨ä¸­é—´ã€‚</li>
<li>è¦ä¸è¦è®¾ç½®æœ€å°é•¿åº¦ï¼Ÿ<code>{:ã…^11}</code>æ˜¯:åé¢æœ‰ä¸€ä¸ª11ã€‚</li>
<li>ä½ æƒ³è¦ä¸€ä¸ªæœ€å¤§é•¿åº¦å—ï¼Ÿ<code>{:ã…^11}</code> ä¸æ˜¯:å‰é¢æ²¡æœ‰<code>.</code>çš„æ•°å­—ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯å¤šç§ç±»å‹çš„æ ¼å¼åŒ–çš„ä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token string">"TODAY'S NEWS"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:-^30}"</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no variable name, pad with -, put in centre, 30 characters long</span>
    <span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token string">"|"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{: &lt;15}{: &gt;15}"</span><span class="token punctuation">,</span> bar<span class="token punctuation">,</span> bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// no variable name, pad with space, 15 characters each, one to the left, one to the right</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">"SEOUL"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">"TOKYO"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{city1:-&lt;15}{city2:-&gt;15}"</span><span class="token punctuation">,</span> city1 <span class="token operator">=</span> a<span class="token punctuation">,</span> city2 <span class="token operator">=</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// variable names city1 and city2, pad with -, one to the left, one to the right</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°å‡ºæ¥äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">---------TODAY'S NEWS---------
|                            |
SEOUL--------------------TOKYO<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>Rustæœ‰ä¸¤ç§ä¸»è¦ç±»å‹çš„å­—ç¬¦ä¸²ã€‚<code>String</code>å’Œ<code>&amp;str</code>. æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>
<ul>
<li><code>&amp;str</code>æ˜¯ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ã€‚å½“ä½ å†™<code>let my_variable = "Hello, world!"</code>æ—¶ï¼Œä½ ä¼šåˆ›å»ºä¸€ä¸ª<code>&amp;str</code>ã€‚<code>&amp;str</code>æ˜¯éå¸¸å¿«çš„ã€‚</li>
<li><code>String</code>æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„å­—ç¬¦ä¸²ã€‚å®ƒæ¯”è¾ƒæ…¢ï¼Œä½†å®ƒæœ‰æ›´å¤šçš„åŠŸèƒ½ã€‚<code>String</code>æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ•°æ®åœ¨å †ä¸Šã€‚</li>
</ul>
<p>å¦å¤–æ³¨æ„ï¼Œ<code>&amp;str</code>å‰é¢æœ‰<code>&amp;</code>ï¼Œå› ä¸ºä½ éœ€è¦ä¸€ä¸ªå¼•ç”¨æ¥ä½¿ç”¨<code>str</code>ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„åŸå› :å †éœ€è¦çŸ¥é“å¤§å°ã€‚æ‰€ä»¥æˆ‘ä»¬ç»™å®ƒä¸€ä¸ª<code>&amp;</code>ï¼Œå®ƒçŸ¥é“å¤§å°ï¼Œç„¶åå®ƒå°±é«˜å…´äº†ã€‚å¦å¤–ï¼Œå› ä¸ºä½ ç”¨ä¸€ä¸ª<code>&amp;</code>ä¸ä¸€ä¸ª<code>str</code>äº¤äº’ï¼Œä½ å¹¶ä¸æ‹¥æœ‰å®ƒã€‚ä½†æ˜¯ä¸€ä¸ª<code>String</code>æ˜¯ä¸€ä¸ª<em>æ‹¥æœ‰</em>çš„ç±»å‹ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šçŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</p>
<p><code>&amp;str</code>å’Œ<code>String</code>éƒ½æ˜¯UTF-8ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å†™</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">"ì„œíƒœì§€"</span><span class="token punctuation">;</span> <span class="token comment">// This is a Korean name. No problem, because a &amp;str is UTF-8.</span>
    <span class="token keyword">let</span> other_name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Adrian Fahrenheit ÈšepeÈ™"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Èš and È™ are no problem in UTF-8.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥åœ¨<code>String::from("Adrian Fahrenheit ÈšepeÈ™")</code>ä¸­çœ‹åˆ°ï¼Œå¾ˆå®¹æ˜“ä»<code>&amp;str</code>ä¸­åšå‡ºä¸€ä¸ª<code>String</code>ã€‚è¿™ä¸¤ç§ç±»å‹è™½ç„¶ä¸åŒï¼Œä½†è”ç³»éå¸¸ç´§å¯†ã€‚</p>
<p>ä½ ç”šè‡³å¯ä»¥å†™è¡¨æƒ…ç¬¦å·ï¼Œè¿™è¦æ„Ÿè°¢UTF-8ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">"ğŸ˜‚"</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"My name is actually {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œä¼šæ‰“å°<code>My name is actually ğŸ˜‚</code>ï¼Œé™¤éä½ çš„å‘½ä»¤è¡Œä¸èƒ½æ‰“å°ã€‚é‚£ä¹ˆå®ƒä¼šæ˜¾ç¤º<code>My name is actually ï¿½</code>ã€‚ä½†Rustå¯¹emojisæˆ–å…¶ä»–Unicodeæ²¡æœ‰é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹<code>str</code>ä½¿ç”¨<code>&amp;</code>çš„åŸå› ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬ç†è§£ã€‚</p>
<ul>
<li><code>str</code>æ˜¯ä¸€ä¸ªåŠ¨æ€å¤§å°çš„ç±»å‹(åŠ¨æ€å¤§å°=å¤§å°å¯ä»¥ä¸åŒ)ã€‚æ¯”å¦‚ â€œì„œíƒœì§€â€å’Œ â€œAdrian Fahrenheit ÈšepeÈ™â€è¿™ä¸¤ä¸ªåå­—çš„å¤§å°æ˜¯ä¸ä¸€æ ·çš„ã€‚</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"A String is always {:?} bytes. It is Sized."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// std::mem::size_of::&lt;Type&gt;() gives you the size in bytes of a type</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"And an i8 is always {:?} bytes. It is Sized."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i8</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"And an f64 is always {:?} bytes. It is Sized."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">f64</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"But a &amp;str? It can be anything. 'ì„œíƒœì§€' is {:?} bytes. It is not Sized."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token string">"ì„œíƒœì§€"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// std::mem::size_of_val() gives you the size in bytes of a variable</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"And 'Adrian Fahrenheit ÈšepeÈ™' is {:?} bytes. It is not Sized."</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token string">"Adrian Fahrenheit ÈšepeÈ™"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">A String is always 24 bytes. It is Sized.
And an i8 is always 1 bytes. It is Sized.
And an f64 is always 8 bytes. It is Sized.
But a &amp;str? It can be anything. 'ì„œíƒœì§€' is 9 bytes. It is not Sized.
And 'Adrian Fahrenheit ÈšepeÈ™' is 25 bytes. It is not Sized.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª &amp;ï¼Œå› ä¸º <code>&amp;</code> æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œ Rust çŸ¥é“æŒ‡é’ˆçš„å¤§å°ã€‚æ‰€ä»¥æŒ‡é’ˆä¼šæ”¾åœ¨æ ˆä¸­ã€‚å¦‚æœæˆ‘ä»¬å†™<code>str</code>ï¼ŒRustå°±ä¸çŸ¥é“è¯¥æ€ä¹ˆåšäº†ï¼Œå› ä¸ºå®ƒä¸çŸ¥é“æŒ‡é’ˆçš„å¤§å°ã€‚</p>
<p>æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å†™å‡º<code>String</code>ã€‚ä¸‹é¢æ˜¯ä¸€äº›ã€‚</p>
<ul>
<li><code>String::from("This is the string text");</code> è¿™æ˜¯Stringçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæ¥å—æ–‡æœ¬å¹¶åˆ›å»ºä¸€ä¸ªString.</li>
<li><code>"This is the string text".to_string()</code>. è¿™æ˜¯&amp;strçš„ä¸€ä¸ªæ–¹æ³•ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªStringã€‚</li>
<li><code>format!</code> å®ã€‚<br>è¿™å’Œ<code>println!</code>ä¸€æ ·ï¼Œåªæ˜¯å®ƒåˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ‰“å°ã€‚æ‰€ä»¥ä½ å¯ä»¥è¿™æ ·åš:</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_name <span class="token operator">=</span> <span class="token string">"Billybrobby"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_country <span class="token operator">=</span> <span class="token string">"USA"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_home <span class="token operator">=</span> <span class="token string">"Korea"</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> together <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span>
        <span class="token string">"I am {} and I come from {} but I live in {}."</span><span class="token punctuation">,</span>
        my_name<span class="token punctuation">,</span> my_country<span class="token punctuation">,</span> my_home
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªä¸€èµ·å‘½åçš„å­—ç¬¦ä¸²ï¼Œä½†è¿˜æ²¡æœ‰æ‰“å°å‡ºæ¥ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§åˆ›å»ºStringçš„æ–¹æ³•å«åš<code>.into()</code>ï¼Œä½†å®ƒæœ‰ç‚¹ä¸åŒï¼Œå› ä¸º<code>.into()</code>å¹¶ä¸åªæ˜¯ç”¨æ¥åˆ›å»º<code>String</code>ã€‚æœ‰äº›ç±»å‹å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨<code>From</code>å’Œ<code>.into()</code>è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ï¼Œå¹¶ä»å¦ä¸€ç§ç±»å‹è½¬æ¢å‡ºæ¥ã€‚è€Œå¦‚æœä½ æœ‰<code>From</code>ï¼Œé‚£ä¹ˆä½ ä¹Ÿæœ‰<code>.into()</code>ã€‚<code>From</code> æ›´åŠ æ¸…æ™°ï¼Œå› ä¸ºä½ å·²ç»çŸ¥é“äº†ç±»å‹:ä½ çŸ¥é“ <code>String::from("Some str")</code> æ˜¯ä¸€ä¸ªæ¥è‡ª <code>&amp;str</code> çš„ <code>String</code>ã€‚ä½†æ˜¯å¯¹äº<code>.into()</code>ï¼Œæœ‰æ—¶å€™ç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token string">"Try to make this a String"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Rustä¸çŸ¥é“ä½ è¦çš„æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå› ä¸ºå¾ˆå¤šç±»å‹éƒ½å¯ä»¥ä»ä¸€ä¸ª<code>&amp;str</code>åšå‡ºæ¥ã€‚å®ƒè¯´:â€æˆ‘å¯ä»¥æŠŠä¸€ä¸ª&amp;stråšæˆå¾ˆå¤šä¸œè¥¿ã€‚ä½ æƒ³è¦å“ªä¸€ç§ï¼Ÿâ€</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0282]: type annotations needed
 --&gt; src\main.rs:2:9
  |
2 |     let my_string = "Try to make this a String".into();
  |         ^^^^^^^^^ consider giving `my_string` a type<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token string">"Try to make this a String"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ä½ å¾—åˆ°äº†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<h2 id="constå’Œstatic"><a href="#constå’Œstatic" class="headerlink" title="constå’Œstatic"></a>constå’Œstatic</h2><p>æœ‰ä¸¤ç§ç±»å‹ä¸ç”¨<code>let</code>æ¥å£°æ˜: <code>const</code>å’Œ<code>static</code>ã€‚å¦å¤–ï¼ŒRustä¸ä¼šä½¿ç”¨ç±»å‹æ¨å¯¼:ä½ éœ€è¦ä¸ºå®ƒä»¬å†™ç±»å‹ã€‚è¿™äº›éƒ½æ˜¯é’ˆå¯¹ä¸ä¼šæ”¹å˜çš„å˜é‡(<code>const</code>çš„æ„æ€æ˜¯å¸¸é‡), ä¸åŒçš„æ˜¯:</p>
<ul>
<li><code>const</code>æ˜¯ä¸€ä¸ªä¸ä¼šæ”¹å˜çš„å€¼</li>
<li><code>static</code>æ˜¯ä¸€ä¸ªä¸ä¼šæ”¹å˜çš„å€¼ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªå›ºå®šçš„å†…å­˜ä½ç½®</li>
</ul>
<p>æ‰€ä»¥å®ƒä»¬å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚Rustç¨‹åºå‘˜å‡ ä¹æ€»æ˜¯ä½¿ç”¨<code>const</code>ã€‚</p>
<p>ä¸€èˆ¬ç”¨å…¨å¤§å†™å­—æ¯ä½œä¸ºåå­—ï¼Œè€Œä¸”é€šå¸¸åœ¨<code>main</code>ä¹‹å¤–ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥åœ¨æ•´ä¸ªç¨‹åºä¸­ç”Ÿå­˜ã€‚</p>
<p>ä¸¤ä¸ªä¾‹å­æ˜¯ <code>const NUMBER_OF_MONTHS: u32 = 12;</code> å’Œ <code>static SEASONS: [&amp;str; 4] = ["Spring", "Summer", "Fall", "Winter"];</code></p>
<h2 id="å…³äºå¼•ç”¨çš„æ›´å¤šä¿¡æ¯"><a href="#å…³äºå¼•ç”¨çš„æ›´å¤šä¿¡æ¯" class="headerlink" title="å…³äºå¼•ç”¨çš„æ›´å¤šä¿¡æ¯"></a>å…³äºå¼•ç”¨çš„æ›´å¤šä¿¡æ¯</h2><p>å¼•ç”¨åœ¨Rustä¸­éå¸¸é‡è¦ã€‚Rustä½¿ç”¨å¼•ç”¨æ¥ç¡®ä¿æ‰€æœ‰çš„å†…å­˜è®¿é—®æ˜¯å®‰å…¨çš„ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>&amp;</code>æ¥åˆ›å»ºä¸€ä¸ªå¼•ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> ref_one <span class="token operator">=</span> <span class="token operator">&amp;</span>country<span class="token punctuation">;</span>
    <span class="token keyword">let</span> ref_two <span class="token operator">=</span> <span class="token operator">&amp;</span>country<span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> ref_one<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±ä¼šæ‰“å°å‡º<code>Austria</code>ã€‚</p>
<p>åœ¨ä»£ç ä¸­ï¼Œ<code>country</code>æ˜¯ä¸€ä¸ª<code>String</code>ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ª<code>country</code>çš„å¼•ç”¨ã€‚å®ƒä»¬çš„ç±»å‹æ˜¯<code>&amp;String</code>ï¼Œä½ è¯´è¿™æ˜¯ä¸€ä¸ª â€œå­—ç¬¦ä¸²çš„å¼•ç”¨â€ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸‰ä¸ªå¼•ç”¨æˆ–è€…ä¸€ç™¾ä¸ªå¯¹ <code>country</code> çš„å¼•ç”¨ï¼Œè¿™éƒ½æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>ä½†è¿™æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> country_ref <span class="token operator">=</span> <span class="token operator">&amp;</span>country<span class="token punctuation">;</span>
    country_ref <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token function">return_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>return_str()</code>å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªStringï¼Œç„¶åå®ƒåˆ›å»ºäº†ä¸€ä¸ªå¯¹Stringçš„å¼•ç”¨ã€‚ç„¶åå®ƒè¯•å›¾è¿”å›å¼•ç”¨ã€‚ä½†æ˜¯<code>country</code>è¿™ä¸ªStringåªæ´»åœ¨å‡½æ•°é‡Œé¢ï¼Œç„¶åå®ƒå°±æ­»äº†ã€‚ä¸€æ—¦ä¸€ä¸ªå˜é‡æ¶ˆå¤±äº†ï¼Œè®¡ç®—æœºå°±ä¼šæ¸…ç†å†…å­˜ï¼Œå¹¶å°†å…¶ç”¨äºå…¶ä»–ç”¨é€”ã€‚æ‰€ä»¥åœ¨å‡½æ•°ç»“æŸåï¼Œ<code>country_ref</code>å¼•ç”¨çš„æ˜¯å·²ç»æ¶ˆå¤±çš„å†…å­˜ï¼Œè¿™æ˜¯ä¸å¯¹çš„ã€‚Rusté˜²æ­¢æˆ‘ä»¬åœ¨è¿™é‡ŒçŠ¯å†…å­˜çš„é”™è¯¯ã€‚</p>
<p>è¿™å°±æ˜¯æˆ‘ä»¬ä¸Šé¢è®²åˆ°çš„ â€œæ‹¥æœ‰â€ç±»å‹çš„é‡è¦éƒ¨åˆ†ã€‚å› ä¸ºä½ æ‹¥æœ‰ä¸€ä¸ª<code>String</code>ï¼Œä½ å¯ä»¥æŠŠå®ƒä¼ ç»™åˆ«äººã€‚ä½†æ˜¯å¦‚æœ <code>&amp;String</code> çš„ <code>String</code> æ­»äº†ï¼Œé‚£ä¹ˆ <code>&amp;String</code> å°±ä¼šæ­»æ‰ï¼Œæ‰€ä»¥ä½ ä¸èƒ½æŠŠå®ƒçš„ â€œæ‰€æœ‰æƒâ€ä¼ ç»™åˆ«äººã€‚</p>
<h2 id="å¯å˜å¼•ç”¨"><a href="#å¯å˜å¼•ç”¨" class="headerlink" title="å¯å˜å¼•ç”¨"></a>å¯å˜å¼•ç”¨</h2><p>å¦‚æœæ‚¨æƒ³ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨æ¥æ”¹å˜æ•°æ®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚å¯¹äºå¯å˜å¼•ç”¨ï¼Œæ‚¨å¯ä»¥å†™ <code>&amp;mut</code> è€Œä¸æ˜¯ <code>&amp;</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// don't forget to write mut here!</span>
    <span class="token keyword">let</span> num_ref <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> my_number<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆè¿™ä¸¤ç§ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<code>my_number</code>æ˜¯<code>i32</code>ï¼Œ<code>num_ref</code>æ˜¯<code>&amp;mut i32</code>(æˆ‘ä»¬è¯´æ˜¯ â€œå¯å˜å¼•ç”¨<code>i32</code>â€œ)ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç”¨å®ƒæ¥ç»™my_numberåŠ 10ã€‚ä½†æ˜¯ä½ ä¸èƒ½å†™<code>num_ref += 10</code>ï¼Œå› ä¸º<code>num_ref</code>ä¸æ˜¯<code>i32</code>çš„å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ª<code>&amp;i32</code>ã€‚å…¶å®è¿™ä¸ªå€¼å°±åœ¨<code>i32</code>é‡Œé¢ã€‚ä¸ºäº†è¾¾åˆ°å€¼æ‰€åœ¨çš„åœ°æ–¹ï¼Œæˆ‘ä»¬ç”¨<code>*</code>ã€‚<code>*</code>çš„æ„æ€æ˜¯ â€œæˆ‘ä¸è¦å¼•ç”¨ï¼Œæˆ‘è¦å¼•ç”¨å¯¹åº”çš„å€¼â€ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª<code>*</code>ä¸<code>&amp;</code>æ˜¯ç›¸åçš„ã€‚å¦å¤–ï¼Œä¸€ä¸ª<code>*</code>æŠ¹å»äº†ä¸€ä¸ª<code>&amp;</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> num_ref <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> my_number<span class="token punctuation">;</span>
    <span class="token operator">*</span>num_ref <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// Use * to change the i32 value.</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> second_number <span class="token operator">=</span> <span class="token number">800</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> triple_reference <span class="token operator">=</span> <span class="token operator">&amp;&amp;</span><span class="token operator">&amp;</span>second_number<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Second_number = triple_reference? {}"</span><span class="token punctuation">,</span> second_number <span class="token operator">==</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>triple_reference<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">18
Second_number = triple_reference? true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å› ä¸ºä½¿ç”¨<code>&amp;</code>å«åš â€œå¼•ç”¨â€ï¼Œæ‰€ä»¥ä½¿ç”¨<code>*</code>å«åš â€œ<strong>de</strong>referencingâ€ã€‚</p>
<p>Rustæœ‰ä¸¤ä¸ªè§„åˆ™ï¼Œåˆ†åˆ«æ˜¯å¯å˜å¼•ç”¨å’Œä¸å¯å˜å¼•ç”¨ã€‚å®ƒä»¬éå¸¸é‡è¦ï¼Œä½†ä¹Ÿå¾ˆå®¹æ˜“è®°ä½ï¼Œå› ä¸ºå®ƒä»¬å¾ˆæœ‰æ„ä¹‰ã€‚</p>
<ul>
<li><strong>è§„åˆ™1</strong>ã€‚å¦‚æœä½ åªæœ‰ä¸å¯å˜å¼•ç”¨ï¼Œä½ å¯ä»¥æœ‰ä»»æ„å¤šçš„å¼•ç”¨ã€‚1ä¸ªä¹Ÿè¡Œï¼Œ3ä¸ªä¹Ÿè¡Œï¼Œ1000ä¸ªä¹Ÿè¡Œã€‚1ä¸ªä¹Ÿè¡Œï¼Œ3ä¸ªä¹Ÿè¡Œï¼Œ1000ä¸ªä¹Ÿè¡Œï¼Œæ²¡é—®é¢˜ã€‚</li>
<li><strong>è§„åˆ™2</strong>: å¦‚æœä½ æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œä½ åªèƒ½æœ‰ä¸€ä¸ªã€‚å¦å¤–ï¼Œä½ ä¸èƒ½åŒæ—¶ä½¿ç”¨ä¸€ä¸ªä¸å¯å˜å¼•ç”¨<strong>å’Œ</strong>ä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚</li>
</ul>
<p>è¿™æ˜¯å› ä¸ºå¯å˜å¼•ç”¨å¯ä»¥æ”¹å˜æ•°æ®ã€‚å¦‚æœä½ åœ¨å…¶ä»–å¼•ç”¨è¯»å–æ•°æ®æ—¶æ”¹å˜æ•°æ®ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚</p>
<p>ä¸€ä¸ªå¾ˆå¥½çš„ç†è§£æ–¹å¼æ˜¯æ€è€ƒä¸€ä¸ªPowerpointæ¼”ç¤ºã€‚</p>
<p>æƒ…å†µä¸€æ˜¯å…³äº<strong>åªæœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨</strong></p>
<p>æƒ…å¢ƒä¸€ ä¸€ä¸ªå‘˜å·¥æ­£åœ¨ç¼–å†™ä¸€ä¸ªPowerpointæ¼”ç¤ºæ–‡ç¨¿ï¼Œä»–å¸Œæœ›ä»–çš„ç»ç†èƒ½å¸®åŠ©ä»–ã€‚ä»–å¸Œæœ›ä»–çš„ç»ç†èƒ½å¸®åŠ©ä»–ã€‚è¯¥å‘˜å·¥å°†è‡ªå·±çš„ç™»å½•ä¿¡æ¯æä¾›ç»™ç»ç†ï¼Œå¹¶è¯·ä»–å¸®å¿™è¿›è¡Œç¼–è¾‘ã€‚ç°åœ¨ï¼Œç»ç†å¯¹è¯¥å‘˜å·¥çš„æ¼”ç¤ºæ–‡ç¨¿æœ‰äº†ä¸€ä¸ª â€œå¯å˜å¼•ç”¨â€ã€‚ç»ç†å¯ä»¥åšä»»ä½•ä»–æƒ³åšçš„ä¿®æ”¹ï¼Œç„¶åæŠŠç”µè„‘è¿˜ç»™ä»–ã€‚è¿™å¾ˆå¥½ï¼Œå› ä¸ºæ²¡æœ‰äººåœ¨çœ‹è¿™ä¸ªæ¼”ç¤ºæ–‡ç¨¿ã€‚</p>
<p>æƒ…å†µäºŒæ˜¯å…³äº<strong>åªæœ‰ä¸å¯å˜å¼•ç”¨</strong></p>
<p>æƒ…å†µäºŒ è¯¥å‘˜å·¥è¦ç»™100ä¸ªäººåšæ¼”ç¤ºã€‚ç°åœ¨è¿™100ä¸ªäººéƒ½å¯ä»¥çœ‹åˆ°è¯¥å‘˜å·¥çš„æ•°æ®ã€‚<br> ä»–ä»¬éƒ½æœ‰ä¸€ä¸ª â€œä¸å¯æ”¹å˜çš„å¼•ç”¨â€ï¼Œå³å‘˜å·¥çš„ä»‹ç»ã€‚è¿™å¾ˆå¥½ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥çœ‹åˆ°å®ƒï¼Œä½†æ²¡æœ‰äººå¯ä»¥æ”¹å˜æ•°æ®ã€‚</p>
<p>æƒ…å†µä¸‰æ˜¯<strong>æœ‰é—®é¢˜çš„æƒ…å†µ</strong></p>
<p>æƒ…å†µä¸‰ å‘˜å·¥æŠŠä»–çš„ç™»å½•ä¿¡æ¯ç»™äº†ç»ç† ä»–çš„ç»ç†ç°åœ¨æœ‰äº†ä¸€ä¸ª â€œå¯å˜å¼•ç”¨â€ã€‚ç„¶åå‘˜å·¥å»ç»™100ä¸ªäººåšæ¼”ç¤ºï¼Œä½†æ˜¯ç»ç†è¿˜æ˜¯å¯ä»¥ç™»å½•ã€‚è¿™æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºç»ç†å¯ä»¥ç™»å½•ï¼Œå¯ä»¥åšä»»ä½•äº‹æƒ…ã€‚ä¹Ÿè®¸ä»–çš„ç»ç†ä¼šç™»å½•ç”µè„‘ï¼Œç„¶åå¼€å§‹ç»™ä»–çš„æ¯äº²æ‰“ä¸€å°é‚®ä»¶! ç°åœ¨è¿™100äººä¸å¾—ä¸çœ‹ç€ç»ç†ç»™ä»–æ¯äº²å†™é‚®ä»¶ï¼Œè€Œä¸æ˜¯æ¼”ç¤ºã€‚è¿™ä¸æ˜¯ä»–ä»¬æœŸæœ›çœ‹åˆ°çš„ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨çš„ä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> number_ref <span class="token operator">=</span> <span class="token operator">&amp;</span>number<span class="token punctuation">;</span>
    <span class="token keyword">let</span> number_change <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> number<span class="token punctuation">;</span>
    <span class="token operator">*</span>number_change <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number_ref<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨æ‰“å°äº†ä¸€ä¸ªæœ‰ç”¨çš„ä¿¡æ¯æ¥å‘Šè¯‰æˆ‘ä»¬é—®é¢˜æ‰€åœ¨ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0502]: cannot borrow `number` as mutable because it is also borrowed as immutable
 --&gt; src\main.rs:4:25
  |
3 |     let number_ref = &amp;number;
  |                      ------- immutable borrow occurs here
4 |     let number_change = &amp;mut number;
  |                         ^^^^^^^^^^^ mutable borrow occurs here
5 |     *number_change += 10;
6 |     println!("{}", number_ref);
  |                    ---------- immutable borrow later used here<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶è€Œï¼Œè¿™æ®µä»£ç å¯ä»¥å·¥ä½œã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> number_change <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> number<span class="token punctuation">;</span> <span class="token comment">// create a mutable reference</span>
    <span class="token operator">*</span>number_change <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// use mutable reference to add 10</span>
    <span class="token keyword">let</span> number_ref <span class="token operator">=</span> <span class="token operator">&amp;</span>number<span class="token punctuation">;</span> <span class="token comment">// create an immutable reference</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number_ref<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// print the immutable reference</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°å‡º<code>20</code>æ²¡æœ‰é—®é¢˜ã€‚å®ƒèƒ½å·¥ä½œæ˜¯å› ä¸ºç¼–è¯‘å™¨è¶³å¤Ÿèªæ˜ï¼Œèƒ½å¤Ÿç†è§£æˆ‘ä»¬çš„ä»£ç ã€‚å®ƒçŸ¥é“æˆ‘ä»¬ä½¿ç”¨äº†<code>number_change</code>æ¥æ”¹å˜<code>number</code>ï¼Œä½†æ²¡æœ‰å†ä½¿ç”¨å®ƒã€‚æ‰€ä»¥è¿™é‡Œæ²¡æœ‰é—®é¢˜ã€‚æˆ‘ä»¬å¹¶æ²¡æœ‰å°†ä¸å¯å˜å’Œå¯å˜å¼•ç”¨ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p>æ—©æœŸåœ¨Rustä¸­ï¼Œè¿™ç§ä»£ç å®é™…ä¸Šä¼šäº§ç”Ÿé”™è¯¯ï¼Œä½†ç°åœ¨çš„ç¼–è¯‘å™¨æ›´èªæ˜äº†ã€‚å®ƒä¸ä»…èƒ½ç†è§£æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œè¿˜èƒ½ç†è§£æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æ‰€æœ‰çš„ä¸œè¥¿ã€‚</p>
<h3 id="å†è°ˆshadowing"><a href="#å†è°ˆshadowing" class="headerlink" title="å†è°ˆshadowing"></a>å†è°ˆshadowing</h3><p>è¿˜è®°å¾—æˆ‘ä»¬è¯´è¿‡ï¼Œshadowingä¸ä¼š<strong>ç ´å</strong>ä¸€ä¸ªå€¼ï¼Œè€Œæ˜¯<strong>é˜»æŒ¡</strong>å®ƒå—ï¼Ÿç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨å¼•ç”¨æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> country_ref <span class="token operator">=</span> <span class="token operator">&amp;</span>country<span class="token punctuation">;</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> country_ref<span class="token punctuation">,</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯æ‰“å°<code>Austria, 8</code>è¿˜æ˜¯<code>8, 8</code>ï¼Ÿå®ƒæ‰“å°çš„æ˜¯<code>Austria, 8</code>ã€‚é¦–å…ˆæˆ‘ä»¬å£°æ˜ä¸€ä¸ª<code>String</code>ï¼Œå«åš<code>country</code>ã€‚ç„¶åæˆ‘ä»¬ç»™è¿™ä¸ªå­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ªå¼•ç”¨<code>country_ref</code>ã€‚ç„¶åæˆ‘ä»¬ç”¨8æ¥shadowingå›½å®¶ï¼Œè¿™æ˜¯ä¸€ä¸ª<code>i32</code>ã€‚ä½†æ˜¯ç¬¬ä¸€ä¸ª<code>country</code>å¹¶æ²¡æœ‰è¢«é”€æ¯ï¼Œæ‰€ä»¥<code>country_ref</code>ä»ç„¶å†™ç€ â€œAustriaâ€ï¼Œè€Œä¸æ˜¯ â€œ8â€ã€‚ä¸‹é¢æ˜¯åŒæ ·çš„ä»£ç ï¼Œå¹¶åŠ äº†ä¸€äº›æ³¨é‡Šæ¥è¯´æ˜å®ƒçš„å·¥ä½œåŸç†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now we have a String called country</span>
    <span class="token keyword">let</span> country_ref <span class="token operator">=</span> <span class="token operator">&amp;</span>country<span class="token punctuation">;</span> <span class="token comment">// country_ref is a reference to this data. It's not going to change</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// Now we have a variable called country that is an i8. But it has no relation to the other one, or to country_ref</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> country_ref<span class="token punctuation">,</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// country_ref still refers to the data of String::from("Austria") that we gave it.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å‡½æ•°çš„å¼•ç”¨"><a href="#å‡½æ•°çš„å¼•ç”¨" class="headerlink" title="å‡½æ•°çš„å¼•ç”¨"></a>å‡½æ•°çš„å¼•ç”¨</h2><p>å¼•ç”¨å¯¹å‡½æ•°éå¸¸æœ‰ç”¨ã€‚Rustä¸­å…³äºå€¼çš„è§„åˆ™æ˜¯:ä¸€ä¸ªå€¼åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚</p>
<p>è¿™æ®µä»£ç å°†æ— æ³•å·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">print_country</span><span class="token punctuation">(</span>country_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> country_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We print "Austria"</span>
    <span class="token function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸ That was fun, let's do it again!</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒä¸èƒ½å·¥ä½œï¼Œå› ä¸º<code>country</code>è¢«ç ´åäº†ã€‚ä¸‹é¢æ˜¯å¦‚ä½•æ“ä½œçš„ã€‚</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬åˆ›å»º<code>String</code>ï¼Œç§°ä¸º<code>country</code>ã€‚<code>country</code>æ˜¯æ‰€æœ‰è€…ã€‚</li>
<li>ç¬¬äºŒæ­¥:æˆ‘ä»¬æŠŠ<code>country</code>ç»™<code>print_country</code>ã€‚<code>print_country</code>æ²¡æœ‰<code>-&gt;</code>ï¼Œæ‰€ä»¥å®ƒä¸è¿”å›ä»»ä½•ä¸œè¥¿ã€‚<code>print_country</code>å®Œæˆåï¼Œæˆ‘ä»¬çš„<code>String</code>ç°åœ¨å·²ç»æ­»äº†ã€‚</li>
<li>ç¬¬ä¸‰æ­¥:æˆ‘ä»¬å°è¯•æŠŠ<code>country</code>ç»™<code>print_country</code>ï¼Œä½†æˆ‘ä»¬å·²ç»è¿™æ ·åšäº†ã€‚æˆ‘ä»¬å·²ç»æ²¡æœ‰<code>country</code>å¯ä»¥ç»™äº†ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥è®©<code>print_country</code>ç»™<code>String</code>å›æ¥ï¼Œä½†æ˜¯æœ‰ç‚¹å°´å°¬ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">print_country</span><span class="token punctuation">(</span>country_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> country_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    country_name <span class="token comment">// return it here</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we have to use let here now to get the String back</span>
    <span class="token function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æ‰“å°å‡ºæ¥äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Austria
Austria<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ›´å¥½çš„è§£å†³æ–¹æ³•æ˜¯å¢åŠ <code>&amp;</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">print_country</span><span class="token punctuation">(</span>country_name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> country_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_country</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We print "Austria"</span>
    <span class="token function">print_country</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// That was fun, let's do it again!</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ <code>print_country()</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å— <code>String</code> çš„å¼•ç”¨: <code>&amp;String</code>ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ç»™countryä¸€ä¸ªå¼•ç”¨ï¼Œå†™ä½œ<code>&amp;country</code>ã€‚è¿™è¡¨ç¤º â€œä½ å¯ä»¥çœ‹å®ƒï¼Œä½†æˆ‘è¦ä¿ç•™å®ƒâ€ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªå¯å˜å¼•ç”¨æ¥åšç±»ä¼¼çš„äº‹æƒ…ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å¯å˜å˜é‡çš„å‡½æ•°çš„ä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">add_hungary</span><span class="token punctuation">(</span>country_name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// first we say that the function takes a mutable reference</span>
    country_name<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"-Hungary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// push_str() adds a &amp;str to a String</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Now it says: {}"</span><span class="token punctuation">,</span> country_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">add_hungary</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we also need to give it a mutable reference.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ‰“å°<code>Now it says: Austria-Hungary</code>ã€‚</p>
<p>æ‰€ä»¥å¾—å‡ºç»“è®º:</p>
<ul>
<li><code>fn function_name(variable: String)</code>æ¥æ”¶äº†<code>String</code>ï¼Œå¹¶æ‹¥æœ‰å®ƒã€‚å¦‚æœå®ƒä¸è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±ä¼šåœ¨å‡½æ•°é‡Œé¢æ­»äº¡ã€‚</li>
<li><code>fn function_name(variable: &amp;String)</code> å€Ÿç”¨ <code>String</code> å¹¶å¯ä»¥æŸ¥çœ‹å®ƒ</li>
<li><code>fn function_name(variable: &amp;mut String)</code>å€Ÿç”¨<code>String</code>ï¼Œå¯ä»¥æ›´æ”¹ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªçœ‹èµ·æ¥åƒå¯å˜å¼•ç”¨çš„ä¾‹å­ï¼Œä½†å®ƒæ˜¯ä¸åŒçš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Austria"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// country is not mutable, but we are going to print Austria-Hungary. How?</span>
    <span class="token function">adds_hungary</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">adds_hungary</span><span class="token punctuation">(</span><span class="token keyword">mut</span> country<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Here's how: adds_hungary takes the String and declares it mutable!</span>
    country<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"-Hungary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ€ä¹ˆå¯èƒ½å‘¢ï¼Ÿå› ä¸º<code>mut country</code>ä¸æ˜¯å¼•ç”¨ã€‚<code>adds_hungary</code>ç°åœ¨æ‹¥æœ‰<code>country</code>ã€‚(è®°ä½ï¼Œå®ƒå ç”¨çš„æ˜¯<code>String</code>è€Œä¸æ˜¯<code>&amp;String</code>)ã€‚å½“ä½ è°ƒç”¨<code>adds_hungary</code>çš„é‚£ä¸€åˆ»ï¼Œå®ƒå°±å®Œå…¨æˆäº†countryçš„ä¸»äººã€‚<code>country</code>ä¸<code>String::from("Austria")</code>æ²¡æœ‰å…³ç³»äº†ã€‚æ‰€ä»¥ï¼Œ<code>adds_hungary</code>å¯ä»¥æŠŠ<code>country</code>å½“ä½œå¯å˜çš„ï¼Œè¿™æ ·åšæ˜¯å®Œå…¨å®‰å…¨çš„ã€‚</p>
<p>è¿˜è®°å¾—æˆ‘ä»¬ä¸Šé¢çš„å‘˜å·¥Powerpointå’Œç»ç†çš„æƒ…å†µå—ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±å¥½æ¯”å‘˜å·¥åªæ˜¯æŠŠè‡ªå·±çš„æ•´å°ç”µè„‘äº¤ç»™äº†ç»ç†ã€‚å‘˜å·¥ä¸ä¼šå†ç¢°å®ƒï¼Œæ‰€ä»¥ç»ç†å¯ä»¥å¯¹å®ƒåšä»»ä½•ä»–æƒ³åšçš„äº‹æƒ…ã€‚</p>
<h2 id="æ‹·è´ç±»å‹"><a href="#æ‹·è´ç±»å‹" class="headerlink" title="æ‹·è´ç±»å‹"></a>æ‹·è´ç±»å‹</h2><p>Rustä¸­çš„ä¸€äº›ç±»å‹éå¸¸ç®€å•ã€‚å®ƒä»¬è¢«ç§°ä¸º<strong>æ‹·è´ç±»å‹</strong>ã€‚è¿™äº›ç®€å•çš„ç±»å‹éƒ½åœ¨æ ˆä¸­ï¼Œç¼–è¯‘å™¨çŸ¥é“å®ƒä»¬çš„å¤§å°ã€‚è¿™æ„å‘³ç€å®ƒä»¬éå¸¸å®¹æ˜“å¤åˆ¶ï¼Œæ‰€ä»¥å½“ä½ æŠŠå®ƒå‘é€åˆ°ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨æ€»æ˜¯ä¼šå¤åˆ¶ã€‚å®ƒæ€»æ˜¯å¤åˆ¶ï¼Œå› ä¸ºå®ƒä»¬æ˜¯å¦‚æ­¤çš„å°è€Œç®€å•ï¼Œæ²¡æœ‰ç†ç”±ä¸å¤åˆ¶ã€‚æ‰€ä»¥ä½ ä¸éœ€è¦æ‹…å¿ƒè¿™äº›ç±»å‹çš„æ‰€æœ‰æƒé—®é¢˜ã€‚</p>
<p>è¿™äº›ç®€å•çš„ç±»å‹åŒ…æ‹¬:æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å‡½æ•°(<code>true</code>å’Œ<code>false</code>)å’Œ<code>char</code>ã€‚</p>
<p>å¦‚ä½•çŸ¥é“ä¸€ä¸ªç±»å‹æ˜¯å¦<strong>å®ç°</strong>å¤åˆ¶ï¼Ÿ(å®ç° = èƒ½å¤Ÿä½¿ç”¨)ä½ å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ char çš„æ–‡æ¡£:</p>
<p><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/primitive.char.html">https://doc.rust-lang.org/std/primitive.char.html</a></p>
<p>åœ¨å·¦è¾¹ä½ å¯ä»¥çœ‹åˆ°<strong>Trait Implementations</strong>ã€‚ä¾‹å¦‚ä½ å¯ä»¥çœ‹åˆ°<strong>Copy</strong>, <strong>Debug</strong>, å’Œ <strong>Display</strong>ã€‚æ‰€ä»¥ä½ çŸ¥é“ï¼Œå½“ä½ æŠŠä¸€ä¸ª<code>char</code>:</p>
<ul>
<li>å½“ä½ æŠŠå®ƒå‘é€åˆ°ä¸€ä¸ªå‡½æ•°(<strong>Copy</strong>)æ—¶ï¼Œå®ƒå°±è¢«å¤åˆ¶äº†ã€‚</li>
<li>å¯ä»¥ç”¨<code>{}</code>æ‰“å°(<strong>Display</strong>)</li>
<li>å¯ä»¥ç”¨<code>{:?}</code>æ‰“å°(<strong>Debug</strong>)</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_number</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// There is no -&gt; so it's not returning anything</span>
                             <span class="token comment">// If number was not copy type, it would take it</span>
                             <span class="token comment">// and we couldn't use it again</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token function">prints_number</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Prints 8. prints_number gets a copy of my_number</span>
    <span class="token function">prints_number</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Prints 8 again.</span>
                              <span class="token comment">// No problem, because my_number is copy type!</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¦‚æœä½ çœ‹ä¸€ä¸‹Stringçš„æ–‡æ¡£ï¼Œå®ƒä¸æ˜¯æ‹·è´ç±»å‹ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/string/struct.String.html">https://doc.rust-lang.org/std/string/struct.String.html</a></p>
<p>åœ¨å·¦è¾¹çš„<strong>Trait Implementations</strong>ä¸­ï¼Œä½ å¯ä»¥æŒ‰å­—æ¯é¡ºåºæŸ¥æ‰¾ã€‚Aã€Bã€Câ€¦â€¦Cä¸­æ²¡æœ‰<strong>Copy</strong>ï¼Œä½†æ˜¯æœ‰<strong>Clone</strong>ã€‚<strong>Clone</strong>å’Œ<strong>Copy</strong>ç±»ä¼¼ï¼Œä½†é€šå¸¸éœ€è¦æ›´å¤šçš„å†…å­˜ã€‚å¦å¤–ï¼Œä½ å¿…é¡»ç”¨<code>.clone()</code>æ¥è°ƒç”¨å®ƒâ€“å®ƒä¸ä¼šè‡ªå·±å…‹éš†ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>prints_country()</code>æ‰“å°çš„æ˜¯å›½å®¶åç§°ï¼Œä¸€ä¸ª<code>String</code>ã€‚æˆ‘ä»¬æƒ³æ‰“å°ä¸¤æ¬¡ï¼Œä½†æˆ‘ä»¬ä¸èƒ½ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_country</span><span class="token punctuation">(</span>country_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> country_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Kiribati"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†ç°åœ¨æˆ‘ä»¬æ˜ç™½äº†è¿™ä¸ªä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0382]: use of moved value: `country`
 --&gt; src\main.rs:4:20
  |
2 |     let country = String::from("Kiribati");
  |         ------- move occurs because `country` has type `std::string::String`, which does not implement the `Copy` trait
3 |     prints_country(country);
  |                    ------- value moved here
4 |     prints_country(country);
  |                    ^^^^^^^ value used here after move<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‡è¦çš„éƒ¨åˆ†æ˜¯<code>which does not implement the Copy trait</code>ã€‚ä½†æ˜¯åœ¨æ–‡æ¡£ä¸­æˆ‘ä»¬çœ‹åˆ°Stringå®ç°äº†<code>Clone</code>çš„ç‰¹æ€§ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­æ·»åŠ <code>.clone()</code>ã€‚è¿™æ ·å°±åˆ›å»ºäº†ä¸€ä¸ªå…‹éš†ï¼Œç„¶åæˆ‘ä»¬å°†å…‹éš†å‘é€åˆ°å‡½æ•°ä¸­ã€‚ç°åœ¨ <code>country</code> è¿˜æ´»ç€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_country</span><span class="token punctuation">(</span>country_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> country_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> country <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Kiribati"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_country</span><span class="token punctuation">(</span>country<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// make a clone and give it to the function. Only the clone goes in, and country is still alive</span>
    <span class="token function">prints_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œå¦‚æœ<code>String</code>éå¸¸å¤§ï¼Œ<code>.clone()</code>å°±ä¼šå ç”¨å¾ˆå¤šå†…å­˜ã€‚ä¸€ä¸ª<code>String</code>å¯ä»¥æ˜¯ä¸€æ•´æœ¬ä¹¦çš„é•¿åº¦ï¼Œæˆ‘ä»¬æ¯æ¬¡è°ƒç”¨<code>.clone()</code>éƒ½ä¼šå¤åˆ¶è¿™æœ¬ä¹¦ã€‚æ‰€ä»¥ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œä½¿ç”¨<code>&amp;</code>æ¥åšå¼•ç”¨æ˜¯æ¯”è¾ƒå¿«çš„ã€‚ä¾‹å¦‚ï¼Œè¿™æ®µä»£ç å°†<code>&amp;str</code>æ¨é€åˆ°<code>String</code>ä¸Šï¼Œç„¶åæ¯æ¬¡åœ¨å‡½æ•°ä¸­ä½¿ç”¨æ—¶éƒ½ä¼šè¿›è¡Œå…‹éš†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">get_length</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Takes ownership of a String</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's {} words long."</span><span class="token punctuation">,</span> input<span class="token punctuation">.</span><span class="token function">split_whitespace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// splits to count the number of words</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">50</span> <span class="token punctuation">{</span>
        my_string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"Here are some more words "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// push the words on</span>
        <span class="token function">get_length</span><span class="token punctuation">(</span>my_string<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// gives it a clone every time</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒçš„æ‰“å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">It's 5 words long.
It's 10 words long.
...
It's 250 words long.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ˜¯50ä¸ªå…‹éš†ã€‚è¿™é‡Œæ˜¯ç”¨å¼•ç”¨ä»£æ›¿æ›´å¥½:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">get_length</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's {} words long."</span><span class="token punctuation">,</span> input<span class="token punctuation">.</span><span class="token function">split_whitespace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">50</span> <span class="token punctuation">{</span>
        my_string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"Here are some more words "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">get_length</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸æ˜¯50ä¸ªå…‹éš†ï¼Œè€Œæ˜¯0ä¸ªã€‚</p>
<h3 id="æ— å€¼å˜é‡"><a href="#æ— å€¼å˜é‡" class="headerlink" title="æ— å€¼å˜é‡"></a>æ— å€¼å˜é‡</h3><p>ä¸€ä¸ªæ²¡æœ‰å€¼çš„å˜é‡å«åš â€œæœªåˆå§‹åŒ–â€å˜é‡ã€‚æœªåˆå§‹åŒ–çš„æ„æ€æ˜¯ â€œè¿˜æ²¡æœ‰å¼€å§‹â€ã€‚å®ƒä»¬å¾ˆç®€å•:åªéœ€å†™ä¸Š<code>let</code>å’Œå˜é‡åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_variable<span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯ä½ è¿˜ä¸èƒ½ä½¿ç”¨å®ƒï¼Œå¦‚æœä»»ä½•ä¸œè¥¿éƒ½æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼ŒRustå°±ä¸ä¼šç¼–è¯‘ã€‚</p>
<p>ä½†æœ‰æ—¶å®ƒä»¬ä¼šå¾ˆæœ‰ç”¨ã€‚ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯å½“:</p>
<ul>
<li>ä½ æœ‰ä¸€ä¸ªä»£ç å—ï¼Œè€Œä½ çš„å˜é‡å€¼å°±åœ¨é‡Œé¢ï¼Œå¹¶ä¸”</li>
<li>å˜é‡éœ€è¦æ´»åœ¨ä»£ç å—ä¹‹å¤–ã€‚</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">loop_then_return</span><span class="token punctuation">(</span><span class="token keyword">mut</span> counter<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> counter <span class="token operator">%</span> <span class="token number">50</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    counter
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number<span class="token punctuation">;</span>

    <span class="token punctuation">{</span>
        <span class="token comment">// Pretend we need to have this code block</span>
        <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token comment">// Pretend there is code here to make a number</span>
            <span class="token comment">// Lots of code, and finally:</span>
            <span class="token number">57</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        my_number <span class="token operator">=</span> <span class="token function">loop_then_return</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>100</code>ã€‚</p>
<p>ä½ å¯ä»¥çœ‹åˆ° <code>my_number</code> æ˜¯åœ¨ <code>main()</code> å‡½æ•°ä¸­å£°æ˜çš„ï¼Œæ‰€ä»¥å®ƒä¸€ç›´æ´»åˆ°æœ€åã€‚ä½†æ˜¯å®ƒçš„å€¼æ˜¯åœ¨å¾ªç¯é‡Œé¢å¾—åˆ°çš„ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå€¼å’Œ<code>my_number</code>ä¸€æ ·é•¿ï¼Œå› ä¸º<code>my_number</code>æœ‰è¿™ä¸ªå€¼ã€‚è€Œå¦‚æœä½ åœ¨å—é‡Œé¢å†™äº†<code>let my_number = loop_then_return(number)</code>ï¼Œå®ƒå°±ä¼šé©¬ä¸Šæ­»æ‰ã€‚</p>
<p>å¦‚æœä½ ç®€åŒ–ä»£ç ï¼Œå¯¹æƒ³è±¡æ˜¯æœ‰å¸®åŠ©çš„ã€‚<code>loop_then_return(number)</code>ç»™å‡ºçš„ç»“æœæ˜¯100ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ é™¤å®ƒï¼Œæ”¹å†™<code>100</code>ã€‚å¦å¤–ï¼Œç°åœ¨æˆ‘ä»¬ä¸éœ€è¦ <code>number</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿåˆ é™¤å®ƒã€‚ç°åœ¨å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number<span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        my_number <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¯´<code>let my_number = { 100 };</code>å·®ä¸å¤šã€‚</p>
<p>å¦å¤–æ³¨æ„ï¼Œ<code>my_number</code>ä¸æ˜¯<code>mut</code>ã€‚æˆ‘ä»¬åœ¨ç»™å®ƒ50ä¹‹å‰å¹¶æ²¡æœ‰ç»™å®ƒä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥å®ƒçš„å€¼ä¸€ç›´æ²¡æœ‰æ”¹å˜ã€‚æœ€åï¼Œ<code>my_number</code>çš„çœŸæ­£ä»£ç åªæ˜¯è®©<code>my_number = 100;</code>ã€‚</p>
<h2 id="é›†åˆç±»å‹"><a href="#é›†åˆç±»å‹" class="headerlink" title="é›†åˆç±»å‹"></a>é›†åˆç±»å‹</h2><p>Rustæœ‰å¾ˆå¤šç±»å‹ç”¨äºåˆ›å»ºé›†åˆã€‚å½“ä½ éœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹æœ‰å¤šä¸ªå€¼æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨é›†åˆã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªå˜é‡ä¸­åŒ…å«ä½ æ‰€åœ¨å›½å®¶çš„æ‰€æœ‰åŸå¸‚çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å…ˆä»æ•°ç»„å¼€å§‹ï¼Œæ•°ç»„çš„é€Ÿåº¦æœ€å¿«ï¼Œä½†åŠŸèƒ½ä¹Ÿæœ€å°‘ã€‚å®ƒä»¬åœ¨è¿™æ–¹é¢æœ‰ç‚¹åƒ<code>&amp;str</code>ã€‚</p>
<h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>æ•°ç»„æ˜¯æ–¹æ‹¬å·å†…çš„æ•°æ®ã€‚<code>[]</code>. æ•°ç»„:</p>
<ul>
<li>ä¸èƒ½æ”¹å˜å…¶å¤§å°ã€‚</li>
<li>å¿…é¡»åªåŒ…å«ç›¸åŒçš„ç±»å‹ã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œå®ƒä»¬çš„é€Ÿåº¦éå¸¸å¿«ã€‚</p>
<p>æ•°ç»„çš„ç±»å‹æ˜¯:<code>[type; number]</code>ã€‚ä¾‹å¦‚ï¼Œ<code>["One", "Two"]</code>çš„ç±»å‹æ˜¯<code>[&amp;str; 2]</code>ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿è¿™ä¸¤ä¸ªæ•°ç»„ä¹Ÿæœ‰ä¸åŒçš„ç±»å‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> array1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"One"</span><span class="token punctuation">,</span> <span class="token string">"Two"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// This one is type [&amp;str; 2]</span>
    <span class="token keyword">let</span> array2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"One"</span><span class="token punctuation">,</span> <span class="token string">"Two"</span><span class="token punctuation">,</span> <span class="token string">"Five"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// But this one is type [&amp;str; 3]. Different type!</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¥½çš„æç¤º:è¦æƒ³çŸ¥é“ä¸€ä¸ªå˜é‡çš„ç±»å‹ï¼Œä½ å¯ä»¥é€šè¿‡ç»™ç¼–è¯‘å™¨ä¸‹åæŒ‡ä»¤æ¥ â€œè¯¢é—®â€å®ƒã€‚æ¯”å¦‚è¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> seasons <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Spring"</span><span class="token punctuation">,</span> <span class="token string">"Summer"</span><span class="token punctuation">,</span> <span class="token string">"Autumn"</span><span class="token punctuation">,</span> <span class="token string">"Winter"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> seasons2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Spring"</span><span class="token punctuation">,</span> <span class="token string">"Summer"</span><span class="token punctuation">,</span> <span class="token string">"Fall"</span><span class="token punctuation">,</span> <span class="token string">"Autumn"</span><span class="token punctuation">,</span> <span class="token string">"Winter"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    seasons<span class="token punctuation">.</span><span class="token function">ddd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
    seasons2<span class="token punctuation">.</span><span class="token function">thd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸ as well</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´:â€ä»€ä¹ˆï¼Ÿseasonsæ²¡æœ‰<code>.ddd()</code>çš„æ–¹æ³•ï¼Œseasons2ä¹Ÿæ²¡æœ‰<code>.thd()</code>çš„æ–¹æ³•ï¼ï¼â€ä½ å¯ä»¥çœ‹åˆ°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0599]: no method named `ddd` found for array `[&amp;str; 4]` in the current scope
 --&gt; src\main.rs:4:13
  |
4 |     seasons.ddd(); // 
  |             ^^^ method not found in `[&amp;str; 4]`

error[E0599]: no method named `thd` found for array `[&amp;str; 5]` in the current scope
 --&gt; src\main.rs:5:14
  |
5 |     seasons2.thd(); // 
  |              ^^^ method not found in `[&amp;str; 5]`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å®ƒå‘Šè¯‰ä½ <code>method not found in `[&amp;str; 4]`</code>ï¼Œè¿™å°±æ˜¯ç±»å‹ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ•°å€¼éƒ½ä¸€æ ·çš„æ•°ç»„ï¼Œä½ å¯ä»¥è¿™æ ·å£°æ˜ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">;</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_array<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±æ‰“å°å‡ºäº†<code>["a", "a", "a", "a", "a", "a", "a", "a", "a", "a"]</code>ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•ç»å¸¸ç”¨æ¥åˆ›å»ºç¼“å†²åŒºã€‚ä¾‹å¦‚ï¼Œ<code>let mut buffer = [0; 640]</code>åˆ›å»ºä¸€ä¸ª640ä¸ªé›¶çš„æ•°ç»„ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å°†é›¶æ”¹ä¸ºå…¶ä»–æ•°å­—ï¼Œä»¥ä¾¿æ·»åŠ æ•°æ®ã€‚</p>
<p>ä½ å¯ä»¥ç”¨[]æ¥ç´¢å¼•(è·å–)æ•°ç»„ä¸­çš„æ¡ç›®ã€‚ç¬¬ä¸€ä¸ªæ¡ç›®æ˜¯[0]ï¼Œç¬¬äºŒä¸ªæ˜¯[1]ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_numbers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 10</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ•°ç»„çš„ä¸€ä¸ªç‰‡æ–­(ä¸€å—)ã€‚é¦–å…ˆä½ éœ€è¦ä¸€ä¸ª&amp;ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸çŸ¥é“å¤§å°ã€‚ç„¶åä½ å¯ä»¥ä½¿ç”¨<code>..</code>æ¥æ˜¾ç¤ºèŒƒå›´ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ•°ç»„ã€‚<code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code>.</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> array_of_ten <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> three_to_five <span class="token operator">=</span> <span class="token operator">&amp;</span>array_of_ten<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> start_at_two <span class="token operator">=</span> <span class="token operator">&amp;</span>array_of_ten<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> end_at_five <span class="token operator">=</span> <span class="token operator">&amp;</span>array_of_ten<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> everything <span class="token operator">=</span> <span class="token operator">&amp;</span>array_of_ten<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Three to five: {:?}, start at two: {:?}, end at five: {:?}, everything: {:?}"</span><span class="token punctuation">,</span> three_to_five<span class="token punctuation">,</span> start_at_two<span class="token punctuation">,</span> end_at_five<span class="token punctuation">,</span> everything<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®°ä½è¿™ä¸€ç‚¹ã€‚</p>
<ul>
<li>ç´¢å¼•å·ä»0å¼€å§‹(ä¸æ˜¯1)</li>
<li>æŒ‡æ•°èŒƒå›´æ˜¯<strong>æ’ä»–çš„</strong>(ä¸åŒ…æ‹¬æœ€åä¸€ä¸ªæ•°å­—)ã€‚</li>
</ul>
<p>æ‰€ä»¥<code>[0..2]</code>æ˜¯æŒ‡ç¬¬ä¸€ä¸ªæŒ‡æ•°å’Œç¬¬äºŒä¸ªæŒ‡æ•°(0å’Œ1)ã€‚æˆ–è€…ä½ ä¹Ÿå¯ä»¥ç§°å®ƒä¸º â€œé›¶ç‚¹å’Œç¬¬ä¸€â€æŒ‡æ•°ã€‚å®ƒæ²¡æœ‰ç¬¬ä¸‰é¡¹ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•2ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ª<strong>åŒ…å®¹çš„</strong>èŒƒå›´ï¼Œè¿™æ„å‘³ç€å®ƒä¹ŸåŒ…æ‹¬æœ€åä¸€ä¸ªæ•°å­—ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ã€‚<br> æ·»åŠ <code>=</code>ï¼Œå†™æˆ<code>..=</code>ï¼Œè€Œä¸æ˜¯<code>..</code>ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³è¦ç¬¬ä¸€é¡¹ã€ç¬¬äºŒé¡¹å’Œç¬¬ä¸‰é¡¹ï¼Œå¯ä»¥å†™æˆ<code>[0..=2]</code>ï¼Œè€Œä¸æ˜¯<code>[0..2]</code>ã€‚</p>
<h2 id="å‘é‡"><a href="#å‘é‡" class="headerlink" title="å‘é‡"></a>å‘é‡</h2><p>å°±åƒæˆ‘ä»¬æœ‰<code>&amp;str</code>å’Œ<code>String</code>ä¸€æ ·ï¼Œæˆ‘ä»¬æœ‰æ•°ç»„å’Œå‘é‡ã€‚æ•°ç»„çš„åŠŸèƒ½å°‘äº†å°±å¿«ï¼Œå‘é‡çš„åŠŸèƒ½å¤šäº†å°±æ…¢ã€‚(å½“ç„¶ï¼ŒRustçš„é€Ÿåº¦ä¸€ç›´éƒ½æ˜¯éå¸¸å¿«çš„ï¼Œæ‰€ä»¥å‘é‡å¹¶ä¸æ…¢ï¼Œåªæ˜¯æ¯”æ•°ç»„æ…¢<em>ä¸€ç‚¹</em>)ã€‚ç±»å‹å†™æˆ<code>Vec</code>ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å«å®ƒ â€œvecâ€ã€‚</p>
<p>å‘é‡çš„å£°æ˜ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ã€‚ä¸€ç§æ˜¯åƒ<code>String</code>ä¸€æ ·ä½¿ç”¨<code>new</code>:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Windy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> name2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Gomesy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// If we run the program now, the compiler will give an error.</span>
    <span class="token comment">// It doesn't know the type of vec.</span>

    my_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it knows: it's Vec&lt;String&gt;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>name2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°<code>Vec</code>é‡Œé¢æ€»æ˜¯æœ‰å…¶ä»–ä¸œè¥¿ï¼Œè¿™å°±æ˜¯<code>&lt;&gt;</code>(è§’æ‹¬å·)çš„ä½œç”¨ã€‚<code>Vec&lt;String&gt;</code>æ˜¯ä¸€ä¸ªæœ‰ä¸€ä¸ªæˆ–å¤šä¸ª<code>String</code>çš„å‘é‡ã€‚ä½ è¿˜å¯ä»¥åœ¨é‡Œé¢æœ‰æ›´å¤šçš„ç±»å‹ã€‚æ¯”å¦‚è¯´</p>
<ul>
<li><code>Vec&lt;(i32, i32)&gt;</code> è¿™æ˜¯ä¸€ä¸ª <code>Vec</code> å…¶ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå…ƒç»„ã€‚<code>(i32, i32)</code>.</li>
<li><code>Vec&lt;Vec&lt;String&gt;&gt;</code>è¿™æ˜¯ä¸€ä¸ª<code>Vec</code>ï¼Œå…¶ä¸­æœ‰<code>Vec</code>çš„<code>Strings</code>ã€‚æ¯”å¦‚è¯´ä½ æƒ³æŠŠä½ å–œæ¬¢çš„ä¹¦ä¿å­˜ä¸º<code>Vec&lt;String&gt;</code>ã€‚ç„¶åä½ å†ç”¨å¦ä¸€æœ¬ä¹¦æ¥åšï¼Œå°±ä¼šå¾—åˆ°å¦ä¸€ä¸ª<code>Vec&lt;String&gt;</code>ã€‚ä¸ºäº†ä¿å­˜è¿™ä¸¤æœ¬ä¹¦ï¼Œä½ ä¼šæŠŠå®ƒä»¬æ”¾å…¥å¦ä¸€ä¸ª<code>Vec</code>ä¸­ï¼Œè¿™å°±æ˜¯<code>Vec&lt;Vec&lt;String&gt;&gt;</code>ã€‚</li>
</ul>
<p>ä¸å…¶ä½¿ç”¨ <code>.push()</code> è®© Rust å†³å®šç±»å‹ï¼Œä¸å¦‚ç›´æ¥å£°æ˜ç±»å‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The compiler knows the type</span>
                                              <span class="token comment">// so there is no error.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå‘é‡ä¸­çš„å…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚</p>
<p>å¦ä¸€ä¸ªåˆ›å»ºå‘é‡çš„ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ <code>vec!</code> å®ã€‚å®ƒçœ‹èµ·æ¥åƒä¸€ä¸ªæ•°ç»„å£°æ˜ï¼Œä½†å‰é¢æœ‰ <code>vec!</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç±»å‹æ˜¯<code>Vec&lt;i32&gt;</code>ã€‚ä½ ç§°å®ƒä¸º â€œi32çš„Vecâ€ã€‚è€Œ<code>Vec&lt;String&gt;</code>æ˜¯ â€œStringçš„Vecâ€ã€‚<code>Vec&lt;Vec&lt;String&gt;&gt;</code>æ˜¯ â€œStringçš„Vecçš„Vecâ€ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥å¯¹ä¸€ä¸ªå‘é‡è¿›è¡Œåˆ†ç‰‡ï¼Œå°±åƒåœ¨æ•°ç»„ä¸­ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> vec_of_ten <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Everything is the same as above except we added vec!.</span>
    <span class="token keyword">let</span> three_to_five <span class="token operator">=</span> <span class="token operator">&amp;</span>vec_of_ten<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> start_at_two <span class="token operator">=</span> <span class="token operator">&amp;</span>vec_of_ten<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> end_at_five <span class="token operator">=</span> <span class="token operator">&amp;</span>vec_of_ten<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> everything <span class="token operator">=</span> <span class="token operator">&amp;</span>vec_of_ten<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Three to five: {:?},
start at two: {:?}
end at five: {:?}
everything: {:?}"</span><span class="token punctuation">,</span> three_to_five<span class="token punctuation">,</span> start_at_two<span class="token punctuation">,</span> end_at_five<span class="token punctuation">,</span> everything<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºVectoræ¯”æ•°ç»„æ…¢ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›æ–¹æ³•è®©å®ƒæ›´å¿«ã€‚ä¸€ä¸ªvecæœ‰ä¸€ä¸ª<strong>å®¹é‡</strong>ï¼Œä¹Ÿå°±æ˜¯ç»™å‘é‡çš„ç©ºé—´ã€‚å½“ä½ åœ¨å‘é‡ä¸Šæ¨é€ä¸€ä¸ªæ–°çš„å…ƒç´ æ—¶ï¼Œå®ƒä¼šè¶Šæ¥è¶Šæ¥è¿‘å®¹é‡ã€‚ç„¶åï¼Œå¦‚æœä½ è¶…è¿‡äº†å®¹é‡ï¼Œå®ƒå°†ä½¿å…¶å®¹é‡ç¿»å€ï¼Œå¹¶å°†å…ƒç´ å¤åˆ¶åˆ°æ–°çš„ç©ºé—´ã€‚è¿™å°±æ˜¯æ‰€è°“çš„é‡æ–°åˆ†é…ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç§åä¸º<code>.capacity()</code>çš„æ–¹æ³•æ¥æŸ¥çœ‹å‘é‡çš„å®¹é‡ï¼Œåœ¨æˆ‘ä»¬å‘å®ƒæ·»åŠ å…ƒç´ æ—¶ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åä¸º<code>.capacity()</code>çš„æ–¹æ³•æ¥è§‚å¯Ÿä¸€ä¸ªå‘é‡çš„å®¹é‡ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> num_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 elements: prints 0</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one character</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 element: prints 4. Vecs with 1 item always start with capacity 4</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4 elements: still prints 4.</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8. We have 5 elements, but it doubled 4 to 8 to make space</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">0
4
4
8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™ä¸ªå‘é‡æœ‰ä¸¤æ¬¡é‡åˆ†é…: 0åˆ°4ï¼Œ4åˆ°8ã€‚æˆ‘ä»¬å¯ä»¥è®©å®ƒæ›´å¿«:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> num_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Give it capacity 8</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one character</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints 8.</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more</span>
    num_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add one more // Now we have 5 elements</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Still 8</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå‘é‡æœ‰0ä¸ªé‡åˆ†é…ï¼Œè¿™æ˜¯æ¯”è¾ƒå¥½çš„ã€‚æ‰€ä»¥å¦‚æœä½ è®¤ä¸ºä½ çŸ¥é“ä½ éœ€è¦å¤šå°‘å…ƒç´ ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>Vec::with_capacity()</code>æ¥ä½¿å®ƒæ›´å¿«ã€‚</p>
<p>ä½ è®°å¾—ä½ å¯ä»¥ç”¨<code>.into()</code>æŠŠ<code>&amp;str</code>å˜æˆ<code>String</code>ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨å®ƒæŠŠä¸€ä¸ªæ•°ç»„å˜æˆ<code>Vec</code>ã€‚ä½ å¿…é¡»å‘Šè¯‰ <code>.into()</code> ä½ æƒ³è¦ä¸€ä¸ª <code>Vec</code>ï¼Œä½†ä½ ä¸å¿…é€‰æ‹© <code>Vec</code> çš„ç±»å‹ã€‚å¦‚æœä½ ä¸æƒ³é€‰æ‹©ï¼Œä½ å¯ä»¥å†™<code>Vec&lt;_&gt;</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_vec2<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Vec&lt;_&gt; means "choose the Vec type for me"</span>
                                             <span class="token comment">// Rust will choose Vec&lt;i32&gt;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å…ƒç»„"><a href="#å…ƒç»„" class="headerlink" title="å…ƒç»„"></a>å…ƒç»„</h2><p>Rustä¸­çš„å…ƒç»„ä½¿ç”¨<code>()</code>ã€‚æˆ‘ä»¬å·²ç»è§è¿‡å¾ˆå¤šç©ºå…ƒç»„äº†ï¼Œå› ä¸ºå‡½æ•°ä¸­çš„<em>nothing</em>å®é™…ä¸Šæ„å‘³ç€ä¸€ä¸ªç©ºå…ƒç»„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">fn do_something() {}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å…¶å®æ˜¯å®ƒçš„ç®€å†™:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">fn do_something() -&gt; () {}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿™ä¸ªå‡½æ•°ä»€ä¹ˆä¹Ÿå¾—ä¸åˆ°(ä¸€ä¸ªç©ºå…ƒç»„)ï¼Œä¹Ÿä¸è¿”å›ä»€ä¹ˆ(ä¸€ä¸ªç©ºå…ƒç»„)ã€‚æ‰€ä»¥æˆ‘ä»¬å·²ç»ç»å¸¸ä½¿ç”¨å…ƒç»„äº†ã€‚å½“ä½ åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ä¸è¿”å›ä»»ä½•ä¸œè¥¿æ—¶ï¼Œä½ å®é™…ä¸Šè¿”å›çš„æ˜¯ä¸€ä¸ªç©ºå…ƒç»„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">just_prints</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Adding ; means we return an empty tuple</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å…ƒç»„å¯ä»¥å®¹çº³å¾ˆå¤šä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥å®¹çº³ä¸åŒçš„ç±»å‹ã€‚å…ƒç»„é‡Œé¢çš„å…ƒç´ ä¹Ÿæ˜¯ç”¨æ•°å­—0ã€1ã€2ç­‰æ¥åšç´¢å¼•çš„ï¼Œä½†è¦è®¿é—®å®ƒä»¬ï¼Œä½ è¦ç”¨<code>.</code>è€Œä¸æ˜¯<code>[]</code>ã€‚è®©æˆ‘ä»¬æŠŠä¸€å¤§å †ç±»å‹æ”¾åˆ°ä¸€ä¸ªå…ƒç»„ä¸­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> random_tuple <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"Here is a name"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token char string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token char string">'b'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"Inside the tuple is: First item: {:?}
Second item: {:?}
Third item: {:?}
Fourth item: {:?}
Fifth item: {:?}
Sixth item: {:?}"</span><span class="token punctuation">,</span>
        random_tuple<span class="token number">.0</span><span class="token punctuation">,</span>
        random_tuple<span class="token number">.1</span><span class="token punctuation">,</span>
        random_tuple<span class="token number">.2</span><span class="token punctuation">,</span>
        random_tuple<span class="token number">.3</span><span class="token punctuation">,</span>
        random_tuple<span class="token number">.4</span><span class="token punctuation">,</span>
        random_tuple<span class="token number">.5</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Inside the tuple is: First item: "Here is a name"
Second item: 8
Third item: ['a']
Fourth item: 'b'
Fifth item: [8, 9, 10]
Sixth item: 7.7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå…ƒç»„çš„ç±»å‹æ˜¯ <code>(&amp;str, i32, Vec&lt;char&gt;, char, [i32; 3], f64)</code>ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå…ƒç»„æ¥åˆ›å»ºå¤šä¸ªå˜é‡ã€‚çœ‹çœ‹è¿™æ®µä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"one"</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">,</span> <span class="token string">"three"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>str_vec</code>é‡Œé¢æœ‰ä¸‰ä¸ªå…ƒç´ ã€‚å¦‚æœæˆ‘ä»¬æƒ³æŠŠå®ƒä»¬æ‹‰å‡ºæ¥å‘¢ï¼Ÿè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ƒç»„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"one"</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">,</span> <span class="token string">"three"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str_vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str_vec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str_vec<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// call them a, b, and c</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡º<code>"two"</code>ï¼Œä¹Ÿå°±æ˜¯<code>b</code>ã€‚è¿™å°±æ˜¯æ‰€è°“çš„<em>è§£æ„</em>ã€‚è¿™æ˜¯å› ä¸ºé¦–å…ˆå˜é‡æ˜¯åœ¨ç»“æ„ä½“é‡Œé¢çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åˆåšäº†<code>a</code>ã€<code>b</code>ã€<code>c</code>è¿™äº›ä¸æ˜¯åœ¨ç»“æ„ä½“é‡Œé¢çš„å˜é‡ã€‚</p>
<p>å¦‚æœä½ éœ€è¦è§£æ„ï¼Œä½†åˆä¸æƒ³è¦æ‰€æœ‰çš„å˜é‡ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>_</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"one"</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">,</span> <span class="token string">"three"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> variable<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str_vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str_vec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> str_vec<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å®ƒåªåˆ›å»ºäº†ä¸€ä¸ªå«<code>variable</code>çš„å˜é‡ï¼Œä½†æ²¡æœ‰ä¸ºå…¶ä»–å€¼åšå˜é‡ã€‚</p>
<p>è¿˜æœ‰å¾ˆå¤šé›†åˆç±»å‹ï¼Œè¿˜æœ‰å¾ˆå¤šä½¿ç”¨æ•°ç»„ã€vecå’Œtupleçš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¹Ÿå°†å­¦ä¹ æ›´å¤šå…³äºå®ƒä»¬çš„çŸ¥è¯†ï¼Œä½†é¦–å…ˆæˆ‘ä»¬å°†å­¦ä¹ æ§åˆ¶æµã€‚</p>
<h2 id="æ§åˆ¶æµ"><a href="#æ§åˆ¶æµ" class="headerlink" title="æ§åˆ¶æµ"></a>æ§åˆ¶æµ</h2><p>æ§åˆ¶æµçš„æ„æ€æ˜¯å‘Šè¯‰ä½ çš„ä»£ç åœ¨ä¸åŒçš„æƒ…å†µä¸‹è¯¥æ€ä¹ˆåšã€‚æœ€ç®€å•çš„æ§åˆ¶æµæ˜¯<code>if</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> my_number <span class="token operator">==</span> <span class="token number">7</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's seven"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–æ³¨æ„ï¼Œä½ ç”¨çš„æ˜¯<code>==</code>è€Œä¸æ˜¯<code>=</code>ã€‚<code>==</code>æ˜¯ç”¨æ¥æ¯”è¾ƒçš„ï¼Œ<code>=</code>æ˜¯ç”¨æ¥<em>èµ‹å€¼</em>çš„(ç»™ä¸€ä¸ªå€¼)ã€‚å¦å¤–æ³¨æ„ï¼Œæˆ‘ä»¬å†™çš„æ˜¯<code>if my_number == 7</code>è€Œä¸æ˜¯<code>if (my_number == 7)</code>ã€‚åœ¨Rustä¸­ï¼Œä½ ä¸éœ€è¦ç”¨<code>if</code>çš„æ‹¬å·ã€‚</p>
<p><code>else if</code>å’Œ<code>else</code>ç»™ä½ æ›´å¤šçš„æ§åˆ¶:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> my_number <span class="token operator">==</span> <span class="token number">7</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's seven"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> my_number <span class="token operator">==</span> <span class="token number">6</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's six"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's a different number"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°å‡º<code>It's a different number</code>ï¼Œå› ä¸ºå®ƒä¸ç­‰äº7æˆ–6ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <code>&amp;&amp;</code>(å’Œ)å’Œ <code>||</code>(æˆ–)æ·»åŠ æ›´å¤šæ¡ä»¶ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> my_number <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> my_number <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span> <span class="token comment">// % 2 means the number that remains after diving by two</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's a positive odd number"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> my_number <span class="token operator">==</span> <span class="token number">6</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's six"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's a different number"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°å‡ºçš„æ˜¯<code>It's a positive odd number</code>ï¼Œå› ä¸ºå½“ä½ æŠŠå®ƒé™¤ä»¥2æ—¶ï¼Œä½ æœ‰ä¸€ä¸ª1çš„ä½™æ•°ï¼Œå®ƒå¤§äº0ã€‚</p>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿‡å¤šçš„<code>if</code>ã€<code>else</code>å’Œ<code>else if</code>ä¼šå¾ˆéš¾è¯»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>match</code>æ¥ä»£æ›¿ï¼Œå®ƒçœ‹èµ·æ¥æ›´å¹²å‡€ã€‚ä½†æ˜¯æ‚¨å¿…é¡»ä¸ºæ¯ä¸€ä¸ªå¯èƒ½çš„ç»“æœè¿›è¡ŒåŒ¹é…ã€‚ä¾‹å¦‚ï¼Œè¿™å°†æ— æ³•å·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number<span class="token punctuation">:</span> <span class="token keyword">u8</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> my_number <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"it's zero"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"it's one"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"it's two"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// âš ï¸</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0004]: non-exhaustive patterns: `3u8..=std::u8::MAX` not covered
 --&gt; src\main.rs:3:11
  |
3 |     match my_number {
  |           ^^^^^^^^^ pattern `3u8..=std::u8::MAX` not covered<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ„å‘³ç€ â€œä½ å‘Šè¯‰æˆ‘0åˆ°2ï¼Œä½†<code>u8</code>å¯ä»¥åˆ°255ã€‚é‚£3å‘¢ï¼Ÿé‚£4å‘¢ï¼Ÿ5å‘¢ï¼Ÿâ€ ä»¥æ­¤ç±»æ¨ã€‚æ‰€ä»¥ä½ å¯ä»¥åŠ ä¸Š<code>_</code>ï¼Œæ„æ€æ˜¯ â€œå…¶ä»–ä»»ä½•ä¸œè¥¿â€ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number<span class="token punctuation">:</span> <span class="token keyword">u8</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> my_number <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"it's zero"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"it's one"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"it's two"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's some other number"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£æ‰“å°<code>It's some other number</code>ã€‚</p>
<p>è®°ä½åŒ¹é…çš„è§„åˆ™:</p>
<ul>
<li>ä½ å†™ä¸‹<code>match</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª<code>{}</code>çš„ä»£ç å—ã€‚</li>
<li>åœ¨å·¦è¾¹å†™ä¸Š<em>æ¨¡å¼</em>ï¼Œç”¨<code>=&gt;</code>èƒ–ç®­å¤´è¯´æ˜åŒ¹é…æ—¶è¯¥æ€ä¹ˆåšã€‚</li>
<li>æ¯ä¸€è¡Œç§°ä¸ºä¸€ä¸ª â€œarmâ€ã€‚</li>
<li>åœ¨armä¹‹é—´æ”¾ä¸€ä¸ªé€—å·(ä¸æ˜¯åˆ†å·)ã€‚</li>
</ul>
<p>ä½ å¯ä»¥ç”¨åŒ¹é…æ¥å£°æ˜ä¸€ä¸ªå€¼ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second_number <span class="token operator">=</span> <span class="token keyword">match</span> my_number <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token number">5</span> <span class="token operator">=&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>second_number</code>å°†æ˜¯10ã€‚ä½ çœ‹åˆ°æœ€åçš„åˆ†å·äº†å—ï¼Ÿé‚£æ˜¯å› ä¸ºï¼Œåœ¨matchç»“æŸåï¼Œæˆ‘ä»¬å®é™…ä¸Šå‘Šè¯‰äº†ç¼–è¯‘å™¨è¿™ä¸ªä¿¡æ¯:<code>let second_number = 10;</code></p>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨æ›´å¤æ‚çš„äº‹æƒ…ä¸Šè¿›è¡ŒåŒ¹é…ã€‚ä½ ç”¨ä¸€ä¸ªå…ƒç»„æ¥åšã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> sky <span class="token operator">=</span> <span class="token string">"cloudy"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> temperature <span class="token operator">=</span> <span class="token string">"warm"</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> <span class="token punctuation">(</span>sky<span class="token punctuation">,</span> temperature<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token string">"cloudy"</span><span class="token punctuation">,</span> <span class="token string">"cold"</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's dark and unpleasant today"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"clear"</span><span class="token punctuation">,</span> <span class="token string">"warm"</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's a nice day"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"cloudy"</span><span class="token punctuation">,</span> <span class="token string">"warm"</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's dark but not bad"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not sure what the weather is."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°äº†<code>It's dark but not bad</code>ï¼Œå› ä¸ºå®ƒä¸<code>sky</code>å’Œ<code>temperature</code>çš„ â€œå¤šäº‘â€å’Œ â€œæ¸©æš–â€ç›¸åŒ¹é…ã€‚</p>
<p>ä½ ç”šè‡³å¯ä»¥æŠŠ<code>if</code>æ”¾åœ¨<code>match</code>é‡Œé¢ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ â€œmatch guardâ€ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> children <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> married <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> <span class="token punctuation">(</span>children<span class="token punctuation">,</span> married<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span>children<span class="token punctuation">,</span> married<span class="token punctuation">)</span> <span class="token keyword">if</span> married <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not married with {} children"</span><span class="token punctuation">,</span> children<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>children<span class="token punctuation">,</span> married<span class="token punctuation">)</span> <span class="token keyword">if</span> children <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> married <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Married but no children"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Married? {}. Number of children: {}."</span><span class="token punctuation">,</span> married<span class="token punctuation">,</span> children<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°<code>Married? true. Number of children: 5.</code></p>
<p>åœ¨ä¸€æ¬¡åŒ¹é…ä¸­ï¼Œä½ å¯ä»¥éšæ„ä½¿ç”¨ _ ã€‚åœ¨è¿™ä¸ªå…³äºé¢œè‰²çš„åŒ¹é…ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªé¢œè‰²ï¼Œä½†ä¸€æ¬¡åªèƒ½é€‰ä¸­ä¸€ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">match_colours</span><span class="token punctuation">(</span>rbg<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> rbg <span class="token punctuation">{</span>
        <span class="token punctuation">(</span>r<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token keyword">if</span> r <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not much red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>_<span class="token punctuation">,</span> b<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token keyword">if</span> b <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not much blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token keyword">if</span> g <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not much green"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Each colour has at least 10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> third <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">match_colours</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">match_colours</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">match_colours</span><span class="token punctuation">(</span>third<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Not much blue
Each colour has at least 10
Not much green<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¹Ÿè¯´æ˜äº†<code>match</code>è¯­å¥çš„ä½œç”¨ï¼Œå› ä¸ºåœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­ï¼Œå®ƒåªæ‰“å°äº†<code>Not much blue</code>ã€‚ä½†æ˜¯<code>first</code>ä¹Ÿæ²¡æœ‰å¤šå°‘ç»¿è‰²ã€‚<code>match</code>è¯­å¥æ€»æ˜¯åœ¨æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…é¡¹æ—¶åœæ­¢ï¼Œè€Œä¸æ£€æŸ¥å…¶ä»–çš„ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œä»£ç ç¼–è¯‘å¾—å¾ˆå¥½ï¼Œä½†ä¸æ˜¯ä½ æƒ³è¦çš„ä»£ç ã€‚</p>
<p>ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªéå¸¸å¤§çš„ <code>match</code> è¯­å¥æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨ <code>for</code> å¾ªç¯å¯èƒ½æ›´å¥½ã€‚æˆ‘ä»¬å°†å¾ˆå¿«è®¨è®ºå¾ªç¯ã€‚</p>
<p>åŒ¹é…å¿…é¡»è¿”å›ç›¸åŒçš„ç±»å‹ã€‚æ‰€ä»¥ä½ ä¸èƒ½è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> some_variable <span class="token operator">=</span> <span class="token keyword">match</span> my_number <span class="token punctuation">{</span>
        <span class="token number">10</span> <span class="token operator">=&gt;</span> <span class="token number">8</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token string">"Not ten"</span><span class="token punctuation">,</span> <span class="token comment">// âš ï¸</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨å‘Šè¯‰ä½ :</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0308]: `match` arms have incompatible types
  --&gt; src\main.rs:17:14
   |
15 |       let some_variable = match my_number {
   |  _________________________-
16 | |         10 =&gt; 8,
   | |               - this is found to be of type `{integer}`
17 | |         _ =&gt; "Not ten",
   | |              ^^^^^^^^^ expected integer, found `&amp;str`
18 | |     };
   | |_____- `match` arms have incompatible types<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·ä¹Ÿä¸è¡Œï¼ŒåŸå› åŒä¸Šã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_variable <span class="token operator">=</span> <span class="token keyword">if</span> my_number <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">{</span> <span class="token number">8</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token string">"something else "</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯è¿™æ ·å°±å¯ä»¥äº†ï¼Œå› ä¸ºä¸æ˜¯<code>match</code>ï¼Œæ‰€ä»¥ä½ æ¯æ¬¡éƒ½æœ‰ä¸åŒçš„<code>let</code>è¯­å¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> my_number <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> some_variable <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> some_variable <span class="token operator">=</span> <span class="token string">"Something else"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>@</code> ç»™ <code>match</code> è¡¨è¾¾å¼çš„å€¼èµ·ä¸€ä¸ªåå­—ï¼Œç„¶åä½ å°±å¯ä»¥ä½¿ç”¨å®ƒã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°ä¸­åŒ¹é…ä¸€ä¸ª <code>i32</code> è¾“å…¥ã€‚å¦‚æœæ˜¯4æˆ–13ï¼Œæˆ‘ä»¬è¦åœ¨<code>println!</code>è¯­å¥ä¸­ä½¿ç”¨è¿™ä¸ªæ•°å­—ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">match_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> input <span class="token punctuation">{</span>
    number <span class="token operator">@</span> <span class="token number">4</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is an unlucky number in China (sounds close to æ­»)!"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
    number <span class="token operator">@</span> <span class="token number">13</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is unlucky in North America, lucky in Italy! In bocca al lupo!"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
    _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Looks like a normal number"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">match_number</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">match_number</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">match_number</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Looks like a normal number
13 is unlucky in North America, lucky in Italy! In bocca al lupo!
4 is an unlucky number in China (sounds close to æ­»)!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h2 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h2><p>æœ‰äº†ç»“æ„ä½“ï¼Œä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„ç±»å‹ã€‚åœ¨ Rust ä¸­ï¼Œä½ ä¼šä¸€ç›´ä½¿ç”¨ç»“æ„ä½“ï¼Œå› ä¸ºå®ƒä»¬éå¸¸æ–¹ä¾¿ã€‚ç»“æ„ä½“æ˜¯ç”¨å…³é”®å­— <code>struct</code> åˆ›å»ºçš„ã€‚ç»“æ„ä½“çš„åç§°åº”è¯¥ç”¨UpperCamelCase(æ¯ä¸ªå­—ç”¨å¤§å†™å­—æ¯ï¼Œä¸è¦ç”¨ç©ºæ ¼)ã€‚å¦‚æœä½ ç”¨å…¨å°å†™çš„ç»“æ„ï¼Œç¼–è¯‘å™¨ä¼šå‘Šè¯‰ä½ ã€‚</p>
<p>æœ‰ä¸‰ç§ç±»å‹çš„ç»“æ„ã€‚ä¸€ç§æ˜¯ â€œå•å…ƒç»“æ„â€ã€‚å•å…ƒçš„æ„æ€æ˜¯ â€œæ²¡æœ‰ä»»ä½•ä¸œè¥¿â€ã€‚å¯¹äºä¸€ä¸ªå•å…ƒç»“æ„ï¼Œä½ åªéœ€è¦å†™åå­—å’Œä¸€ä¸ªåˆ†å·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">FileDirectory</span><span class="token punctuation">;</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªå…ƒç»„ç»“æ„ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªæœªå‘½åç»“æ„ã€‚ä¹‹æ‰€ä»¥æ˜¯ â€œæœªå‘½åâ€ï¼Œæ˜¯å› ä¸ºä½ åªéœ€è¦å†™ç±»å‹ï¼Œè€Œä¸æ˜¯å­—æ®µåã€‚å½“ä½ éœ€è¦ä¸€ä¸ªç®€å•çš„ç»“æ„ï¼Œå¹¶ä¸”ä¸éœ€è¦è®°ä½åå­—æ—¶ï¼Œå…ƒç»„ç»“æ„æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Colour</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_colour <span class="token operator">=</span> <span class="token class-name">Colour</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make a colour out of RGB (red, green, blue)</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The second part of the colour is: {}"</span><span class="token punctuation">,</span> my_colour<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ—¶æ‰“å°å‡º<code>The second part of the colour is: 0</code>ã€‚</p>
<p>ç¬¬ä¸‰ç§ç±»å‹æ˜¯å‘½åç»“æ„ã€‚è¿™å¯èƒ½æ˜¯æœ€å¸¸è§çš„ç»“æ„ã€‚åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼Œä½ åœ¨ä¸€ä¸ª <code>{}</code> ä»£ç å—ä¸­å£°æ˜å­—æ®µåå’Œç±»å‹ã€‚è¯·æ³¨æ„ï¼Œåœ¨å‘½åç»“æ„åé¢ä¸è¦å†™åˆ†å·ï¼Œå› ä¸ºåé¢æœ‰ä¸€æ•´ä¸ªä»£ç å—ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Colour</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Declare the same Colour tuple struct</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">SizeAndColour</span> <span class="token punctuation">{</span>
    size<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    colour<span class="token punctuation">:</span> <span class="token class-name">Colour</span><span class="token punctuation">,</span> <span class="token comment">// And we put it in our new named struct</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_colour <span class="token operator">=</span> <span class="token class-name">Colour</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> size_and_colour <span class="token operator">=</span> <span class="token class-name">SizeAndColour</span> <span class="token punctuation">{</span>
        size<span class="token punctuation">:</span> <span class="token number">150</span><span class="token punctuation">,</span>
        colour<span class="token punctuation">:</span> my_colour
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨ä¸€ä¸ªå‘½åç»“æ„ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨é€—å·æ¥åˆ†éš”å­—æ®µã€‚å¯¹äºæœ€åä¸€ä¸ªå­—æ®µï¼Œä½ å¯ä»¥åŠ ä¸€ä¸ªé€—å·æˆ–ä¸åŠ â€“è¿™å–å†³äºä½ ã€‚<code>SizeAndColour</code> åœ¨ <code>colour</code> åé¢æœ‰ä¸€ä¸ªé€—å·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Colour</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Declare the same Colour tuple struct</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">SizeAndColour</span> <span class="token punctuation">{</span>
    size<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    colour<span class="token punctuation">:</span> <span class="token class-name">Colour</span><span class="token punctuation">,</span> <span class="token comment">// And we put it in our new named struct</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†ä½ ä¸éœ€è¦å®ƒã€‚ä½†æ€»æ˜¯æ”¾ä¸€ä¸ªé€—å·å¯èƒ½æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºæœ‰æ—¶ä½ ä¼šæ”¹å˜å­—æ®µçš„é¡ºåºã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Colour</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Declare the same Colour tuple struct</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">SizeAndColour</span> <span class="token punctuation">{</span>
    size<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    colour<span class="token punctuation">:</span> <span class="token class-name">Colour</span> <span class="token comment">// No comma here</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åæˆ‘ä»¬å†³å®šæ”¹å˜é¡ºåºâ€¦</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">SizeAndColour</span> <span class="token punctuation">{</span>
    colour<span class="token punctuation">:</span> <span class="token class-name">Colour</span> <span class="token comment">// âš ï¸ Whoops! Now this doesn't have a comma.</span>
    size<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ— è®ºå“ªç§æ–¹å¼éƒ½ä¸æ˜¯å¾ˆé‡è¦ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€‰æ‹©æ˜¯å¦ä½¿ç”¨é€—å·ã€‚</p>
<p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>Country</code>ç»“æ„æ¥ä¸¾ä¾‹è¯´æ˜ã€‚<code>Country</code>ç»“æ„æœ‰<code>population</code>ã€<code>capital</code>å’Œ<code>leader_name</code>ä¸‰ä¸ªå­—æ®µã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Country</span> <span class="token punctuation">{</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    capital<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    leader_name<span class="token punctuation">:</span> <span class="token class-name">String</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> population <span class="token operator">=</span> <span class="token number">500_000</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> capital <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Elista"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> leader_name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Batu Khasikov"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> kalmykia <span class="token operator">=</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
        population<span class="token punctuation">:</span> population<span class="token punctuation">,</span>
        capital<span class="token punctuation">:</span> capital<span class="token punctuation">,</span>
        leader_name<span class="token punctuation">:</span> leader_name<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æŠŠåŒæ ·çš„ä¸œè¥¿å†™äº†ä¸¤æ¬¡ï¼Ÿæˆ‘ä»¬å†™äº†<code>population: population</code>ã€<code>capital: capital</code>å’Œ<code>leader_name: leader_name</code>ã€‚å®é™…ä¸Šï¼Œä½ ä¸éœ€è¦è¿™æ ·åš:å¦‚æœå­—æ®µåå’Œå˜é‡åæ˜¯ä¸€æ ·çš„ï¼Œä½ å°±ä¸ç”¨å†™ä¸¤æ¬¡ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Country</span> <span class="token punctuation">{</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    capital<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    leader_name<span class="token punctuation">:</span> <span class="token class-name">String</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> population <span class="token operator">=</span> <span class="token number">500_000</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> capital <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Elista"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> leader_name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Batu Khasikov"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> kalmykia <span class="token operator">=</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
        population<span class="token punctuation">,</span>
        capital<span class="token punctuation">,</span>
        leader_name<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><p><code>enum</code>æ˜¯enumerationsçš„ç®€ç§°ã€‚å®ƒä»¬çœ‹èµ·æ¥ä¸ç»“æ„ä½“éå¸¸ç›¸ä¼¼ï¼Œä½†åˆæœ‰æ‰€ä¸åŒã€‚è¿™å°±æ˜¯åŒºåˆ«:</p>
<ul>
<li>å½“ä½ æƒ³è¦ä¸€ä¸ªä¸œè¥¿<strong>å’Œ</strong>å¦ä¸€ä¸ªä¸œè¥¿æ—¶ï¼Œä½¿ç”¨<code>struct</code>.</li>
<li>å½“ä½ æƒ³è¦ä¸€ä¸ªä¸œè¥¿<strong>æˆ–</strong>å¦ä¸€ä¸ªä¸œè¥¿æ—¶ï¼Œè¯·ä½¿ç”¨ <code>enum</code>ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œç»“æ„ä½“æ˜¯ç”¨äº<strong>å¤šä¸ªäº‹ç‰©</strong>åœ¨ä¸€èµ·ï¼Œè€Œæšä¸¾åˆ™æ˜¯ç”¨äº<strong>å¤šä¸ªé€‰æ‹©</strong>åœ¨ä¸€èµ·ã€‚</p>
<p>è¦å£°æ˜ä¸€ä¸ªæšä¸¾ï¼Œè¯·å†™<code>enum</code>ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªåŒ…å«é€‰é¡¹çš„ä»£ç å—ï¼Œç”¨é€—å·åˆ†éš”ã€‚å°±åƒ <code>struct</code> ä¸€æ ·ï¼Œæœ€åä¸€éƒ¨åˆ†å¯ä»¥æœ‰é€—å·ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º <code>ThingsInTheSky</code> çš„æšä¸¾ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">ThingsInTheSky</span> <span class="token punctuation">{</span>
    <span class="token class-name">Sun</span><span class="token punctuation">,</span>
    <span class="token class-name">Stars</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå› ä¸ºä½ å¯ä»¥çœ‹åˆ°å¤ªé˜³ï¼Œ<strong>æˆ–</strong>æ˜Ÿæ˜Ÿ:ä½ å¿…é¡»é€‰æ‹©ä¸€ä¸ªã€‚è¿™äº›å«åš<strong>å˜ä½“</strong>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// create the enum with two choices</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">ThingsInTheSky</span> <span class="token punctuation">{</span>
    <span class="token class-name">Sun</span><span class="token punctuation">,</span>
    <span class="token class-name">Stars</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// With this function we can use an i32 to create ThingsInTheSky.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">create_skystate</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">ThingsInTheSky</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> time <span class="token punctuation">{</span>
        <span class="token number">6</span><span class="token punctuation">..=</span><span class="token number">18</span> <span class="token operator">=&gt;</span> <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Sun</span><span class="token punctuation">,</span> <span class="token comment">// Between 6 and 18 hours we can see the sun</span>
        _ <span class="token operator">=&gt;</span> <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Stars</span><span class="token punctuation">,</span> <span class="token comment">// Otherwise, we can see stars</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// With this function we can match against the two choices in ThingsInTheSky.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">check_skystate</span><span class="token punctuation">(</span>state<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">ThingsInTheSky</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> state <span class="token punctuation">{</span>
        <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Sun</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I can see the sun!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Stars</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I can see the stars!"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// it's 8 o'clock</span>
    <span class="token keyword">let</span> skystate <span class="token operator">=</span> <span class="token function">create_skystate</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// create_skystate returns a ThingsInTheSky</span>
    <span class="token function">check_skystate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>skystate<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Give it a reference so it can read the variable skystate</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º<code>I can see the sun!</code>ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥å°†æ•°æ®æ·»åŠ åˆ°ä¸€ä¸ªæšä¸¾ä¸­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">ThingsInTheSky</span> <span class="token punctuation">{</span>
    <span class="token class-name">Sun</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Now each variant has a string</span>
    <span class="token class-name">Stars</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">create_skystate</span><span class="token punctuation">(</span>time<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">ThingsInTheSky</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> time <span class="token punctuation">{</span>
        <span class="token number">6</span><span class="token punctuation">..=</span><span class="token number">18</span> <span class="token operator">=&gt;</span> <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Sun</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I can see the sun!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Write the strings here</span>
        _ <span class="token operator">=&gt;</span> <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Stars</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I can see the stars!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">check_skystate</span><span class="token punctuation">(</span>state<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">ThingsInTheSky</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> state <span class="token punctuation">{</span>
        <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Sun</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> description<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Give the string the name description so we can use it</span>
        <span class="token class-name">ThingsInTheSky</span><span class="token punctuation">::</span><span class="token class-name">Stars</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Or you can name it n. Or anything else - it doesn't matter</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// it's 8 o'clock</span>
    <span class="token keyword">let</span> skystate <span class="token operator">=</span> <span class="token function">create_skystate</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// create_skystate returns a ThingsInTheSky</span>
    <span class="token function">check_skystate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>skystate<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Give it a reference so it can read the variable skystate</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯ä¸€æ ·çš„:<code>I can see the sun!</code>ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ â€œå¯¼å…¥â€ä¸€ä¸ªæšä¸¾ï¼Œè¿™æ ·ä½ å°±ä¸ç”¨æ‰“é‚£ä¹ˆå¤šå­—äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ¯æ¬¡åœ¨å¿ƒæƒ…ä¸ŠåŒ¹é…æ—¶éƒ½è¦è¾“å…¥ <code>Mood::</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Mood</span> <span class="token punctuation">{</span>
    <span class="token class-name">Happy</span><span class="token punctuation">,</span>
    <span class="token class-name">Sleepy</span><span class="token punctuation">,</span>
    <span class="token class-name">NotBad</span><span class="token punctuation">,</span>
    <span class="token class-name">Angry</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">match_mood</span><span class="token punctuation">(</span>mood<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Mood</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> happiness_level <span class="token operator">=</span> <span class="token keyword">match</span> mood <span class="token punctuation">{</span>
        <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Happy</span> <span class="token operator">=&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// Here we type Mood:: every time</span>
        <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Sleepy</span> <span class="token operator">=&gt;</span> <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">NotBad</span> <span class="token operator">=&gt;</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Angry</span> <span class="token operator">=&gt;</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    happiness_level
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mood <span class="token operator">=</span> <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">NotBad</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> happiness_level <span class="token operator">=</span> <span class="token function">match_mood</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_mood<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Out of 1 to 10, my happiness is {}"</span><span class="token punctuation">,</span> happiness_level<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°çš„æ˜¯<code>Out of 1 to 10, my happiness is 7</code>ã€‚è®©æˆ‘ä»¬å¯¼å…¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°‘æ‰“ç‚¹å­—äº†ã€‚è¦å¯¼å…¥æ‰€æœ‰çš„ä¸œè¥¿ï¼Œå†™<code>*</code>ã€‚æ³¨æ„:å®ƒå’Œ<code>*</code>çš„è§£å¼•ç”¨é”®æ˜¯ä¸€æ ·çš„ï¼Œä½†å®Œå…¨ä¸åŒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Mood</span> <span class="token punctuation">{</span>
    <span class="token class-name">Happy</span><span class="token punctuation">,</span>
    <span class="token class-name">Sleepy</span><span class="token punctuation">,</span>
    <span class="token class-name">NotBad</span><span class="token punctuation">,</span>
    <span class="token class-name">Angry</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">match_mood</span><span class="token punctuation">(</span>mood<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Mood</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// We imported everything in Mood. Now we can just write Happy, Sleepy, etc.</span>
    <span class="token keyword">let</span> happiness_level <span class="token operator">=</span> <span class="token keyword">match</span> mood <span class="token punctuation">{</span>
        <span class="token class-name">Happy</span> <span class="token operator">=&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// We don't have to write Mood:: anymore</span>
        <span class="token class-name">Sleepy</span> <span class="token operator">=&gt;</span> <span class="token number">6</span><span class="token punctuation">,</span>
        <span class="token class-name">NotBad</span> <span class="token operator">=&gt;</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token class-name">Angry</span> <span class="token operator">=&gt;</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    happiness_level
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mood <span class="token operator">=</span> <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Happy</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> happiness_level <span class="token operator">=</span> <span class="token function">match_mood</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_mood<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Out of 1 to 10, my happiness is {}"</span><span class="token punctuation">,</span> happiness_level<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p><code>enum</code> çš„éƒ¨åˆ†ä¹Ÿå¯ä»¥å˜æˆä¸€ä¸ªæ•´æ•°ã€‚è¿™æ˜¯å› ä¸º Rust ç»™ <code>enum</code> çš„æ¯ä¸ªarmæä¾›äº†ä¸€ä¸ªä»¥ 0 å¼€å¤´çš„æ•°å­—ï¼Œä¾›å®ƒè‡ªå·±ä½¿ç”¨ã€‚å¦‚æœä½ çš„æšä¸¾ä¸­æ²¡æœ‰ä»»ä½•å…¶ä»–æ•°æ®ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥åšä¸€äº›äº‹æƒ…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Season</span> <span class="token punctuation">{</span>
    <span class="token class-name">Spring</span><span class="token punctuation">,</span> <span class="token comment">// If this was Spring(String) or something it wouldn't work</span>
    <span class="token class-name">Summer</span><span class="token punctuation">,</span>
    <span class="token class-name">Autumn</span><span class="token punctuation">,</span>
    <span class="token class-name">Winter</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">Season</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> four_seasons <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">Spring</span><span class="token punctuation">,</span> <span class="token class-name">Summer</span><span class="token punctuation">,</span> <span class="token class-name">Autumn</span><span class="token punctuation">,</span> <span class="token class-name">Winter</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> season <span class="token keyword">in</span> four_seasons <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> season <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">0
1
2
3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸è¿‡å¦‚æœä½ æƒ³çš„è¯ï¼Œä½ å¯ä»¥ç»™å®ƒä¸€ä¸ªä¸åŒçš„æ•°å­—â€“Rustå¹¶ä¸åœ¨æ„ï¼Œå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ¥ä½¿ç”¨å®ƒã€‚åªéœ€åœ¨ä½ æƒ³è¦çš„å˜ä½“ä¸ŠåŠ ä¸€ä¸ª <code>=</code> å’Œä½ çš„æ•°å­—ã€‚ä½ ä¸å¿…ç»™æ‰€æœ‰çš„éƒ½åˆ†é…ä¸€ä¸ªæ•°å­—ã€‚ä½†å¦‚æœä½ ä¸è¿™æ ·åšï¼ŒRustå°±ä¼šä»å‰ä¸€ä¸ªarmåŠ 1æ¥èµ‹å€¼ç»™å½“å‰armã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Star</span> <span class="token punctuation">{</span>
    <span class="token class-name">BrownDwarf</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token class-name">RedDwarf</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token class-name">YellowStar</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span>
    <span class="token class-name">RedGiant</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token class-name">DeadStar</span><span class="token punctuation">,</span> <span class="token comment">// Think about this one. What number will it have?</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">Star</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> starvec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">BrownDwarf</span><span class="token punctuation">,</span> <span class="token class-name">RedDwarf</span><span class="token punctuation">,</span> <span class="token class-name">YellowStar</span><span class="token punctuation">,</span> <span class="token class-name">RedGiant</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> star <span class="token keyword">in</span> starvec <span class="token punctuation">{</span>
        <span class="token keyword">match</span> star <span class="token keyword">as</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span>
            size <span class="token keyword">if</span> size <span class="token operator">&lt;=</span> <span class="token number">80</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not the biggest star."</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Remember: size doesn't mean anything. It's just a name we chose so we can print it</span>
            size <span class="token keyword">if</span> size <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This is a good-sized star."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"That star is pretty big!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"What about DeadStar? It's the number {}."</span><span class="token punctuation">,</span> <span class="token class-name">DeadStar</span> <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Not the biggest star.
Not the biggest star.
This is a good-sized star.
This is a good-sized star.
What about DeadStar? It's the number 1001.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>DeadStar</code>æœ¬æ¥æ˜¯4å·ï¼Œä½†ç°åœ¨æ˜¯1001ã€‚</p>
<h3 id="ä½¿ç”¨å¤šç§ç±»å‹çš„æšä¸¾"><a href="#ä½¿ç”¨å¤šç§ç±»å‹çš„æšä¸¾" class="headerlink" title="ä½¿ç”¨å¤šç§ç±»å‹çš„æšä¸¾"></a>ä½¿ç”¨å¤šç§ç±»å‹çš„æšä¸¾</h3><p>ä½ çŸ¥é“<code>Vec</code>ã€æ•°ç»„ç­‰ä¸­çš„å…ƒç´ éƒ½éœ€è¦ç›¸åŒçš„ç±»å‹(åªæœ‰tupleä¸åŒ)ã€‚ä½†å…¶å®ä½ å¯ä»¥ç”¨ä¸€ä¸ªæšä¸¾æ¥æ”¾ä¸åŒçš„ç±»å‹ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³æœ‰ä¸€ä¸ª<code>Vec</code>ï¼Œæœ‰<code>u32</code>æˆ–<code>i32</code>ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>Vec&lt;(u32, i32)&gt;</code>(ä¸€ä¸ªå¸¦æœ‰<code>(u32, i32)</code>å…ƒç»„çš„vec)ï¼Œä½†æ˜¯æˆ‘ä»¬æ¯æ¬¡åªæƒ³è¦ä¸€ä¸ªã€‚æ‰€ä»¥è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæšä¸¾ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Number</span> <span class="token punctuation">{</span>
    <span class="token constant">U32</span><span class="token punctuation">(</span><span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token constant">I32</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥æœ‰ä¸¤ä¸ªå˜ä½“:<code>U32</code>å˜ä½“é‡Œé¢æœ‰<code>u32</code>ï¼Œ<code>I32</code>å˜ä½“é‡Œé¢æœ‰<code>i32</code>ã€‚<code>U32</code>å’Œ<code>I32</code>åªæ˜¯æˆ‘ä»¬èµ·çš„åå­—ã€‚å®ƒä»¬å¯èƒ½æ˜¯<code>UThirtyTwo</code>æˆ–<code>IThirtyTwo</code>æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚</p>
<p>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æŠŠå®ƒä»¬æ”¾åˆ° <code>Vec</code> ä¸­ï¼Œæˆ‘ä»¬å°±ä¼šæœ‰ä¸€ä¸ª <code>Vec&lt;Number&gt;</code>ï¼Œç¼–è¯‘å™¨å¾ˆé«˜å…´ï¼Œå› ä¸ºéƒ½æ˜¯åŒä¸€ä¸ªç±»å‹ã€‚ç¼–è¯‘å™¨å¹¶ä¸åœ¨ä¹æˆ‘ä»¬æœ‰ <code>u32</code> æˆ– <code>i32</code>ï¼Œå› ä¸ºå®ƒä»¬éƒ½åœ¨ä¸€ä¸ªå«åš <code>Number</code> çš„å•ä¸€ç±»å‹é‡Œé¢ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œä½ å¿…é¡»é€‰æ‹©ä¸€ä¸ªï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code>.is_positive()</code>æ–¹æ³•æ¥æŒ‘é€‰ã€‚å¦‚æœæ˜¯ <code>true</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†é€‰æ‹© <code>U32</code>ï¼Œå¦‚æœæ˜¯ <code>false</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†é€‰æ‹© <code>I32</code>ã€‚</p>
<p>ç°åœ¨çš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Number</span> <span class="token punctuation">{</span>
    <span class="token constant">U32</span><span class="token punctuation">(</span><span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token constant">I32</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">get_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Number</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token keyword">match</span> input<span class="token punctuation">.</span><span class="token function">is_positive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token class-name">Number</span><span class="token punctuation">::</span><span class="token constant">U32</span><span class="token punctuation">(</span>input <span class="token keyword">as</span> <span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// change it to u32 if it's positive</span>
        <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token class-name">Number</span><span class="token punctuation">::</span><span class="token constant">I32</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// otherwise just give the number because it's already i32</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    number
<span class="token punctuation">}</span>


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token function">get_number</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">get_number</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> my_vec <span class="token punctuation">{</span>
        <span class="token keyword">match</span> item <span class="token punctuation">{</span>
            <span class="token class-name">Number</span><span class="token punctuation">::</span><span class="token constant">U32</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's a u32 with the value {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Number</span><span class="token punctuation">::</span><span class="token constant">I32</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's an i32 with the value {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡ºäº†æˆ‘ä»¬æƒ³çœ‹åˆ°çš„ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">It's an i32 with the value -800
It's a u32 with the value 8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<h2 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h2><p>æœ‰äº†å¾ªç¯ï¼Œä½ å¯ä»¥å‘Šè¯‰ Rust ç»§ç»­æŸäº‹ï¼Œç›´åˆ°ä½ æƒ³è®©å®ƒåœæ­¢ã€‚æ‚¨ä½¿ç”¨ <code>loop</code> æ¥å¯åŠ¨ä¸€ä¸ªä¸ä¼šåœæ­¢çš„å¾ªç¯ï¼Œé™¤éæ‚¨å‘Šè¯‰å®ƒä½•æ—¶<code>break</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// This program will never stop</span>
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å‘Šè¯‰ç¼–è¯‘å™¨ä»€ä¹ˆæ—¶å€™èƒ½åœæ­¢:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// set a counter to 0</span>
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        counter <span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// increase the counter by 1</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The counter is now: {}"</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> counter <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span> <span class="token comment">// stop when counter == 5</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The counter is now: 1
The counter is now: 2
The counter is now: 3
The counter is now: 4
The counter is now: 5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢æœ‰ä¸€ä¸ªå¾ªç¯ï¼Œä½ å¯ä»¥ç»™å®ƒä»¬å‘½åã€‚æœ‰äº†åå­—ï¼Œä½ å¯ä»¥å‘Šè¯‰ Rust è¦ä»å“ªä¸ªå¾ªç¯ä¸­ <code>break</code> å‡ºæ¥ã€‚ä½¿ç”¨ <code>'</code> (ç§°ä¸º â€œtickâ€) å’Œ <code>:</code> æ¥ç»™å®ƒå‘½åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Now entering the first loop."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token lifetime-annotation symbol">'first_loop</span><span class="token punctuation">:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        <span class="token comment">// Give the first loop a name</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The counter is now: {}"</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> counter <span class="token operator">&gt;</span> <span class="token number">9</span> <span class="token punctuation">{</span>
            <span class="token comment">// Starts a second loop inside this loop</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Now entering the second loop."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token lifetime-annotation symbol">'second_loop</span><span class="token punctuation">:</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>
                <span class="token comment">// now we are inside 'second_loop</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The second counter is now: {}"</span><span class="token punctuation">,</span> counter2<span class="token punctuation">)</span><span class="token punctuation">;</span>
                counter2 <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> counter2 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span> <span class="token lifetime-annotation symbol">'first_loop</span><span class="token punctuation">;</span> <span class="token comment">// Break out of 'first_loop so we can exit the program</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Now entering the first loop.
The counter is now: 1
The counter is now: 2
The counter is now: 3
The counter is now: 4
The counter is now: 5
The counter is now: 6
The counter is now: 7
The counter is now: 8
The counter is now: 9
The counter is now: 10
Now entering the second loop.
The second counter is now: 0
The second counter is now: 1
The second counter is now: 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>while</code>å¾ªç¯æ˜¯æŒ‡åœ¨æŸä»¶äº‹æƒ…è¿˜åœ¨<code>true</code>æ—¶ç»§ç»­çš„å¾ªç¯ã€‚æ¯ä¸€æ¬¡å¾ªç¯ï¼ŒRust éƒ½ä¼šæ£€æŸ¥å®ƒæ˜¯å¦ä»ç„¶æ˜¯ <code>true</code>ã€‚å¦‚æœå˜æˆ<code>false</code>ï¼ŒRustä¼šåœæ­¢å¾ªç¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> counter <span class="token operator">&lt;</span> <span class="token number">5</span> <span class="token punctuation">{</span>
        counter <span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The counter is now: {}"</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>for</code>å¾ªç¯å¯ä»¥è®©ä½ å‘Šè¯‰Rustæ¯æ¬¡è¦åšä»€ä¹ˆã€‚ä½†æ˜¯åœ¨ <code>for</code> å¾ªç¯ä¸­ï¼Œå¾ªç¯ä¼šåœ¨ä¸€å®šæ¬¡æ•°ååœæ­¢ã€‚<code>for</code>å¾ªç¯ç»å¸¸ä½¿ç”¨<strong>èŒƒå›´</strong>ã€‚ä½ ä½¿ç”¨ <code>..</code> å’Œ <code>..=</code> æ¥åˆ›å»ºä¸€ä¸ªèŒƒå›´ã€‚</p>
<ul>
<li><code>..</code>åˆ›å»ºä¸€ä¸ª<strong>æ’ä»–çš„</strong>èŒƒå›´:<code>0..3</code>åˆ›å»ºäº†<code>0, 1, 2</code>.</li>
<li><code>..=</code>åˆ›å»ºä¸€ä¸ª<strong>åŒ…å«çš„</strong>èŒƒå›´: <code>0..=3</code>åˆ›å»º<code>0, 1, 2</code>ã€‚<code>0..=3</code> = <code>0, 1, 2, 3</code>.</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The next number is: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The number is: 0
The number is: 1
The number is: 2
The next number is: 0
The next number is: 1
The next number is: 2
The next number is: 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åŒæ—¶æ³¨æ„åˆ°ï¼Œ<code>number</code>æˆä¸º0..3çš„å˜é‡åã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå«åš <code>n</code>ï¼Œæˆ–è€… <code>ntod_het___hno_f</code>ï¼Œæˆ–è€…ä»»ä½•åå­—ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>println!</code>ä¸­ä½¿ç”¨è¿™ä¸ªåå­—ã€‚</p>
<p>å¦‚æœä½ ä¸éœ€è¦å˜é‡åï¼Œå°±ç”¨<code>_</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Printing the same thing three times"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Printing the same thing three times
Printing the same thing three times
Printing the same thing three times<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸ºæˆ‘ä»¬æ¯æ¬¡éƒ½æ²¡æœ‰ç»™å®ƒä»»ä½•æ•°å­—æ¥æ‰“å°ã€‚</p>
<p>è€Œå®é™…ä¸Šï¼Œå¦‚æœä½ ç»™äº†ä¸€ä¸ªå˜é‡åå´ä¸ç”¨ï¼ŒRustä¼šå‘Šè¯‰ä½ :</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Printing the same thing three times"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°çš„å†…å®¹å’Œä¸Šé¢ä¸€æ ·ã€‚ç¨‹åºç¼–è¯‘æ­£å¸¸ï¼Œä½†Rustä¼šæé†’ä½ æ²¡æœ‰ä½¿ç”¨<code>number</code>:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">warning: unused variable: `number`
 --&gt; src\main.rs:2:9
  |
2 |     for number in 0..3 {
  |         ^^^^^^ help: if this is intentional, prefix it with an underscore: `_number`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Rust å»ºè®®å†™ <code>_number</code> è€Œä¸æ˜¯ <code>_</code>ã€‚åœ¨å˜é‡åå‰åŠ ä¸Š <code>_</code> æ„å‘³ç€ â€œä¹Ÿè®¸æˆ‘ä»¥åä¼šç”¨åˆ°å®ƒâ€ã€‚ä½†æ˜¯åªç”¨<code>_</code>æ„å‘³ç€ â€œæˆ‘æ ¹æœ¬ä¸å…³å¿ƒè¿™ä¸ªå˜é‡â€ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ ä»¥åä¼šä½¿ç”¨å®ƒä»¬ï¼Œå¹¶ä¸”ä¸æƒ³è®©ç¼–è¯‘å™¨å‘Šè¯‰ä½ ï¼Œä½ å¯ä»¥åœ¨å˜é‡åå‰é¢åŠ ä¸Š<code>_</code>ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ç”¨<code>break</code>æ¥è¿”å›ä¸€ä¸ªå€¼ã€‚<br> ä½ æŠŠå€¼å†™åœ¨ <code>break</code> ä¹‹åï¼Œå¹¶ä½¿ç”¨ <code>;</code>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨ <code>loop</code> å’Œä¸€ä¸ªæ–­ç‚¹ç»™å‡º <code>my_number</code> å€¼çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        counter <span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> counter <span class="token operator">%</span> <span class="token number">53</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span> counter<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ—¶æ‰“å°å‡º<code>56</code>ã€‚<code>break counter;</code>çš„æ„æ€æ˜¯ â€œä¸­æ–­å¹¶è¿”å›è®¡æ•°å™¨çš„å€¼â€ã€‚è€Œä¸”å› ä¸ºæ•´ä¸ªå—ä»¥<code>let</code>å¼€å§‹ï¼Œæ‰€ä»¥<code>my_number</code>å¾—åˆ°å€¼ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•ä½¿ç”¨å¾ªç¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³æˆ‘ä»¬ä¹‹å‰çš„é¢œè‰² â€œåŒ¹é…â€é—®é¢˜ã€‚è¿™æ˜¯ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºæˆ‘ä»¬è¦æ¯”è¾ƒæ‰€æœ‰çš„ä¸œè¥¿ï¼Œè€Œ â€œforâ€å¾ªç¯ä¼šæŸ¥çœ‹æ¯ä¸€é¡¹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">match_colours</span><span class="token punctuation">(</span>rbg<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Comparing a colour with {} red, {} blue, and {} green:"</span><span class="token punctuation">,</span> rbg<span class="token number">.0</span><span class="token punctuation">,</span> rbg<span class="token number">.1</span><span class="token punctuation">,</span> rbg<span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">(</span>rbg<span class="token number">.0</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>rbg<span class="token number">.1</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>rbg<span class="token number">.2</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Put the colours in a vec. Inside are tuples with the colour names</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> all_have_at_least_10 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// Start with true. We will set it to false if one colour is less than 10</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> new_vec <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item<span class="token number">.0</span> <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">{</span>
            all_have_at_least_10 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Now it's false</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not much {}."</span><span class="token punctuation">,</span> item<span class="token number">.1</span><span class="token punctuation">)</span> <span class="token comment">// And we print the colour name.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> all_have_at_least_10 <span class="token punctuation">{</span> <span class="token comment">// Check if it's still true, and print if true</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Each colour has at least 10."</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Add one more line</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> third <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">match_colours</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">match_colours</span><span class="token punctuation">(</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">match_colours</span><span class="token punctuation">(</span>third<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Comparing a colour with 200 red, 0 blue, and 0 green:
Not much blue.
Not much green.

Comparing a colour with 50 red, 50 blue, and 50 green:
Each colour has at least 10.

Comparing a colour with 200 red, 50 blue, and 0 green:
Not much green.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å®ç°ç»“æ„ä½“å’Œæšä¸¾"><a href="#å®ç°ç»“æ„ä½“å’Œæšä¸¾" class="headerlink" title="å®ç°ç»“æ„ä½“å’Œæšä¸¾"></a>å®ç°ç»“æ„ä½“å’Œæšä¸¾</h2><p>åœ¨è¿™é‡Œä½ å¯ä»¥å¼€å§‹èµ‹äºˆä½ çš„ç»“æ„ä½“å’Œæšä¸¾ä¸€äº›çœŸæ­£çš„åŠ›é‡ã€‚è¦è°ƒç”¨ <code>struct</code> æˆ– <code>enum</code> ä¸Šçš„å‡½æ•°ï¼Œè¯·ä½¿ç”¨ <code>impl</code> å—ã€‚è¿™äº›å‡½æ•°è¢«ç§°ä¸º<strong>æ–¹æ³•</strong>ã€‚<code>impl</code>å—ä¸­æœ‰ä¸¤ç§æ–¹æ³•ã€‚</p>
<ul>
<li>å¸¸è§„æ–¹æ³•:è¿™äº›æ–¹æ³•å– <strong>self</strong> (æˆ– <strong>&amp;self</strong> æˆ– <strong>&amp;mut self</strong> )ã€‚å¸¸è§„æ–¹æ³•ä½¿ç”¨<code>.</code>(å¥å·)ã€‚<code>.clone()</code>æ˜¯å¸¸è§„æ–¹æ³•çš„ä¸€ä¸ªä¾‹å­ã€‚</li>
<li>å…³è”æ–¹æ³•(æˆ– â€œé™æ€â€æ–¹æ³•):è¿™äº›æ–¹æ³•ä¸ç”¨selfã€‚å…³è”çš„æ„æ€æ˜¯ â€œç›¸å…³äºâ€ã€‚å®ƒä»¬çš„å†™æ³•ä¸åŒï¼Œä½¿ç”¨ <code>::</code>ã€‚<code>String::from()</code>æ˜¯ä¸€ä¸ªå…³è”æ–¹æ³•ï¼Œ<code>Vec::new()</code>ä¹Ÿæ˜¯ã€‚ä½ é€šå¸¸çœ‹åˆ°å…³è”æ–¹æ³•ç”¨äºåˆ›å»ºæ–°å˜é‡ã€‚</li>
</ul>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºAnimalå¹¶æ‰“å°å®ƒä»¬ã€‚</p>
<p>å¯¹äºæ–°çš„<code>struct</code>æˆ–<code>enum</code>ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨<code>{:?}</code>æ¥æ‰“å°ï¼Œä½ éœ€è¦ç»™å®ƒ<strong>Debug</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†è¿™æ ·åš:å¦‚æœä½ åœ¨ç»“æ„ä½“æˆ–æšä¸¾ä¸Šé¢å†™äº†<code>#[derive(Debug)]</code>ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥ç”¨<code>{:?}</code>æ¥æ‰“å°ã€‚è¿™äº›å¸¦æœ‰<code>#[]</code>çš„ä¿¡æ¯è¢«ç§°ä¸º<strong>å±æ€§</strong>ã€‚ä½ æœ‰æ—¶å¯ä»¥ç”¨å®ƒä»¬æ¥å‘Šè¯‰ç¼–è¯‘å™¨ç»™ä½ çš„ç»“æ„ä½“ä¸€ä¸ªèƒ½åŠ›ï¼Œæ¯”å¦‚<code>Debug</code>ã€‚å±æ€§æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬ä»¥åä¼šå­¦ä¹ å®ƒä»¬ã€‚ä½†æ˜¯<code>derive</code>å¯èƒ½æ˜¯æœ€å¸¸è§çš„ï¼Œä½ ç»å¸¸åœ¨ç»“æ„ä½“å’Œæšä¸¾ä¸Šé¢çœ‹åˆ°å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    animal_type<span class="token punctuation">:</span> <span class="token class-name">AnimalType</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">AnimalType</span> <span class="token punctuation">{</span>
    <span class="token class-name">Cat</span><span class="token punctuation">,</span>
    <span class="token class-name">Dog</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token comment">// Self means Animal.</span>
        <span class="token comment">//You can also write Animal instead of Self</span>

        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            <span class="token comment">// When we write Animal::new(), we always get a cat that is 10 years old</span>
            age<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            animal_type<span class="token punctuation">:</span> <span class="token class-name">AnimalType</span><span class="token punctuation">::</span><span class="token class-name">Cat</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">change_to_dog</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// because we are inside Animal, &amp;mut self means &amp;mut Animal</span>
                                  <span class="token comment">// use .change_to_dog() to change the cat to a dog</span>
                                  <span class="token comment">// with &amp;mut self we can change it</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Changing animal to dog!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>animal_type <span class="token operator">=</span> <span class="token class-name">AnimalType</span><span class="token punctuation">::</span><span class="token class-name">Dog</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">change_to_cat</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// use .change_to_cat() to change the dog to a cat</span>
        <span class="token comment">// with &amp;mut self we can change it</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Changing animal to cat!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>animal_type <span class="token operator">=</span> <span class="token class-name">AnimalType</span><span class="token punctuation">::</span><span class="token class-name">Cat</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">check_type</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// we want to read self</span>
        <span class="token keyword">match</span> <span class="token keyword">self</span><span class="token punctuation">.</span>animal_type <span class="token punctuation">{</span>
            <span class="token class-name">AnimalType</span><span class="token punctuation">::</span><span class="token class-name">Dog</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The animal is a dog"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">AnimalType</span><span class="token punctuation">::</span><span class="token class-name">Cat</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The animal is a cat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> new_animal <span class="token operator">=</span> <span class="token class-name">Animal</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Associated method to create a new animal</span>
                                        <span class="token comment">// It is a cat, 10 years old</span>
    new_animal<span class="token punctuation">.</span><span class="token function">check_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    new_animal<span class="token punctuation">.</span><span class="token function">change_to_dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    new_animal<span class="token punctuation">.</span><span class="token function">check_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    new_animal<span class="token punctuation">.</span><span class="token function">change_to_cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    new_animal<span class="token punctuation">.</span><span class="token function">check_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The animal is a cat
Changing animal to dog!
The animal is a dog
Changing animal to cat!
The animal is a cat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>è®°ä½ï¼ŒSelf(ç±»å‹Self)å’Œself(å˜é‡self)æ˜¯ç¼©å†™ã€‚(ç¼©å†™=ç®€å†™æ–¹å¼)</p>
<p>æ‰€ä»¥ï¼Œåœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼ŒSelf = Animalã€‚å¦å¤–ï¼Œ<code>fn change_to_dog(&amp;mut self)</code>çš„æ„æ€æ˜¯<code>fn change_to_dog(&amp;mut Animal)</code>ã€‚</p>
<p>ä¸‹é¢å†ä¸¾ä¸€ä¸ªå°ä¾‹å­ã€‚è¿™æ¬¡æˆ‘ä»¬å°†åœ¨<code>enum</code>ä¸Šä½¿ç”¨<code>impl</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Mood</span> <span class="token punctuation">{</span>
    <span class="token class-name">Good</span><span class="token punctuation">,</span>
    <span class="token class-name">Bad</span><span class="token punctuation">,</span>
    <span class="token class-name">Sleepy</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Mood</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token keyword">self</span> <span class="token punctuation">{</span>
            <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Good</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Feeling good!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Bad</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Eh, not feeling so good"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Sleepy</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Need sleep NOW"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mood <span class="token operator">=</span> <span class="token class-name">Mood</span><span class="token punctuation">::</span><span class="token class-name">Sleepy</span><span class="token punctuation">;</span>
    my_mood<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰“å°å‡º<code>Need sleep NOW</code>ã€‚</p>
<h2 id="è§£æ„"><a href="#è§£æ„" class="headerlink" title="è§£æ„"></a>è§£æ„</h2><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€äº›è§£æ„ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨<code>let</code>å€’è¿‡æ¥ä»ä¸€ä¸ªç»“æ„ä½“æˆ–æšä¸¾ä¸­è·å–å€¼ã€‚æˆ‘ä»¬äº†è§£åˆ°è¿™æ˜¯<code>destructuring</code>ï¼Œå› ä¸ºä½ å¾—åˆ°çš„å˜é‡ä¸æ˜¯ç»“æ„ä½“çš„ä¸€éƒ¨åˆ†ã€‚ç°åœ¨ä½ åˆ†åˆ«å¾—åˆ°äº†å€¼ã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Person</span> <span class="token punctuation">{</span> <span class="token comment">// make a simple struct for a person</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    real_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    happiness<span class="token punctuation">:</span> <span class="token keyword">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> papa_doc <span class="token operator">=</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span> <span class="token comment">// create variable papa_doc</span>
        name<span class="token punctuation">:</span> <span class="token string">"Papa Doc"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        real_name<span class="token punctuation">:</span> <span class="token string">"Clarence"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
        happiness<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span> <span class="token comment">// destructure papa_doc</span>
        name<span class="token punctuation">:</span> a<span class="token punctuation">,</span>
        real_name<span class="token punctuation">:</span> b<span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> c<span class="token punctuation">,</span>
        happiness<span class="token punctuation">:</span> d
    <span class="token punctuation">}</span> <span class="token operator">=</span> papa_doc<span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"They call him {} but his real name is {}. He is {} cm tall and is he happy? {}"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:<code>They call him Papa Doc but his real name is Clarence. He is 170 cm tall and is he happy? false</code></p>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯å€’è¿‡æ¥çš„ã€‚é¦–å…ˆæˆ‘ä»¬è¯´<code>let papa_doc = Person { fields }</code>æ¥åˆ›å»ºç»“æ„ã€‚ç„¶åæˆ‘ä»¬è¯´ <code>let Person { fields } = papa_doc</code> æ¥è§£æ„å®ƒã€‚</p>
<p>ä½ ä¸å¿…å†™<code>name: a</code>â€“ä½ å¯ä»¥ç›´æ¥å†™<code>name</code>ã€‚ä½†è¿™é‡Œæˆ‘ä»¬å†™ <code>name = a</code> æ˜¯å› ä¸ºæˆ‘ä»¬æƒ³ä½¿ç”¨ä¸€ä¸ªåå­—ä¸º <code>a</code> çš„å˜é‡ã€‚</p>
<p>ç°åœ¨å†ä¸¾ä¸€ä¸ªæ›´å¤§çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª <code>City</code> ç»“æ„ã€‚æˆ‘ä»¬ç»™å®ƒä¸€ä¸ª<code>new</code>å‡½æ•°æ¥åˆ›å»ºå®ƒã€‚ç„¶åæˆ‘ä»¬æœ‰ä¸€ä¸ª <code>process_city_values</code> å‡½æ•°æ¥å¤„ç†è¿™äº›å€¼ã€‚åœ¨å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ª <code>Vec</code>ï¼Œä½†ä½ å¯ä»¥æƒ³è±¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è§£æ„å®ƒä¹‹ååšæ›´å¤šçš„äº‹æƒ…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    name_before<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> name_before<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">,</span>
            name_before<span class="token punctuation">,</span>
            population<span class="token punctuation">,</span>
            date_founded<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">process_city_values</span><span class="token punctuation">(</span>city<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">City</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">,</span>
        name_before<span class="token punctuation">,</span>
        population<span class="token punctuation">,</span>
        date_founded<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> city<span class="token punctuation">;</span>
        <span class="token comment">// now we have the values to use separately</span>
    <span class="token keyword">let</span> two_names <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>name<span class="token punctuation">,</span> name_before<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The city's two names are {:?}"</span><span class="token punctuation">,</span> two_names<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> tallinn <span class="token operator">=</span> <span class="token class-name">City</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Tallinn"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Reval"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">426_538</span><span class="token punctuation">,</span> <span class="token number">1219</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">process_city_values</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tallinn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º<code>The city's two names are ["Tallinn", "Reval"]</code>ã€‚</p>
<h2 id="å¼•ç”¨å’Œç‚¹è¿ç®—ç¬¦"><a href="#å¼•ç”¨å’Œç‚¹è¿ç®—ç¬¦" class="headerlink" title="å¼•ç”¨å’Œç‚¹è¿ç®—ç¬¦"></a>å¼•ç”¨å’Œç‚¹è¿ç®—ç¬¦</h2><p>æˆ‘ä»¬äº†è§£åˆ°ï¼Œå½“ä½ æœ‰ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨<code>*</code>æ¥è·å–å€¼ã€‚å¼•ç”¨æ˜¯ä¸€ç§ä¸åŒçš„ç±»å‹ï¼Œæ‰€ä»¥è¿™æ˜¯æ— æ³•è¿è¡Œçš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> reference <span class="token operator">=</span> <span class="token operator">&amp;</span>my_number<span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_number <span class="token operator">==</span> reference<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨æ‰“å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: can't compare `{integer}` with `&amp;{integer}`
 --&gt; src\main.rs:5:30
  |
5 |     println!("{}", my_number == reference);
  |                              ^^ no implementation for `{integer} == &amp;{integer}`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥æˆ‘ä»¬æŠŠç¬¬5è¡Œæ”¹æˆ<code>println!("{}", my_number == *reference);</code>ï¼Œç°åœ¨æ‰“å°çš„æ˜¯<code>true</code>ï¼Œå› ä¸ºç°åœ¨æ˜¯<code>i32</code> == <code>i32</code>ï¼Œè€Œä¸æ˜¯<code>i32</code> == <code>&amp;i32</code>ã€‚è¿™å°±æ˜¯æ‰€è°“çš„è§£å¼•ç”¨ã€‚</p>
<p>ä½†æ˜¯å½“ä½ ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•æ—¶ï¼ŒRustä¼šä¸ºä½ è§£é™¤å¼•ç”¨ã€‚æ–¹æ³•ä¸­çš„ <code>.</code> è¢«ç§°ä¸ºç‚¹è¿ç®—ç¬¦ï¼Œå®ƒå¯ä»¥å…è´¹è¿›è¡Œé€’å½’ã€‚</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæœ‰ä¸€ä¸ª <code>u8</code> å­—æ®µçš„ç»“æ„ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å¯¹å®ƒè¿›è¡Œå¼•ç”¨ï¼Œå¹¶å°è¯•è¿›è¡Œæ¯”è¾ƒã€‚å®ƒå°†æ— æ³•å·¥ä½œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Item</span> <span class="token punctuation">{</span>
    number<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span>
        number<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> reference_number <span class="token operator">=</span> <span class="token operator">&amp;</span>item<span class="token punctuation">.</span>number<span class="token punctuation">;</span> <span class="token comment">// reference number type is &amp;u8</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> reference_number <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸ &amp;u8 and u8 cannot be compared</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸ºäº†è®©å®ƒå·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å–æ¶ˆå®šä¹‰ã€‚<code>println!("{}", *reference_number == 8);</code>.</p>
<p>ä½†å¦‚æœä½¿ç”¨ç‚¹è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬ä¸éœ€è¦<code>*</code>ã€‚ä¾‹å¦‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Item</span> <span class="token punctuation">{</span>
    number<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span>
        number<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> reference_item <span class="token operator">=</span> <span class="token operator">&amp;</span>item<span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> reference_item<span class="token punctuation">.</span>number <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we don't need to write *reference_item.number</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨è®©æˆ‘ä»¬ä¸º <code>Item</code> åˆ›å»ºä¸€ä¸ªæ–¹æ³•ï¼Œå°† <code>number</code> ä¸å¦ä¸€ä¸ªæ•°å­—è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬ä¸éœ€è¦åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ <code>*</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Item</span> <span class="token punctuation">{</span>
    number<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">compare_number</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other_number<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// takes a reference to self</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Are {} and {} equal? {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>number<span class="token punctuation">,</span> other_number<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>number <span class="token operator">==</span> other_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// We don't need to write *self.number</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> item <span class="token operator">=</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span>
        number<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> reference_item <span class="token operator">=</span> <span class="token operator">&amp;</span>item<span class="token punctuation">;</span> <span class="token comment">// This is type &amp;Item</span>
    <span class="token keyword">let</span> reference_item_two <span class="token operator">=</span> <span class="token operator">&amp;</span>reference_item<span class="token punctuation">;</span> <span class="token comment">// This is type &amp;&amp;Item</span>

    item<span class="token punctuation">.</span><span class="token function">compare_number</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// the method works</span>
    reference_item<span class="token punctuation">.</span><span class="token function">compare_number</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// it works here too</span>
    reference_item_two<span class="token punctuation">.</span><span class="token function">compare_number</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// and here</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥åªè¦è®°ä½:å½“ä½ ä½¿ç”¨<code>.</code>è¿ç®—ç¬¦æ—¶ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒ<code>*</code>ã€‚</p>
<h2 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h2><p>åœ¨å‡½æ•°ä¸­ï¼Œä½ è¦å†™å‡ºé‡‡å–ä»€ä¹ˆç±»å‹ä½œä¸ºè¾“å…¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_number</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    number
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token function">return_number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¦‚æœä½ æƒ³ç”¨çš„ä¸ä»…ä»…æ˜¯<code>i32</code>å‘¢ï¼Ÿä½ å¯ä»¥ç”¨æ³›å‹æ¥è§£å†³ã€‚Genericsçš„æ„æ€æ˜¯ â€œä¹Ÿè®¸æ˜¯ä¸€ç§ç±»å‹ï¼Œä¹Ÿè®¸æ˜¯å¦ä¸€ç§ç±»å‹â€ã€‚</p>
<p>å¯¹äºæ³›å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨è§’æ‹¬å·ï¼Œé‡Œé¢åŠ ä¸Šç±»å‹ï¼Œåƒè¿™æ ·ã€‚<code>&lt;T&gt;</code> è¿™æ„å‘³ç€ â€œä»»ä½•ç±»å‹ä½ éƒ½å¯ä»¥æ”¾å…¥å‡½æ•°ä¸­â€ é€šå¸¸æƒ…å†µä¸‹ï¼Œgenericsä½¿ç”¨ä¸€ä¸ªå¤§å†™å­—æ¯çš„ç±»å‹(Tã€Uã€Vç­‰)ï¼Œå°½ç®¡ä½ ä¸å¿…åªä½¿ç”¨ä¸€ä¸ªå­—æ¯ã€‚</p>
<p>è¿™å°±æ˜¯ä½ å¦‚ä½•æ”¹å˜å‡½æ•°ä½¿å…¶é€šç”¨çš„æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_number</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    number
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token function">return_number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‡è¦çš„éƒ¨åˆ†æ˜¯å‡½æ•°ååçš„<code>&lt;T&gt;</code>ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªï¼ŒRustä¼šè®¤ä¸ºTæ˜¯ä¸€ä¸ªå…·ä½“çš„(å…·ä½“çš„=ä¸æ˜¯é€šç”¨çš„)ç±»å‹ã€‚<br> å¦‚<code>String</code>æˆ–<code>i8</code>ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å†™å‡ºä¸€ä¸ªç±»å‹åï¼Œè¿™å°±æ›´å®¹æ˜“ç†è§£äº†ã€‚çœ‹çœ‹æˆ‘ä»¬æŠŠ <code>T</code> æ”¹æˆ <code>MyType</code> ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_number</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token class-name">MyType</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">MyType</span> <span class="token punctuation">{</span> <span class="token comment">// âš ï¸</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    number
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œ<code>MyType</code>æ˜¯å…·ä½“çš„ï¼Œä¸æ˜¯é€šç”¨çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å†™è¿™ä¸ªï¼Œæ‰€ä»¥ç°åœ¨å°±å¯ä»¥äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_number</span><span class="token operator">&lt;</span><span class="token class-name">MyType</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token class-name">MyType</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">MyType</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    number
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token function">return_number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å•å­—æ¯<code>T</code>æ˜¯äººçš„çœ¼ç›ï¼Œä½†å‡½æ•°ååé¢çš„éƒ¨åˆ†æ˜¯ç¼–è¯‘å™¨çš„ â€œçœ¼ç›â€ã€‚æ²¡æœ‰äº†å®ƒï¼Œå°±ä¸é€šç”¨äº†ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å†å›åˆ°ç±»å‹<code>T</code>ï¼Œå› ä¸ºRustä»£ç é€šå¸¸ä½¿ç”¨<code>T</code>ã€‚</p>
<p>ä½ ä¼šè®°å¾—Rustä¸­æœ‰äº›ç±»å‹æ˜¯<strong>Copy</strong>ï¼Œæœ‰äº›æ˜¯<strong>Clone</strong>ï¼Œæœ‰äº›æ˜¯<strong>Display</strong>ï¼Œæœ‰äº›æ˜¯<strong>Debug</strong>ï¼Œç­‰ç­‰ã€‚ç”¨<strong>Debug</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>{:?}</code>æ¥æ‰“å°ã€‚æ‰€ä»¥ç°åœ¨å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¦‚æœè¦æ‰“å°<code>T</code>å°±æœ‰é—®é¢˜äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">print_number</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number: {:?}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print_number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>print_number</code>éœ€è¦<strong>Debug</strong>æ‰“å°<code>number</code>ï¼Œä½†æ˜¯<code>T</code>ä¸<code>Debug</code>æ˜¯ä¸€ä¸ªç±»å‹å—ï¼Ÿä¹Ÿè®¸ä¸æ˜¯ã€‚ä¹Ÿè®¸å®ƒæ²¡æœ‰<code>#[derive(Debug)]</code>ï¼Œè°çŸ¥é“å‘¢ï¼Ÿç¼–è¯‘å™¨ä¹Ÿä¸çŸ¥é“ï¼Œæ‰€ä»¥å®ƒç»™å‡ºäº†ä¸€ä¸ªé”™è¯¯ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: `T` doesn't implement `std::fmt::Debug`
  --&gt; src\main.rs:29:43
   |
29 |     println!("Here is your number: {:?}", number);
   |                                           ^^^^^^ `T` cannot be formatted using `{:?}` because it doesn't implement `std::fmt::Debug`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Tæ²¡æœ‰å®ç°<strong>Debug</strong>ã€‚é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦è¦ä¸ºTå®ç°Debugå‘¢ï¼Ÿä¸ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“Tæ˜¯ä»€ä¹ˆã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘Šè¯‰å‡½æ•°ã€‚â€åˆ«æ‹…å¿ƒï¼Œå› ä¸ºä»»ä½•Tç±»å‹çš„å‡½æ•°éƒ½ä¼šæœ‰Debugâ€</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span><span class="token punctuation">;</span> <span class="token comment">// Debug is located at std::fmt::Debug. So now we can just write 'Debug'.</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_number</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Debug</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// &lt;T: Debug&gt; is the important part</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your number: {:?}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print_number</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨ç¼–è¯‘å™¨çŸ¥é“:â€å¥½çš„ï¼Œè¿™ä¸ªç±»å‹Tè¦æœ‰Debugâ€ã€‚ç°åœ¨ä»£ç å·¥ä½œäº†ï¼Œå› ä¸º<code>i32</code>æœ‰Debugã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»™å®ƒå¾ˆå¤šç±»å‹ã€‚<code>String</code>, <code>&amp;str</code>, ç­‰ç­‰ï¼Œå› ä¸ºå®ƒä»¬éƒ½æœ‰Debug.</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç»“æ„ï¼Œå¹¶ç”¨#[derive(Debug)]ç»™å®ƒDebugï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰“å°å®ƒã€‚æˆ‘ä»¬çš„å‡½æ•°å¯ä»¥å–<code>i32</code>ï¼ŒAnimalç»“æ„ç­‰ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_item</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Debug</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your item: {:?}"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> charlie <span class="token operator">=</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Charlie"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">;</span>

    <span class="token function">print_item</span><span class="token punctuation">(</span>charlie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_item</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Here is your item: Animal { name: "Charlie", age: 1 }
Here is your item: 55<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªé€šç”¨å‡½æ•°ä¸­éœ€è¦ä¸æ­¢ä¸€ä¸ªç±»å‹ã€‚æˆ‘ä»¬å¿…é¡»å†™å‡ºæ¯ä¸ªç±»å‹çš„åç§°ï¼Œå¹¶è€ƒè™‘å¦‚ä½•ä½¿ç”¨å®ƒã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è¦ä¸¤ä¸ªç±»å‹ã€‚é¦–å…ˆæˆ‘ä»¬è¦æ‰“å°ä¸€ä¸ªç±»å‹ä¸ºTçš„è¯­å¥ã€‚ç”¨<code>{}</code>æ‰“å°æ¯”è¾ƒå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè¦æ±‚ç”¨<code>Display</code>æ¥æ‰“å°<code>T</code>ã€‚</p>
<p>å…¶æ¬¡æ˜¯ç±»å‹Uï¼Œ<code>num_1</code>å’Œ<code>num_2</code>è¿™ä¸¤ä¸ªå˜é‡çš„ç±»å‹ä¸ºU(Uæ˜¯æŸç§æ•°å­—)ã€‚æˆ‘ä»¬æƒ³è¦æ¯”è¾ƒå®ƒä»¬ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦<code>PartialOrd</code>ã€‚è¿™ä¸ªç‰¹æ€§è®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>&lt;</code>ã€<code>&gt;</code>ã€<code>==</code>ç­‰ã€‚æˆ‘ä»¬ä¹Ÿæƒ³æ‰“å°å®ƒä»¬ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦<code>Display</code>æ¥æ‰“å°<code>U</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cmp<span class="token punctuation">::</span></span><span class="token class-name">PartialOrd</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">compare_and_display</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">:</span> <span class="token class-name">Display</span> <span class="token operator">+</span> <span class="token class-name">PartialOrd</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>statement<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> num_1<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">,</span> num_2<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}! Is {} greater than {}? {}"</span><span class="token punctuation">,</span> statement<span class="token punctuation">,</span> num_1<span class="token punctuation">,</span> num_2<span class="token punctuation">,</span> num_1 <span class="token operator">&gt;</span> num_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">compare_and_display</span><span class="token punctuation">(</span><span class="token string">"Listen up!"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡ºäº†<code>Listen up!! Is 9 greater than 8? true</code>ã€‚</p>
<p>æ‰€ä»¥<code>fn compare_and_display&lt;T: Display, U: Display + PartialOrd&gt;(statement: T, num_1: U, num_2: U)</code>è¯´ã€‚</p>
<ul>
<li>å‡½æ•°åç§°æ˜¯<code>compare_and_display</code>,</li>
<li>ç¬¬ä¸€ä¸ªç±»å‹æ˜¯Tï¼Œå®ƒæ˜¯é€šç”¨çš„ã€‚å®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨{}æ‰“å°çš„ç±»å‹ã€‚</li>
<li>ä¸‹ä¸€ä¸ªç±»å‹æ˜¯Uï¼Œå®ƒæ˜¯é€šç”¨çš„ã€‚å®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨{}æ‰“å°çš„ç±»å‹ã€‚å¦å¤–ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥æ¯”è¾ƒçš„ç±»å‹(ä½¿ç”¨ <code>&gt;</code>ã€<code>&lt;</code> å’Œ <code>==</code>)ã€‚</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»™<code>compare_and_display</code>ä¸åŒçš„ç±»å‹ã€‚<code>statement</code>å¯ä»¥æ˜¯ä¸€ä¸ª<code>String</code>ï¼Œä¸€ä¸ª<code>&amp;str</code>ï¼Œä»»ä½•æœ‰Displayçš„ç±»å‹ã€‚</p>
<p>ä¸ºäº†è®©é€šç”¨å‡½æ•°æ›´å®¹æ˜“è¯»æ‡‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼Œåœ¨ä»£ç å—ä¹‹å‰å°±å†™ä¸Š<code>where</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cmp<span class="token punctuation">::</span></span><span class="token class-name">PartialOrd</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">compare_and_display</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>statement<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> num_1<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">,</span> num_2<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">)</span>
<span class="token keyword">where</span>
    <span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token punctuation">,</span>
    <span class="token class-name">U</span><span class="token punctuation">:</span> <span class="token class-name">Display</span> <span class="token operator">+</span> <span class="token class-name">PartialOrd</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}! Is {} greater than {}? {}"</span><span class="token punctuation">,</span> statement<span class="token punctuation">,</span> num_1<span class="token punctuation">,</span> num_2<span class="token punctuation">,</span> num_1 <span class="token operator">&gt;</span> num_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">compare_and_display</span><span class="token punctuation">(</span><span class="token string">"Listen up!"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ æœ‰å¾ˆå¤šé€šç”¨ç±»å‹æ—¶ï¼Œä½¿ç”¨<code>where</code>æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p>
<p>è¿˜è¦æ³¨æ„ã€‚</p>
<ul>
<li>å¦‚æœä½ æœ‰ä¸€ä¸ªç±»å‹Tå’Œå¦ä¸€ä¸ªç±»å‹Tï¼Œå®ƒä»¬å¿…é¡»æ˜¯ç›¸åŒçš„ã€‚</li>
<li>å¦‚æœä½ æœ‰ä¸€ä¸ªç±»å‹Tå’Œå¦ä¸€ä¸ªç±»å‹Uï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸åŒçš„ã€‚ä½†å®ƒä»¬ä¹Ÿå¯ä»¥æ˜¯ç›¸åŒçš„ã€‚</li>
</ul>
<p>æ¯”å¦‚è¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">say_two</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>statement_1<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> statement_2<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Type T needs Display, type U needs Display</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I have two things to say: {} and {}"</span><span class="token punctuation">,</span> statement_1<span class="token punctuation">,</span> statement_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token function">say_two</span><span class="token punctuation">(</span><span class="token string">"Hello there!"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I hate sand."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Type T is a &amp;str, but type U is a String.</span>
    <span class="token function">say_two</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Where is Padme?"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Is she all right?"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Both types are String.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">I have two things to say: Hello there! and I hate sand.
I have two things to say: Where is Padme? and Is she all right?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="é€‰é¡¹å’Œç»“æœ"><a href="#é€‰é¡¹å’Œç»“æœ" class="headerlink" title="é€‰é¡¹å’Œç»“æœ"></a>é€‰é¡¹å’Œç»“æœ</h2><p>æˆ‘ä»¬ç°åœ¨ç†è§£äº†æšä¸¾å’Œæ³›å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç†è§£<code>Option</code>å’Œ<code>Result</code>ã€‚Rustä½¿ç”¨è¿™ä¸¤ä¸ªæšä¸¾æ¥ä½¿ä»£ç æ›´å®‰å…¨ã€‚</p>
<p>æˆ‘ä»¬å°†ä»<code>Option</code>å¼€å§‹ã€‚</p>
<h3 id="é€‰é¡¹"><a href="#é€‰é¡¹" class="headerlink" title="é€‰é¡¹"></a>é€‰é¡¹</h3><p>å½“ä½ æœ‰ä¸€ä¸ªå¯èƒ½å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½ä¸å­˜åœ¨çš„å€¼æ—¶ï¼Œä½ å°±ç”¨<code>Option</code>ã€‚å½“ä¸€ä¸ªå€¼å­˜åœ¨çš„æ—¶å€™å°±æ˜¯<code>Some(value)</code>ï¼Œä¸å­˜åœ¨çš„æ—¶å€™å°±æ˜¯<code>None</code>ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåä»£ç çš„ä¾‹å­ï¼Œå¯ä»¥ç”¨<code>Option</code>æ¥æ”¹è¿›ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">    <span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">take_fifth</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token function">take_fifth</span><span class="token punctuation">(</span>new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“æˆ‘ä»¬è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œå®ƒå´©æºƒã€‚ä»¥ä¸‹æ˜¯ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">thread 'main' panicked at 'index out of bounds: the len is 2 but the index is 4', src\main.rs:34:5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å´©æºƒçš„æ„æ€æ˜¯ï¼Œç¨‹åºåœ¨é—®é¢˜å‘ç”Ÿä¹‹å‰å°±åœæ­¢äº†ã€‚Rustçœ‹åˆ°å‡½æ•°æƒ³è¦åšä¸€äº›ä¸å¯èƒ½çš„äº‹æƒ…ï¼Œå°±ä¼šåœæ­¢ã€‚å®ƒ â€œè§£å¼€å †æ ˆâ€(ä»å †æ ˆä¸­å–å€¼)ï¼Œå¹¶å‘Šè¯‰ä½  â€œå¯¹ä¸èµ·ï¼Œæˆ‘ä¸èƒ½è¿™æ ·åšâ€ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°†è¿”å›ç±»å‹ä»<code>i32</code>æ”¹ä¸º<code>Option&lt;i32&gt;</code>ã€‚è¿™æ„å‘³ç€ â€œå¦‚æœæœ‰çš„è¯ç»™æˆ‘ä¸€ä¸ª<code>Some(i32)</code>ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ç»™æˆ‘ä¸€ä¸ª<code>None</code>â€œã€‚æˆ‘ä»¬è¯´<code>i32</code>æ˜¯ â€œåŒ…â€åœ¨ä¸€ä¸ª<code>Option</code>é‡Œé¢ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåœ¨ä¸€ä¸ª<code>Option</code>é‡Œé¢ã€‚ä½ å¿…é¡»åšä¸€äº›äº‹æƒ…æ‰èƒ½æŠŠè¿™ä¸ªå€¼å¼„å‡ºæ¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">take_fifth</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> value<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span> <span class="token punctuation">{</span> <span class="token comment">// .len() gives the length of the vec.</span>
                         <span class="token comment">// It must be at least 5.</span>
        <span class="token class-name">None</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bigger_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}"</span><span class="token punctuation">,</span> <span class="token function">take_fifth</span><span class="token punctuation">(</span>new_vec<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">take_fifth</span><span class="token punctuation">(</span>bigger_vec<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°çš„æ˜¯<code>None, Some(5)</code>ã€‚è¿™ä¸‹å¥½äº†ï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬å†ä¹Ÿä¸å´©æºƒäº†ã€‚ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•å¾—åˆ°5çš„å€¼å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>.unwrap()</code> åœ¨ä¸€ä¸ªé€‰é¡¹ä¸­è·å–å€¼ï¼Œä½†è¦å°å¿ƒ <code>.unwrap()</code>ã€‚è¿™å°±åƒæ‹†ç¤¼ç‰©ä¸€æ ·:ä¹Ÿè®¸é‡Œé¢æœ‰å¥½ä¸œè¥¿ï¼Œä¹Ÿè®¸é‡Œé¢æœ‰ä¸€æ¡æ„¤æ€’çš„è›‡ã€‚åªæœ‰åœ¨ä½ ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œä½ æ‰ä¼šæƒ³è¦<code>.unwrap()</code>ã€‚å¦‚æœä½ æ‹†å¼€ä¸€ä¸ª<code>None</code>çš„å€¼ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">take_fifth</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> value<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token punctuation">{</span>
        <span class="token class-name">None</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bigger_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}"</span><span class="token punctuation">,</span>
        <span class="token function">take_fifth</span><span class="token punctuation">(</span>new_vec<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// this one is None. .unwrap() will panic!</span>
        <span class="token function">take_fifth</span><span class="token punctuation">(</span>bigger_vec<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¶ˆæ¯æ˜¯: â€œthread â€˜mainâ€™ panicked at â€˜called <code>Option::unwrap()</code> on a <code>None</code> valueâ€™, src\main.rs:14:9â€.</p>
<p>ä½†æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨<code>.unwrap()</code>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>match</code>ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠæˆ‘ä»¬æœ‰<code>Some</code>çš„å€¼æ‰“å°å‡ºæ¥ï¼Œå¦‚æœæœ‰<code>None</code>çš„å€¼å°±ä¸è¦ç¢°ã€‚æ¯”å¦‚è¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">take_fifth</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> value<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token punctuation">{</span>
        <span class="token class-name">None</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">handle_option</span><span class="token punctuation">(</span>my_option<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> item <span class="token keyword">in</span> my_option <span class="token punctuation">{</span>
    <span class="token keyword">match</span> item <span class="token punctuation">{</span>
      <span class="token class-name">Some</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Found a {}!"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Found a None!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bigger_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> option_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make a new vec to hold our options</span>
                                     <span class="token comment">// The vec is type: Vec&lt;Option&lt;i32&gt;&gt;. That means a vec of Option&lt;i32&gt;.</span>

    option_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">take_fifth</span><span class="token punctuation">(</span>new_vec<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This pushes "None" into the vec</span>
    option_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">take_fifth</span><span class="token punctuation">(</span>bigger_vec<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This pushes "Some(5)" into the vec</span>

    <span class="token function">handle_option</span><span class="token punctuation">(</span>option_vec<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// handle_option looks at every option in the vec.</span>
                               <span class="token comment">// It prints the value if it is Some. It doesn't touch it if it is None.</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Found a None!
Found a 5!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>å› ä¸ºæˆ‘ä»¬çŸ¥é“æ³›å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å¤Ÿè¯»æ‡‚<code>Option</code>çš„ä»£ç ã€‚å®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¦è®°ä½çš„é‡è¦ä¸€ç‚¹æ˜¯:æœ‰äº†<code>Some</code>ï¼Œä½ å°±æœ‰äº†ä¸€ä¸ªç±»å‹ä¸º<code>T</code>çš„å€¼(ä»»ä½•ç±»å‹)ã€‚è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>enum</code>åå­—åé¢çš„è§’æ‹¬å·å›´ç»•ç€<code>T</code>æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å®ƒæ˜¯é€šç”¨çš„ã€‚å®ƒæ²¡æœ‰<code>Display</code>è¿™æ ·çš„traitæˆ–ä»»ä½•ä¸œè¥¿æ¥é™åˆ¶å®ƒï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ã€‚ä½†æ˜¯å¯¹äº<code>None</code>ï¼Œä½ ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚</p>
<p>æ‰€ä»¥åœ¨<code>match</code>è¯­å¥ä¸­ï¼Œå¯¹äºOptionï¼Œä½ ä¸èƒ½è¯´ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token class-name">Some</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The value is {}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token class-name">None</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The value is {}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å› ä¸º<code>None</code>åªæ˜¯<code>None</code>ã€‚</p>
<p>å½“ç„¶ï¼Œè¿˜æœ‰æ›´ç®€å•çš„æ–¹æ³•æ¥ä½¿ç”¨Optionã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå«åš <code>.is_some()</code> çš„æ–¹æ³•æ¥å‘Šè¯‰æˆ‘ä»¬æ˜¯å¦æ˜¯ <code>Some</code>ã€‚(æ˜¯çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªå«åš<code>.is_none()</code>çš„æ–¹æ³•ã€‚)åœ¨è¿™ä¸ªæ›´ç®€å•çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦<code>handle_option()</code>äº†ã€‚æˆ‘ä»¬ä¹Ÿä¸éœ€è¦é€‰é¡¹çš„vecäº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">take_fifth</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> value<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token punctuation">{</span>
        <span class="token class-name">None</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bigger_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> vec_of_vecs <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>new_vec<span class="token punctuation">,</span> bigger_vec<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> vec <span class="token keyword">in</span> vec_of_vecs <span class="token punctuation">{</span>
        <span class="token keyword">let</span> inside_number <span class="token operator">=</span> <span class="token function">take_fifth</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> inside_number<span class="token punctuation">.</span><span class="token function">is_some</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// .is_some() returns true if we get Some, false if we get None</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"We got: {}"</span><span class="token punctuation">,</span> inside_number<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// now it is safe to use .unwrap() because we already checked</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"We got nothing."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">We got nothing.
We got: 5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>ç»“æœå’ŒOptionç±»ä¼¼ï¼Œä½†è¿™é‡Œçš„åŒºåˆ«æ˜¯ã€‚</p>
<ul>
<li>é€‰é¡¹å¤§çº¦æ˜¯<code>Some</code>æˆ–<code>None</code>(æœ‰å€¼æˆ–æ— å€¼)ã€‚</li>
<li>ç»“æœå¤§çº¦æ˜¯<code>Ok</code>æˆ–<code>Err</code>(è¿˜å¥½çš„ç»“æœï¼Œæˆ–é”™è¯¯çš„ç»“æœ)ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œ<code>Option</code>æ˜¯å¦‚æœä½ åœ¨æƒ³:â€ä¹Ÿè®¸ä¼šæœ‰ï¼Œä¹Ÿè®¸ä¸ä¼šæœ‰ã€‚â€ä¹Ÿè®¸ä¼šæœ‰ä¸€äº›ä¸œè¥¿ï¼Œä¹Ÿè®¸ä¸ä¼šæœ‰ã€‚â€ ä½†<code>Result</code>æ˜¯å¦‚æœä½ åœ¨æƒ³: â€œä¹Ÿè®¸ä¼šå¤±è´¥â€</p>
<p>æ¯”è¾ƒä¸€ä¸‹ï¼Œè¿™é‡Œæ˜¯é€‰é¡¹å’Œç»“æœçš„ç­¾åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥Resultåœ¨ <code>Ok</code> é‡Œé¢æœ‰ä¸€ä¸ªå€¼ï¼Œåœ¨ <code>Err</code> é‡Œé¢æœ‰ä¸€ä¸ªå€¼ã€‚è¿™æ˜¯å› ä¸ºé”™è¯¯é€šå¸¸(åº”è¯¥æœ‰)æœ‰ä¿¡æ¯åœ¨é‡Œé¢ã€‚</p>
<p><code>Result&lt;T, E&gt;</code>çš„æ„æ€æ˜¯ä½ è¦æƒ³å¥½<code>Ok</code>è¦è¿”å›ä»€ä¹ˆï¼Œ<code>Err</code>è¦è¿”å›ä»€ä¹ˆã€‚å…¶å®ï¼Œä½ å¯ä»¥å†³å®šä»»ä½•äº‹æƒ…ã€‚ç”šè‡³è¿™ä¸ªä¹Ÿå¯ä»¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">check_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">check_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>check_error</code>è¯´ â€œå¦‚æœå¾—åˆ°<code>Ok</code>å°±è¿”å›<code>()</code>ï¼Œå¦‚æœå¾—åˆ°<code>Err</code>å°±è¿”å›<code>()</code>â€œã€‚ç„¶åæˆ‘ä»¬ç”¨<code>()</code>è¿”å›<code>Ok</code>ã€‚</p>
<p>ç¼–è¯‘å™¨ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæœ‰è¶£çš„è­¦å‘Šã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">warning: unused `std::result::Result` that must be used
 --&gt; src\main.rs:6:5
  |
6 |     check_error();
  |     ^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_must_use)]` on by default
  = note: this `Result` may be an `Err` variant, which should be handled<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯çœŸçš„:æˆ‘ä»¬åªè¿”å›äº†<code>Result</code>ï¼Œä½†å®ƒå¯èƒ½æ˜¯ä¸€ä¸ª<code>Err</code>ã€‚æ‰€ä»¥è®©æˆ‘ä»¬ç¨å¾®å¤„ç†ä¸€ä¸‹è¿™ä¸ªé”™è¯¯ï¼Œå°½ç®¡æˆ‘ä»¬ä»ç„¶æ²¡æœ‰çœŸæ­£åšä»»ä½•äº‹æƒ…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">give_result</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> input <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token function">give_result</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's okay, guys"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's an error, guys"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰“å°å‡º<code>It's an error, guys</code>ã€‚æ‰€ä»¥æˆ‘ä»¬åªæ˜¯å¤„ç†äº†ç¬¬ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>è®°ä½ï¼Œè½»æ¾æ£€æŸ¥çš„å››ç§æ–¹æ³•æ˜¯<code>.is_some()</code>ã€<code>is_none()</code>ã€<code>is_ok()</code>å’Œ<code>is_err()</code>ã€‚</p>
<p>æœ‰æ—¶ï¼Œä¸€ä¸ªå¸¦æœ‰Resultçš„å‡½æ•°ä¼šç”¨<code>String</code>æ¥è¡¨ç¤º<code>Err</code>çš„å€¼ã€‚è¿™ä¸æ˜¯æœ€å¥½çš„æ–¹æ³•ï¼Œä½†æ¯”æˆ‘ä»¬ç›®å‰æ‰€åšçš„è¦å¥½ä¸€äº›ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">check_if_five</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> number <span class="token punctuation">{</span>
        <span class="token number">5</span> <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token string">"Sorry, the number wasn't five."</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// This is our error message</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> result_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Create a new vec for the results</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token number">2</span><span class="token punctuation">..</span><span class="token number">7</span> <span class="token punctuation">{</span>
        result_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">check_if_five</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// push each result into the vec</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> result_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬çš„Vecæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[Err("Sorry, the number wasn\'t five."), Err("Sorry, the number wasn\'t five."), Err("Sorry, the number wasn\'t five."), Ok(5),
Err("Sorry, the number wasn\'t five.")]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å°±åƒOptionä¸€æ ·ï¼Œåœ¨<code>Err</code>ä¸Šç”¨<code>.unwrap()</code>å°±ä¼šå´©æºƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">    <span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> error_value<span class="token punctuation">:</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token string">"There was an error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Create a Result that is already an Err</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> error_value<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Unwrap it</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¨‹åºå´©æºƒï¼Œæ‰“å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value: "There was an error"', src\main.rs:30:20<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿™äº›ä¿¡æ¯å¯ä»¥å¸®åŠ©ä½ ä¿®æ­£ä½ çš„ä»£ç ã€‚<code>src\main.rs:30:20</code>çš„æ„æ€æ˜¯ â€œåœ¨ç›®å½•srcçš„main.rså†…ï¼Œç¬¬30è¡Œå’Œç¬¬20åˆ—â€ã€‚æ‰€ä»¥ä½ å¯ä»¥å»é‚£é‡ŒæŸ¥çœ‹ä½ çš„ä»£ç å¹¶ä¿®å¤é—®é¢˜ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„é”™è¯¯ç±»å‹ã€‚æ ‡å‡†åº“ä¸­çš„ç»“æœå‡½æ•°å’Œå…¶ä»–äººçš„ä»£ç é€šå¸¸éƒ½ä¼šè¿™æ ·åš:ä¾‹å¦‚ï¼Œæ ‡å‡†åº“ä¸­çš„è¿™ä¸ªå‡½æ•°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">from_utf8</span><span class="token punctuation">(</span>vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">FromUtf8Error</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå­—èŠ‚å‘é‡(<code>u8</code>)ï¼Œå¹¶å°è¯•åˆ›å»ºä¸€ä¸ª<code>String</code>ï¼Œæ‰€ä»¥ç»“æœçš„æˆåŠŸæƒ…å†µæ˜¯<code>String</code>ï¼Œé”™è¯¯æƒ…å†µæ˜¯<code>FromUtf8Error</code>ã€‚ä½ å¯ä»¥ç»™ä½ çš„é”™è¯¯ç±»å‹èµ·ä»»ä½•ä½ æƒ³è¦çš„åå­—ã€‚</p>
<p>ä½¿ç”¨ <code>match</code> ä¸ <code>Option</code> å’Œ <code>Result</code> æœ‰æ—¶éœ€è¦å¾ˆå¤šä»£ç ã€‚ä¾‹å¦‚ï¼Œ<code>.get()</code> æ–¹æ³•åœ¨ <code>Vec</code> ä¸Šè¿”å› <code>Option</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> get_one <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 to get the first number</span>
    <span class="token keyword">let</span> get_two <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Returns None</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> get_one<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> get_two<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ‰“å°</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Some(2)
None<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥åŒ¹é…å¾—åˆ°æ•°å€¼ã€‚è®©æˆ‘ä»¬ä½¿ç”¨0åˆ°10çš„èŒƒå›´ï¼Œçœ‹çœ‹æ˜¯å¦ç¬¦åˆ<code>my_vec</code>ä¸­çš„æ•°å­—ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
      <span class="token keyword">match</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯å¥½çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹<code>None</code>ä¸åšä»»ä½•å¤„ç†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å…³å¿ƒã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨<code>if let</code>æŠŠä»£ç å˜å°ã€‚<code>if let</code>çš„æ„æ€æ˜¯ â€œç¬¦åˆå°±åšï¼Œä¸ç¬¦åˆå°±ä¸åšâ€ã€‚<code>if let</code>æ˜¯æŒ‡å¯¹æ‰€æœ‰çš„ä¸œè¥¿éƒ½ä¸å…³å¿ƒåŒ¹é…çš„æ—¶å€™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é‡è¦çš„æ˜¯è¦è®°ä½</strong>ã€‚<code>if let Some(number) = my_vec.get(index)</code>çš„æ„æ€æ˜¯ â€œå¦‚æœä½ ä»<code>my_vec.get(index)</code>å¾—åˆ°<code>Some(number)</code>â€œã€‚</p>
<p>å¦å¤–æ³¨æ„:å®ƒä½¿ç”¨çš„æ˜¯ä¸€ä¸ª<code>=</code>ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><code>while let</code>å°±åƒ<code>if let</code>çš„ä¸€ä¸ªwhileå¾ªç¯ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·çš„æ°”è±¡ç«™æ•°æ®ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">["Berlin", "cloudy", "5", "-7", "78"]
["Athens", "sunny", "not humid", "20", "10", "50"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬æƒ³å¾—åˆ°æ•°å­—ï¼Œä½†ä¸æƒ³å¾—åˆ°æ–‡å­—ã€‚å¯¹äºæ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš <code>parse::&lt;i32&gt;()</code> çš„æ–¹æ³•ã€‚<code>parse()</code>æ˜¯æ–¹æ³•ï¼Œ<code>::&lt;i32&gt;</code>æ˜¯ç±»å‹ã€‚å®ƒå°†å°è¯•æŠŠ <code>&amp;str</code> å˜æˆ <code>i32</code>ï¼Œå¦‚æœå¯ä»¥çš„è¯å°±æŠŠå®ƒç»™æˆ‘ä»¬ã€‚å®ƒè¿”å›ä¸€ä¸ª <code>Result</code>ï¼Œå› ä¸ºå®ƒå¯èƒ½æ— æ³•å·¥ä½œ(æ¯”å¦‚ä½ æƒ³è®©å®ƒè§£æ â€œBillybrobbyâ€â€“é‚£ä¸æ˜¯ä¸€ä¸ªæ•°å­—)ã€‚</p>
<p>æˆ‘ä»¬è¿˜å°†ä½¿ç”¨ <code>.pop()</code>ã€‚è¿™å°†ä»å‘é‡ä¸­å–å‡ºæœ€åä¸€é¡¹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> weather_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Berlin"</span><span class="token punctuation">,</span> <span class="token string">"cloudy"</span><span class="token punctuation">,</span> <span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"-7"</span><span class="token punctuation">,</span> <span class="token string">"78"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Athens"</span><span class="token punctuation">,</span> <span class="token string">"sunny"</span><span class="token punctuation">,</span> <span class="token string">"not humid"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token string">"50"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token keyword">mut</span> city <span class="token keyword">in</span> weather_vec <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"For the city of {}:"</span><span class="token punctuation">,</span> city<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// In our data, every first item is the city name</span>
        <span class="token keyword">while</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>information<span class="token punctuation">)</span> <span class="token operator">=</span> city<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// This means: keep going until you can't pop anymore</span>
            <span class="token comment">// When the vector reaches 0 items, it will return None</span>
            <span class="token comment">// and it will stop.</span>
            <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=</span> information<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Try to parse the variable we called information</span>
                <span class="token comment">// This returns a result. If it's Ok(number), it will print it</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>  <span class="token comment">// We don't write anything here because we do nothing if we get an error. Throw them all away</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">For the city of Berlin:
The number is: 78
The number is: -7
The number is: 5
For the city of Athens:
The number is: 50
The number is: 10
The number is: 20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å…¶ä»–é›†åˆç±»å‹"><a href="#å…¶ä»–é›†åˆç±»å‹" class="headerlink" title="å…¶ä»–é›†åˆç±»å‹"></a>å…¶ä»–é›†åˆç±»å‹</h2><p>Rustè¿˜æœ‰å¾ˆå¤šé›†åˆç±»å‹ã€‚ä½ å¯ä»¥åœ¨æ ‡å‡†åº“ä¸­çš„ <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/beta/std/collections/">https://doc.rust-lang.org/beta/std/collections/</a> çœ‹åˆ°å®ƒä»¬ã€‚é‚£ä¸ªé¡µé¢å¯¹ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä¸€ç§ç±»å‹æœ‰å¾ˆå¥½çš„è§£é‡Šï¼Œæ‰€ä»¥å¦‚æœä½ ä¸çŸ¥é“ä½ æƒ³è¦ä»€ä¹ˆç±»å‹ï¼Œå°±å»é‚£é‡Œã€‚è¿™äº›é›†åˆéƒ½åœ¨æ ‡å‡†åº“çš„<code>std::collections</code>é‡Œé¢ã€‚ä½¿ç”¨å®ƒä»¬çš„æœ€å¥½æ–¹æ³•æ˜¯ä½¿ç”¨ <code>use</code> è¯­å¥ã€‚<br> å°±åƒæˆ‘ä»¬çš„<code>enums</code>ä¸€æ ·ã€‚æˆ‘ä»¬å°†ä»<code>HashMap</code>å¼€å§‹ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„ã€‚</p>
<h3 id="HashMapå’ŒBTreeMap"><a href="#HashMapå’ŒBTreeMap" class="headerlink" title="HashMapå’ŒBTreeMap"></a>HashMapå’ŒBTreeMap</h3><p>HashMapæ˜¯ç”±<em>keys</em>å’Œ<em>values</em>ç»„æˆçš„é›†åˆã€‚ä½ ä½¿ç”¨é”®æ¥æŸ¥æ‰¾ä¸é”®åŒ¹é…çš„å€¼ã€‚ä½ å¯ä»¥åªç”¨<code>HashMap::new()</code>åˆ›å»ºä¸€ä¸ªæ–°çš„<code>HashMap</code>ï¼Œå¹¶ä½¿ç”¨<code>.insert(key, value)</code>æ¥æ’å…¥å…ƒç´ ã€‚</p>
<p><code>HashMap</code>æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œæ‰€ä»¥å¦‚æœä½ æŠŠ<code>HashMap</code>ä¸­çš„æ¯ä¸€ä¸ªé”®éƒ½æ‰“å°åœ¨ä¸€èµ·ï¼Œå¯èƒ½ä¼šæ‰“å°å‡ºä¸åŒçš„ç»“æœã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªä¾‹å­ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span> <span class="token comment">// This is so we can just write HashMap instead of std::collections::HashMap every time</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token punctuation">,</span> <span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// This will have the year and the population for the year</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> tallinn <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Tallinn"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        population<span class="token punctuation">:</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// So far the HashMap is empty</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    tallinn<span class="token punctuation">.</span>population<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1372</span><span class="token punctuation">,</span> <span class="token number">3_250</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// insert three dates</span>
    tallinn<span class="token punctuation">.</span>population<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1851</span><span class="token punctuation">,</span> <span class="token number">24_000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tallinn<span class="token punctuation">.</span>population<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">437_619</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">for</span> <span class="token punctuation">(</span>year<span class="token punctuation">,</span> population<span class="token punctuation">)</span> <span class="token keyword">in</span> tallinn<span class="token punctuation">.</span>population <span class="token punctuation">{</span> <span class="token comment">// The HashMap is HashMap&lt;u32, u32&gt; so it returns a two items each time</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"In the year {} the city of {} had a population of {}."</span><span class="token punctuation">,</span> year<span class="token punctuation">,</span> tallinn<span class="token punctuation">.</span>name<span class="token punctuation">,</span> population<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">In the year 1372 the city of Tallinn had a population of 3250.
In the year 2020 the city of Tallinn had a population of 437619.
In the year 1851 the city of Tallinn had a population of 24000.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æˆ–è€…å¯èƒ½ä¼šæ‰“å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">In the year 1851 the city of Tallinn had a population of 24000.
In the year 2020 the city of Tallinn had a population of 437619.
In the year 1372 the city of Tallinn had a population of 3250.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä¸æŒ‰é¡ºåºæ’åˆ—ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦ä¸€ä¸ªå¯ä»¥æ’åºçš„<code>HashMap</code>ï¼Œä½ å¯ä»¥ç”¨<code>BTreeMap</code>ã€‚å…¶å®å®ƒä»¬ä¹‹é—´æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¿«é€Ÿçš„æŠŠæˆ‘ä»¬çš„<code>HashMap</code>æ”¹æˆ<code>BTreeMap</code>æ¥çœ‹çœ‹ã€‚å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè¿™å‡ ä¹æ˜¯ä¸€æ ·çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">BTreeMap</span><span class="token punctuation">;</span> <span class="token comment">// Just change HashMap to BTreeMap</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token class-name">BTreeMap</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token punctuation">,</span> <span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// Just change HashMap to BTreeMap</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> tallinn <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Tallinn"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        population<span class="token punctuation">:</span> <span class="token class-name">BTreeMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Just change HashMap to BTreeMap</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    tallinn<span class="token punctuation">.</span>population<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1372</span><span class="token punctuation">,</span> <span class="token number">3_250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tallinn<span class="token punctuation">.</span>population<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1851</span><span class="token punctuation">,</span> <span class="token number">24_000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tallinn<span class="token punctuation">.</span>population<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">437_619</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>year<span class="token punctuation">,</span> population<span class="token punctuation">)</span> <span class="token keyword">in</span> tallinn<span class="token punctuation">.</span>population <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"In the year {} the city of {} had a population of {}."</span><span class="token punctuation">,</span> year<span class="token punctuation">,</span> tallinn<span class="token punctuation">.</span>name<span class="token punctuation">,</span> population<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ä¼šä¸€ç›´æ‰“å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">In the year 1372 the city of Tallinn had a population of 3250.
In the year 1851 the city of Tallinn had a population of 24000.
In the year 2020 the city of Tallinn had a population of 437619.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹<code>HashMap</code>ã€‚</p>
<p>åªè¦æŠŠé”®æ”¾åœ¨<code>[]</code>çš„æ–¹æ‹¬å·é‡Œï¼Œå°±å¯ä»¥å¾—åˆ°<code>HashMap</code>çš„å€¼ã€‚åœ¨æ¥ä¸‹æ¥çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†å¸¦å‡º<code>Bielefeld</code>è¿™ä¸ªé”®çš„å€¼ï¼Œä¹Ÿå°±æ˜¯<code>Germany</code>ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰é”®ï¼Œç¨‹åºä¼šå´©æºƒã€‚æ¯”å¦‚ä½ å†™äº†<code>println!("{:?}", city_hashmap["Bielefeldd"]);</code>ï¼Œé‚£ä¹ˆå°±ä¼šå´©æºƒï¼Œå› ä¸º<code>Bielefeldd</code>ä¸å­˜åœ¨ã€‚</p>
<p>å¦‚æœä½ ä¸ç¡®å®šä¼šæœ‰ä¸€ä¸ªé”®ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>.get()</code>ï¼Œå®ƒè¿”å›ä¸€ä¸ª<code>Option</code>ã€‚å¦‚æœå®ƒå­˜åœ¨ï¼Œå°†æ˜¯<code>Some(value)</code>ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä½ å°†å¾—åˆ°<code>None</code>ï¼Œè€Œä¸æ˜¯ä½¿ç¨‹åºå´©æºƒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>.get()</code> æ˜¯ä» <code>HashMap</code> ä¸­è·å–ä¸€ä¸ªå€¼çš„æ¯”è¾ƒå®‰å…¨çš„æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> canadian_cities <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Calgary"</span><span class="token punctuation">,</span> <span class="token string">"Vancouver"</span><span class="token punctuation">,</span> <span class="token string">"Gimli"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> german_cities <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Karlsruhe"</span><span class="token punctuation">,</span> <span class="token string">"Bad Doberan"</span><span class="token punctuation">,</span> <span class="token string">"Bielefeld"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> city_hashmap <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> city <span class="token keyword">in</span> canadian_cities <span class="token punctuation">{</span>
        city_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>city<span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> city <span class="token keyword">in</span> german_cities <span class="token punctuation">{</span>
        city_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>city<span class="token punctuation">,</span> <span class="token string">"Germany"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> city_hashmap<span class="token punctuation">[</span><span class="token string">"Bielefeld"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> city_hashmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Bielefeld"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> city_hashmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"Bielefeldd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">"Germany"
Some("Germany")
None<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯å› ä¸º<em>Bielefeld</em>å­˜åœ¨ï¼Œä½†<em>Bielefeldd</em>ä¸å­˜åœ¨ã€‚</p>
<p>å¦‚æœ<code>HashMap</code>å·²ç»æœ‰ä¸€ä¸ªé”®ï¼Œå½“ä½ è¯•å›¾æŠŠå®ƒæ”¾è¿›å»æ—¶ï¼Œå®ƒå°†è¦†ç›–å®ƒçš„å€¼ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> book_hashmap <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    book_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"L'Allemagne Moderne"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    book_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Le Petit Prince"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    book_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"ì„€ë„ìš° ì˜¤ë¸Œ ìœ ì–´ ìŠ¤ë§ˆì¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    book_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Eye of the World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> book_hashmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>Some("Eye of the World")</code>ï¼Œå› ä¸ºå®ƒæ˜¯ä½ æœ€åä½¿ç”¨ <code>.insert()</code> çš„æ¡ç›®ã€‚</p>
<p>æ£€æŸ¥ä¸€ä¸ªæ¡ç›®æ˜¯å¦å­˜åœ¨æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œå› ä¸ºä½ å¯ä»¥ç”¨ <code>.get()</code> æ£€æŸ¥ï¼Œå®ƒç»™å‡ºäº† <code>Option</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> book_hashmap <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    book_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"L'Allemagne Moderne"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> book_hashmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// is_none() returns a bool: true if it's None, false if it's Some</span>
        book_hashmap<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Le Petit Prince"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> book_hashmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°<code>Some("L\'Allemagne Moderne")</code>æ˜¯å› ä¸ºå·²ç»æœ‰äº†keyä¸º<code>1</code>çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰æ’å…¥<code>Le Petit Prince</code>ã€‚</p>
<p><code>HashMap</code>æœ‰ä¸€ä¸ªéå¸¸æœ‰è¶£çš„æ–¹æ³•ï¼Œå«åš<code>.entry()</code>ï¼Œä½ ä¸€å®šè¦è¯•è¯•ã€‚æœ‰äº†å®ƒï¼Œä½ å¯ä»¥åœ¨æ²¡æœ‰é”®çš„æƒ…å†µä¸‹ï¼Œç”¨å¦‚<code>.or_insert()</code>è¿™ç±»æ–¹æ³•æ¥æ’å…¥å€¼ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå®ƒè¿˜ç»™å‡ºäº†ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³çš„è¯ï¼Œä½ å¯ä»¥æ”¹å˜å®ƒã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨æ¯æ¬¡æ’å…¥ä¹¦ååˆ°<code>HashMap</code>æ—¶æ’å…¥ä¸€ä¸ª<code>true</code>ã€‚</p>
<p>è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå›¾ä¹¦é¦†ï¼Œå¹¶å¸Œæœ›è·Ÿè¸ªæˆ‘ä»¬çš„ä¹¦ç±ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> book_collection <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"L'Allemagne Moderne"</span><span class="token punctuation">,</span> <span class="token string">"Le Petit Prince"</span><span class="token punctuation">,</span> <span class="token string">"Eye of the World"</span><span class="token punctuation">,</span> <span class="token string">"Eye of the World"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Eye of the World appears twice</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> book_hashmap <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> book <span class="token keyword">in</span> book_collection <span class="token punctuation">{</span>
        book_hashmap<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>book<span class="token punctuation">,</span> true_or_false<span class="token punctuation">)</span> <span class="token keyword">in</span> book_hashmap <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Do we have {}? {}"</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> true_or_false<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Do we have Eye of the World? true
Do we have Le Petit Prince? true
Do we have L'Allemagne Moderne? true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½†è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ä¹Ÿè®¸æœ€å¥½æ˜¯æ•°ä¸€ä¸‹ä¹¦çš„æ•°é‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±çŸ¥é“<em>ä¸–ç•Œä¹‹çœ¼</em> æœ‰ä¸¤æœ¬ã€‚é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹<code>.entry()</code>åšäº†ä»€ä¹ˆï¼Œä»¥åŠ<code>.or_insert()</code>åšäº†ä»€ä¹ˆã€‚<code>.entry()</code>å…¶å®æ˜¯è¿”å›äº†ä¸€ä¸ªåä¸º<code>Entry</code>çš„<code>enum</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">entry</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token class-name">K</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token operator">&gt;</span> <span class="token comment">// ğŸš§</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/collections/hash_map/enum.Entry.html">Entryæ–‡æ¡£é¡µ</a>ã€‚ä¸‹é¢æ˜¯å…¶ä»£ç çš„ç®€å•ç‰ˆæœ¬ã€‚<code>K</code>è¡¨ç¤ºkeyï¼Œ<code>V</code>è¡¨ç¤ºvalueã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span>hash_map<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">Entry</span><span class="token operator">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Occupied</span><span class="token punctuation">(</span><span class="token class-name">OccupiedEntry</span><span class="token operator">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Vacant</span><span class="token punctuation">(</span><span class="token class-name">VacantEntry</span><span class="token operator">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token class-name">V</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åå½“æˆ‘ä»¬è°ƒç”¨<code>.or_insert()</code>æ—¶ï¼Œå®ƒå°±ä¼šæŸ¥çœ‹æšä¸¾ï¼Œå¹¶å†³å®šè¯¥æ€ä¹ˆåšã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">or_insert</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> default<span class="token punctuation">:</span> <span class="token class-name">V</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">V</span> <span class="token punctuation">{</span> <span class="token comment">// ğŸš§</span>
    <span class="token keyword">match</span> <span class="token keyword">self</span> <span class="token punctuation">{</span>
        <span class="token class-name">Occupied</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> entry<span class="token punctuation">.</span><span class="token function">into_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Vacant</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> entry<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>default<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰è¶£çš„æ˜¯ï¼Œå®ƒè¿”å›ä¸€ä¸ª<code>mut</code>çš„å¼•ç”¨ã€‚<code>&amp;mut V</code>. è¿™æ„å‘³ç€ä½ å¯ä»¥ä½¿ç”¨<code>let</code>å°†å…¶é™„åŠ åˆ°ä¸€ä¸ªå˜é‡ä¸Šï¼Œå¹¶æ”¹å˜å˜é‡æ¥æ”¹å˜<code>HashMap</code>ä¸­çš„å€¼ã€‚æ‰€ä»¥å¯¹äºæ¯æœ¬ä¹¦ï¼Œå¦‚æœæ²¡æœ‰æ¡ç›®ï¼Œæˆ‘ä»¬å°±ä¼šæ’å…¥ä¸€ä¸ª0ã€‚è€Œå¦‚æœæœ‰çš„è¯ï¼Œæˆ‘ä»¬å°†åœ¨å¼•ç”¨ä¸Šä½¿ç”¨<code>+= 1</code>æ¥å¢åŠ æ•°å­—ã€‚ç°åœ¨å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> book_collection <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"L'Allemagne Moderne"</span><span class="token punctuation">,</span> <span class="token string">"Le Petit Prince"</span><span class="token punctuation">,</span> <span class="token string">"Eye of the World"</span><span class="token punctuation">,</span> <span class="token string">"Eye of the World"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> book_hashmap <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> book <span class="token keyword">in</span> book_collection <span class="token punctuation">{</span>
        <span class="token keyword">let</span> return_value <span class="token operator">=</span> book_hashmap<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// return_value is a mutable reference. If nothing is there, it will be 0</span>
        <span class="token operator">*</span>return_value <span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Now return_value is at least 1. And if there was another book, it will go up by 1</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>book<span class="token punctuation">,</span> number<span class="token punctuation">)</span> <span class="token keyword">in</span> book_hashmap <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>é‡è¦çš„éƒ¨åˆ†æ˜¯<code>let return_value = book_hashmap.entry(book).or_insert(0);</code>ã€‚å¦‚æœå»æ‰ <code>let</code>ï¼Œä½ ä¼šå¾—åˆ° <code>book_hashmap.entry(book).or_insert(0)</code>ã€‚å¦‚æœæ²¡æœ‰<code>let</code>ï¼Œå®ƒä»€ä¹ˆä¹Ÿä¸åš:å®ƒæ’å…¥äº†0ï¼Œæ²¡æœ‰è·å–æŒ‡å‘0çš„å¯å˜å¼•ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒç»‘å®šåˆ°<code>return_value</code>ä¸Šï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿ç•™0ã€‚ç„¶åæˆ‘ä»¬æŠŠå€¼å¢åŠ 1ï¼Œè¿™æ ·<code>HashMap</code>ä¸­çš„æ¯æœ¬ä¹¦éƒ½è‡³å°‘æœ‰1ã€‚ç„¶åå½“<code>.entry()</code>å†çœ‹<em>ä¸–ç•Œä¹‹çœ¼</em>æ—¶ï¼Œå®ƒä¸ä¼šæ’å…¥ä»»ä½•ä¸œè¥¿ï¼Œä½†å®ƒç»™æˆ‘ä»¬ä¸€ä¸ªå¯å˜çš„1ã€‚ç„¶åæˆ‘ä»¬æŠŠå®ƒå¢åŠ åˆ°2ï¼Œæ‰€ä»¥å®ƒæ‰ä¼šæ‰“å°å‡ºè¿™æ ·çš„ç»“æœã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">L'Allemagne Moderne, 1
Le Petit Prince, 1
Eye of the World, 2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<p>ä½ ä¹Ÿå¯ä»¥ç”¨<code>.or_insert()</code>åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚æ’å…¥ä¸€ä¸ªvecï¼Œç„¶åæ¨å…¥æ•°æ®ã€‚è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬é—®è¡—ä¸Šçš„ç”·äººå’Œå¥³äººä»–ä»¬å¯¹ä¸€ä¸ªæ”¿æ²»å®¶çš„çœ‹æ³•ã€‚ä»–ä»¬ç»™å‡ºçš„è¯„åˆ†ä»0åˆ°10ã€‚ç„¶åæˆ‘ä»¬è¦æŠŠè¿™äº›æ•°å­—æ”¾åœ¨ä¸€èµ·ï¼Œçœ‹çœ‹è¿™ä¸ªæ”¿æ²»å®¶æ˜¯æ›´å—ç”·äººæ¬¢è¿è¿˜æ˜¯å¥³äººæ¬¢è¿ã€‚å®ƒå¯ä»¥æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span> <span class="token comment">// This is the raw data</span>
        <span class="token punctuation">(</span><span class="token string">"male"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"female"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"male"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"female"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"female"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"male"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> survey_hash <span class="token operator">=</span> <span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> data <span class="token punctuation">{</span> <span class="token comment">// This gives a tuple of (&amp;str, i32)</span>
        survey_hash<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span>item<span class="token number">.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or_insert</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This pushes the number into the Vec inside</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>male_or_female<span class="token punctuation">,</span> numbers<span class="token punctuation">)</span> <span class="token keyword">in</span> survey_hash <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}: {:?}"</span><span class="token punctuation">,</span> male_or_female<span class="token punctuation">,</span> numbers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">"female", [5, 6, 5]
"male", [9, 0, 10]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>é‡è¦çš„ä¸€è¡Œæ˜¯:<code>survey_hash.entry(item.0).or_insert(Vec::new()).push(item.1);</code>ï¼Œæ‰€ä»¥å¦‚æœå®ƒçœ‹åˆ° â€œå¥³â€ï¼Œå°±ä¼šæ£€æŸ¥<code>HashMap</code>ä¸­æ˜¯å¦å·²ç»æœ‰ â€œå¥³â€ã€‚å¦‚æœæ²¡æœ‰ï¼Œå®ƒå°±ä¼šæ’å…¥ä¸€ä¸ª<code>Vec::new()</code>ï¼Œç„¶åæŠŠæ•°å­—æ¨å…¥ã€‚å¦‚æœå®ƒçœ‹åˆ° â€œå¥³æ€§â€å·²ç»åœ¨<code>HashMap</code>ä¸­ï¼Œå®ƒå°†ä¸ä¼šæ’å…¥ä¸€ä¸ªæ–°çš„Vecï¼Œè€Œåªæ˜¯å°†æ•°å­—æ¨å…¥å…¶ä¸­ã€‚</p>
<h3 id="HashSetå’ŒBTreeSet"><a href="#HashSetå’ŒBTreeSet" class="headerlink" title="HashSetå’ŒBTreeSet"></a>HashSetå’ŒBTreeSet</h3><p><code>HashSet</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªåªæœ‰keyçš„<code>HashMap</code>ã€‚åœ¨<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/collections/struct.HashSet.html">HashSetçš„é¡µé¢</a>ä¸Šé¢æœ‰è§£é‡Šã€‚</p>
<p><code>A hash set implemented as a HashMap where the value is ().</code> æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ª<code>HashMap</code>ï¼Œæœ‰é”®ï¼Œæ²¡æœ‰å€¼ã€‚</p>
<p>å¦‚æœä½ åªæ˜¯æƒ³çŸ¥é“ä¸€ä¸ªé”®æ˜¯å¦å­˜åœ¨ï¼Œæˆ–è€…ä¸å­˜åœ¨ï¼Œä½ ç»å¸¸ä¼šä½¿ç”¨<code>HashSet</code>ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰100ä¸ªéšæœºæ•°ï¼Œæ¯ä¸ªæ•°å­—åœ¨1å’Œ100ä¹‹é—´ã€‚å¦‚æœä½ è¿™æ ·åšï¼Œæœ‰äº›æ•°å­—ä¼šå‡ºç°ä¸æ­¢ä¸€æ¬¡ï¼Œè€Œæœ‰äº›æ•°å­—æ ¹æœ¬ä¸ä¼šå‡ºç°ã€‚å¦‚æœä½ æŠŠå®ƒä»¬æ”¾åˆ°<code>HashSet</code>ä¸­ï¼Œé‚£ä¹ˆä½ å°±ä¼šæœ‰ä¸€ä¸ªæ‰€æœ‰å‡ºç°çš„æ•°å­—çš„åˆ—è¡¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashSet</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> many_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span>
        <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span>
        <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span>
        <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> number_hashset <span class="token operator">=</span> <span class="token class-name">HashSet</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> many_numbers <span class="token punctuation">{</span>
        number_hashset<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> hashset_length <span class="token operator">=</span> number_hashset<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The length tells us how many numbers are in it</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"There are {} unique numbers, so we are missing {}."</span><span class="token punctuation">,</span> hashset_length<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token operator">-</span> hashset_length<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Let's see what numbers we are missing</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> missing_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number_hashset<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_none</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// If .get() returns None,</span>
            missing_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"It does not contain: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> number <span class="token keyword">in</span> missing_vec <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">There are 66 unique numbers, so we are missing 34.
It does not contain: 1 2 4 6 7 9 12 21 23 27 30 31 39 40 45 47 48 50 52 53 62 65 69 70 72 75 77 78 83 85 88 97 98 99<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>BTreeSet</code>ä¸<code>HashSet</code>ç›¸ä¼¼ï¼Œå°±åƒ<code>BTreeMap</code>ä¸<code>HashMap</code>ç›¸ä¼¼ä¸€æ ·ã€‚å¦‚æœæˆ‘ä»¬æŠŠ<code>HashSet</code>ä¸­çš„æ¯ä¸€é¡¹éƒ½æ‰“å°å‡ºæ¥ï¼Œå°±ä¸çŸ¥é“é¡ºåºæ˜¯ä»€ä¹ˆäº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">for</span> entry <span class="token keyword">in</span> number_hashset <span class="token punctuation">{</span> <span class="token comment">// ğŸš§</span>
    <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä¹Ÿè®¸å®ƒèƒ½æ‰“å°å‡ºè¿™ä¸ªã€‚<code>67 28 42 25 95 59 87 11 5 81 64 34 8 15 13 86 10 89 63 93 49 41 46 57 60 29 17 22 74 43 32 38 36 76 71 18 14 84 61 16 35 90 56 54 91 19 94 44 3 0 68 80 51 92 24 20 82 26 58 33 55 96 37 66 79 73</code>. ä½†å®ƒå‡ ä¹ä¸ä¼šå†ä»¥åŒæ ·çš„æ–¹å¼æ‰“å°ã€‚</p>
<p>åœ¨è¿™é‡Œä¹Ÿä¸€æ ·ï¼Œå¦‚æœä½ å†³å®šéœ€è¦è®¢è´­çš„è¯ï¼Œå¾ˆå®¹æ˜“æŠŠä½ çš„<code>HashSet</code>æ”¹æˆ<code>BTreeSet</code>ã€‚åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦åšä¸¤å¤„æ”¹åŠ¨ï¼Œå°±å¯ä»¥ä»<code>HashSet</code>åˆ‡æ¢åˆ°<code>BTreeSet</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">BTreeSet</span><span class="token punctuation">;</span> <span class="token comment">// Change HashSet to BTreeSet</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> many_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span>
        <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span>
        <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span>
        <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> number_btreeset <span class="token operator">=</span> <span class="token class-name">BTreeSet</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Change HashSet to BTreeSet</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> many_numbers <span class="token punctuation">{</span>
        number_btreeset<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> entry <span class="token keyword">in</span> number_btreeset <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ä¼šæŒ‰é¡ºåºæ‰“å°ã€‚<code>0 3 5 8 10 11 13 14 15 16 17 18 19 20 22 24 25 26 28 29 32 33 34 35 36 37 38 41 42 43 44 46 49 51 54 55 56 57 58 59 60 61 63 64 66 67 68 71 73 74 76 79 80 81 82 84 86 87 89 90 91 92 93 94 95 96</code>.</p>
<h3 id="äºŒå‰å †"><a href="#äºŒå‰å †" class="headerlink" title="äºŒå‰å †"></a>äºŒå‰å †</h3><p><code>BinaryHeap</code>æ˜¯ä¸€ç§æœ‰è¶£çš„é›†åˆç±»å‹ï¼Œå› ä¸ºå®ƒå¤§éƒ¨åˆ†æ˜¯æ— åºçš„ï¼Œä½†ä¹Ÿæœ‰ä¸€ç‚¹ç§©åºã€‚å®ƒæŠŠæœ€å¤§çš„å…ƒç´ æ”¾åœ¨å‰é¢ï¼Œä½†å…¶ä»–å…ƒç´ æ˜¯æŒ‰ä»»ä½•é¡ºåºæ’åˆ—çš„ã€‚</p>
<p>æˆ‘ä»¬å°†ç”¨å¦ä¸€ä¸ªå…ƒç´ åˆ—è¡¨æ¥ä¸¾ä¾‹ï¼Œä½†è¿™æ¬¡æ•°æ®å°‘äº›ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">BinaryHeap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">show_remainder</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">BinaryHeap</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// This function shows the remainder in the BinaryHeap. Actually an iterator would be</span>
                                                         <span class="token comment">// faster than a function - we will learn them later.</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> remainder_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> number <span class="token keyword">in</span> input <span class="token punctuation">{</span>
        remainder_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">*</span>number<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    remainder_vec
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> many_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// These numbers are in order</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_heap <span class="token operator">=</span> <span class="token class-name">BinaryHeap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> many_numbers <span class="token punctuation">{</span>
        my_heap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">while</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">=</span> my_heap<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// .pop() returns Some(number) if a number is there, None if not. It pops from the front</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Popped off {}. Remaining numbers are: {:?}"</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> <span class="token function">show_remainder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_heap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Popped off 30. Remaining numbers are: [25, 15, 20, 0, 10, 5]
Popped off 25. Remaining numbers are: [20, 15, 5, 0, 10]
Popped off 20. Remaining numbers are: [15, 10, 5, 0]
Popped off 15. Remaining numbers are: [10, 0, 5]
Popped off 10. Remaining numbers are: [5, 0]
Popped off 5. Remaining numbers are: [0]
Popped off 0. Remaining numbers are: []<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œ0æŒ‡æ•°çš„æ•°å­—æ€»æ˜¯æœ€å¤§çš„ã€‚25, 20, 15, 10, 5, ç„¶åæ˜¯0.</p>
<p>ä½¿ç”¨<code>BinaryHeap&lt;(u8, &amp;str)&gt;</code>çš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯ç”¨äºä¸€ä¸ªäº‹æƒ…çš„é›†åˆã€‚è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>BinaryHeap&lt;(u8, &amp;str)&gt;</code>ï¼Œå…¶ä¸­<code>u8</code>æ˜¯ä»»åŠ¡é‡è¦æ€§çš„æ•°å­—ã€‚<code>&amp;str</code>æ˜¯å¯¹è¦åšçš„äº‹æƒ…çš„æè¿°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">BinaryHeap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> jobs <span class="token operator">=</span> <span class="token class-name">BinaryHeap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Add jobs to do throughout the day</span>
    jobs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"Write back to email from the CEO"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jobs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">"Finish the report today"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jobs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"Watch some YouTube"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jobs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token string">"Tell your team members thanks for always working hard"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    jobs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"Plan who to hire next for the team"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>job<span class="token punctuation">)</span> <span class="token operator">=</span> jobs<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You need to: {}"</span><span class="token punctuation">,</span> job<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†ä¸€ç›´æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You need to: Write back to email from the CEO
You need to: Finish the report today
You need to: Tell your team members thanks for always working hard
You need to: Plan who to hire next for the team
You need to: Watch some YouTube<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="VecDeque"><a href="#VecDeque" class="headerlink" title="VecDeque"></a>VecDeque</h3><p><code>VecDeque</code>å°±æ˜¯ä¸€ä¸ª<code>Vec</code>ï¼Œæ—¢èƒ½ä»å‰é¢å¼¹å‡ºitemï¼Œåˆèƒ½ä»åé¢å¼¹å‡ºitemã€‚Rustæœ‰<code>VecDeque</code>æ˜¯å› ä¸º<code>Vec</code>å¾ˆé€‚åˆä»åé¢(æœ€åä¸€ä¸ªç‰©å“)å¼¹å‡ºï¼Œä½†ä»å‰é¢å¼¹å‡ºå°±ä¸é‚£ä¹ˆå¥½äº†ã€‚å½“ä½ åœ¨<code>.pop()</code>ä¸Šä½¿ç”¨<code>Vec</code>çš„æ—¶å€™ï¼Œå®ƒåªæ˜¯æŠŠå³è¾¹æœ€åä¸€ä¸ªitemå–ä¸‹æ¥ï¼Œå…¶ä»–çš„éƒ½ä¸ä¼šåŠ¨ã€‚ä½†æ˜¯å¦‚æœä½ æŠŠå®ƒä»å…¶ä»–éƒ¨åˆ†å–ä¸‹æ¥ï¼Œå³è¾¹çš„æ‰€æœ‰ç‰©å“éƒ½ä¼šå‘å·¦ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚ä½ å¯ä»¥åœ¨<code>.remove()</code>çš„æè¿°ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Removes and returns the element at position index within the vector, shifting all elements after it to the left.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‰€ä»¥å¦‚æœä½ è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒå°†åˆ é™¤ <code>9</code>ã€‚ç´¢å¼•1ä¸­çš„<code>8</code>å°†ç§»åˆ°ç´¢å¼•0ï¼Œç´¢å¼•2ä¸­çš„<code>7</code>å°†ç§»åˆ°ç´¢å¼•1ï¼Œä»¥æ­¤ç±»æ¨ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªå¤§åœè½¦åœºï¼Œæ¯å½“æœ‰ä¸€è¾†è½¦ç¦»å¼€æ—¶ï¼Œå³è¾¹æ‰€æœ‰çš„è½¦éƒ½è¦ç§»è¿‡æ¥ã€‚</p>
<p>æ¯”å¦‚è¯´ï¼Œè¿™å¯¹è®¡ç®—æœºæ¥è¯´æ˜¯ä¸€ä¸ª<em>å¾ˆå¤§</em>çš„å·¥ä½œé‡ã€‚äº‹å®ä¸Šï¼Œå¦‚æœä½ åœ¨playgroundä¸Šè¿è¡Œå®ƒï¼Œå®ƒå¯èƒ½ä¼šå› ä¸ºå·¥ä½œå¤ªå¤šè€Œç›´æ¥æ”¾å¼ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">600_000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">600000</span> <span class="token punctuation">{</span>
        my_vec<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯60ä¸‡ä¸ªé›¶çš„<code>Vec</code>ã€‚æ¯æ¬¡ä½ ç”¨<code>remove(0)</code>ï¼Œå®ƒå°±ä¼šæŠŠæ¯ä¸ªé›¶å‘å·¦ç§»åŠ¨ä¸€ä¸ªç©ºæ ¼ã€‚ç„¶åå®ƒå°±ä¼šåš60ä¸‡æ¬¡ã€‚</p>
<p>ç”¨<code>VecDeque</code>å°±ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªé—®é¢˜äº†ã€‚å®ƒé€šå¸¸æ¯”<code>Vec</code>æ…¢ä¸€ç‚¹ï¼Œä½†å¦‚æœä½ è¦åœ¨ä¸¤ç«¯éƒ½åšäº‹æƒ…ï¼Œé‚£ä¹ˆå®ƒå°±å¿«å¤šäº†ã€‚ä½ å¯ä»¥ç›´æ¥ç”¨<code>VecDeque::from</code>ä¸<code>Vec</code>æ¥åˆ›å»ºä¸€ä¸ªã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸Šé¢çš„ä»£ç å°±æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">VecDeque</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token class-name">VecDeque</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">600000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">600000</span> <span class="token punctuation">{</span>
        my_vec<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pop_front is like .pop but for the front</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨é€Ÿåº¦å¿«äº†å¾ˆå¤šï¼Œåœ¨playgroundä¸Šï¼Œå®ƒåœ¨ä¸€ç§’å†…å®Œæˆï¼Œè€Œä¸æ˜¯æ”¾å¼ƒã€‚</p>
<p>åœ¨æ¥ä¸‹æ¥çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ª<code>Vec</code>ä¸Šåšä¸€äº›äº‹ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>VecDeque</code>ï¼Œç”¨<code>.push_front()</code>æŠŠå®ƒä»¬æ”¾åœ¨å‰é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æ·»åŠ çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¼šåœ¨å³è¾¹ã€‚ä½†æ˜¯æˆ‘ä»¬æ¨é€çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª<code>(&amp;str, bool)</code>:<code>&amp;str</code>æ˜¯æè¿°, <code>false</code>è¡¨ç¤ºè¿˜æ²¡æœ‰å®Œæˆã€‚æˆ‘ä»¬ç”¨<code>done()</code>å‡½æ•°ä»åé¢å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³åˆ é™¤å®ƒã€‚ç›¸åï¼Œæˆ‘ä»¬æŠŠ<code>false</code>æ”¹æˆ<code>true</code>ï¼Œç„¶åæŠŠå®ƒæ¨åˆ°å‰é¢ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿ç•™å®ƒã€‚</p>
<p>å®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">VecDeque</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">check_remaining</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">VecDeque</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Each item is a (&amp;str, bool)</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> input <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item<span class="token number">.1</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You must: {}"</span><span class="token punctuation">,</span> item<span class="token number">.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">done</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">VecDeque</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> task_done <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pop off the back</span>
    task_done<span class="token number">.1</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                            <span class="token comment">// now it's done - mark as true</span>
    input<span class="token punctuation">.</span><span class="token function">push_front</span><span class="token punctuation">(</span>task_done<span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// put it at the front now</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vecdeque <span class="token operator">=</span> <span class="token class-name">VecDeque</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> things_to_do <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"send email to customer"</span><span class="token punctuation">,</span> <span class="token string">"add new product to list"</span><span class="token punctuation">,</span> <span class="token string">"phone Loki back"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> thing <span class="token keyword">in</span> things_to_do <span class="token punctuation">{</span>
        my_vecdeque<span class="token punctuation">.</span><span class="token function">push_front</span><span class="token punctuation">(</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">done</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> my_vecdeque<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">done</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> my_vecdeque<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">check_remaining</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_vecdeque<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> task <span class="token keyword">in</span> my_vecdeque <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{:?} "</span><span class="token punctuation">,</span> task<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You must: phone Loki back
("add new product to list", true) ("send email to customer", true) ("phone Loki back", false)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h2 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="?æ“ä½œç¬¦"></a>?æ“ä½œç¬¦</h2><p>æœ‰ä¸€ç§æ›´çŸ­çš„æ–¹æ³•æ¥å¤„ç†<code>Result</code>(å’Œ<code>Option</code>)ï¼Œå®ƒæ¯”<code>match</code>å’Œ<code>if let</code>æ›´çŸ­ã€‚å®ƒå«åš â€œé—®å·è¿ç®—ç¬¦â€ï¼Œå°±æ˜¯<code>?</code>ã€‚åœ¨è¿”å›ç»“æœçš„å‡½æ•°åï¼Œå¯ä»¥åŠ ä¸Š<code>?</code>ã€‚è¿™æ ·å°±ä¼š:</p>
<ul>
<li>è¿”å›<code>Result</code>é‡Œé¢çš„å†…å®¹ï¼Œå¦‚æœæ˜¯<code>Ok</code>ã€‚</li>
<li>å¦‚æœæ˜¯<code>Err</code>ï¼Œåˆ™å°†é”™è¯¯ä¼ å›ã€‚</li>
</ul>
<p>æ¢å¥è¯è¯´ï¼Œå®ƒå‡ ä¹ä¸ºä½ åšäº†æ‰€æœ‰çš„äº‹æƒ…ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>.parse()</code> å†è¯•ä¸€æ¬¡ã€‚æˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªåä¸º <code>parse_str</code> çš„å‡½æ•°ï¼Œè¯•å›¾å°† <code>&amp;str</code> å˜æˆ <code>i32</code>ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">parse_str</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> parsed_number <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// Here is the question mark</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>parsed_number<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ª <code>&amp;str</code>ã€‚å¦‚æœæ˜¯ <code>Ok</code>ï¼Œåˆ™ç»™å‡ºä¸€ä¸ª <code>i32</code>ï¼ŒåŒ…è£¹åœ¨ <code>Ok</code> ä¸­ã€‚å¦‚æœæ˜¯ <code>Err</code>ï¼Œåˆ™è¿”å› <code>ParseIntError</code>ã€‚ç„¶åæˆ‘ä»¬å°è¯•è§£æè¿™ä¸ªæ•°å­—ï¼Œå¹¶åŠ ä¸Š<code>?</code>ã€‚ä¹Ÿå°±æ˜¯ â€œæ£€æŸ¥æ˜¯å¦é”™è¯¯ï¼Œå¦‚æœæ²¡é—®é¢˜å°±ç»™å‡ºResulté‡Œé¢çš„å†…å®¹â€ã€‚å¦‚æœæœ‰é—®é¢˜ï¼Œå°±ä¼šè¿”å›é”™è¯¯å¹¶ç»“æŸã€‚ä½†å¦‚æœæ²¡é—®é¢˜ï¼Œå°±ä¼šè¿›å…¥ä¸‹ä¸€è¡Œã€‚ä¸‹ä¸€è¡Œæ˜¯<code>Ok()</code>é‡Œé¢çš„æ•°å­—ã€‚æˆ‘ä»¬éœ€è¦ç”¨<code>Ok</code>æ¥åŒ…è£…ï¼Œå› ä¸ºè¿”å›çš„æ˜¯<code>Result&lt;i32, ParseIntError&gt;</code>ï¼Œè€Œä¸æ˜¯<code>i32</code>ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¯•è¯•æˆ‘ä»¬çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒå¯¹<code>&amp;str</code>çš„vecæœ‰ä»€ä¹ˆä½œç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">parse_str</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> parsed_number <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>parsed_number<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Seven"</span><span class="token punctuation">,</span> <span class="token string">"8"</span><span class="token punctuation">,</span> <span class="token string">"9.0"</span><span class="token punctuation">,</span> <span class="token string">"nice"</span><span class="token punctuation">,</span> <span class="token string">"6060"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> str_vec <span class="token punctuation">{</span>
        <span class="token keyword">let</span> parsed <span class="token operator">=</span> <span class="token function">parse_str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> parsed<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Err(ParseIntError { kind: InvalidDigit })
Ok(8)
Err(ParseIntError { kind: InvalidDigit })
Err(ParseIntError { kind: InvalidDigit })
Ok(6060)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬æ˜¯æ€ä¹ˆæ‰¾åˆ°<code>std::num::ParseIntError</code>çš„å‘¢ï¼Ÿä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯å† â€œé—®â€ä¸€ä¸‹ç¼–è¯‘å™¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> failure <span class="token operator">=</span> <span class="token string">"Not a number"</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    failure<span class="token punctuation">.</span><span class="token function">rbrbrb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸ Compiler: "What is rbrbrb()???"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨ä¸æ‡‚ï¼Œè¯´ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0599]: no method named `rbrbrb` found for enum `std::result::Result&lt;i32, std::num::ParseIntError&gt;` in the current scope
 --&gt; src\main.rs:3:13
  |
3 |     failure.rbrbrb();
  |             ^^^^^^ method not found in `std::result::Result&lt;i32, std::num::ParseIntError&gt;`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥<code>std::result::Result&lt;i32, std::num::ParseIntError&gt;</code>å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ç­¾åã€‚</p>
<p>æˆ‘ä»¬ä¸éœ€è¦å†™ <code>std::result::Result</code>ï¼Œå› ä¸º <code>Result</code> æ€»æ˜¯ â€œåœ¨èŒƒå›´å†…â€(åœ¨èŒƒå›´å†… = å‡†å¤‡å¥½ä½¿ç”¨)ã€‚Rustå¯¹æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„æ‰€æœ‰ç±»å‹éƒ½æ˜¯è¿™æ ·åšçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…å†™<code>std::result::Result</code>ã€<code>std::collections::Vec</code>ç­‰ã€‚</p>
<p>æˆ‘ä»¬ç°åœ¨è¿˜æ²¡æœ‰å¤„ç†æ–‡ä»¶è¿™æ ·çš„ä¸œè¥¿ï¼Œæ‰€ä»¥?æ“ä½œç¬¦çœ‹èµ·æ¥è¿˜ä¸æ˜¯å¤ªæœ‰ç”¨ã€‚ä½†è¿™é‡Œæœ‰ä¸€ä¸ªæ— ç”¨ä½†å¿«é€Ÿçš„ä¾‹å­ï¼Œè¯´æ˜ä½ å¦‚ä½•åœ¨å•è¡Œä¸Šä½¿ç”¨å®ƒã€‚ä¸å…¶ç”¨ <code>.parse()</code> åˆ›å»ºä¸€ä¸ª <code>i32</code>ï¼Œä¸å¦‚åšæ›´å¤šã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª <code>u16</code>ï¼Œç„¶åæŠŠå®ƒå˜æˆ <code>String</code>ï¼Œå†å˜æˆ <code>u32</code>ï¼Œç„¶åå†å˜æˆ <code>String</code>ï¼Œæœ€åå˜æˆ <code>i32</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">parse_str</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> parsed_number <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">u16</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// Add a ? each time to check and pass it on</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>parsed_number<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> str_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Seven"</span><span class="token punctuation">,</span> <span class="token string">"8"</span><span class="token punctuation">,</span> <span class="token string">"9.0"</span><span class="token punctuation">,</span> <span class="token string">"nice"</span><span class="token punctuation">,</span> <span class="token string">"6060"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> str_vec <span class="token punctuation">{</span>
        <span class="token keyword">let</span> parsed <span class="token operator">=</span> <span class="token function">parse_str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> parsed<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°å‡ºåŒæ ·çš„ä¸œè¥¿ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬åœ¨ä¸€è¡Œä¸­å¤„ç†äº†ä¸‰ä¸ª<code>Result</code>ã€‚ç¨åæˆ‘ä»¬å°†å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œå› ä¸ºå®ƒä»¬æ€»æ˜¯è¿”å›<code>Result</code>ï¼Œå› ä¸ºå¾ˆå¤šäº‹æƒ…éƒ½å¯èƒ½å‡ºé”™ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹:ä½ æƒ³æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå‘å®ƒå†™å…¥ï¼Œç„¶åå…³é—­å®ƒã€‚é¦–å…ˆä½ éœ€è¦æˆåŠŸæ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶(è¿™å°±æ˜¯ä¸€ä¸ª<code>Result</code>)ã€‚ç„¶åä½ éœ€è¦æˆåŠŸåœ°å†™å…¥å®ƒ(é‚£æ˜¯ä¸€ä¸ª<code>Result</code>)ã€‚å¯¹äº<code>?</code>ï¼Œä½ å¯ä»¥åœ¨ä¸€è¡Œä¸Šå®Œæˆã€‚</p>
<h3 id="When-panic-and-unwrap-are-good"><a href="#When-panic-and-unwrap-are-good" class="headerlink" title="When panic and unwrap are good"></a>When panic and unwrap are good</h3><p>Rustæœ‰ä¸€ä¸ª<code>panic!</code>çš„å®ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è®©å®ƒå´©æºƒã€‚å®ƒä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"Time to panic!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œç¨‹åºæ—¶ï¼Œä¼šæ˜¾ç¤ºä¿¡æ¯<code>"Time to panic!"</code>ã€‚<code>thread 'main' panicked at 'Time to panic!', src\main.rs:2:3</code></p>
<p>ä½ ä¼šè®°å¾—<code>src\main.rs</code>æ˜¯ç›®å½•å’Œæ–‡ä»¶åï¼Œ<code>2:3</code>æ˜¯è¡Œåå’Œåˆ—åã€‚æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œä½ å°±å¯ä»¥æ‰¾åˆ°ä»£ç å¹¶ä¿®å¤å®ƒã€‚</p>
<p><code>panic!</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„å®ï¼Œä»¥ç¡®ä¿ä½ çŸ¥é“ä»€ä¹ˆæ—¶å€™æœ‰å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªå«åš<code>prints_three_things</code>çš„å‡½æ•°æ€»æ˜¯ä»ä¸€ä¸ªå‘é‡ä¸­æ‰“å°å‡ºç´¢å¼•[0]ã€[1]å’Œ[2]ã€‚è¿™æ²¡å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬æ€»æ˜¯ç»™å®ƒä¸€ä¸ªæœ‰ä¸‰ä¸ªå…ƒç´ çš„å‘é‡ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_three_things</span><span class="token punctuation">(</span>vector<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}, {}"</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">prints_three_things</span><span class="token punctuation">(</span>my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°å‡º<code>8, 9, 10</code>ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚</p>
<p>ä½†è¯•æƒ³ä¸€ä¸‹ï¼Œåæ¥æˆ‘ä»¬å†™çš„ä»£ç è¶Šæ¥è¶Šå¤šï¼Œå¿˜è®°äº†<code>my_vec</code>åªèƒ½æœ‰ä¸‰ä¸ªå…ƒç´ ã€‚ç°åœ¨<code>my_vec</code>åœ¨è¿™éƒ¨åˆ†æœ‰å…­ä¸ªå…ƒç´ ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_three_things</span><span class="token punctuation">(</span>vector<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}, {}"</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Now my_vec has six things</span>
  <span class="token function">prints_three_things</span><span class="token punctuation">(</span>my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå› ä¸º[0]å’Œ[1]å’Œ[2]éƒ½åœ¨è¿™ä¸ªè¾ƒé•¿çš„<code>Vec</code>é‡Œé¢ã€‚ä½†å¦‚æœåªèƒ½æœ‰ä¸‰ä¸ªå…ƒç´ å‘¢ï¼Ÿæˆ‘ä»¬å°±ä¸ä¼šçŸ¥é“æœ‰é—®é¢˜äº†ï¼Œå› ä¸ºç¨‹åºä¸ä¼šå´©æºƒã€‚æˆ‘ä»¬åº”è¯¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_three_things</span><span class="token punctuation">(</span>vector<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> vector<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"my_vec must always have three items"</span><span class="token punctuation">)</span> <span class="token comment">// will panic if the length is not 3</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}, {}"</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">prints_three_things</span><span class="token punctuation">(</span>my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœå‘é‡æœ‰6ä¸ªå…ƒç´ ï¼Œå®ƒåº”è¯¥è¦å´©æºƒ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">    <span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">prints_three_things</span><span class="token punctuation">(</span>vector<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> vector<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"my_vec must always have three items"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}, {}"</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vector<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">prints_three_things</span><span class="token punctuation">(</span>my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†<code>thread 'main' panicked at 'my_vec must always have three items', src\main.rs:8:9</code>ã€‚å¤šäºäº†<code>panic!</code>ï¼Œæˆ‘ä»¬ç°åœ¨è®°å¾—<code>my_vec</code>åº”è¯¥åªæœ‰ä¸‰ä¸ªå…ƒç´ ã€‚æ‰€ä»¥<code>panic!</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®ï¼Œå¯ä»¥åœ¨ä½ çš„ä»£ç ä¸­åˆ›å»ºæé†’ã€‚</p>
<p>è¿˜æœ‰ä¸‰ä¸ªä¸<code>panic!</code>ç±»ä¼¼çš„å®ï¼Œä½ åœ¨æµ‹è¯•ä¸­ç»å¸¸ä½¿ç”¨ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ <code>assert!</code>, <code>assert_eq!</code>, å’Œ <code>assert_ne!</code>.</p>
<p>ä¸‹é¢æ˜¯å®ƒä»¬çš„æ„æ€ã€‚</p>
<ul>
<li><code>assert!()</code>: å¦‚æœ<code>()</code>é‡Œé¢çš„éƒ¨åˆ†ä¸æ˜¯çœŸçš„, ç¨‹åºå°±ä¼šå´©æºƒ.</li>
<li><code>assert_eq!()</code>:<code>()</code>é‡Œé¢çš„ä¸¤ä¸ªå…ƒç´ å¿…é¡»ç›¸ç­‰ã€‚</li>
<li><code>assert_ne!()</code>:<code>()</code>é‡Œé¢çš„ä¸¤ä¸ªå…ƒç´ å¿…é¡»ä¸ç›¸ç­‰ã€‚(<em>ne</em>è¡¨ç¤ºä¸ç›¸ç­‰)</li>
</ul>
<p>ä¸€äº›ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_name <span class="token operator">=</span> <span class="token string">"Loki Laufeyson"</span><span class="token punctuation">;</span>

    <span class="token macro property">assert!</span><span class="token punctuation">(</span>my_name <span class="token operator">==</span> <span class="token string">"Loki Laufeyson"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_name<span class="token punctuation">,</span> <span class="token string">"Loki Laufeyson"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_ne!</span><span class="token punctuation">(</span>my_name<span class="token punctuation">,</span> <span class="token string">"Mithridates"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ä¼šæœ‰ä»»ä½•ä½œç”¨ï¼Œå› ä¸ºä¸‰ä¸ªæ–­è¨€å®éƒ½æ²¡æœ‰é—®é¢˜ã€‚(è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„)</p>
<p>å¦‚æœä½ æ„¿æ„ï¼Œè¿˜å¯ä»¥åŠ ä¸ªæç¤ºä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_name <span class="token operator">=</span> <span class="token string">"Loki Laufeyson"</span><span class="token punctuation">;</span>

    <span class="token macro property">assert!</span><span class="token punctuation">(</span>
        my_name <span class="token operator">==</span> <span class="token string">"Loki Laufeyson"</span><span class="token punctuation">,</span>
        <span class="token string">"{} should be Loki Laufeyson"</span><span class="token punctuation">,</span>
        my_name
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>
        my_name<span class="token punctuation">,</span> <span class="token string">"Loki Laufeyson"</span><span class="token punctuation">,</span>
        <span class="token string">"{} and Loki Laufeyson should be equal"</span><span class="token punctuation">,</span>
        my_name
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_ne!</span><span class="token punctuation">(</span>
        my_name<span class="token punctuation">,</span> <span class="token string">"Mithridates"</span><span class="token punctuation">,</span>
        <span class="token string">"You entered {}. Input must not equal Mithridates"</span><span class="token punctuation">,</span>
        my_name
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™äº›ä¿¡æ¯åªæœ‰åœ¨ç¨‹åºå´©æºƒæ—¶æ‰ä¼šæ˜¾ç¤ºã€‚æ‰€ä»¥å¦‚æœä½ è¿è¡Œè¿™ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_name <span class="token operator">=</span> <span class="token string">"Mithridates"</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_ne!</span><span class="token punctuation">(</span>
        my_name<span class="token punctuation">,</span> <span class="token string">"Mithridates"</span><span class="token punctuation">,</span>
        <span class="token string">"You enter {}. Input must not equal Mithridates"</span><span class="token punctuation">,</span>
        my_name
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒå°†æ˜¾ç¤º:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">thread 'main' panicked at 'assertion failed: `(left != right)`
  left: `"Mithridates"`,
 right: `"Mithridates"`: You entered Mithridates. Input must not equal Mithridates', src\main.rs:4:5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å®ƒè¯´ â€œä½ è¯´å·¦ï¼=å³ï¼Œä½†å·¦==å³â€ã€‚è€Œä¸”å®ƒæ˜¾ç¤ºæˆ‘ä»¬çš„ä¿¡æ¯è¯´<code>You entered Mithridates. Input must not equal Mithridates</code>ã€‚</p>
<p>å½“ä½ åœ¨å†™ç¨‹åºçš„æ—¶å€™ï¼Œæƒ³è®©å®ƒåœ¨å‡ºç°é—®é¢˜çš„æ—¶å€™å´©æºƒï¼Œ<code>unwrap</code>æ˜¯ä¸ªå¥½æ³¨æ„ã€‚åé¢ï¼Œå½“ä½ çš„ä»£ç å†™å®Œåï¼ŒæŠŠ<code>unwrap</code>æ”¹æˆå…¶ä»–ä¸ä¼šå´©æºƒçš„ä¸œè¥¿å°±å¥½äº†ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ç”¨<code>expect</code>ï¼Œå®ƒå’Œ<code>unwrap</code>ä¸€æ ·ï¼Œä½†æ˜¯æ›´å¥½ä¸€äº›ï¼Œå› ä¸ºå®ƒæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ä¿¡æ¯ã€‚æ•™ç§‘ä¹¦é€šå¸¸ä¼šç»™å‡ºè¿™æ ·çš„å»ºè®®:â€å¦‚æœä½ ç»å¸¸ä½¿ç”¨<code>.unwrap()</code>, è‡³å°‘ä¹Ÿè¦ç”¨<code>.expect()</code>æ¥è·å¾—æ›´å¥½çš„é”™è¯¯ä¿¡æ¯.â€</p>
<p>è¿™æ ·ä¼šå´©æºƒçš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">   <span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_fourth</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> fourth <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>fourth
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> fourth <span class="token operator">=</span> <span class="token function">get_fourth</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é”™è¯¯ä¿¡æ¯æ˜¯<code>thread 'main' panicked at 'called Option::unwrap() on a None value', src\main.rs:7:18</code>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬ç”¨<code>expect</code>æ¥å†™è‡ªå·±çš„ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">   <span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_fourth</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> fourth <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"Input vector needs at least 4 items"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>fourth
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> fourth <span class="token operator">=</span> <span class="token function">get_fourth</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆå´©æºƒäº†ï¼Œä½†é”™è¯¯æ¯”è¾ƒå¤šã€‚<code>thread 'main' panicked at 'Input vector needs at least 4 items', src\main.rs:7:18</code>. <code>.expect()</code>å› ä¸ºè¿™ä¸ªåŸå› æ¯”<code>.unwrap()</code>è¦å¥½ä¸€ç‚¹ï¼Œä½†æ˜¯åœ¨<code>None</code>ä¸Šè¿˜æ˜¯ä¼šæ…Œã€‚ç°åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªä¸å¥½çš„åšæ³•çš„ä¾‹å­ï¼Œä¸€ä¸ªå‡½æ•°è¯•å›¾è§£åŒ…ä¸¤æ¬¡ã€‚å®ƒéœ€è¦ä¸€ä¸ª<code>Vec&lt;Option&lt;i32&gt;&gt;</code>ï¼Œæ‰€ä»¥å¯èƒ½æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šæœ‰ä¸€ä¸ª<code>Some&lt;i32&gt;</code>ï¼Œä¹Ÿå¯èƒ½æœ‰ä¸€ä¸ª<code>None</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">try_two_unwraps</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Index 0 is: {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Index 1 is: {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> vector <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// This vector has a None, so it will panic</span>
    <span class="token function">try_two_unwraps</span><span class="token punctuation">(</span>vector<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¶ˆæ¯æ˜¯:<code>thread 'main' panicked at 'called `Option::unwrap()` on a `None` value', src\main.rs:2:32</code>ã€‚æˆ‘ä»¬ä¸æ£€æŸ¥è¡Œå·ï¼Œå°±ä¸çŸ¥é“æ˜¯ç¬¬ä¸€ä¸ª<code>.unwrap()</code>è¿˜æ˜¯ç¬¬äºŒä¸ª<code>.unwrap()</code>ã€‚æœ€å¥½æ˜¯æ£€æŸ¥é•¿åº¦ï¼Œä¹Ÿä¸è¦è§£åŒ…ã€‚ä¸è¿‡æœ‰äº†<code>.expect()</code>è‡³å°‘ä¼šå¥½<em>ä¸€ç‚¹</em>ã€‚ä¸‹é¢æ˜¯<code>.expect()</code>çš„æƒ…å†µã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">try_two_unwraps</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Index 0 is: {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"The first unwrap had a None!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Index 1 is: {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">"The second unwrap had a None!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> vector <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">try_two_unwraps</span><span class="token punctuation">(</span>vector<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œè¿™æ˜¯å¥½ä¸€ç‚¹çš„ã€‚<code>thread 'main' panicked at 'The first unwrap had a None!', src\main.rs:2:32</code>. æˆ‘ä»¬ä¹Ÿæœ‰è¡Œå·ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å®ƒã€‚</p>
<p>å¦‚æœä½ æƒ³ä¸€ç›´æœ‰ä¸€ä¸ªä½ æƒ³é€‰æ‹©çš„å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨<code>unwrap_or</code>ã€‚å¦‚æœä½ è¿™æ ·åšï¼Œå®ƒæ°¸è¿œä¸ä¼šå´©æºƒã€‚å°±æ˜¯è¿™æ ·çš„ã€‚</p>
<ul>
<li>1)å¥½ï¼Œå› ä¸ºä½ çš„ç¨‹åºä¸ä¼šå´©æºƒï¼Œä½†</li>
<li>2)å¦‚æœä½ æƒ³è®©ç¨‹åºåœ¨å‡ºç°é—®é¢˜æ—¶å´©æºƒï¼Œä¹Ÿè®¸ä¸å¥½ã€‚</li>
</ul>
<p>ä½†é€šå¸¸æˆ‘ä»¬éƒ½ä¸å¸Œæœ›è‡ªå·±çš„ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥<code>unwrap_or</code>æ˜¯ä¸ªä¸é”™çš„æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> fourth <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// If .get doesn't work, we will make the value &amp;0.</span>
                                              <span class="token comment">// .get returns a reference, so we need &amp;0 and not 0</span>
                                              <span class="token comment">// You can write "let *fourth" with a * if you want fourth to be</span>
                                              <span class="token comment">// a 0 and not a &amp;0, but here we just print so it doesn't matter</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> fourth<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>0</code>ï¼Œå› ä¸º <code>.unwrap_or(&amp;0)</code> ç»™å‡ºäº†ä¸€ä¸ª 0ï¼Œå³ä½¿å®ƒæ˜¯ <code>None</code>ã€‚</p>
<h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>æˆ‘ä»¬ä»¥å‰è§è¿‡trait:<code>Debug</code>ã€<code>Copy</code>ã€<code>Clone</code>éƒ½æ˜¯traitã€‚è¦ç»™ä¸€ä¸ªç±»å‹ä¸€ä¸ªtraitï¼Œå°±å¿…é¡»å®ç°å®ƒã€‚å› ä¸º<code>Debug</code>å’Œå…¶ä»–çš„traitéƒ½å¾ˆå¸¸è§ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰è‡ªåŠ¨å®ç°çš„å±æ€§ã€‚è¿™å°±æ˜¯å½“ä½ å†™ä¸‹<code>#[derive(Debug)]</code>æ‰€å‘ç”Ÿçš„äº‹æƒ…:ä½ è‡ªåŠ¨å®ç°äº†<code>Debug</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">MyStruct</span> <span class="token punctuation">{</span>
    number<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å…¶ä»–çš„ç‰¹æ€§å°±æ¯”è¾ƒå›°éš¾äº†ï¼Œæ‰€ä»¥éœ€è¦ç”¨<code>impl</code>æ‰‹åŠ¨å®ç°ã€‚ä¾‹å¦‚ï¼Œ<code>Add</code>(åœ¨<code>std::ops::Add</code>å¤„æ‰¾åˆ°)æ˜¯ç”¨æ¥ç´¯åŠ ä¸¤ä¸ªä¸œè¥¿çš„ã€‚ä½†æ˜¯Rustå¹¶ä¸çŸ¥é“ä½ åˆ°åº•è¦æ€ä¹ˆç´¯åŠ ï¼Œæ‰€ä»¥ä½ å¿…é¡»å‘Šè¯‰å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">ThingsToAdd</span> <span class="token punctuation">{</span>
    first_thing<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    second_thing<span class="token punctuation">:</span> <span class="token keyword">f32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥ç´¯åŠ <code>first_thing</code>å’Œ<code>second_thing</code>ï¼Œä½†æˆ‘ä»¬éœ€è¦æä¾›æ›´å¤šä¿¡æ¯ã€‚ä¹Ÿè®¸æˆ‘ä»¬æƒ³è¦ä¸€ä¸ª<code>f32</code>ï¼Œæ‰€ä»¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>second_thing <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>first_thing <span class="token keyword">as</span> <span class="token keyword">f32</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†ä¹Ÿè®¸æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªæ•´æ•°ï¼Œæ‰€ä»¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>second_thing <span class="token keyword">as</span> <span class="token keyword">u32</span> <span class="token operator">+</span> <span class="token keyword">self</span><span class="token punctuation">.</span>first_thing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æˆ–è€…æˆ‘ä»¬æƒ³æŠŠ<code>self.first_thing</code>æ”¾åœ¨<code>self.second_thing</code>æ—è¾¹ï¼Œè¯´æˆ‘ä»¬è¦è¿™æ ·åŠ ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æŠŠ55åŠ åˆ°33.4ï¼Œæˆ‘ä»¬è¦çœ‹åˆ°çš„æ˜¯5533.4ï¼Œè€Œä¸æ˜¯88.4ã€‚</p>
<p>æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªtraitã€‚å…³äº<code>trait</code>ï¼Œè¦è®°ä½çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œå®ƒä»¬æ˜¯å…³äºè¡Œä¸ºçš„ã€‚è¦åˆ›å»ºä¸€ä¸ªtraitï¼Œå†™ä¸‹å•è¯<code>trait</code>ï¼Œç„¶ååˆ›å»ºä¸€äº›å‡½æ•°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span> <span class="token comment">// A simple struct - an Animal only has a name</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span> <span class="token comment">// The dog trait gives some functionality</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">bark</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// It can bark</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Woof woof!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// and it can run</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The dog is running!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Dog</span> <span class="token keyword">for</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Now Animal has the trait Dog</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rover <span class="token operator">=</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Rover"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    rover<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now Animal can use bark()</span>
    rover<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// and it can use run()</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³æ‰“å° â€œç‹—åœ¨è·‘â€ã€‚å¦‚æœä½ æƒ³çš„è¯ï¼Œä½ å¯ä»¥æ”¹å˜<code>trait</code>ç»™ä½ çš„æ–¹æ³•ï¼Œä½†ä½ å¿…é¡»æœ‰ç›¸åŒçš„ç­¾åã€‚è¿™æ„å‘³ç€å®ƒéœ€è¦æ¥å—åŒæ ·çš„ä¸œè¥¿ï¼Œå¹¶è¿”å›åŒæ ·çš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜ <code>.run()</code> çš„æ–¹æ³•ï¼Œä½†æˆ‘ä»¬å¿…é¡»éµå¾ªç­¾åã€‚ç­¾åè¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The dog is running!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>fn run(&amp;self)</code>çš„æ„æ€æ˜¯ â€œfn <code>run()</code>ä»¥<code>&amp;self</code>ä¸ºå‚æ•°ï¼Œä¸è¿”å›ä»»ä½•å†…å®¹â€ã€‚æ‰€ä»¥ä½ ä¸èƒ½è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span> <span class="token comment">// âš ï¸</span>
    <span class="token number">5</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Rustä¼šè¯´ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">= note: expected fn pointer `fn(&amp;Animal)`
           found fn pointer `fn(&amp;Animal) -&gt; i32`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†æˆ‘ä»¬å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span> <span class="token comment">// A simple struct - an Animal only has a name</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span> <span class="token comment">// The dog trait gives some functionality</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">bark</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// It can bark</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Woof woof!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// and it can run</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The dog is running!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Dog</span> <span class="token keyword">for</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is running!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rover <span class="token operator">=</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Rover"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    rover<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now Animal can use bark()</span>
    rover<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// and it can use run()</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å®ƒæ‰“å°çš„æ˜¯ <code>Rover is running!</code>ã€‚è¿™æ˜¯å¥½çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿”å›çš„æ˜¯ <code>()</code>ï¼Œæˆ–è€…è¯´ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œè¿™å°±æ˜¯traitæ‰€è¯´çš„ã€‚</p>
<p>å½“ä½ å†™ä¸€ä¸ªtraitçš„æ—¶å€™ï¼Œä½ å¯ä»¥ç›´æ¥å†™å‡½æ•°ç­¾åï¼Œä½†å¦‚æœä½ è¿™æ ·åšï¼Œç”¨æˆ·å°†ä¸å¾—ä¸å†™å‡½æ•°å®ç°ã€‚æˆ‘ä»¬æ¥è¯•è¯•ã€‚ç°åœ¨æˆ‘ä»¬æŠŠ<code>bark()</code>å’Œ<code>run()</code>æ”¹æˆåªè¯´<code>fn bark(&amp;self);</code>å’Œ<code>fn run(&amp;self);</code>ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å‡½æ•°å®ç°ï¼Œæ‰€ä»¥å¿…é¡»ç”±ç”¨æˆ·æ¥å†™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Animal</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">bark</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bark() says it needs a &amp;self and returns nothing</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// run() says it needs a &amp;self and returns nothing.</span>
                   <span class="token comment">// So now we have to write them ourselves.</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Dog</span> <span class="token keyword">for</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">bark</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, stop barking!!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is running!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rover <span class="token operator">=</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Rover"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    rover<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rover<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œå½“ä½ åˆ›å»ºä¸€ä¸ªtraitæ—¶ï¼Œä½ å¿…é¡»æ€è€ƒ:â€æˆ‘åº”è¯¥å†™å“ªäº›åŠŸèƒ½ï¼Ÿè€Œç”¨æˆ·åº”è¯¥å†™å“ªäº›å‡½æ•°ï¼Ÿâ€ å¦‚æœä½ è®¤ä¸ºç”¨æˆ·æ¯æ¬¡ä½¿ç”¨å‡½æ•°çš„æ–¹å¼åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±æŠŠå‡½æ•°å†™å‡ºæ¥ã€‚å¦‚æœä½ è®¤ä¸ºç”¨æˆ·ä¼šä»¥ä¸åŒçš„æ–¹å¼ä½¿ç”¨ï¼Œé‚£å°±å†™å‡ºå‡½æ•°ç­¾åå³å¯ã€‚</p>
<p>æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬å°è¯•ä¸ºæˆ‘ä»¬çš„structå®ç°Displayç‰¹æ€§ã€‚é¦–å…ˆæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„ç»“æ„ä½“:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mr_mantle <span class="token operator">=</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Reggie Mantle"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬è¦æ‰“å°<code>mr_mantle</code>ã€‚è°ƒè¯•å¾ˆå®¹æ˜“å¾—å‡ºã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mr_mantle <span class="token operator">=</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Reggie Mantle"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Mr. Mantle is a {:?}"</span><span class="token punctuation">,</span> mr_mantle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†Debugæ‰“å°ä¸æ˜¯æœ€æ¼‚äº®çš„æ–¹å¼ï¼Œå› ä¸ºå®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Mr. Mantle is a Cat { name: "Reggie Mantle", age: 4 }<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´å¥½çš„æ‰“å°ï¼Œå°±éœ€è¦å®ç°<code>Display</code>ä¸º<code>Cat</code>ã€‚åœ¨<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/fmt/trait.Display.html">https://doc.rust-lang.org/std/fmt/trait.Display.html</a>ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Displayçš„ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€ä¸ªä¾‹å­ã€‚å®ƒè¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Position</span> <span class="token punctuation">{</span>
    longitude<span class="token punctuation">:</span> <span class="token keyword">f32</span><span class="token punctuation">,</span>
    latitude<span class="token punctuation">:</span> <span class="token keyword">f32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Position</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"({}, {})"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>longitude<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>latitude<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰äº›éƒ¨åˆ†æˆ‘ä»¬è¿˜ä¸æ˜ç™½ï¼Œæ¯”å¦‚<code>&lt;'_&gt;</code>å’Œ<code>f</code>åœ¨åšä»€ä¹ˆã€‚ä½†æˆ‘ä»¬ç†è§£<code>Position</code>ç»“æ„ä½“:å®ƒåªæ˜¯ä¸¤ä¸ª<code>f32</code>ã€‚æˆ‘ä»¬ä¹Ÿæ˜ç™½ï¼Œ<code>self.longitude</code>å’Œ<code>self.latitude</code>æ˜¯ç»“æ„ä½“ä¸­çš„å­—æ®µã€‚æ‰€ä»¥ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„ç»“æ„ä½“å°±å¯ä»¥ç”¨è¿™ä¸ªä»£ç ï¼Œç”¨<code>self.name</code>å’Œ<code>self.age</code>ã€‚å¦å¤–ï¼Œ<code>write!</code>çœ‹èµ·æ¥å¾ˆåƒ<code>println!</code>ï¼Œæ‰€ä»¥å¾ˆç†Ÿæ‚‰ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™æ ·å†™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} is a cat who is {} years old."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ª<code>fn main()</code>ã€‚ç°åœ¨æˆ‘ä»¬çš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
  <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
      <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} is a cat who is {} years old."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mr_mantle <span class="token operator">=</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Reggie Mantle"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> mr_mantle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆåŠŸäº†! ç°åœ¨ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨<code>{}</code>æ‰“å°æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°<code>Reggie Mantle is a cat who is 4 years old.</code>ã€‚è¿™çœ‹èµ·æ¥å¥½å¤šäº†ã€‚</p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœä½ å®ç°äº†<code>Display</code>ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å…è´¹å¾—åˆ°<code>ToString</code>çš„ç‰¹æ€§ã€‚è¿™æ˜¯å› ä¸ºä½ ä½¿ç”¨<code>format!</code>å®æ¥å®ç°<code>.fmt()</code>å‡½æ•°ï¼Œè¿™è®©ä½ å¯ä»¥ç”¨<code>.to_string()</code>æ¥åˆ›å»ºä¸€ä¸ª<code>String</code>ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åšè¿™æ ·çš„äº‹æƒ…ï¼Œæˆ‘ä»¬æŠŠ<code>reggie_mantle</code>ä¼ ç»™ä¸€ä¸ªæƒ³è¦<code>String</code>çš„å‡½æ•°ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Cat</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} is a cat who is {} years old."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_cats</span><span class="token punctuation">(</span>pet<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> pet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mr_mantle <span class="token operator">=</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Reggie Mantle"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">print_cats</span><span class="token punctuation">(</span>mr_mantle<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Turn him into a String here</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Mr. Mantle's String is {} letters long."</span><span class="token punctuation">,</span> mr_mantle<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Turn him into chars and count them</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Reggie Mantle is a cat who is 4 years old.
Mr. Mantle's String is 42 letters long.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>




<p>å…³äºtraitï¼Œè¦è®°ä½çš„æ˜¯ï¼Œå®ƒä»¬æ˜¯å…³äºæŸäº›ä¸œè¥¿çš„è¡Œä¸ºã€‚ä½ çš„<code>struct</code>æ˜¯å¦‚ä½•è¡ŒåŠ¨çš„ï¼Ÿå®ƒèƒ½åšä»€ä¹ˆï¼Ÿè¿™å°±æ˜¯traitçš„ä½œç”¨ã€‚å¦‚æœä½ æƒ³æƒ³æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€çœ‹åˆ°çš„ä¸€äº›traitï¼Œå®ƒä»¬éƒ½æ˜¯å…³äºè¡Œä¸ºçš„:<code>Copy</code>æ˜¯ä¸€ä¸ªç±»å‹å¯ä»¥åšçš„äº‹æƒ…ã€‚<code>Display</code>ä¹Ÿæ˜¯ä¸€ä¸ªç±»å‹èƒ½åšçš„äº‹æƒ…ã€‚<code>ToString</code>æ˜¯å¦ä¸€ä¸ªtraitï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªç±»å‹å¯ä»¥åšçš„äº‹æƒ…:å®ƒå¯ä»¥å˜åŒ–æˆä¸€ä¸ª<code>String</code>ã€‚åœ¨æˆ‘ä»¬çš„ <code>Dog</code> traitä¸­ï¼Œ<em>Dog</em>è¿™ä¸ªè¯å¹¶ä¸æ„å‘³ç€ä½ èƒ½åšçš„äº‹æƒ…ï¼Œä½†å®ƒç»™å‡ºäº†ä¸€äº›è®©å®ƒåšäº‹æƒ…çš„æ–¹æ³•ã€‚<br> ä½ ä¹Ÿå¯ä»¥ä¸º <code>struct Poodle</code> æˆ– <code>struct Beagle</code> å®ç°å®ƒï¼Œå®ƒä»¬éƒ½ä¼šå¾—åˆ° <code>Dog</code> æ–¹æ³•ã€‚</p>
<p>è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¸å•çº¯è¡Œä¸ºè”ç³»æ›´ç´§å¯†çš„ä¾‹å­ã€‚æˆ‘ä»¬å°†æƒ³è±¡ä¸€ä¸ªæœ‰ä¸€äº›ç®€å•è§’è‰²çš„å¹»æƒ³æ¸¸æˆã€‚ä¸€ä¸ªæ˜¯<code>Monster</code>ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯<code>Wizard</code>å’Œ<code>Ranger</code>ã€‚<code>Monster</code>åªæ˜¯æœ‰<code>health</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”»å‡»å®ƒï¼Œå…¶ä»–ä¸¤ä¸ªè¿˜æ²¡æœ‰ä»€ä¹ˆã€‚ä½†æ˜¯æˆ‘ä»¬åšäº†ä¸¤ä¸ªtraitã€‚ä¸€ä¸ªå«<code>FightClose</code>ï¼Œè®©ä½ è¿‘èº«ä½œæˆ˜ã€‚å¦ä¸€ä¸ªæ˜¯<code>FightFromDistance</code>ï¼Œè®©ä½ åœ¨è¿œå¤„æˆ˜æ–—ã€‚åªæœ‰<code>Ranger</code>å¯ä»¥ä½¿ç”¨<code>FightFromDistance</code>ã€‚ä¸‹é¢æ˜¯å®ƒçš„æ ·å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Monster</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Wizard</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Ranger</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">FightClose</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_sword</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your sword. Your opponent now has {} health left."</span><span class="token punctuation">,</span>
            opponent<span class="token punctuation">.</span>health
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_hand</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your hand. Your opponent now has {} health left."</span><span class="token punctuation">,</span>
            opponent<span class="token punctuation">.</span>health
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightClose</span> <span class="token keyword">for</span> <span class="token class-name">Wizard</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightClose</span> <span class="token keyword">for</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">FightFromDistance</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_bow</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> distance <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">{</span>
            opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span>
                <span class="token string">"You attack with your bow. Your opponent now has {} health left."</span><span class="token punctuation">,</span>
                opponent<span class="token punctuation">.</span>health
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_rock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> distance <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">{</span>
            opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your rock. Your opponent now has {} health left."</span><span class="token punctuation">,</span>
            opponent<span class="token punctuation">.</span>health
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightFromDistance</span> <span class="token keyword">for</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> radagast <span class="token operator">=</span> <span class="token class-name">Wizard</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> aragorn <span class="token operator">=</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> uruk_hai <span class="token operator">=</span> <span class="token class-name">Monster</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">40</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    radagast<span class="token punctuation">.</span><span class="token function">attack_with_sword</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">)</span><span class="token punctuation">;</span>
    aragorn<span class="token punctuation">.</span><span class="token function">attack_with_bow</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You attack with your sword. Your opponent now has 30 health left.
You attack with your bow. Your opponent now has 20 health left.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬åœ¨traité‡Œé¢ä¸€ç›´ä¼ é€’<code>self</code>ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨ä¸èƒ½ç”¨å®ƒåšä»€ä¹ˆã€‚é‚£æ˜¯å› ä¸º Rust ä¸çŸ¥é“ä»€ä¹ˆç±»å‹ä¼šä½¿ç”¨å®ƒã€‚å®ƒå¯èƒ½æ˜¯ä¸€ä¸ª <code>Wizard</code>ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ª <code>Ranger</code>ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå«åš <code>Toefocfgetobjtnode</code> çš„æ–°ç»“æ„ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚ä¸ºäº†è®©<code>self</code>å…·æœ‰ä¸€å®šçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨traitä¸­æ·»åŠ å¿…è¦çš„traitã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç”¨<code>{:?}</code>æ‰“å°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦<code>Debug</code>ã€‚ä½ åªè¦æŠŠå®ƒå†™åœ¨<code>:</code>(å†’å·)åé¢ï¼Œå°±å¯ä»¥æŠŠå®ƒæ·»åŠ åˆ°traitä¸­ã€‚ç°åœ¨æˆ‘ä»¬çš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Monster</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token comment">// Now Wizard has Debug</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Wizard</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token comment">// Now Wizard has health</span>
<span class="token punctuation">}</span>
<span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token comment">// So does Ranger</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Ranger</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token comment">// So does Ranger</span>
<span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">FightClose</span><span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span> <span class="token punctuation">{</span> <span class="token comment">// Now a type needs Debug to use FightClose</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_sword</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your sword. Your opponent now has {} health left. You are now at: {:?}"</span><span class="token punctuation">,</span> <span class="token comment">// We can now print self with {:?} because we have Debug</span>
            opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">self</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_hand</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your hand. Your opponent now has {} health left.  You are now at: {:?}"</span><span class="token punctuation">,</span>
            opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">self</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightClose</span> <span class="token keyword">for</span> <span class="token class-name">Wizard</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightClose</span> <span class="token keyword">for</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">FightFromDistance</span><span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span> <span class="token punctuation">{</span> <span class="token comment">// We could also do trait FightFromDistance: FightClose because FightClose needs Debug</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_bow</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> distance <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">{</span>
            opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span>
                <span class="token string">"You attack with your bow. Your opponent now has {} health left.  You are now at: {:?}"</span><span class="token punctuation">,</span>
                opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> <span class="token keyword">self</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">attack_with_rock</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> distance <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">{</span>
            opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your rock. Your opponent now has {} health left.  You are now at: {:?}"</span><span class="token punctuation">,</span>
            opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> <span class="token keyword">self</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightFromDistance</span> <span class="token keyword">for</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> radagast <span class="token operator">=</span> <span class="token class-name">Wizard</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">60</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> aragorn <span class="token operator">=</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">80</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> uruk_hai <span class="token operator">=</span> <span class="token class-name">Monster</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">40</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    radagast<span class="token punctuation">.</span><span class="token function">attack_with_sword</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">)</span><span class="token punctuation">;</span>
    aragorn<span class="token punctuation">.</span><span class="token function">attack_with_bow</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You attack with your sword. Your opponent now has 30 health left. You are now at: Wizard { health: 60 }
You attack with your bow. Your opponent now has 20 health left.  You are now at: Ranger { health: 80 }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>åœ¨çœŸå®çš„æ¸¸æˆä¸­ï¼Œå¯èƒ½æœ€å¥½ä¸ºæ¯ä¸ªç±»å‹é‡å†™è¿™ä¸ªï¼Œå› ä¸º<code>You are now at: Wizard { health: 60 }</code>çœ‹èµ·æ¥æœ‰ç‚¹å¯ç¬‘ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆtraité‡Œé¢çš„æ–¹æ³•é€šå¸¸å¾ˆç®€å•ï¼Œå› ä¸ºä½ ä¸çŸ¥é“ä»€ä¹ˆç±»å‹ä¼šä½¿ç”¨å®ƒã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½å†™å‡º <code>self.0 += 10</code> è¿™æ ·çš„ä¸œè¥¿ã€‚ä½†æ˜¯è¿™ä¸ªä¾‹å­è¡¨æ˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬æ­£åœ¨å†™çš„traité‡Œé¢ä½¿ç”¨å…¶ä»–çš„traitã€‚å½“æˆ‘ä»¬è¿™æ ·åšçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€äº›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ã€‚</p>
<p>å¦å¤–ä¸€ç§ä½¿ç”¨traitçš„æ–¹å¼æ˜¯ä½¿ç”¨æ‰€è°“çš„<code>trait bounds</code>ã€‚æ„æ€æ˜¯ â€œé€šè¿‡ä¸€ä¸ªtraitè¿›è¡Œé™åˆ¶â€ã€‚traité™åˆ¶å¾ˆç®€å•ï¼Œå› ä¸ºä¸€ä¸ªtraitå®é™…ä¸Šä¸éœ€è¦ä»»ä½•æ–¹æ³•ï¼Œæˆ–è€…è¯´æ ¹æœ¬ä¸éœ€è¦ä»»ä½•ä¸œè¥¿ã€‚è®©æˆ‘ä»¬ç”¨ç±»ä¼¼ä½†ä¸åŒçš„ä¸œè¥¿é‡å†™æˆ‘ä»¬çš„ä»£ç ã€‚è¿™æ¬¡æˆ‘ä»¬çš„traitæ²¡æœ‰ä»»ä½•æ–¹æ³•ï¼Œä½†æˆ‘ä»¬æœ‰å…¶ä»–éœ€è¦traitä½¿ç”¨çš„å‡½æ•°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Debug</span><span class="token punctuation">;</span>  <span class="token comment">// So we don't have to write std::fmt::Debug every time now</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Monster</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Wizard</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Ranger</span> <span class="token punctuation">{</span>
    health<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">trait</span> <span class="token class-name">Magic</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// No methods for any of these traits. They are just trait bounds</span>
<span class="token keyword">trait</span> <span class="token class-name">FightClose</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">trait</span> <span class="token class-name">FightFromDistance</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">FightClose</span> <span class="token keyword">for</span> <span class="token class-name">Ranger</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Each type gets FightClose,</span>
<span class="token keyword">impl</span> <span class="token class-name">FightClose</span> <span class="token keyword">for</span> <span class="token class-name">Wizard</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">FightFromDistance</span> <span class="token keyword">for</span> <span class="token class-name">Ranger</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// but only Ranger gets FightFromDistance</span>
<span class="token keyword">impl</span> <span class="token class-name">Magic</span> <span class="token keyword">for</span> <span class="token class-name">Wizard</span><span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">// and only Wizard gets Magic</span>

<span class="token keyword">fn</span> <span class="token function-definition function">attack_with_bow</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">FightFromDistance</span> <span class="token operator">+</span> <span class="token class-name">Debug</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>character<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">T</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> distance <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">{</span>
        opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"You attack with your bow. Your opponent now has {} health left.  You are now at: {:?}"</span><span class="token punctuation">,</span>
            opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> character
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">attack_with_sword</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">FightClose</span> <span class="token operator">+</span> <span class="token class-name">Debug</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>character<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">T</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"You attack with your sword. Your opponent now has {} health left. You are now at: {:?}"</span><span class="token punctuation">,</span>
        opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> character
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">fireball</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Magic</span> <span class="token operator">+</span> <span class="token class-name">Debug</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>character<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">T</span><span class="token punctuation">,</span> opponent<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Monster</span><span class="token punctuation">,</span> distance<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> distance <span class="token operator">&lt;</span> <span class="token number">15</span> <span class="token punctuation">{</span>
        opponent<span class="token punctuation">.</span>health <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You raise your hands and cast a fireball! Your opponent now has {} health left. You are now at: {:?}"</span><span class="token punctuation">,</span>
    opponent<span class="token punctuation">.</span>health<span class="token punctuation">,</span> character<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> radagast <span class="token operator">=</span> <span class="token class-name">Wizard</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">60</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> aragorn <span class="token operator">=</span> <span class="token class-name">Ranger</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">80</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> uruk_hai <span class="token operator">=</span> <span class="token class-name">Monster</span> <span class="token punctuation">{</span> health<span class="token punctuation">:</span> <span class="token number">40</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">attack_with_sword</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>radagast<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">attack_with_bow</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>aragorn<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fireball</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>radagast<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> uruk_hai<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°å‡ºæ¥çš„ä¸œè¥¿å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You attack with your sword. Your opponent now has 30 health left. You are now at: Wizard { health: 60 }
You attack with your bow. Your opponent now has 20 health left.  You are now at: Ranger { health: 80 }
You raise your hands and cast a fireball! Your opponent now has 0 health left. You are now at: Wizard { health: 60 }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ï¼Œå½“ä½ ä½¿ç”¨traitsæ—¶ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåŒæ ·çš„äº‹æƒ…ã€‚è¿™ä¸€åˆ‡éƒ½å–å†³äºä»€ä¹ˆå¯¹ä½ æ­£åœ¨ç¼–å†™çš„ç¨‹åºæœ€æœ‰æ„ä¹‰ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°ä¸€äº›åœ¨Rustä¸­ä½¿ç”¨çš„ä¸»è¦traitã€‚</p>
<h3 id="From-trait"><a href="#From-trait" class="headerlink" title="From trait"></a>From trait</h3><p><em>From</em>æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„traitï¼Œä½ çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå› ä¸ºä½ å·²ç»çœ‹åˆ°äº†å¾ˆå¤šã€‚ä½¿ç”¨<em>From</em>ï¼Œä½ å¯ä»¥ä»ä¸€ä¸ª<code>&amp;str</code>åˆ›å»ºä¸€ä¸ª<code>String</code>ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨è®¸å¤šå…¶ä»–ç±»å‹åˆ›å»ºå¤šç§ç±»å‹ã€‚ä¾‹å¦‚ï¼ŒVecä½¿ç”¨<em>From</em>æ¥åˆ›å»ºä»¥ä¸‹ç±»å‹:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">From&lt;&amp;'_ [T]&gt;
From&lt;&amp;'_ mut [T]&gt;
From&lt;&amp;'_ str&gt;
From&lt;&amp;'a Vec&lt;T&gt;&gt;
From&lt;[T; N]&gt;
From&lt;BinaryHeap&lt;T&gt;&gt;
From&lt;Box&lt;[T]&gt;&gt;
From&lt;CString&gt;
From&lt;Cow&lt;'a, [T]&gt;&gt;
From&lt;String&gt;
From&lt;Vec&lt;NonZeroU8&gt;&gt;
From&lt;Vec&lt;T&gt;&gt;
From&lt;VecDeque&lt;T&gt;&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œæœ‰å¾ˆå¤š<code>Vec::from()</code>æˆ‘ä»¬è¿˜æ²¡æœ‰ç”¨è¿‡ã€‚æˆ‘ä»¬æ¥åšå‡ ä¸ªï¼Œçœ‹çœ‹ä¼šæ€ä¹ˆæ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span> <span class="token comment">// We will make a generic function to print them so we want Display</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_vec</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Take any Vec&lt;T&gt; if type T has Display</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> input <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> array_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Try from an array</span>
    <span class="token function">print_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>array_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> str_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"What kind of vec will I be?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// An array from a &amp;str? This will be interesting</span>
    <span class="token function">print_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>str_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> string_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"What kind of vec will a String be?"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Also from a String</span>
    <span class="token function">print_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>string_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°çš„å†…å®¹å¦‚ä¸‹ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">8 9 10
87 104 97 116 32 107 105 110 100 32 111 102 32 118 101 99 32 119 105 108 108 32 73 32 98 101 63
87 104 97 116 32 107 105 110 100 32 111 102 32 118 101 99 32 119 105 108 108 32 97 32 83 116 114 105 110 103 32 98 101 63<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä»ç±»å‹ä¸Šçœ‹ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‘é‡æ˜¯<code>Vec&lt;u8&gt;</code>ï¼Œä¹Ÿå°±æ˜¯<code>&amp;str</code>å’Œ<code>String</code>çš„å­—èŠ‚ã€‚æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°<code>From</code>æ˜¯éå¸¸çµæ´»çš„ï¼Œç”¨çš„ä¹Ÿå¾ˆå¤šã€‚æˆ‘ä»¬ç”¨è‡ªå·±çš„ç±»å‹æ¥è¯•è¯•ã€‚</p>
<p>æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªç»“æ„ä½“ï¼Œç„¶åä¸ºå…¶ä¸­ä¸€ä¸ªç»“æ„ä½“å®ç°<code>From</code>ã€‚ä¸€ä¸ªç»“æ„ä½“å°†æ˜¯<code>City</code>ï¼Œå¦ä¸€ä¸ªç»“æ„ä½“å°†æ˜¯<code>Country</code>ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåšåˆ°è¿™ä¸€ç‚¹ã€‚<code>let country_name = Country::from(vector_of_cities)</code>.</p>
<p>å®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token comment">// So we can print City</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span> <span class="token comment">// just a new function</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            population<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token comment">// Country also needs to be printed</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Country</span> <span class="token punctuation">{</span>
    cities<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">City</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// Our cities go in here</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">From</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">City</span><span class="token operator">&gt;&gt;</span> <span class="token keyword">for</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span> <span class="token comment">// Note: we don't have to write From&lt;City&gt;, we can also do</span>
                                   <span class="token comment">// From&lt;Vec&lt;City&gt;&gt;. So we can also implement on a type that</span>
                                   <span class="token comment">// we didn't create</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">from</span><span class="token punctuation">(</span>cities<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">City</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span> cities <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">print_cities</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// function to print the cities in Country</span>
        <span class="token keyword">for</span> city <span class="token keyword">in</span> <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>cities <span class="token punctuation">{</span>
            <span class="token comment">// &amp; because Vec&lt;City&gt; isn't Copy</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?} has a population of {:?}."</span><span class="token punctuation">,</span> city<span class="token punctuation">.</span>name<span class="token punctuation">,</span> city<span class="token punctuation">.</span>population<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> helsinki <span class="token operator">=</span> <span class="token class-name">City</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Helsinki"</span><span class="token punctuation">,</span> <span class="token number">631_695</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> turku <span class="token operator">=</span> <span class="token class-name">City</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Turku"</span><span class="token punctuation">,</span> <span class="token number">186_756</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> finland_cities <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>helsinki<span class="token punctuation">,</span> turku<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// This is the Vec&lt;City&gt;</span>
    <span class="token keyword">let</span> finland <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>finland_cities<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// So now we can use From</span>

    finland<span class="token punctuation">.</span><span class="token function">print_cities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">"Helsinki" has a population of 631695.
"Turku" has a population of 186756.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œ<code>From</code>å¾ˆå®¹æ˜“ä»ä½ æ²¡æœ‰åˆ›å»ºçš„ç±»å‹ä¸­å®ç°ï¼Œæ¯”å¦‚<code>Vec</code>ã€<code>i32</code>ç­‰ç­‰ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæœ‰ä¸¤ä¸ªå‘é‡çš„å‘é‡ã€‚ç¬¬ä¸€ä¸ªå‘é‡å­˜æ”¾å¶æ•°ï¼Œç¬¬äºŒä¸ªå‘é‡å­˜æ”¾å¥‡æ•°ã€‚å¯¹äº<code>From</code>ï¼Œä½ å¯ä»¥ç»™å®ƒä¸€ä¸ª<code>i32</code>çš„å‘é‡ï¼Œå®ƒä¼šæŠŠå®ƒå˜æˆ<code>Vec&lt;Vec&lt;i32&gt;&gt;</code>:ä¸€ä¸ªå®¹çº³<code>i32</code>çš„å‘é‡ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">From</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">EvenOddVec</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">From</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span> <span class="token keyword">for</span> <span class="token class-name">EvenOddVec</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">from</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> even_odd_vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span> <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// A vec with two empty vecs inside</span>
                                                                    <span class="token comment">// This is the return value but first we must fill it</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> input <span class="token punctuation">{</span>
            <span class="token keyword">if</span> item <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                even_odd_vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                even_odd_vec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">Self</span><span class="token punctuation">(</span>even_odd_vec<span class="token punctuation">)</span> <span class="token comment">// Now it is done so we return it as Self (Self = EvenOddVec)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> bunch_of_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">,</span> <span class="token number">9787</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token class-name">EvenOddVec</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>bunch_of_numbers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Even numbers: {:?}\nOdd numbers: {:?}"</span><span class="token punctuation">,</span> new_vec<span class="token number">.0</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> new_vec<span class="token number">.0</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Even numbers: [8, 222, 0, 8]
Odd numbers: [7, -1, 3, 9787, -47, 77, 55, 7]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>åƒ <code>EvenOddVec</code> è¿™æ ·çš„ç±»å‹å¯èƒ½æœ€å¥½æ˜¯é€šç”¨ <code>T</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è®¸å¤šæ•°å­—ç±»å‹ã€‚å¦‚æœä½ æƒ³ç»ƒä¹ çš„è¯ï¼Œä½ å¯ä»¥è¯•ç€æŠŠè¿™ä¸ªä¾‹å­åšæˆé€šç”¨çš„ã€‚</p>
<h3 id="åœ¨å‡½æ•°ä¸­ä½¿ç”¨å­—ç¬¦ä¸²å’Œ-amp-str"><a href="#åœ¨å‡½æ•°ä¸­ä½¿ç”¨å­—ç¬¦ä¸²å’Œ-amp-str" class="headerlink" title="åœ¨å‡½æ•°ä¸­ä½¿ç”¨å­—ç¬¦ä¸²å’Œ&amp;str"></a>åœ¨å‡½æ•°ä¸­ä½¿ç”¨å­—ç¬¦ä¸²å’Œ&amp;str</h3><p>æœ‰æ—¶ä½ æƒ³è®©ä¸€ä¸ªå‡½æ•°å¯ä»¥åŒæ—¶æ¥å— <code>String</code> å’Œ <code>&amp;str</code>ã€‚ä½ å¯ä»¥é€šè¿‡æ³›å‹å’Œ <code>AsRef</code> ç‰¹æ€§æ¥å®ç°è¿™ä¸€ç‚¹ã€‚<code>AsRef</code> ç”¨äºä»ä¸€ä¸ªç±»å‹å‘å¦ä¸€ä¸ªç±»å‹æä¾›å¼•ç”¨ã€‚å¦‚æœä½ çœ‹çœ‹ <code>String</code> çš„æ–‡æ¡£ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒå¯¹è®¸å¤šç±»å‹éƒ½æœ‰ <code>AsRef</code>ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/string/struct.String.html">https://doc.rust-lang.org/std/string/struct.String.html</a></p>
<p>ä¸‹é¢æ˜¯å®ƒä»¬çš„ä¸€äº›å‡½æ•°ç­¾åã€‚</p>
<p><code>AsRef&lt;str&gt;</code>:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">impl</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token keyword">str</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">String</span>

<span class="token keyword">fn</span> <span class="token function-definition function">as_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>AsRef&lt;[u8]&gt;</code>:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">impl</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">String</span>

<span class="token keyword">fn</span> <span class="token function-definition function">as_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>AsRef&lt;OsStr&gt;</code>:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">impl</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token class-name">OsStr</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">String</span>

<span class="token keyword">fn</span> <span class="token function-definition function">as_ref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token class-name">OsStr</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒéœ€è¦<code>&amp;self</code>ï¼Œå¹¶ç»™å‡ºå¦ä¸€ä¸ªç±»å‹çš„å¼•ç”¨ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªé€šç”¨ç±»å‹Tï¼Œä½ å¯ä»¥è¯´å®ƒéœ€è¦<code>AsRef&lt;str&gt;</code>ã€‚å¦‚æœä½ è¿™æ ·åšï¼Œå®ƒå°†èƒ½å¤Ÿä½¿ç”¨ä¸€ä¸ª<code>&amp;str</code>å’Œä¸€ä¸ª<code>String</code>ã€‚</p>
<p>æˆ‘ä»¬å…ˆè¯´è¯´æ³›å‹å‡½æ•°ã€‚è¿™ä¸ªè¿˜ä¸èƒ½ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">print_it</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token string">"Please print me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Rustè¯´<code>error[E0277]: T doesn't implement std::fmt::Display</code>ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šè¦æ±‚Tå®ç°Displayã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_it</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token string">"Please print me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å¯ä»¥ç”¨äº†ï¼Œæ‰“å°å‡º<code>Please print me</code>ã€‚è¿™æ˜¯å¥½çš„ï¼Œä½†Tä»ç„¶å¯ä»¥æ˜¯å¤šç§ç±»å‹ã€‚<br>å¯ä»¥æ˜¯<code>i8</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>f32</code>ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•å®ç°äº†<code>Display</code>çš„ç±»å‹ã€‚æˆ‘ä»¬åŠ ä¸Š<code>AsRef&lt;str&gt;</code>ï¼Œç°åœ¨Téœ€è¦<code>AsRef&lt;str&gt;</code>å’Œ<code>Display</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_it</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token keyword">str</span><span class="token operator">&gt;</span> <span class="token operator">+</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token string">"Please print me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token string">"Also, please print me"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// print_it(7); &lt;- This will not print</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œå®ƒä¸ä¼šæ¥å—<code>i8</code>è¿™æ ·çš„ç±»å‹ã€‚</p>
<p>ä¸è¦å¿˜äº†ï¼Œå½“å‡½æ•°å˜é•¿æ—¶ï¼Œä½ å¯ä»¥ç”¨<code>where</code>æ¥å†™ä¸åŒçš„å‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬åŠ ä¸ŠDebugï¼Œé‚£ä¹ˆå°±ä¼šå˜æˆ<code>fn print_it&lt;T: AsRef&lt;str&gt; + Display + Debug&gt;(input: T)</code>ï¼Œè¿™ä¸€è¡Œå°±å¾ˆé•¿äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Debug</span><span class="token punctuation">,</span> <span class="token class-name">Display</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// add Debug</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_it</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token comment">// Now this line is easy to read</span>
<span class="token keyword">where</span>
    <span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token keyword">str</span><span class="token operator">&gt;</span> <span class="token operator">+</span> <span class="token class-name">Debug</span> <span class="token operator">+</span> <span class="token class-name">Display</span><span class="token punctuation">,</span> <span class="token comment">// and these traits are easy to read</span>
<span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token string">"Please print me"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token string">"Also, please print me"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="é“¾å¼æ–¹æ³•"><a href="#é“¾å¼æ–¹æ³•" class="headerlink" title="é“¾å¼æ–¹æ³•"></a>é“¾å¼æ–¹æ³•</h2><p>Rustæ˜¯ä¸€ç§ç³»ç»Ÿç¼–ç¨‹è¯­è¨€ï¼Œå°±åƒCå’ŒC++ä¸€æ ·ï¼Œå®ƒçš„ä»£ç å¯ä»¥å†™æˆç‹¬ç«‹çš„å‘½ä»¤ï¼Œå•ç‹¬æˆè¡Œï¼Œä½†å®ƒä¹Ÿæœ‰å‡½æ•°å¼é£æ ¼ã€‚ä¸¤ç§é£æ ¼éƒ½å¯ä»¥ï¼Œä½†å‡½æ•°å¼é€šå¸¸æ¯”è¾ƒçŸ­ã€‚ä¸‹é¢ä»¥éå‡½æ•°å¼(ç§°ä¸º â€œå‘½ä»¤å¼â€)ä¸ºä¾‹ï¼Œè®©<code>Vec</code>ä»1åˆ°10ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> new_vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> counter <span class="token operator">&lt;</span> <span class="token number">11</span> <span class="token punctuation">{</span>
        new_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°<code>[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</code>ã€‚</p>
<p>è€Œè¿™é‡Œæ˜¯å‡½æ•°å¼é£æ ¼çš„ä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">..=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Or you can write it like this:</span>
    <span class="token comment">// let new_vec: Vec&lt;i32&gt; = (1..=10).collect();</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>.collect()</code>å¯ä»¥ä¸ºå¾ˆå¤šç±»å‹åšé›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å‘Šè¯‰å®ƒç±»å‹ã€‚</p>
<p>ç”¨å‡½æ•°å¼å¯ä»¥é“¾æ¥æ–¹æ³•ã€‚â€é“¾æ¥æ–¹æ³•â€çš„æ„æ€æ˜¯æŠŠå¾ˆå¤šæ–¹æ³•æ”¾åœ¨ä¸€ä¸ªè¯­å¥ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¾ˆå¤šæ–¹æ³•é“¾åœ¨ä¸€èµ·çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±åˆ›å»ºäº†ä¸€ä¸ª<code>[3, 4, 5, 6]</code>çš„Vecã€‚è¿™ä¸€è¡Œçš„ä¿¡æ¯é‡å¾ˆå¤§ï¼Œæ‰€ä»¥æŠŠæ¯ä¸ªæ–¹æ³•æ”¾åœ¨æ–°çš„ä¸€è¡Œä¸Šä¼šæœ‰å¸®åŠ©ã€‚è®©æˆ‘ä»¬è¿™æ ·åšï¼Œä»¥ä½¿å…¶æ›´å®¹æ˜“é˜…è¯»ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> my_vec
        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// "iterate" over the items (iterate = work with each item inside it). into_iter() gives us owned values, not references</span>
        <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// skip over three items: 0, 1, and 2</span>
        <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// take the next four: 3, 4, 5, and 6</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// put them in a new Vec&lt;i32&gt;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ äº†è§£é—­åŒ…å’Œè¿­ä»£å™¨æ—¶ï¼Œä½ å¯ä»¥æœ€å¥½åœ°ä½¿ç”¨è¿™ç§å‡½æ•°å¼ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥å°†å­¦ä¹ å®ƒä»¬ã€‚</p>
<h2 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h2><p>è¿­ä»£å™¨æ˜¯ä¸€ä¸ªæ„é€ ï¼Œå®ƒå¯ä»¥ç»™ä½ é›†åˆä¸­çš„å…ƒç´ ï¼Œä¸€æ¬¡ä¸€ä¸ªã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å¾ˆå¤šè¿­ä»£å™¨:<code>for</code>å¾ªç¯ç»™ä½ ä¸€ä¸ªè¿­ä»£å™¨ã€‚å½“ä½ æƒ³åœ¨å…¶ä»–æ—¶å€™ä½¿ç”¨è¿­ä»£å™¨æ—¶ï¼Œä½ å¿…é¡»é€‰æ‹©ä»€ä¹ˆæ ·çš„è¿­ä»£å™¨:</p>
<ul>
<li><code>.iter()</code> å¼•ç”¨çš„è¿­ä»£å™¨</li>
<li><code>.iter_mut()</code> å¯å˜å¼•ç”¨çš„è¿­ä»£å™¨</li>
<li><code>.into_iter()</code> å€¼çš„è¿­ä»£å™¨(ä¸æ˜¯å¼•ç”¨)</li>
</ul>
<p><code>for</code>å¾ªç¯å…¶å®åªæ˜¯ä¸€ä¸ªä½¿ç”¨<code>.iter_mut()</code>çš„è¿­ä»£å™¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™å¯ä»¥æ”¹å˜å€¼çš„åŸå› ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨è¿­ä»£å™¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> vector1 <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// we will use .iter() and .into_iter() on this one</span>
    <span class="token keyword">let</span> vector1_a <span class="token operator">=</span> vector1<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> vector1_b <span class="token operator">=</span> vector1<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> vector2 <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// we will use .iter_mut() on this one</span>
    vector2<span class="token punctuation">.</span><span class="token function">iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>x <span class="token operator">+=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> vector1_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> vector2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> vector1_b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[2, 3, 4]
[110, 120, 130]
[10, 20, 30]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å‰ä¸¤ä¸ªæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªå«<code>.map()</code>çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥è®©ä½ å¯¹æ¯ä¸€ä¸ªå…ƒç´ åšä¸€äº›äº‹æƒ…ï¼Œç„¶åæŠŠå®ƒä¼ é€’ä¸‹å»ã€‚æœ€åæˆ‘ä»¬ç”¨çš„æ˜¯ä¸€ä¸ªå«<code>.for_each()</code>çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•åªæ˜¯è®©ä½ å¯¹æ¯ä¸€ä¸ªå…ƒç´ åšä¸€äº›äº‹æƒ…ã€‚<code>.iter_mut()</code>åŠ ä¸Š<code>for_each()</code>åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ª<code>for</code>çš„å¾ªç¯ã€‚åœ¨æ¯ä¸€ä¸ªæ–¹æ³•é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸€ä¸ªå…ƒç´ èµ·ä¸€ä¸ªåå­—(æˆ‘ä»¬åˆšæ‰å«å®ƒ <code>x</code>)ï¼Œç„¶åç”¨å®ƒæ¥æ”¹å˜å®ƒã€‚è¿™äº›è¢«ç§°ä¸ºé—­åŒ…ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚å­¦ä¹ å®ƒä»¬ã€‚</p>
<p>è®©æˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒä»¬ï¼Œä¸€æ¬¡ä¸€ä¸ªã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ç”¨<code>.iter()</code>å¯¹<code>vector1</code>è¿›è¡Œå¼•ç”¨ã€‚æˆ‘ä»¬ç»™æ¯ä¸ªå…ƒç´ éƒ½åŠ äº†1ï¼Œå¹¶ä½¿å…¶æˆä¸ºä¸€ä¸ªæ–°çš„Vecã€‚<code>vector1</code>è¿˜æ´»ç€ï¼Œå› ä¸ºæˆ‘ä»¬åªç”¨äº†å¼•ç”¨:æˆ‘ä»¬æ²¡æœ‰æŒ‰å€¼å–ã€‚ç°åœ¨æˆ‘ä»¬æœ‰ <code>vector1</code>ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–°çš„ Vec å« <code>vector1_a</code>ã€‚å› ä¸º<code>.map()</code>åªæ˜¯ä¼ é€’äº†å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>.collect()</code>æŠŠå®ƒå˜æˆä¸€ä¸ª<code>Vec</code>ã€‚</p>
<p>ç„¶åæˆ‘ä»¬ç”¨<code>into_iter</code>ä»<code>vector1</code>ä¸­æŒ‰å€¼å¾—åˆ°ä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿™æ ·å°±ç ´åäº†<code>vector1</code>ï¼Œå› ä¸ºè¿™å°±æ˜¯<code>into_iter()</code>çš„ä½œç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬åšäº†<code>vector1_b</code>ä¹‹åï¼Œå°±ä¸èƒ½å†ä½¿ç”¨<code>vector1</code>äº†ã€‚</p>
<p>æœ€åæˆ‘ä»¬åœ¨<code>vector2</code>ä¸Šä½¿ç”¨<code>.iter_mut()</code>ã€‚å®ƒæ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨<code>.collect()</code>æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„Vecã€‚ç›¸åï¼Œæˆ‘ä»¬ç”¨å¯å˜å¼•ç”¨æ”¹å˜åŒä¸€Vecä¸­çš„å€¼ã€‚æ‰€ä»¥<code>vector2</code>ä»ç„¶å­˜åœ¨ã€‚å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦ä¸€ä¸ªæ–°çš„Vecï¼Œæˆ‘ä»¬ä½¿ç”¨<code>for_each</code>:å®ƒå°±åƒä¸€ä¸ª<code>for</code>å¾ªç¯ã€‚</p>
<h3 id="è¿­ä»£å™¨å¦‚ä½•å·¥ä½œ"><a href="#è¿­ä»£å™¨å¦‚ä½•å·¥ä½œ" class="headerlink" title="è¿­ä»£å™¨å¦‚ä½•å·¥ä½œ"></a>è¿­ä»£å™¨å¦‚ä½•å·¥ä½œ</h3><p>è¿­ä»£å™¨çš„å·¥ä½œåŸç†æ˜¯ä½¿ç”¨ä¸€ä¸ªå«åš <code>.next()</code> çš„æ–¹æ³•ï¼Œå®ƒç»™å‡ºä¸€ä¸ª <code>Option</code>ã€‚å½“ä½ ä½¿ç”¨è¿­ä»£å™¨æ—¶ï¼ŒRustä¼šä¸€éåˆä¸€éåœ°è°ƒç”¨<code>next()</code>ã€‚å¦‚æœå¾—åˆ° <code>Some</code>ï¼Œå®ƒå°±ä¼šç»§ç»­å‰è¿›ã€‚å¦‚æœå¾—åˆ° <code>None</code>ï¼Œå®ƒå°±åœæ­¢ã€‚</p>
<p>ä½ è¿˜è®°å¾— <code>assert_eq!</code> å®å—ï¼Ÿåœ¨æ–‡æ¡£ä¸­ï¼Œä½ ç»å¸¸çœ‹åˆ°å®ƒã€‚è¿™é‡Œå®ƒå±•ç¤ºäº†è¿­ä»£å™¨çš„å·¥ä½œåŸç†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token char string">'a'</span><span class="token punctuation">,</span> <span class="token char string">'b'</span><span class="token punctuation">,</span> <span class="token char string">'ê±°'</span><span class="token punctuation">,</span> <span class="token char string">'æŸ³'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Just a regular Vec</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec_iter <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is an Iterator type now, but we haven't called it yet</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_vec_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Call the first item with .next()</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_vec_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token char string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Call the next</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_vec_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token char string">'ê±°'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Again</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_vec_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token char string">'æŸ³'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Again</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_vec_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Nothing is left: just None</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>my_vec_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// You can keep calling .next() but it will always be None</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸ºè‡ªå·±çš„structæˆ–enumå®ç°<code>Iterator</code>å¹¶ä¸éš¾ã€‚é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä¹¦åº“ï¼Œæƒ³ä¸€æƒ³ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token comment">// we want to print it with {:?}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Library</span> <span class="token punctuation">{</span>
    library_type<span class="token punctuation">:</span> <span class="token class-name">LibraryType</span><span class="token punctuation">,</span> <span class="token comment">// this is our enum</span>
    books<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// list of books</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">LibraryType</span> <span class="token punctuation">{</span> <span class="token comment">// libraries can be city libraries or country libraries</span>
    <span class="token class-name">City</span><span class="token punctuation">,</span>
    <span class="token class-name">Country</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Library</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">add_book</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> book<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// we use add_book to add new books</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>books<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we take a &amp;str and turn it into a String, then add it to the Vec</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span> <span class="token comment">// this creates a new Library</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            library_type<span class="token punctuation">:</span> <span class="token class-name">LibraryType</span><span class="token punctuation">::</span><span class="token class-name">City</span><span class="token punctuation">,</span> <span class="token comment">// most are in the city so we'll choose City</span>
                                             <span class="token comment">// most of the time</span>
            books<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_library <span class="token operator">=</span> <span class="token class-name">Library</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// make a new library</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"The Doom of the Darksword"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add some books</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"Demian - die Geschichte einer Jugend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"êµ¬ìš´ëª½"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"å¾è¼©ã¯çŒ«ã§ã‚ã‚‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_library<span class="token punctuation">.</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we can print our list of books</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å¾ˆå¥½ç”¨ã€‚ç°åœ¨æˆ‘ä»¬æƒ³ä¸ºåº“å®ç°<code>Iterator</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨<code>for</code>å¾ªç¯ä¸­ä½¿ç”¨å®ƒã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬å°è¯• <code>for</code> å¾ªç¯ï¼Œå®ƒå°±æ— æ³•å·¥ä½œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">for</span> item <span class="token keyword">in</span> my_library <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å®ƒè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: `Library` is not an iterator
  --&gt; src\main.rs:47:16
   |
47 |    for item in my_library {
   |                ^^^^^^^^^^ `Library` is not an iterator
   |
   = help: the trait `std::iter::Iterator` is not implemented for `Library`
   = note: required by `std::iter::IntoIterator::into_iter`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨<code>impl Iterator for Library</code>æŠŠåº“åšæˆè¿­ä»£å™¨ã€‚<code>Iterator</code>traitçš„ä¿¡æ¯åœ¨æ ‡å‡†åº“ä¸­ã€‚<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/iter/trait.Iterator.html">https://doc.rust-lang.org/std/iter/trait.Iterator.html</a></p>
<p>åœ¨é¡µé¢çš„å·¦ä¸Šæ–¹å†™ç€:<code>Associated Types: Item</code>å’Œ<code>Required Methods: next</code>ã€‚â€å…³è”ç±»å‹â€çš„æ„æ€æ˜¯ â€œä¸€èµ·ä½¿ç”¨çš„ç±»å‹â€ã€‚æˆ‘ä»¬çš„å…³è”ç±»å‹å°†æ˜¯<code>String</code>ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›è¿­ä»£å™¨ç»™æˆ‘ä»¬æä¾›Stringã€‚</p>
<p>åœ¨é¡µé¢ä¸­ï¼Œå®ƒæœ‰ä¸€ä¸ªçœ‹èµ·æ¥åƒè¿™æ ·çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// an iterator which alternates between Some and None</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Alternate</span> <span class="token punctuation">{</span>
    state<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Iterator</span> <span class="token keyword">for</span> <span class="token class-name">Alternate</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Item</span> <span class="token operator">=</span> <span class="token keyword">i32</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">next</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>state <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token comment">// if it's even, Some(i32), else None</span>
        <span class="token keyword">if</span> val <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token class-name">Some</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">None</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°<code>impl Iterator for Alternate</code>ä¸‹é¢å†™ç€<code>type Item = i32</code>ã€‚è¿™å°±æ˜¯å…³è”ç±»å‹ã€‚æˆ‘ä»¬çš„è¿­ä»£å™¨å°†é’ˆå¯¹æˆ‘ä»¬çš„ä¹¦ç±åˆ—è¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ª<code>Vec&lt;String&gt;</code>ã€‚å½“æˆ‘ä»¬è°ƒç”¨nextçš„æ—¶å€™ã€‚<br> å®ƒå°†ç»™æˆ‘ä»¬ä¸€ä¸ª<code>String</code>ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å†™<code>type Item = String;</code>ã€‚è¿™å°±æ˜¯å…³è”é¡¹ã€‚</p>
<p>ä¸ºäº†å®ç° <code>Iterator</code>ï¼Œä½ éœ€è¦å†™ <code>fn next()</code> å‡½æ•°ã€‚è¿™æ˜¯ä½ å†³å®šè¿­ä»£å™¨åº”è¯¥åšä»€ä¹ˆçš„åœ°æ–¹ã€‚å¯¹äºæˆ‘ä»¬çš„ <code>Library</code>ï¼Œæˆ‘ä»¬é¦–å…ˆå¸Œæœ›å®ƒç»™æˆ‘ä»¬æœ€åä¸€æœ¬ä¹¦ã€‚æ‰€ä»¥æˆ‘ä»¬å°†<code>match</code>ä¸<code>.pop()</code>ä¸€èµ·ï¼Œå¦‚æœæ˜¯<code>Some</code>çš„è¯ï¼Œå°±æŠŠæœ€åä¸€é¡¹å»æ‰ã€‚æˆ‘ä»¬è¿˜æƒ³ä¸ºæ¯ä¸ªå…ƒç´ æ‰“å° â€œis found!â€ã€‚ç°åœ¨å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug, Clone)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Library</span> <span class="token punctuation">{</span>
    library_type<span class="token punctuation">:</span> <span class="token class-name">LibraryType</span><span class="token punctuation">,</span>
    books<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug, Clone)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">LibraryType</span> <span class="token punctuation">{</span>
    <span class="token class-name">City</span><span class="token punctuation">,</span>
    <span class="token class-name">Country</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Library</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">add_book</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> book<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>books<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            library_type<span class="token punctuation">:</span> <span class="token class-name">LibraryType</span><span class="token punctuation">::</span><span class="token class-name">City</span><span class="token punctuation">,</span>
            <span class="token comment">// most of the time</span>
            books<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Iterator</span> <span class="token keyword">for</span> <span class="token class-name">Library</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Item</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">next</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token keyword">self</span><span class="token punctuation">.</span>books<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Some</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>book <span class="token operator">+</span> <span class="token string">" is found!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Rust allows String + &amp;str</span>
            <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_library <span class="token operator">=</span> <span class="token class-name">Library</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"The Doom of the Darksword"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"Demian - die Geschichte einer Jugend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"êµ¬ìš´ëª½"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_library<span class="token punctuation">.</span><span class="token function">add_book</span><span class="token punctuation">(</span><span class="token string">"å¾è¼©ã¯çŒ«ã§ã‚ã‚‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> my_library<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// we can use a for loop now. Give it a clone so Library won't be destroyed</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">å¾è¼©ã¯çŒ«ã§ã‚ã‚‹ is found!
êµ¬ìš´ëª½ is found!
Demian - die Geschichte einer Jugend is found!
The Doom of the Darksword is found!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h2><p>é—­åŒ…å°±åƒå¿«é€Ÿå‡½æ•°ï¼Œä¸éœ€è¦åå­—ã€‚æœ‰æ—¶å®ƒä»¬è¢«ç§°ä¸ºlambdaã€‚Closureså¾ˆå®¹æ˜“è¾¨è¯†ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨<code>||</code>è€Œä¸æ˜¯<code>()</code>ã€‚å®ƒä»¬åœ¨ Rust ä¸­éå¸¸å¸¸è§ï¼Œä¸€æ—¦ä½ å­¦ä¼šäº†ä½¿ç”¨å®ƒä»¬ï¼Œä½ å°±ä¼šçˆ±ä¸é‡Šæ‰‹ã€‚</p>
<p>ä½ å¯ä»¥å°†ä¸€ä¸ªé—­åŒ…ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸Šï¼Œç„¶åå½“ä½ ä½¿ç”¨å®ƒæ—¶ï¼Œå®ƒçœ‹èµ·æ¥å°±åƒä¸€ä¸ªå‡½æ•°ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This is a closure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™ä¸ªé—­åŒ…ä»€ä¹ˆéƒ½ä¸éœ€è¦:<code>||</code>ï¼Œå¹¶æ‰“å°ä¸€æ¡ä¿¡æ¯ã€‚<code>This is a closure</code>.</p>
<p>åœ¨<code>||</code>ä¹‹é—´æˆ‘ä»¬å¯ä»¥æ·»åŠ è¾“å…¥å˜é‡å’Œç±»å‹ï¼Œå°±åƒåœ¨<code>()</code>é‡Œé¢æ·»åŠ å‡½æ•°ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">5
10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å½“é—­åŒ…å˜å¾—æ›´å¤æ‚æ—¶ï¼Œä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªä»£ç å—ã€‚é‚£å°±å¯ä»¥éšå¿ƒæ‰€æ¬²çš„é•¿ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> other_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The two numbers are {} and {}."</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> other_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// This closure can be as long as we want, just like a function.</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯é—­åŒ…æ˜¯ç‰¹æ®Šçš„ï¼Œå› ä¸ºå®ƒå¯ä»¥æ¥å—é—­åŒ…ä¹‹å¤–çš„å˜é‡ï¼Œå³ä½¿ä½ åªå†™<code>||</code>ã€‚æ‰€ä»¥ä½ å¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_one <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> number_two <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number_one <span class="token operator">+</span> number_two<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™å°±æ‰“å°å‡ºäº†<code>16</code>ã€‚ä½ ä¸éœ€è¦åœ¨ <code>||</code> ä¸­æ”¾å…¥ä»»ä½•ä¸œè¥¿ï¼Œå› ä¸ºå®ƒå¯ä»¥ç›´æ¥å– <code>number_one</code> å’Œ <code>number_two</code> å¹¶æ·»åŠ å®ƒä»¬ã€‚</p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯<strong>closure</strong>è¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå› ä¸ºå®ƒä»¬ä¼šå–å˜é‡å¹¶å°†å®ƒä»¬ â€œåŒ…å›´â€åœ¨é‡Œé¢ã€‚å¦‚æœä½ æƒ³å¾ˆæ­£ç¡®çš„è¯´ã€‚</p>
<ul>
<li>ä¸€ä¸ª<code>||</code>å¦‚æœä¸æŠŠå˜é‡ä»å¤–é¢åŒ…å›´èµ·æ¥ é‚£å°±æ˜¯ä¸€ä¸ª â€œåŒ¿åå‡½æ•°â€. åŒ¿åçš„æ„æ€æ˜¯ â€œæ²¡æœ‰åå­—â€ã€‚å®ƒçš„å·¥ä½œåŸç†æ›´åƒä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚</li>
<li><code>||</code> ä»å¤–éƒ¨åŒ…å›´å˜é‡çš„å‡½æ•°æ˜¯ â€œclosureâ€ã€‚å®ƒæŠŠå‘¨å›´çš„å˜é‡ â€œå°é—­â€èµ·æ¥ä½¿ç”¨ã€‚</li>
</ul>
<p>ä½†æ˜¯äººä»¬ç»å¸¸ä¼šæŠŠæ‰€æœ‰çš„<code>||</code>å‡½æ•°éƒ½å«åšé—­åŒ…ï¼Œæ‰€ä»¥ä½ ä¸ç”¨æ‹…å¿ƒåå­—çš„é—®é¢˜ã€‚æˆ‘ä»¬åªå¯¹ä»»ä½•å¸¦æœ‰<code>||</code>çš„å‡½æ•°è¯´ â€œclosureâ€ï¼Œä½†è¯·è®°ä½ï¼Œå®ƒå¯èƒ½æ„å‘³ç€ä¸€ä¸ª â€œåŒ¿åå‡½æ•°â€ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦çŸ¥é“è¿™ä¸¤è€…çš„åŒºåˆ«å‘¢ï¼Ÿå› ä¸ºåŒ¿åå‡½æ•°å…¶å®å’Œæœ‰åå­—çš„å‡½æ•°åšçš„æœºå™¨ä»£ç æ˜¯ä¸€æ ·çš„ã€‚å®ƒä»¬ç»™äººçš„æ„Ÿè§‰æ˜¯ â€œé«˜å±‚æŠ½è±¡â€ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å¤§å®¶ä¼šè§‰å¾—æœºå™¨ä»£ç ä¼šå¾ˆå¤æ‚ã€‚ä½†æ˜¯Rustç”¨å®ƒåšå‡ºæ¥çš„æœºå™¨ç å’Œæ™®é€šå‡½æ•°ä¸€æ ·å¿«ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å†æ¥çœ‹çœ‹é—­åŒ…èƒ½åšçš„ä¸€äº›äº‹æƒ…ã€‚ä½ ä¹Ÿå¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_one <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> number_two <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number_one <span class="token operator">+</span> number_two <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªé—­åŒ…å–<code>number_one</code>å’Œ<code>number_two</code>ã€‚æˆ‘ä»¬è¿˜ç»™äº†å®ƒä¸€ä¸ªæ–°çš„å˜é‡ <code>x</code>ï¼Œå¹¶è¯´ <code>x</code> æ˜¯ 5.ç„¶åå®ƒæŠŠè¿™ä¸‰ä¸ªåŠ åœ¨ä¸€èµ·æ‰“å° <code>21</code>ã€‚</p>
<p>é€šå¸¸åœ¨Rustä¸­ï¼Œä½ ä¼šåœ¨ä¸€ä¸ªæ–¹æ³•é‡Œé¢çœ‹åˆ°é—­åŒ…ï¼Œå› ä¸ºé‡Œé¢æœ‰ä¸€ä¸ªé—­åŒ…æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚çš„ <code>.map()</code> å’Œ <code>.for_each()</code> ä¸­çœ‹åˆ°äº†é—­åŒ…ã€‚åœ¨é‚£ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å†™äº† <code>|x|</code> æ¥å¼•å…¥è¿­ä»£å™¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚</p>
<p>ä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­:æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœ<code>unwrap</code>ä¸èµ·ä½œç”¨ï¼Œå¯ä»¥ç”¨<code>unwrap_or</code>æ–¹æ³•ç»™å‡ºä¸€ä¸ªå€¼ã€‚ä¹‹å‰æˆ‘ä»¬å†™çš„æ˜¯:<code>let fourth = my_vec.get(3).unwrap_or(&amp;0);</code>ã€‚ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ª<code>unwrap_or_else</code>æ–¹æ³•ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªé—­åŒ…ã€‚æ‰€ä»¥ä½ å¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> fourth <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or_else</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// try to unwrap. If it doesn't work,</span>
        <span class="token keyword">if</span> my_vec<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_some</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>               <span class="token comment">// see if my_vec has something at index [0]</span>
            <span class="token operator">&amp;</span>my_vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                             <span class="token comment">// Give the number at index 0 if there is something</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token operator">&amp;</span><span class="token number">0</span> <span class="token comment">// otherwise give a &amp;0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> fourth<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œç»“å°¾å¯ä»¥å¾ˆç®€å•ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åªå†™<code>let fourth = my_vec.get(3).unwrap_or_else(|| &amp;0);</code>ã€‚ä½ ä¸éœ€è¦æ€»æ˜¯å› ä¸ºæœ‰ä¸€ä¸ªé—­åŒ…å°±ä½¿ç”¨<code>{}</code>å¹¶å†™å‡ºå¤æ‚çš„ä»£ç ã€‚åªè¦ä½ æŠŠ<code>||</code>æ”¾è¿›å»ï¼Œç¼–è¯‘å™¨å°±çŸ¥é“ä½ æ”¾äº†ä½ éœ€è¦çš„é—­åŒ…ã€‚</p>
<p>æœ€å¸¸ç”¨çš„é—­åŒ…æ–¹æ³•å¯èƒ½æ˜¯<code>.map()</code>ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒã€‚ä¸‹é¢æ˜¯ä¸€ç§ä½¿ç”¨æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> double_vec <span class="token operator">=</span> num_vec        <span class="token comment">// take num_vec</span>
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                     <span class="token comment">// iterate over it</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>number<span class="token closure-punctuation punctuation">|</span></span> number <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">// for each item, multiply by two</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// then make a new Vec from this</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> double_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯åœ¨<code>.enumerate()</code>ä¹‹åä½¿ç”¨<code>.for_each()</code>ã€‚<code>.enumerate()</code>æ–¹æ³•ç»™å‡ºä¸€ä¸ªå¸¦æœ‰ç´¢å¼•å·å’Œå…ƒç´ çš„è¿­ä»£å™¨ã€‚ä¾‹å¦‚:<code>[10, 9, 8]</code>å˜æˆ<code>(0, 10), (1, 9), (2, 8)</code>ã€‚è¿™é‡Œæ¯ä¸ªé¡¹çš„ç±»å‹æ˜¯<code>(usize, i32)</code>ã€‚æ‰€ä»¥ä½ å¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    num_vec
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">// iterate over num_vec</span>
        <span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// get (index, number)</span>
        <span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Index number {} has number {}"</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// do something for each one</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Index number 0 has number 10
Index number 1 has number 9
Index number 2 has number 8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨<code>for_each</code>ä»£æ›¿<code>map</code>ã€‚<code>map</code>æ˜¯ç”¨äºå¯¹<strong>æ¯ä¸ªå…ƒç´ åšä¸€äº›äº‹æƒ…ï¼Œå¹¶å°†å…¶ä¼ é€’å‡ºå»ï¼Œè€Œ<code>for_each</code>æ˜¯å½“ä½ çœ‹åˆ°æ¯ä¸ªå…ƒç´ </strong>æ—¶åšä¸€äº›äº‹æƒ…ã€‚å¦å¤–ï¼Œ<code>map</code>ä¸åšä»»ä½•äº‹æƒ…ï¼Œé™¤éä½ ä½¿ç”¨<code>collect</code>è¿™æ ·çš„æ–¹æ³•ã€‚</p>
<p>å…¶å®ï¼Œè¿™å°±æ˜¯è¿­ä»£å™¨çš„æœ‰è¶£ä¹‹å¤„ã€‚å¦‚æœä½ å°è¯•<code>map</code>è€Œä¸ä½¿ç”¨<code>collect</code>è¿™æ ·çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šå‘Šè¯‰ä½ ï¼Œå®ƒä»€ä¹ˆä¹Ÿä¸åšã€‚å®ƒä¸ä¼šå´©æºƒï¼Œä½†ç¼–è¯‘å™¨ä¼šå‘Šè¯‰ä½ ï¼Œä½ ä»€ä¹ˆéƒ½æ²¡åšã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    num_vec
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Index number {} has number {}"</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">warning: unused `std::iter::Map` that must be used
 --&gt; src\main.rs:4:5
  |
4 | /     num_vec
5 | |         .iter()
6 | |         .enumerate()
7 | |         .map(|(index, number)| println!("Index number {} has number {}", index, number));
  | |_________________________________________________________________________________________^
  |
  = note: `#[warn(unused_must_use)]` on by default
  = note: iterators are lazy and do nothing unless consumed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯ä¸€ä¸ª<strong>è­¦å‘Š</strong>ï¼Œæ‰€ä»¥è¿™ä¸æ˜¯ä¸€ä¸ªé”™è¯¯:ç¨‹åºè¿è¡Œæ­£å¸¸ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆnum_vecæ²¡æœ‰ä»»ä½•ä½œç”¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ç±»å‹å°±çŸ¥é“äº†ã€‚</p>
<ul>
<li><p><code>let num_vec = vec![10, 9, 8];</code> ç°åœ¨æ˜¯ä¸€ä¸ª<code>Vec&lt;i32&gt;</code>ã€‚</p>
</li>
<li><p><code>.iter()</code> ç°åœ¨æ˜¯ä¸€ä¸ª <code>Iter&lt;i32&gt;</code>ã€‚æ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå…¶å…ƒç´ ä¸º <code>i32</code>ã€‚</p>
</li>
<li><p><code>.enumerate()</code>ç°åœ¨æ˜¯ä¸€ä¸ª<code>Enumerate&lt;Iter&lt;i32&gt;&gt;</code>å‹ã€‚æ‰€ä»¥å®ƒæ˜¯<code>Enumerate</code>å‹çš„<code>Iter</code>å‹çš„<code>i32</code>sã€‚</p>
</li>
<li><p><code>.map()</code>ç°åœ¨æ˜¯ä¸€ä¸ª<code>Map&lt;Enumerate&lt;Iter&lt;i32&gt;&gt;&gt;</code>çš„ç±»å‹ã€‚æ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªç±»å‹<code>Map</code>çš„ç±»å‹<code>Enumerate</code>çš„ç±»å‹<code>Iter</code>çš„ç±»å‹<code>i32</code>sã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬æ‰€åšçš„åªæ˜¯åšäº†ä¸€ä¸ªè¶Šæ¥è¶Šå¤æ‚çš„ç»“æ„ã€‚æ‰€ä»¥è¿™ä¸ª<code>Map&lt;Enumerate&lt;Iter&lt;i32&gt;&gt;&gt;</code>æ˜¯ä¸€ä¸ªå‡†å¤‡å¥½äº†çš„ç»“æ„ï¼Œä½†åªæœ‰å½“æˆ‘ä»¬å‘Šè¯‰å®ƒè¦åšä»€ä¹ˆçš„æ—¶å€™ï¼Œå®ƒæ‰ä¼šå»åšã€‚Rustè¿™æ ·åšæ˜¯å› ä¸ºå®ƒéœ€è¦å¿«é€Ÿã€‚å®ƒä¸æƒ³è¿™æ ·åš:</p>
<ul>
<li>éå†Vecä¸­æ‰€æœ‰çš„<code>i32</code></li>
<li>ç„¶åä»è¿­ä»£å™¨ä¸­æšä¸¾å‡ºæ‰€æœ‰çš„<code>i32</code></li>
<li>ç„¶åå°†æ‰€æœ‰åˆ—ä¸¾çš„<code>i32</code>æ˜ å°„è¿‡æ¥</li>
</ul>
<p>Rust åªæƒ³åšä¸€æ¬¡è®¡ç®—ï¼Œæ‰€ä»¥å®ƒåˆ›å»ºç»“æ„å¹¶ç­‰å¾…ã€‚ç„¶åï¼Œå¦‚æœæˆ‘ä»¬è¯´<code>.collect::&lt;Vec&lt;i32&gt;&gt;()</code>ï¼Œå®ƒçŸ¥é“è¯¥æ€ä¹ˆåšï¼Œå¹¶å¼€å§‹ç§»åŠ¨ã€‚è¿™å°±æ˜¯<code>iterators are lazy and do nothing unless consumed</code>çš„æ„æ€ã€‚è¿­ä»£å™¨åœ¨ä½  â€œæ¶ˆè€—â€å®ƒä»¬(ç”¨å®Œå®ƒä»¬)ä¹‹å‰ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚</p>
<p>ä½ ç”šè‡³å¯ä»¥ç”¨<code>.collect()</code>åˆ›å»ºåƒ<code>HashMap</code>è¿™æ ·å¤æ‚çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å®ƒéå¸¸å¼ºå¤§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¦‚ä½•å°†ä¸¤ä¸ªå‘é‡æ”¾å…¥<code>HashMap</code>çš„ä¾‹å­ã€‚é¦–å…ˆæˆ‘ä»¬æŠŠä¸¤ä¸ªå‘é‡åšå‡ºæ¥ï¼Œç„¶åæˆ‘ä»¬ä¼šå¯¹å®ƒä»¬ä½¿ç”¨<code>.into_iter()</code>æ¥å¾—åˆ°ä¸€ä¸ªå€¼çš„è¿­ä»£å™¨ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨<code>.zip()</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å°†ä¸¤ä¸ªè¿­ä»£å™¨è¿æ¥åœ¨ä¸€èµ·ï¼Œå°±åƒæ‹‰é“¾ä¸€æ ·ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>.collect()</code>æ¥åˆ›å»º<code>HashMap</code>ã€‚</p>
<p>ä¸‹é¢æ˜¯ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// a Vec&lt;i32&gt;</span>
    <span class="token keyword">let</span> some_words <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"zero"</span><span class="token punctuation">,</span> <span class="token string">"one"</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">,</span> <span class="token string">"three"</span><span class="token punctuation">,</span> <span class="token string">"four"</span><span class="token punctuation">,</span> <span class="token string">"five"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// a Vec&lt;&amp;str&gt;</span>

    <span class="token keyword">let</span> number_word_hashmap <span class="token operator">=</span> some_numbers
        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment">// now it is an iter</span>
        <span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>some_words<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// inside .zip() we put in the other iter. Now they are together.</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">HashMap</span><span class="token operator">&lt;</span>_<span class="token punctuation">,</span> _<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"For key {} we get {}."</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> number_word_hashmap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">For key 2 we get two.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å†™äº† <code>&lt;HashMap&lt;_, _&gt;&gt;</code>ï¼Œå› ä¸ºè¿™è¶³ä»¥è®© Rust å†³å®š <code>HashMap&lt;i32, &amp;str&gt;</code> çš„ç±»å‹ã€‚å¦‚æœä½ æƒ³å†™ <code>.collect::&lt;HashMap&lt;i32, &amp;str&gt;&gt;();</code>ä¹Ÿè¡Œï¼Œä¹Ÿå¯ä»¥è¿™æ ·å†™:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// a Vec&lt;i32&gt;</span>
    <span class="token keyword">let</span> some_words <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"zero"</span><span class="token punctuation">,</span> <span class="token string">"one"</span><span class="token punctuation">,</span> <span class="token string">"two"</span><span class="token punctuation">,</span> <span class="token string">"three"</span><span class="token punctuation">,</span> <span class="token string">"four"</span><span class="token punctuation">,</span> <span class="token string">"five"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// a Vec&lt;&amp;str&gt;</span>
    <span class="token keyword">let</span> number_word_hashmap<span class="token punctuation">:</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>_<span class="token punctuation">,</span> _<span class="token operator">&gt;</span> <span class="token operator">=</span> some_numbers  <span class="token comment">// Because we tell it the type here...</span>
        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>some_words<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we don't have to tell it here</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±åƒ<code>.enumerate()</code>çš„<code>char</code>ã€‚<code>char_indices()</code>. (Indicesçš„æ„æ€æ˜¯ â€œç´¢å¼•â€)ã€‚ä½ ç”¨å®ƒçš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”±3ä½æ•°ç»„æˆçš„å¤§å­—ç¬¦ä¸²ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> numbers_together <span class="token operator">=</span> <span class="token string">"140399923481800622623218009598281"</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> number<span class="token punctuation">)</span> <span class="token keyword">in</span> numbers_together<span class="token punctuation">.</span><span class="token function">char_indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token punctuation">(</span>index <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..=</span><span class="token number">1</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// just print the number if there is a remainder</span>
            _ <span class="token operator">=&gt;</span> <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{}\t"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// otherwise print the number with a tab space</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰“å°<code>140     399     923     481     800     622     623     218     009     598    281</code>ã€‚</p>
<h3 id="é—­åŒ…ä¸­çš„"><a href="#é—­åŒ…ä¸­çš„" class="headerlink" title="é—­åŒ…ä¸­çš„|_|"></a>é—­åŒ…ä¸­çš„|_|</h3><p>æœ‰æ—¶ä½ ä¼šåœ¨ä¸€ä¸ªé—­åŒ…ä¸­çœ‹åˆ° <code>|_|</code>ã€‚è¿™æ„å‘³ç€è¿™ä¸ªé—­åŒ…éœ€è¦ä¸€ä¸ªå‚æ•°(æ¯”å¦‚ <code>x</code>)ï¼Œä½†ä½ ä¸æƒ³ä½¿ç”¨å®ƒã€‚æ‰€ä»¥ <code>|_|</code> æ„å‘³ç€ â€œå¥½å§ï¼Œè¿™ä¸ªé—­åŒ…éœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œä½†æˆ‘ä¸ä¼šç»™å®ƒä¸€ä¸ªåå­—ï¼Œå› ä¸ºæˆ‘ä¸å…³å¿ƒå®ƒâ€ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªé”™è¯¯çš„ä¾‹å­ï¼Œå½“ä½ ä¸è¿™æ ·åšçš„æ—¶å€™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"We didn't use the variables at all"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Rustè¯´</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0593]: closure is expected to take 1 argument, but it takes 0 arguments
  --&gt; src\main.rs:28:36
   |
28 |     println!("{:?}", my_vec.iter().for_each(|| println!("We didn't use the variables at all")));
   |                                    ^^^^^^^^ -- takes 0 arguments
   |                                    |
   |                                    expected closure that takes 1 argument<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨å…¶å®ç»™ä½ ä¸€äº›å¸®åŠ©ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">help: consider changing the closure to take and ignore the expected argument
   |
28 |     println!("{:?}", my_vec.iter().for_each(|_| println!("We didn't use the variables at all")));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯å¾ˆå¥½çš„å»ºè®®ã€‚å¦‚æœä½ æŠŠ<code>||</code>æ”¹æˆ<code>|_|</code>å°±å¯ä»¥äº†ã€‚</p>
<h3 id="é—­åŒ…å’Œè¿­ä»£å™¨çš„æœ‰ç”¨æ–¹æ³•"><a href="#é—­åŒ…å’Œè¿­ä»£å™¨çš„æœ‰ç”¨æ–¹æ³•" class="headerlink" title="é—­åŒ…å’Œè¿­ä»£å™¨çš„æœ‰ç”¨æ–¹æ³•"></a>é—­åŒ…å’Œè¿­ä»£å™¨çš„æœ‰ç”¨æ–¹æ³•</h3><p>ä¸€æ—¦ä½ ç†Ÿæ‚‰äº†é—­åŒ…ï¼ŒRustå°±ä¼šæˆä¸ºä¸€ç§éå¸¸æœ‰è¶£çš„è¯­è¨€ã€‚æœ‰äº†é—­åŒ…ï¼Œä½ å¯ä»¥å°†æ–¹æ³•äº’ç›¸<em>é“¾æ¥</em>èµ·æ¥ï¼Œç”¨å¾ˆå°‘çš„ä»£ç åšå¾ˆå¤šäº‹æƒ…ã€‚ä¸‹é¢æ˜¯ä¸€äº›æˆ‘ä»¬è¿˜æ²¡æœ‰è§è¿‡çš„é—­åŒ…å’Œä½¿ç”¨é—­åŒ…çš„æ–¹æ³•ã€‚</p>
<p><code>.filter()</code>: è¿™å¯ä»¥è®©ä½ åœ¨è¿­ä»£å™¨ä¸­ä¿ç•™ä½ æƒ³ä¿ç•™çš„å…ƒç´ ã€‚è®©æˆ‘ä»¬è¿‡æ»¤ä¸€å¹´ä¸­çš„æœˆä»½ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> months <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"January"</span><span class="token punctuation">,</span> <span class="token string">"February"</span><span class="token punctuation">,</span> <span class="token string">"March"</span><span class="token punctuation">,</span> <span class="token string">"April"</span><span class="token punctuation">,</span> <span class="token string">"May"</span><span class="token punctuation">,</span> <span class="token string">"June"</span><span class="token punctuation">,</span> <span class="token string">"July"</span><span class="token punctuation">,</span> <span class="token string">"August"</span><span class="token punctuation">,</span> <span class="token string">"September"</span><span class="token punctuation">,</span> <span class="token string">"October"</span><span class="token punctuation">,</span> <span class="token string">"November"</span><span class="token punctuation">,</span> <span class="token string">"December"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> filtered_months <span class="token operator">=</span> months
        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                         <span class="token comment">// make an iter</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>month<span class="token closure-punctuation punctuation">|</span></span> month<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span>     <span class="token comment">// We don't want months more than 5 bytes in length.</span>
                                             <span class="token comment">// We know that each letter is one byte so .len() is fine</span>
        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>month<span class="token closure-punctuation punctuation">|</span></span> month<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Also we only like months with the letter u</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> filtered_months<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°<code>["June", "July"]</code>ã€‚</p>
<p><code>.filter_map()</code>. è¿™ä¸ªå«åš<code>filter_map()</code>ï¼Œå› ä¸ºå®ƒåšäº†<code>.filter()</code>å’Œ<code>.map()</code>ã€‚é—­åŒ…å¿…é¡»è¿”å›ä¸€ä¸ª <code>Option&lt;T&gt;</code>ï¼Œç„¶åå¯¹æ¯ä¸ª<code>Option</code>, å¦‚æœæ˜¯ <code>Some</code>, <code>filter_map()</code>å°†å–å‡ºå®ƒçš„å€¼ã€‚æ‰€ä»¥æ¯”å¦‚è¯´ä½ <code>.filter_map()</code>ä¸€ä¸ª<code>vec![Some(2), None, Some(3)]</code>ï¼Œå®ƒå°±ä¼šè¿”å›<code>[2, 3]</code>ã€‚</p>
<p>æˆ‘ä»¬å°†ç”¨ä¸€ä¸ª<code>Company</code>ç»“æ„ä½“æ¥å†™ä¸€ä¸ªä¾‹å­ã€‚æ¯ä¸ªå…¬å¸éƒ½æœ‰ä¸€ä¸ª<code>name</code>ï¼Œæ‰€ä»¥è¿™ä¸ªå­—æ®µæ˜¯<code>String</code>ï¼Œä½†æ˜¯CEOå¯èƒ½æœ€è¿‘å·²ç»è¾èŒäº†ã€‚æ‰€ä»¥<code>ceo</code>å­—æ®µæ˜¯<code>Option&lt;String&gt;</code>ã€‚æˆ‘ä»¬ä¼š<code>.filter_map()</code>è¿‡ä¸€äº›å…¬å¸ï¼Œåªä¿ç•™CEOåå­—ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Company</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    ceo<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> ceo<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> ceo <span class="token operator">=</span> <span class="token keyword">match</span> ceo <span class="token punctuation">{</span>
            <span class="token string">""</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            name <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// ceo is decided, so now we return Self</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            ceo<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">get_ceo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>ceo<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Just returns a clone of the CEO (struct is not Copy)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> company_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Umbrella Corporation"</span><span class="token punctuation">,</span> <span class="token string">"Unknown"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Ovintiv"</span><span class="token punctuation">,</span> <span class="token string">"Doug Suttles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"The Red-Headed League"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Stark Enterprises"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> all_the_ceos <span class="token operator">=</span> company_vec
        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter_map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>company<span class="token closure-punctuation punctuation">|</span></span> company<span class="token punctuation">.</span><span class="token function">get_ceo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// filter_map needs Option&lt;T&gt;</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> all_the_ceos<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡ºäº†<code>["Unknown", "Doug Suttles"]</code>ã€‚</p>
<p>æ—¢ç„¶ <code>.filter_map()</code> éœ€è¦ <code>Option</code>ï¼Œé‚£ä¹ˆ <code>Result</code> å‘¢ï¼Ÿæ²¡é—®é¢˜:æœ‰ä¸€ä¸ªå«åš <code>.ok()</code> çš„æ–¹æ³•ï¼Œå¯ä»¥æŠŠ <code>Result</code> å˜æˆ <code>Option</code>ã€‚ä¹‹æ‰€ä»¥å«<code>.ok()</code>ï¼Œæ˜¯å› ä¸ºå®ƒèƒ½å‘é€çš„åªæ˜¯<code>Ok</code>çš„ç»“æœ(<code>Err</code>çš„ä¿¡æ¯æ²¡æœ‰äº†)ã€‚ä½ è®°å¾—<code>Option</code>æ˜¯<code>Option&lt;T&gt;</code>ï¼Œè€Œ<code>Result</code>æ˜¯<code>Result&lt;T, E&gt;</code>ï¼ŒåŒæ—¶æœ‰<code>Ok</code>å’Œ<code>Err</code>çš„ä¿¡æ¯ã€‚æ‰€ä»¥å½“ä½ ä½¿ç”¨<code>.ok()</code>æ—¶ï¼Œä»»ä½•<code>Err</code>çš„ä¿¡æ¯éƒ½ä¼šä¸¢å¤±ï¼Œå˜æˆ<code>None</code>ã€‚</p>
<p>ä½¿ç”¨ <code>.parse()</code> æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°è¯•è§£æä¸€äº›ç”¨æˆ·è¾“å…¥ã€‚<code>.parse()</code>åœ¨è¿™é‡Œæ¥å—ä¸€ä¸ª<code>&amp;str</code>ï¼Œå¹¶è¯•å›¾æŠŠå®ƒå˜æˆä¸€ä¸ª<code>f32</code>ã€‚å®ƒè¿”å›ä¸€ä¸ª <code>Result</code>ï¼Œä½†æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <code>filter_map()</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€æŠ›å‡ºé”™è¯¯ã€‚<code>Err</code>çš„ä»»ä½•å†…å®¹éƒ½ä¼šå˜æˆ<code>None</code>ï¼Œå¹¶è¢«<code>.filter_map()</code>è¿‡æ»¤æ‰ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user_input <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"8.9"</span><span class="token punctuation">,</span> <span class="token string">"Nine point nine five"</span><span class="token punctuation">,</span> <span class="token string">"8.0"</span><span class="token punctuation">,</span> <span class="token string">"7.6"</span><span class="token punctuation">,</span> <span class="token string">"eleventy-twelve"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> actual_numbers <span class="token operator">=</span> user_input
        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">filter_map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>input<span class="token closure-punctuation punctuation">|</span></span> input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">f32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">f32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> actual_numbers<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†æ‰“å°: <code>[8.9, 8.0, 7.6]</code>ã€‚</p>
<p>ä¸<code>.ok()</code>ç›¸å¯¹çš„æ˜¯<code>.ok_or()</code>å’Œ<code>ok_or_else()</code>ã€‚è¿™æ ·å°±æŠŠ<code>Option</code>å˜æˆäº†<code>Result</code>ã€‚ä¹‹æ‰€ä»¥å«<code>.ok_or()</code>ï¼Œæ˜¯å› ä¸º<code>Result</code>ç»™å‡ºäº†ä¸€ä¸ª<code>Ok</code><strong>æˆ–</strong><code>Err</code>ï¼Œæ‰€ä»¥ä½ å¿…é¡»è®©å®ƒçŸ¥é“<code>Err</code>çš„å€¼æ˜¯å¤šå°‘ã€‚è¿™æ˜¯å› ä¸º<code>None</code>ä¸­çš„<code>Option</code>æ²¡æœ‰ä»»ä½•ä¿¡æ¯ã€‚å¦å¤–ï¼Œä½ ç°åœ¨å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›æ–¹æ³•åç§°ä¸­çš„<em>else</em>éƒ¨åˆ†æ„å‘³ç€å®ƒæœ‰ä¸€ä¸ªé—­åŒ…ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬çš„<code>Option</code>ä»<code>Company</code>ç»“æ„ä¸­å–å‡ºæ¥ï¼Œç„¶åè¿™æ ·æŠŠå®ƒå˜æˆä¸€ä¸ª<code>Result</code>ã€‚å¯¹äºé•¿æœŸçš„é”™è¯¯å¤„ç†ï¼Œæœ€å¥½æ˜¯åˆ›å»ºè‡ªå·±çš„é”™è¯¯ç±»å‹ã€‚<br> ä½†æ˜¯ç°åœ¨æˆ‘ä»¬åªæ˜¯ç»™å®ƒä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥å®ƒå°±å˜æˆäº†<code>Result&lt;String, &amp;str&gt;</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// Everything before main() is exactly the same</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Company</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    ceo<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> ceo<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> ceo <span class="token operator">=</span> <span class="token keyword">match</span> ceo <span class="token punctuation">{</span>
            <span class="token string">""</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            name <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            ceo<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">get_ceo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>ceo<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> company_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Umbrella Corporation"</span><span class="token punctuation">,</span> <span class="token string">"Unknown"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Ovintiv"</span><span class="token punctuation">,</span> <span class="token string">"Doug Suttles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"The Red-Headed League"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Stark Enterprises"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> results_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Pretend we need to gather error results too</span>

    company_vec
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>company<span class="token closure-punctuation punctuation">|</span></span> results_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>company<span class="token punctuation">.</span><span class="token function">get_ceo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or</span><span class="token punctuation">(</span><span class="token string">"No CEO found"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> results_vec <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™è¡Œæ˜¯æœ€å¤§çš„å˜åŒ–:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>company<span class="token closure-punctuation punctuation">|</span></span> results_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>company<span class="token punctuation">.</span><span class="token function">get_ceo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or</span><span class="token punctuation">(</span><span class="token string">"No CEO found"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å®ƒçš„æ„æ€æ˜¯:â€æ¯å®¶å…¬å¸ï¼Œç”¨<code>get_ceo()</code>. å¦‚æœä½ å¾—åˆ°äº†ï¼Œé‚£å°±æŠŠ<code>Ok</code>é‡Œé¢çš„æ•°å€¼ä¼ ç»™ä½ ã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±åœ¨<code>Err</code>é‡Œé¢ä¼ é€’ â€œæ²¡æœ‰æ‰¾åˆ°CEOâ€ã€‚ç„¶åæŠŠè¿™ä¸ªæ¨åˆ°vecé‡Œã€‚â€</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬æ‰“å°<code>results_vec</code>çš„æ—¶å€™ï¼Œå°±ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Ok("Unknown")
Ok("Doug Suttles")
Err("No CEO found")
Err("No CEO found")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æœ‰äº†æ‰€æœ‰å››ä¸ªæ¡ç›®ã€‚ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ <code>.ok_or_else()</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé—­åŒ…ï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„é”™è¯¯ä¿¡æ¯ã€‚ç°åœ¨æˆ‘ä»¬æœ‰ç©ºé—´ä½¿ç”¨<code>format!</code>æ¥åˆ›å»ºä¸€ä¸ª<code>String</code>ï¼Œå¹¶å°†å…¬å¸åç§°æ”¾åœ¨å…¶ä¸­ã€‚ç„¶åæˆ‘ä»¬è¿”å›<code>String</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// Everything before main() is exactly the same</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Company</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    ceo<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Company</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> ceo<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> ceo <span class="token operator">=</span> <span class="token keyword">match</span> ceo <span class="token punctuation">{</span>
            <span class="token string">""</span> <span class="token operator">=&gt;</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            name <span class="token operator">=&gt;</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            ceo<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">get_ceo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>ceo<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> company_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Umbrella Corporation"</span><span class="token punctuation">,</span> <span class="token string">"Unknown"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Ovintiv"</span><span class="token punctuation">,</span> <span class="token string">"Doug Suttles"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"The Red-Headed League"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Company</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Stark Enterprises"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> results_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    company_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>company<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        results_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>company<span class="token punctuation">.</span><span class="token function">get_ceo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ok_or_else</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> err_message <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"No CEO found for {}"</span><span class="token punctuation">,</span> company<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            err_message
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> results_vec <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±æœ‰äº†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Ok("Unknown")
Ok("Doug Suttles")
Err("No CEO found for The Red-Headed League")
Err("No CEO found for Stark Enterprises")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


<p><code>.and_then()</code>æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„æ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª<code>Option</code>ï¼Œç„¶åè®©ä½ å¯¹å®ƒçš„å€¼åšä¸€äº›äº‹æƒ…ï¼Œå¹¶æŠŠå®ƒä¼ é€’å‡ºå»ã€‚æ‰€ä»¥å®ƒçš„è¾“å…¥æ˜¯ä¸€ä¸ª <code>Option</code>ï¼Œè¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ª <code>Option</code>ã€‚è¿™æœ‰ç‚¹åƒä¸€ä¸ªå®‰å…¨çš„ â€œè§£åŒ…ï¼Œç„¶ååšä¸€äº›äº‹æƒ…ï¼Œç„¶åå†åŒ…â€ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>.get()</code> ä»ä¸€ä¸ª vec ä¸­å¾—åˆ°ä¸€ä¸ªæ•°å­—ï¼Œå› ä¸ºå®ƒè¿”å›ä¸€ä¸ª <code>Option</code>ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä¼ ç»™ <code>and_then()</code>ï¼Œå¦‚æœå®ƒæ˜¯ <code>Some</code>ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒåšä¸€äº›æ•°å­¦è¿ç®—ã€‚å¦‚æœæ˜¯<code>None</code>ï¼Œé‚£ä¹ˆ<code>None</code>å°±ä¼šè¢«ä¼ é€’è¿‡å»ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// just a vec with numbers</span>

    <span class="token keyword">let</span> number_to_add <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>       <span class="token comment">// use this in the math later</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> empty_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// results go in here</span>


    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>
        empty_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            new_vec
               <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>number<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">Some</span><span class="token punctuation">(</span>number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and_then</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>number<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">Some</span><span class="token punctuation">(</span>number <span class="token operator">+</span> number_to_add<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> empty_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡ºäº†<code>[Some(14), Some(15), Some(6), None, None]</code>ã€‚ä½ å¯ä»¥çœ‹åˆ°<code>None</code>å¹¶æ²¡æœ‰è¢«è¿‡æ»¤æ‰ï¼Œåªæ˜¯ä¼ é€’äº†ã€‚</p>
<p><code>.and()</code>æœ‰ç‚¹åƒ<code>Option</code>çš„<code>bool</code>ã€‚ä½ å¯ä»¥åŒ¹é…å¾ˆå¤šä¸ª<code>Option</code>ï¼Œå¦‚æœå®ƒä»¬éƒ½æ˜¯<code>Some</code>ï¼Œé‚£ä¹ˆå®ƒä¼šç»™å‡ºæœ€åä¸€ä¸ªã€‚è€Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ˜¯<code>None</code>ï¼Œé‚£ä¹ˆå°±ä¼šç»™å‡º<code>None</code>ã€‚</p>
<p>é¦–å…ˆè¿™é‡Œæœ‰ä¸€ä¸ª<code>bool</code>çš„ä¾‹å­æ¥å¸®åŠ©æƒ³è±¡ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯<code>&amp;&amp;</code>(å’Œ)ï¼Œå“ªæ€•æ˜¯ä¸€ä¸ª<code>false</code>ï¼Œä¹Ÿä¼šè®©ä¸€åˆ‡<code>false</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> one <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> two <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> three <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> four <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> one <span class="token operator">&amp;&amp;</span> three<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints true</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> one <span class="token operator">&amp;&amp;</span> two <span class="token operator">&amp;&amp;</span> three <span class="token operator">&amp;&amp;</span> four<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints false</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨è¿™é‡Œçš„<code>.and()</code>ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬åšäº†äº”æ¬¡æ“ä½œï¼Œå¹¶æŠŠç»“æœæ”¾åœ¨ä¸€ä¸ªVec&lt;Option&lt;&amp;str&gt;&gt;ä¸­ã€‚å¦‚æœæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬å°±æŠŠ<code>Some("success!")</code>æ¨åˆ°Vecä¸­ã€‚ç„¶åæˆ‘ä»¬å†åšä¸¤æ¬¡è¿™æ ·çš„æ“ä½œã€‚ä¹‹åæˆ‘ä»¬ç”¨<code>.and()</code>æ¯æ¬¡åªæ˜¾ç¤ºå¾—åˆ°<code>Some</code>çš„ç´¢å¼•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first_try <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second_try <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> third_try <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">"success!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span>first_try<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> first_try<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>second_try<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>third_try<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">None
None
Some("success!")
Some("success!")
None<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¬¬ä¸€ä¸ª(ç´¢å¼•0)æ˜¯<code>None</code>ï¼Œå› ä¸ºåœ¨<code>second_try</code>ä¸­æœ‰ä¸€ä¸ª<code>None</code>ä¸ºç´¢å¼•0ã€‚ç¬¬äºŒä¸ªæ˜¯<code>None</code>ï¼Œå› ä¸ºåœ¨<code>first_try</code>ä¸­æœ‰ä¸€ä¸ª<code>None</code>ã€‚å…¶æ¬¡æ˜¯<code>Some("success!")</code>ï¼Œå› ä¸º<code>first_try</code>ã€<code>second try</code>ã€<code>third_try</code>ä¸­æ²¡æœ‰<code>None</code>ã€‚</p>
<p><code>.any()</code>å’Œ<code>.all()</code>åœ¨è¿­ä»£å™¨ä¸­éå¸¸å®¹æ˜“ä½¿ç”¨ã€‚å®ƒä»¬æ ¹æ®ä½ çš„è¾“å…¥è¿”å›ä¸€ä¸ª<code>bool</code>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åšäº†ä¸€ä¸ªéå¸¸å¤§çš„vec(å¤§çº¦20000ä¸ªå…ƒç´ )ï¼ŒåŒ…å«äº†ä»<code>'a'</code>åˆ°<code>'åƒ'</code>çš„æ‰€æœ‰å­—ç¬¦ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥æ£€æŸ¥æ˜¯å¦æœ‰å­—ç¬¦åœ¨å…¶ä¸­ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ›´å°çš„vecï¼Œé—®å®ƒæ˜¯å¦éƒ½æ˜¯å­—æ¯(ç”¨<code>.is_alphabetic()</code>æ–¹æ³•)ã€‚ç„¶åæˆ‘ä»¬é—®å®ƒæ˜¯ä¸æ˜¯æ‰€æœ‰çš„å­—ç¬¦éƒ½å°äºéŸ©æ–‡å­—ç¬¦<code>'í–‰'</code>ã€‚</p>
<p>è¿˜è¦æ³¨æ„æ”¾ä¸€ä¸ªå‚ç…§ç‰©ï¼Œå› ä¸º<code>.iter()</code>ç»™äº†ä¸€ä¸ªå‚ç…§ç‰©ï¼Œä½ éœ€è¦ä¸€ä¸ª<code>&amp;</code>å’Œå¦ä¸€ä¸ª<code>&amp;</code>è¿›è¡Œæ¯”è¾ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">in_char_vec</span><span class="token punctuation">(</span>char_vec<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> check<span class="token punctuation">:</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Is {} inside? {}"</span><span class="token punctuation">,</span> check<span class="token punctuation">,</span> char_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span><span class="token keyword">char</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">char</span> <span class="token operator">==</span> check<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> char_vec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">..</span><span class="token char string">'åƒ'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">in_char_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>char_vec<span class="token punctuation">,</span> <span class="token char string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">in_char_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>char_vec<span class="token punctuation">,</span> <span class="token char string">'ë·'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">in_char_vec</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>char_vec<span class="token punctuation">,</span> <span class="token char string">'é‘¿'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> smaller_vec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token char string">'A'</span><span class="token punctuation">..</span><span class="token char string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"All alphabetic? {}"</span><span class="token punctuation">,</span> smaller_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>x<span class="token closure-punctuation punctuation">|</span></span> x<span class="token punctuation">.</span><span class="token function">is_alphabetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"All less than the character í–‰? {}"</span><span class="token punctuation">,</span> smaller_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">&lt;</span> <span class="token char string">'í–‰'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Is i inside? true
Is ë· inside? false
Is é‘¿ inside? false
All alphabetic? false
All less than the character í–‰? true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œ<code>.any()</code>åªæ£€æŸ¥åˆ°ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ï¼Œç„¶åå°±åœæ­¢äº†ã€‚å¦‚æœå®ƒå·²ç»æ‰¾åˆ°äº†ä¸€ä¸ªåŒ¹é…é¡¹ï¼Œå®ƒä¸ä¼šæ£€æŸ¥æ‰€æœ‰çš„å…ƒç´ ã€‚å¦‚æœæ‚¨è¦åœ¨ <code>Vec</code> ä¸Šä½¿ç”¨ <code>.any()</code>ï¼Œæœ€å¥½æŠŠå¯èƒ½åŒ¹é…çš„å…ƒç´ æ¨åˆ°å‰é¢ã€‚æˆ–è€…ä½ å¯ä»¥åœ¨ <code>.iter()</code> ä¹‹åä½¿ç”¨ <code>.rev()</code> æ¥åå‘è¿­ä»£ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªè¿™æ ·çš„vecã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> big_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    big_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™ä¸ª<code>Vec</code>æœ‰1000ä¸ª<code>6</code>ï¼Œåé¢è¿˜æœ‰ä¸€ä¸ª<code>5</code>ã€‚æˆ‘ä»¬å‡è®¾æˆ‘ä»¬è¦ç”¨<code>.any()</code>æ¥çœ‹çœ‹å®ƒæ˜¯å¦åŒ…å«5ã€‚é¦–å…ˆè®©æˆ‘ä»¬ç¡®å®š<code>.rev()</code>æ˜¯æœ‰æ•ˆçš„ã€‚è®°ä½ï¼Œä¸€ä¸ª<code>Iterator</code>æ€»æ˜¯æœ‰<code>.next()</code>ï¼Œè®©ä½ æ¯æ¬¡éƒ½æ£€æŸ¥å®ƒçš„å·¥ä½œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> big_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    big_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> iterator <span class="token operator">=</span> big_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒçš„æ‰“å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Some(5)
Some(6)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬æ˜¯å¯¹çš„:æœ‰ä¸€ä¸ª<code>Some(5)</code>ï¼Œç„¶å1000ä¸ª<code>Some(6)</code>å¼€å§‹ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> big_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    big_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> big_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>number<span class="token closure-punctuation punctuation">|</span></span> number <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œä¸”å› ä¸ºæ˜¯<code>.rev()</code>ï¼Œæ‰€ä»¥å®ƒåªè°ƒç”¨<code>.next()</code>ä¸€æ¬¡å°±åœæ­¢äº†ã€‚å¦‚æœæˆ‘ä»¬ä¸ç”¨<code>.rev()</code>ï¼Œé‚£ä¹ˆå®ƒå°†è°ƒç”¨<code>.next()</code> 1001æ¬¡æ‰åœæ­¢ã€‚è¿™æ®µä»£ç æ˜¾ç¤ºäº†å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> big_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    big_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// Start counting</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> big_iter <span class="token operator">=</span> big_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make it an Iterator</span>

    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        counter <span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> big_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Keep calling .next() until we get Some(5)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Final counter is: {}"</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>Final counter is: 1001</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“å®ƒå¿…é¡»è°ƒç”¨ <code>.next()</code> 1001 æ¬¡æ‰èƒ½æ‰¾åˆ° 5ã€‚</p>
<p><code>.find()</code> å‘Šè¯‰ä½ ä¸€ä¸ªè¿­ä»£å™¨æ˜¯å¦æœ‰ä¸œè¥¿ï¼Œè€Œ <code>.position()</code> å‘Šè¯‰ä½ å®ƒåœ¨å“ªé‡Œã€‚<code>.find()</code>ä¸<code>.any()</code>ä¸åŒï¼Œå› ä¸ºå®ƒè¿”å›ä¸€ä¸ª<code>Option</code>ï¼Œé‡Œé¢æœ‰å€¼(æˆ–<code>None</code>)ã€‚åŒæ—¶ï¼Œ<code>.position()</code>ä¹Ÿæ˜¯ä¸€ä¸ªå¸¦æœ‰ä½ç½®å·çš„<code>Option</code>ï¼Œæˆ–<code>None</code>ã€‚æ¢å¥è¯è¯´</p>
<ul>
<li><code>.find()</code>: â€œæˆ‘å°½é‡å¸®ä½ æ‹¿â€</li>
<li><code>.position()</code>:â€æˆ‘å¸®ä½ æ‰¾æ‰¾çœ‹åœ¨å“ªé‡Œâ€</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>number<span class="token closure-punctuation punctuation">|</span></span> number <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// find takes a reference, so we give it &amp;number</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>number<span class="token closure-punctuation punctuation">|</span></span> number <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>number<span class="token closure-punctuation punctuation">|</span></span> number <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> num_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token operator">&amp;</span>number<span class="token closure-punctuation punctuation">|</span></span> number <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Some(30) // This is the number itself
None // No number inside times 2 == 30
Some(2) // This is the position
None<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p>ä½¿ç”¨ <code>.cycle()</code> ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ°¸è¿œå¾ªç¯çš„è¿­ä»£å™¨ã€‚è¿™ç§ç±»å‹çš„è¿­ä»£å™¨ä¸ <code>.zip()</code> å¾ˆå¥½åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥åˆ›å»ºæ–°çš„ä¸œè¥¿ï¼Œå°±åƒè¿™ä¸ªä¾‹å­ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ª <code>Vec&lt;(i32, &amp;str)&gt;</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> even_odd <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"even"</span><span class="token punctuation">,</span> <span class="token string">"odd"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> even_odd_vec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>even_odd<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> even_odd_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œå³ä½¿<code>.cycle()</code>å¯èƒ½æ°¸è¿œä¸ä¼šç»“æŸï¼Œä½†å½“æŠŠå®ƒä»¬å‹ç¼©åœ¨ä¸€èµ·æ—¶ï¼Œå¦ä¸€ä¸ªè¿­ä»£å™¨åªè¿è¡Œäº†6æ¬¡ã€‚<br> ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>.cycle()</code>æ‰€åšçš„è¿­ä»£å™¨ä¸ä¼šå†è¢«<code>.next()</code>è°ƒç”¨ï¼Œæ‰€ä»¥å…­æ¬¡ä¹‹åå°±å®Œæˆäº†ã€‚è¾“å‡ºçš„ç»“æœæ˜¯</p>
<pre class="line-numbers language-none"><code class="language-none">[(0, "even"), (1, "odd"), (2, "even"), (3, "odd"), (4, "even"), (5, "odd")]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç±»ä¼¼çš„äº‹æƒ…ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªæ²¡æœ‰ç»“å°¾çš„èŒƒå›´æ¥å®Œæˆã€‚å¦‚æœä½ å†™<code>0..</code>ï¼Œé‚£ä¹ˆä½ å°±åˆ›å»ºäº†ä¸€ä¸ªæ°¸ä¸åœæ­¢çš„èŒƒå›´ã€‚ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> ten_chars <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">..</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> skip_then_ten_chars <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">..</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">1300</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> ten_chars<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> skip_then_ten_chars<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸¤è€…éƒ½æ˜¯æ‰“å°åä¸ªå­—ç¬¦ï¼Œä½†ç¬¬äºŒä¸ªè·³è¿‡1300ä½ï¼Œæ‰“å°çš„æ˜¯äºšç¾å°¼äºšè¯­çš„åä¸ªå­—æ¯ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j']
['Õµ', 'Õ¶', 'Õ·', 'Õ¸', 'Õ¹', 'Õº', 'Õ»', 'Õ¼', 'Õ½', 'Õ¾']<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>å¦ä¸€ç§æµè¡Œçš„æ–¹æ³•å«åš<code>.fold()</code>ã€‚è¿™ä¸ªæ–¹æ³•ç»å¸¸ç”¨äºå°†è¿­ä»£å™¨ä¸­çš„å…ƒç´ åŠ åœ¨ä¸€èµ·ï¼Œä½†ä½ ä¹Ÿå¯ä»¥åšæ›´å¤šçš„äº‹æƒ…ã€‚å®ƒä¸<code>.for_each()</code>æœ‰äº›ç±»ä¼¼ã€‚åœ¨ <code>.fold()</code> ä¸­ï¼Œä½ é¦–å…ˆæ·»åŠ ä¸€ä¸ªèµ·å§‹å€¼ (å¦‚æœä½ æ˜¯æŠŠå…ƒç´ åŠ åœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆå°±æ˜¯ 0)ï¼Œç„¶åæ˜¯ä¸€ä¸ªé€—å·ï¼Œç„¶åæ˜¯é—­åŒ…ã€‚ç»“å°¾ç»™ä½ ä¸¤ä¸ªå…ƒç´ :åˆ°ç›®å‰ä¸ºæ­¢çš„æ€»æ•°ï¼Œå’Œä¸‹ä¸€ä¸ªå…ƒç´ ã€‚é¦–å…ˆè¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ˜¾ç¤º<code>.fold()</code>å°†å…ƒç´ åŠ åœ¨ä¸€èµ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> some_numbers
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">fold</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>total_so_far<span class="token punctuation">,</span> next_number<span class="token closure-punctuation punctuation">|</span></span> total_so_far <span class="token operator">+</span> next_number<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œåœ¨ç¬¬1æ­¥ä¸­ï¼Œå®ƒä»0å¼€å§‹ï¼Œå†åŠ ä¸Šä¸‹ä¸€ä¸ªæ•°å­—:9ã€‚</p>
<ul>
<li>ç¬¬1æ­¥ï¼Œä»0å¼€å§‹ï¼ŒåŠ ä¸Šä¸‹ä¸€ä¸ªæ•°å­—9</li>
<li>ç„¶åæŠŠ9åŠ ä¸Š6: 15ã€‚</li>
<li>ç„¶åæŠŠ15åŠ ä¸Š9: 24ã€‚</li>
<li>ç„¶åå–24ï¼Œå†åŠ ä¸Š10: 34ã€‚</li>
<li>æœ€åå–34ï¼Œå†åŠ ä¸Š11: 45ã€‚æ‰€ä»¥å®ƒçš„æ‰“å°ç»“æœæ˜¯<code>45</code>.</li>
</ul>
<p>ä½†æ˜¯ä½ ä¸éœ€è¦åªç”¨å®ƒæ¥æ·»åŠ ä¸œè¥¿ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸€ä¸ªå­—ç¬¦ä¸ŠåŠ ä¸€ä¸ªâ€™-â€˜ï¼Œå°±ä¼šå˜æˆ<code>String</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> a_string <span class="token operator">=</span> <span class="token string">"I don't have any dashes in me."</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"{}"</span><span class="token punctuation">,</span>
        a_string
            <span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Now it's an iterator</span>
            <span class="token punctuation">.</span><span class="token function">fold</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token keyword">mut</span> string_so_far<span class="token punctuation">,</span> next_char<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// Start with a String "-". Bring it in as mutable each time along with the next char</span>
                string_so_far<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>next_char<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Push the char on, then '-'</span>
                string_so_far<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                string_so_far<span class="token punctuation">}</span> <span class="token comment">// Don't forget to pass it on to the next loop</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">-I- -d-o-n-'-t- -h-a-v-e- -a-n-y- -d-a-s-h-e-s- -i-n- -m-e-.-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p>è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ–¹ä¾¿çš„æ–¹æ³•ï¼Œæ¯”å¦‚</p>
<ul>
<li><code>.take_while()</code>ï¼Œåªè¦å¾—åˆ°<code>true</code>ï¼Œå°±ä¼šå¸¦å…¥ä¸€ä¸ªè¿­ä»£å™¨(ä¾‹å¦‚<code>take while x &gt; 5</code>)</li>
<li><code>.cloned()</code>ï¼Œå®ƒåœ¨è¿­ä»£å™¨å†…åšäº†ä¸€ä¸ªå…‹éš†ã€‚è¿™å°†ä¸€ä¸ªå¼•ç”¨å˜æˆäº†ä¸€ä¸ªå€¼ã€‚</li>
<li><code>.by_ref()</code>ï¼Œå®ƒä½¿è¿­ä»£å™¨å–ä¸€ä¸ªå¼•ç”¨ã€‚è¿™å¾ˆå¥½çš„ä¿è¯äº†ä½ ä½¿ç”¨<code>Vec</code>æˆ–ç±»ä¼¼çš„æ–¹æ³•æ¥åˆ›å»ºè¿­ä»£å™¨åå¯ä»¥ä½¿ç”¨å®ƒã€‚</li>
<li>è®¸å¤šå…¶ä»–çš„<code>_while</code>æ–¹æ³•:<code>.skip_while()</code>ã€<code>.map_while()</code>ç­‰ç­‰ã€‚</li>
<li><code>.sum()</code>:å°±æ˜¯æŠŠæ‰€æœ‰çš„ä¸œè¥¿åŠ åœ¨ä¸€èµ·ã€‚</li>
</ul>
<p><code>.chunks()</code>å’Œ<code>.windows()</code>æ˜¯å°†çŸ¢é‡åˆ‡å‰²æˆä½ æƒ³è¦çš„å°ºå¯¸çš„ä¸¤ç§æ–¹æ³•ã€‚ä½ æŠŠä½ æƒ³è¦çš„å°ºå¯¸æ”¾åœ¨æ‹¬å·é‡Œã€‚æ¯”å¦‚è¯´ä½ æœ‰ä¸€ä¸ªæœ‰10ä¸ªå…ƒç´ çš„çŸ¢é‡ï¼Œä½ æƒ³è¦ä¸€ä¸ª3çš„å°ºå¯¸ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯è¿™æ ·çš„ã€‚</p>
<ul>
<li><p><code>.chunks()</code>ä¼šç»™ä½ 4ä¸ªåˆ‡ç‰‡: [0, 1, 2], ç„¶åæ˜¯[3, 4, 5], ç„¶åæ˜¯[6, 7, 8], æœ€åæ˜¯[9]. æ‰€ä»¥å®ƒä¼šå°è¯•ç”¨ä¸‰ä¸ªå…ƒç´ åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡ï¼Œä½†å¦‚æœå®ƒæ²¡æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå®ƒå°±ä¸ä¼šå´©æºƒã€‚å®ƒåªä¼šç»™ä½ å‰©ä¸‹çš„ä¸œè¥¿ã€‚</p>
</li>
<li><p><code>.windows()</code>ä¼šå…ˆç»™ä½ ä¸€ä¸ª[0, 1, 2]çš„åˆ‡ç‰‡ã€‚ç„¶åå®ƒå°†ç§»è¿‡ä¸€ç‰‡ï¼Œç»™ä½ [1, 2, 3]ã€‚å®ƒå°†ä¸€ç›´è¿™æ ·åšï¼Œç›´åˆ°æœ€ååˆ°è¾¾3çš„æœ€åä¸€ç‰‡ï¼Œç„¶ååœæ­¢ã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥è®©æˆ‘ä»¬åœ¨ä¸€ä¸ªç®€å•çš„æ•°å­—å‘é‡ä¸Šä½¿ç”¨å®ƒä»¬ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> chunk <span class="token keyword">in</span> num_vec<span class="token punctuation">.</span><span class="token function">chunks</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> window <span class="token keyword">in</span> num_vec<span class="token punctuation">.</span><span class="token function">windows</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> window<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[1, 2, 3]
[4, 5, 6]
[7, 8, 9]
[0]

[1, 2, 3]
[2, 3, 4]
[3, 4, 5]
[4, 5, 6]
[5, 6, 7]
[6, 7, 8]
[7, 8, 9]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœä½ ä»€ä¹ˆéƒ½ä¸ç»™å®ƒï¼Œ<code>.chunks()</code>ä¼šå´©æºƒã€‚ä½ å¯ä»¥ä¸ºä¸€ä¸ªåªæœ‰ä¸€é¡¹çš„å‘é‡å†™<code>.chunks(1000)</code>ï¼Œä½†ä½ ä¸èƒ½ä¸ºä»»ä½•é•¿åº¦ä¸º0çš„ä¸œè¥¿å†™<code>.chunks()</code>ã€‚ å¦‚æœä½ ç‚¹å‡»[src]ï¼Œä½ å¯ä»¥åœ¨å‡½æ•°ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå®ƒè¯´<code>assert!(chunk_size != 0);</code>ã€‚</p>
<p><code>.match_indices()</code> è®©ä½ æŠŠ <code>String</code> æˆ– <code>&amp;str</code> é‡Œé¢æ‰€æœ‰ç¬¦åˆä½ çš„è¾“å…¥çš„ä¸œè¥¿éƒ½æå–å‡ºæ¥ï¼Œå¹¶ç»™ä½ ç´¢å¼•ã€‚å®ƒä¸ <code>.enumerate()</code> ç±»ä¼¼ï¼Œå› ä¸ºå®ƒè¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„å…ƒç»„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rules <span class="token operator">=</span> <span class="token string">"Rule number 1: No fighting. Rule number 2: Go to bed at 8 pm. Rule number 3: Wake up at 6 am."</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> rule_locations <span class="token operator">=</span> rules<span class="token punctuation">.</span><span class="token function">match_indices</span><span class="token punctuation">(</span><span class="token string">"Rule"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is Vec&lt;usize, &amp;str&gt; but we just tell Rust to do it</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> rule_locations<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[(0, "Rule"), (28, "Rule"), (62, "Rule")]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<p><code>.peekable()</code> è®©ä½ åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œåœ¨é‚£é‡Œä½ å¯ä»¥çœ‹åˆ° (çª¥è§†) ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚å®ƒå°±åƒè°ƒç”¨ <code>.next()</code> (å®ƒç»™å‡ºäº†ä¸€ä¸ª <code>Option</code>)ï¼Œé™¤äº†è¿­ä»£å™¨ä¸ä¼šç§»åŠ¨ï¼Œæ‰€ä»¥ä½ å¯ä»¥éšæ„ä½¿ç”¨å®ƒã€‚å®é™…ä¸Šï¼Œä½ å¯ä»¥æŠŠpeekableçœ‹æˆæ˜¯ â€œå¯åœæ­¢â€çš„ï¼Œå› ä¸ºä½ å¯ä»¥æƒ³åœå¤šä¹…å°±åœå¤šä¹…ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªå…ƒç´ éƒ½ä½¿ç”¨<code>.peek()</code>ä¸‰æ¬¡ã€‚æˆ‘ä»¬å¯ä»¥æ°¸è¿œä½¿ç”¨<code>.peek()</code>ï¼Œç›´åˆ°æˆ‘ä»¬ä½¿ç”¨<code>.next()</code>ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> just_numbers <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> number_iter <span class="token operator">=</span> just_numbers<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">peekable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This actually creates a type of iterator called Peekable</span>

    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I love the number {}"</span><span class="token punctuation">,</span> number_iter<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I really love the number {}"</span><span class="token punctuation">,</span> number_iter<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is such a nice number"</span><span class="token punctuation">,</span> number_iter<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        number_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">I love the number 1
I really love the number 1
1 is such a nice number
I love the number 5
I really love the number 5
5 is such a nice number
I love the number 100
I really love the number 100
100 is such a nice number<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>.peek()</code>å¯¹ä¸€ä¸ªå…ƒç´ è¿›è¡ŒåŒ¹é…ã€‚ä½¿ç”¨å®Œåï¼Œæˆ‘ä»¬è°ƒç”¨<code>.next()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> locations <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token punctuation">(</span><span class="token string">"Nevis"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"Taber"</span><span class="token punctuation">,</span> <span class="token number">8428</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"Markerville"</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"Cardston"</span><span class="token punctuation">,</span> <span class="token number">3585</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> location_iter <span class="token operator">=</span> locations<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">peekable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> location_iter<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_some</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> location_iter<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token operator">*</span>number <span class="token operator">&lt;</span> <span class="token number">100</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// .peek() gives us a reference so we need *</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Found a hamlet: {} with {} people"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> number<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Found a town: {} with {} people"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token keyword">break</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        location_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Found a hamlet: Nevis with 25 people
Found a town: Taber with 8428 people
Found a hamlet: Markerville with 45 people
Found a town: Cardston with 3585 people<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€åï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨<code>.match_indices()</code>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®<code>&amp;str</code>ä¸­çš„ç©ºæ ¼æ•°ï¼Œå°†åå­—æ”¾å…¥<code>struct</code>ä¸­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Names</span> <span class="token punctuation">{</span>
    one_word<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    two_words<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    three_words<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> vec_of_names <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token string">"Caesar"</span><span class="token punctuation">,</span>
        <span class="token string">"Frodo Baggins"</span><span class="token punctuation">,</span>
        <span class="token string">"Bilbo Baggins"</span><span class="token punctuation">,</span>
        <span class="token string">"Jean-Luc Picard"</span><span class="token punctuation">,</span>
        <span class="token string">"Data"</span><span class="token punctuation">,</span>
        <span class="token string">"Rand Al'Thor"</span><span class="token punctuation">,</span>
        <span class="token string">"Paul Atreides"</span><span class="token punctuation">,</span>
        <span class="token string">"Barack Hussein Obama"</span><span class="token punctuation">,</span>
        <span class="token string">"Bill Jefferson Clinton"</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> iter_of_names <span class="token operator">=</span> vec_of_names<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">peekable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> all_names <span class="token operator">=</span> <span class="token class-name">Names</span> <span class="token punctuation">{</span> <span class="token comment">// start an empty Names struct</span>
        one_word<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        two_words<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        three_words<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> iter_of_names<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_some</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> next_item <span class="token operator">=</span> iter_of_names<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We can use .unwrap() because we know it is Some</span>
        <span class="token keyword">match</span> next_item<span class="token punctuation">.</span><span class="token function">match_indices</span><span class="token punctuation">(</span><span class="token char string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Create a quick vec using .match_indices and check the length</span>
            <span class="token number">0</span> <span class="token operator">=&gt;</span> all_names<span class="token punctuation">.</span>one_word<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>next_item<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token number">1</span> <span class="token operator">=&gt;</span> all_names<span class="token punctuation">.</span>two_words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>next_item<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=&gt;</span> all_names<span class="token punctuation">.</span>three_words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>next_item<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> all_names<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Names { one_word: ["Caesar", "Data"], two_words: ["Frodo Baggins", "Bilbo Baggins", "Jean-Luc Picard", "Rand Al\'Thor", "Paul Atreides"], three_words:
["Barack Hussein Obama", "Bill Jefferson Clinton"] }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<h2 id="dbgï¼å®å’Œ-inspect"><a href="#dbgï¼å®å’Œ-inspect" class="headerlink" title="dbgï¼å®å’Œ.inspect"></a>dbgï¼å®å’Œ.inspect</h2><p><code>dbg!</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å®ï¼Œå¯ä»¥å¿«é€Ÿæ‰“å°ä¿¡æ¯ã€‚å®ƒæ˜¯ <code>println!</code> çš„ä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£å“ï¼Œå› ä¸ºå®ƒçš„è¾“å…¥é€Ÿåº¦æ›´å¿«ï¼Œæä¾›çš„ä¿¡æ¯æ›´å¤šã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token macro property">dbg!</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°å‡º<code>[src\main.rs:4] my_number = 8</code>ã€‚</p>
<p>ä½†å®é™…ä¸Šï¼Œä½ å¯ä»¥æŠŠ<code>dbg!</code>æ”¾åœ¨å…¶ä»–å¾ˆå¤šåœ°æ–¹ï¼Œç”šè‡³å¯ä»¥æŠŠä»£ç åŒ…åœ¨é‡Œé¢ã€‚æ¯”å¦‚çœ‹è¿™æ®µä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_number <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    my_number <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> double_vec <span class="token operator">=</span> new_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯å˜æ•°å­—ï¼Œå¹¶æ”¹å˜äº†å®ƒã€‚ç„¶ååˆ›å»ºä¸€ä¸ªvecï¼Œå¹¶ä½¿ç”¨<code>iter</code>å’Œ<code>map</code>ä»¥åŠ<code>collect</code>åˆ›å»ºä¸€ä¸ªæ–°çš„vecã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥æŠŠ<code>dbg!</code>æ”¾åœ¨ä»»ä½•åœ°æ–¹ã€‚<code>dbg!</code>é—®ç¼–è¯‘å™¨ã€‚â€æ­¤åˆ»ä½ åœ¨åšä»€ä¹ˆï¼Ÿâ€ç„¶åå‘Šè¯‰ä½ ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_number <span class="token operator">=</span> <span class="token macro property">dbg!</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">dbg!</span><span class="token punctuation">(</span>my_number <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">dbg!</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> double_vec <span class="token operator">=</span> <span class="token macro property">dbg!</span><span class="token punctuation">(</span>new_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">dbg!</span><span class="token punctuation">(</span>double_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src\main.rs:3] 9 = 9<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å’Œã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src\main.rs:4] my_number += 10 = ()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å’Œã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src\main.rs:6] vec![8, 9, 10] = [
    8,
    9,
    10,
]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œè¿™ä¸ªï¼Œç”šè‡³å¯ä»¥æ˜¾ç¤ºå‡ºè¡¨è¾¾å¼çš„å€¼ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src\main.rs:8] new_vec.iter().map(|x| x * 2).collect::&lt;Vec&lt;i32&gt;&gt;() = [
    16,
    18,
    20,
]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å’Œã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src\main.rs:10] double_vec = [
    16,
    18,
    20,
]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p><code>.inspect</code> ä¸ <code>dbg!</code> æœ‰ç‚¹ç±»ä¼¼ï¼Œä½†ä½ åœ¨è¿­ä»£å™¨ä¸­ä½¿ç”¨å®ƒå°±åƒ <code>map</code>ã€‚å®ƒç»™äº†ä½ è¿­ä»£é¡¹ï¼Œä½ å¯ä»¥æ‰“å°å®ƒæˆ–è€…åšä»»ä½•ä½ æƒ³åšçš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å†çœ‹çœ‹æˆ‘ä»¬çš„ <code>double_vec</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> double_vec <span class="token operator">=</span> new_vec
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬æƒ³çŸ¥é“æ›´å¤šå…³äºä»£ç çš„ä¿¡æ¯ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ä¸¤ä¸ªåœ°æ–¹æ·»åŠ <code>inspect()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> double_vec <span class="token operator">=</span> new_vec
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">inspect</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>first_item<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The item is: {}"</span><span class="token punctuation">,</span> first_item<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">inspect</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>next_item<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Then it is: {}"</span><span class="token punctuation">,</span> next_item<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The item is: 8
Then it is: 16
The item is: 9
Then it is: 18
The item is: 10
Then it is: 20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œä¸”å› ä¸º<code>.inspect</code>é‡‡å–çš„æ˜¯å°é—­å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éšæ„å†™ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> double_vec <span class="token operator">=</span> new_vec
        <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">inspect</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>first_item<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The item is: {}"</span><span class="token punctuation">,</span> first_item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">match</span> <span class="token operator">*</span><span class="token operator">*</span>first_item <span class="token operator">%</span> <span class="token number">2</span> <span class="token punctuation">{</span> <span class="token comment">// first item is a &amp;&amp;i32 so we use **</span>
                <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It is even."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                _ <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It is odd."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"In binary it is {:b}."</span><span class="token punctuation">,</span> first_item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The item is: 8
It is even.
In binary it is 1000.
The item is: 9
It is odd.
In binary it is 1001.
The item is: 10
It is even.
In binary it is 1010.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="amp-strçš„ç±»å‹"><a href="#amp-strçš„ç±»å‹" class="headerlink" title="&amp;strçš„ç±»å‹"></a>&amp;strçš„ç±»å‹</h2><p><code>&amp;str</code>çš„ç±»å‹ä¸æ­¢ä¸€ç§ã€‚æˆ‘ä»¬æœ‰ã€‚</p>
<ul>
<li>å­—ç¬¦ä¸²: å½“ä½ å†™<code>let my_str = "I am a &amp;str"</code>çš„æ—¶å€™ï¼Œä½ å°±ä¼šäº§ç”Ÿè¿™äº›å­—ç¬¦ã€‚å®ƒä»¬åœ¨æ•´ä¸ªç¨‹åºä¸­æŒç»­å­˜åœ¨ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç›´æ¥å†™è¿›äºŒè¿›åˆ¶ä¸­çš„ï¼Œå®ƒä»¬çš„ç±»å‹æ˜¯ <code>&amp;'static str</code>ã€‚<code>'</code>çš„æ„æ€æ˜¯å®ƒçš„ç”Ÿå‘½æœŸï¼Œå­—ç¬¦ä¸²å­—å…ƒæœ‰ä¸€ä¸ªå«<code>static</code>çš„ç”Ÿå‘½æœŸã€‚</li>
<li>å€Ÿç”¨strã€‚è¿™æ˜¯å¸¸è§„çš„ <code>&amp;str</code> å½¢å¼ï¼Œæ²¡æœ‰ <code>static</code> ç”Ÿå‘½æœŸã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ª<code>String</code>ï¼Œå¹¶å¾—åˆ°äº†å®ƒçš„å¼•ç”¨ï¼Œå½“ä½ éœ€è¦å®ƒæ—¶ï¼ŒRustä¼šæŠŠå®ƒè½¬æ¢ä¸º<code>&amp;str</code>ã€‚æ¯”å¦‚è¯´</li>
</ul>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_str</span><span class="token punctuation">(</span>my_str<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// it can use &amp;String like a &amp;str</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am a string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we give prints_str a &amp;String</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯lifetimeå‘¢ï¼Ÿæˆ‘ä»¬ç°åœ¨å°±æ¥äº†è§£ä¸€ä¸‹ã€‚</p>
<h2 id="ç”Ÿå‘½æœŸ"><a href="#ç”Ÿå‘½æœŸ" class="headerlink" title="ç”Ÿå‘½æœŸ"></a>ç”Ÿå‘½æœŸ</h2><p>ç”Ÿå‘½æœŸçš„æ„æ€æ˜¯ â€œå˜é‡çš„ç”Ÿå‘½æœŸæœ‰å¤šé•¿â€ã€‚ä½ åªéœ€è¦è€ƒè™‘å¼•ç”¨çš„ç”Ÿå‘½æœŸã€‚è¿™æ˜¯å› ä¸ºå¼•ç”¨çš„ç”Ÿå‘½æœŸä¸èƒ½æ¯”å®ƒä»¬æ¥è‡ªçš„å¯¹è±¡æ›´é•¿ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¸èƒ½ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">returns_reference</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am a string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&amp;</span>my_string <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜æ˜¯<code>my_string</code>åªå­˜åœ¨äº<code>returns_reference</code>ä¸­ã€‚æˆ‘ä»¬è¯•å›¾è¿”å› <code>&amp;my_string</code>ï¼Œä½†æ˜¯ <code>&amp;my_string</code> ä¸èƒ½æ²¡æœ‰ <code>my_string</code>ã€‚æ‰€ä»¥ç¼–è¯‘å™¨è¯´ä¸è¡Œã€‚</p>
<p>è¿™ä¸ªä»£ç ä¹Ÿä¸è¡Œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">returns_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am a string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token string">"I am a str"</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_str <span class="token operator">=</span> <span class="token function">returns_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†å‡ ä¹æ˜¯æˆåŠŸçš„ã€‚ç¼–è¯‘å™¨è¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0106]: missing lifetime specifier
 --&gt; src\main.rs:6:21
  |
6 | fn returns_str() -&gt; &amp;str {
  |                     ^ expected named lifetime parameter
  |
  = help: this function's return type contains a borrowed value, but there is no value for it to be borrowed from
help: consider using the `'static` lifetime
  |
6 | fn returns_str() -&gt; &amp;'static str {
  |                     ^^^^^^^^<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>missing lifetime specifier</code>çš„æ„æ€æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ª<code>'</code>çš„ç”Ÿå‘½æœŸã€‚ç„¶åè¯´å®ƒ<code>contains a borrowed value, but there is no value for it to be borrowed from</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>I am a str</code>ä¸æ˜¯å€Ÿæ¥çš„ã€‚å®ƒå†™<code>&amp;'static str</code>å°±è¯´<code>consider using the 'static lifetime</code>ã€‚æ‰€ä»¥å®ƒè®¤ä¸ºæˆ‘ä»¬åº”è¯¥å°è¯•è¯´è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–‡å­—ã€‚</p>
<p>ç°åœ¨å®ƒå·¥ä½œäº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">returns_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am a string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token string">"I am a str"</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_str <span class="token operator">=</span> <span class="token function">returns_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿”å›äº†ä¸€ä¸ª <code>&amp;str</code>ï¼Œç”Ÿå‘½æœŸä¸º <code>static</code>ã€‚åŒæ—¶ï¼Œ<code>my_string</code>åªèƒ½ä»¥<code>String</code>çš„å½¢å¼è¿”å›:æˆ‘ä»¬ä¸èƒ½è¿”å›å¯¹å®ƒçš„å¼•ç”¨ï¼Œå› ä¸ºå®ƒå°†åœ¨ä¸‹ä¸€è¡Œæ­»äº¡ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨<code>fn returns_str() -&gt; &amp;'static str</code>å‘Šè¯‰Rustï¼Œ â€œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬åªä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡â€. å­—ç¬¦ä¸²å­—é¢é‡åœ¨æ•´ä¸ªç¨‹åºä¸­éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œæ‰€ä»¥Rustå¾ˆé«˜å…´ã€‚ä½ ä¼šæ³¨æ„åˆ°ï¼Œè¿™ä¸æ³›å‹ç±»ä¼¼ã€‚å½“æˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨ç±»ä¼¼ <code>&lt;T: Display&gt;</code> çš„ä¸œè¥¿æ—¶ï¼Œæˆ‘ä»¬æ‰¿è¯ºæˆ‘ä»¬å°†åªä½¿ç”¨å®ç°äº† <code>Display</code> çš„è¾“å…¥ã€‚ç”Ÿå‘½æœŸä¹Ÿç±»ä¼¼:æˆ‘ä»¬å¹¶æ²¡æœ‰æ”¹å˜ä»»ä½•å˜é‡çš„ç”Ÿå‘½æœŸã€‚æˆ‘ä»¬åªæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¾“å…¥çš„ç”Ÿå‘½æœŸæ˜¯å¤šå°‘ã€‚</p>
<p>ä½†æ˜¯<code>'static</code>å¹¶ä¸æ˜¯å”¯ä¸€çš„ç”Ÿå‘½æœŸã€‚å®é™…ä¸Šï¼Œæ¯ä¸ªå˜é‡éƒ½æœ‰ä¸€ä¸ªç”Ÿå‘½æœŸï¼Œä½†é€šå¸¸æˆ‘ä»¬ä¸å¿…å†™å‡ºæ¥ã€‚ç¼–è¯‘å™¨å¾ˆèªæ˜ï¼Œä¸€èˆ¬éƒ½èƒ½è‡ªå·±ç®—å‡ºæ¥ã€‚åªæœ‰åœ¨ç¼–è¯‘å™¨ä¸çŸ¥é“çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰éœ€è¦å†™å‡ºç”Ÿå‘½æœŸã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªç”Ÿå‘½æœŸçš„ä¾‹å­ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ª<code>City</code>ç»“æ„ï¼Œå¹¶ç»™å®ƒä¸€ä¸ª<code>&amp;str</code>çš„åå­—ã€‚æˆ‘ä»¬å¯èƒ½æƒ³è¿™æ ·åšï¼Œå› ä¸ºè¿™æ ·åšçš„æ€§èƒ½æ¯”ç”¨<code>String</code>å¿«ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™æ ·å†™ï¼Œä½†è¿˜ä¸èƒ½ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token comment">// âš ï¸</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_city <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Ichinomiya"</span><span class="token punctuation">,</span>
        date_founded<span class="token punctuation">:</span> <span class="token number">1921</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0106]: missing lifetime specifier
 --&gt; src\main.rs:3:11
  |
3 |     name: &amp;str,
  |           ^ expected named lifetime parameter
  |
help: consider introducing a named lifetime parameter
  |
2 | struct City&lt;'a&gt; {
3 |     name: &amp;'a str,
  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Rust éœ€è¦ <code>&amp;str</code> çš„ç”Ÿå‘½æœŸï¼Œå› ä¸º <code>&amp;str</code> æ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚å¦‚æœ<code>name</code>æŒ‡å‘çš„å€¼è¢«ä¸¢å¼ƒäº†ä¼šæ€æ ·ï¼Ÿé‚£å°±ä¸å®‰å…¨äº†ã€‚</p>
<p><code>'static</code>å‘¢ï¼Œèƒ½ç”¨å—ï¼Ÿæˆ‘ä»¬ä»¥å‰ç”¨è¿‡ã€‚æˆ‘ä»¬è¯•è¯•å§ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token comment">// change &amp;str to &amp;'static str</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_city <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Ichinomiya"</span><span class="token punctuation">,</span>
        date_founded<span class="token punctuation">:</span> <span class="token number">1921</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} was founded in {}"</span><span class="token punctuation">,</span> my_city<span class="token punctuation">.</span>name<span class="token punctuation">,</span> my_city<span class="token punctuation">.</span>date_founded<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¥½çš„ï¼Œè¿™å°±å¯ä»¥äº†ã€‚ä¹Ÿè®¸è¿™å°±æ˜¯ä½ æƒ³è¦çš„ç»“æ„ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬åªèƒ½æ¥å— â€œå­—ç¬¦ä¸²å­—é¢é‡â€ï¼Œæ‰€ä»¥ä¸èƒ½æ¥å—å¯¹å…¶ä»–ä¸œè¥¿çš„å¼•ç”¨ã€‚æ‰€ä»¥è¿™å°†æ— æ³•å·¥ä½œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'static</span> <span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token comment">// must live for the whole program</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> city_names <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Ichinomiya"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Kurume"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// city_names does not live for the whole program</span>

    <span class="token keyword">let</span> my_city <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token operator">&amp;</span>city_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// âš ï¸ This is a &amp;str, but not a &amp;'static str. It is a reference to a value inside city_names</span>
        date_founded<span class="token punctuation">:</span> <span class="token number">1921</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} was founded in {}"</span><span class="token punctuation">,</span> my_city<span class="token punctuation">.</span>name<span class="token punctuation">,</span> my_city<span class="token punctuation">.</span>date_founded<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0597]: `city_names` does not live long enough
  --&gt; src\main.rs:12:16
   |
12 |         name: &amp;city_names[0],
   |                ^^^^^^^^^^
   |                |
   |                borrowed value does not live long enough
   |                requires that `city_names` is borrowed for `'static`
...
18 | }
   | - `city_names` dropped here while still borrowed<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ç»™å®ƒçš„å¼•ç”¨å…¶å®å·²ç»å¤Ÿé•¿å¯¿äº†ã€‚ä½†æ˜¯æˆ‘ä»¬æ‰¿è¯ºåªç»™å®ƒä¸€ä¸ª<code>&amp;'static str</code>ï¼Œè¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°±è¯•è¯•ä¹‹å‰ç¼–è¯‘å™¨çš„å»ºè®®ã€‚å®ƒè¯´å°è¯•å†™<code>struct City&lt;'a&gt;</code>å’Œ<code>name: &amp;'a str</code>ã€‚è¿™å°±æ„å‘³ç€ï¼Œåªæœ‰å½“<code>name</code>æ´»åˆ°<code>City</code>ä¸€æ ·å¯¿å‘½çš„æƒ…å†µä¸‹ï¼Œå®ƒæ‰ä¼šæ¥å—<code>name</code>çš„å¼•ç”¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// City has lifetime 'a</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token comment">// and name also has lifetime 'a.</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> city_names <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Ichinomiya"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Kurume"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> my_city <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token operator">&amp;</span>city_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        date_founded<span class="token punctuation">:</span> <span class="token number">1921</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} was founded in {}"</span><span class="token punctuation">,</span> my_city<span class="token punctuation">.</span>name<span class="token punctuation">,</span> my_city<span class="token punctuation">.</span>date_founded<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–è®°ä½ï¼Œå¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥å†™ä»»ä½•ä¸œè¥¿æ¥ä»£æ›¿<code>'a</code>ã€‚è¿™ä¹Ÿå’Œæ³›å‹ç±»ä¼¼ï¼Œæˆ‘ä»¬å†™<code>T</code>å’Œ<code>U</code>ï¼Œä½†å®é™…ä¸Šå¯ä»¥å†™ä»»ä½•ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'city</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// The lifetime is now called 'city</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'city</span> <span class="token keyword">str</span><span class="token punctuation">,</span> <span class="token comment">// and name has the 'city lifetime</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä¸€èˆ¬éƒ½ä¼šå†™<code>'a, 'b, 'c</code>ç­‰ï¼Œå› ä¸ºè¿™æ ·å†™èµ·æ¥æ¯”è¾ƒå¿«ï¼Œä¹Ÿæ˜¯å¸¸ç”¨çš„å†™æ³•ã€‚ä½†å¦‚æœä½ æƒ³çš„è¯ï¼Œä½ å¯ä»¥éšæ—¶æ›´æ”¹ã€‚æœ‰ä¸€ä¸ªå¾ˆå¥½çš„å»ºè®®æ˜¯ï¼Œå¦‚æœä»£ç éå¸¸å¤æ‚ï¼ŒæŠŠç”Ÿå‘½æœŸæ”¹æˆä¸€ä¸ª â€œäººç±»å¯è¯»â€çš„åå­—å¯ä»¥å¸®åŠ©ä½ é˜…è¯»ä»£ç ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸traitçš„æ¯”è¾ƒï¼Œå¯¹äºæ³›å‹ã€‚æ¯”å¦‚è¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">prints</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"T is {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ å†™<code>T: Display</code>çš„æ—¶å€™ï¼Œå®ƒçš„æ„æ€æ˜¯ â€œåªæœ‰å½“Tæœ‰Displayæ—¶ï¼Œæ‰å–Tâ€ã€‚<br>è€Œä¸æ˜¯è¯´: â€œæˆ‘æŠŠDisplayç»™Tâ€.</p>
<p>å¯¹äºç”Ÿå‘½æœŸä¹Ÿæ˜¯å¦‚æ­¤ã€‚å½“ä½ åœ¨è¿™é‡Œå†™ â€˜a:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    date_founded<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ„æ€æ˜¯ â€œå¦‚æœ<code>name</code>çš„ç”Ÿå‘½æœŸè‡³å°‘ä¸<code>City</code>ä¸€æ ·é•¿ï¼Œæ‰æ¥å—<code>name</code>çš„è¾“å…¥â€ã€‚<br>å®ƒçš„æ„æ€ä¸æ˜¯è¯´: â€œæˆ‘ä¼šè®©<code>name</code>çš„è¾“å…¥ä¸<code>City</code>ä¸€æ ·é•¿å¯¿â€ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥äº†è§£ä¸€ä¸‹ä¹‹å‰çœ‹åˆ°çš„<code>&lt;'_&gt;</code>ã€‚è¿™è¢«ç§°ä¸º â€œåŒ¿åç”Ÿå‘½æœŸâ€ï¼Œæ˜¯ä½¿ç”¨å¼•ç”¨çš„ä¸€ä¸ªæŒ‡æ ‡ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åœ¨å®ç°ç»“æ„æ—¶ï¼ŒRustä¼šå‘ä½ å»ºè®®ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå‡ ä¹å¯ä»¥å·¥ä½œçš„ç»“æ„ï¼Œä½†è¿˜æ²¡æœ‰ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">    <span class="token comment">// âš ï¸</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Adventurer</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">take_damage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} has {} hit points left!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥æˆ‘ä»¬å¯¹<code>struct</code>åšäº†æˆ‘ä»¬éœ€è¦åšçš„äº‹æƒ…:é¦–å…ˆæˆ‘ä»¬è¯´<code>name</code>æ¥è‡ªäºä¸€ä¸ª<code>&amp;str</code>ã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦lifetimeï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™äº†å®ƒ<code>&lt;'a&gt;</code>ã€‚ç„¶åæˆ‘ä»¬å¿…é¡»å¯¹<code>struct</code>åšåŒæ ·çš„å¤„ç†ï¼Œä»¥è¯æ˜å®ƒä»¬è‡³å°‘å’Œè¿™ä¸ªç”Ÿå‘½æœŸä¸€æ ·é•¿ã€‚ä½†æ˜¯Rustå´å‘Šè¯‰æˆ‘ä»¬è¦è¿™æ ·åš:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0726]: implicit elided lifetime not allowed here
 --&gt; src\main.rs:6:6
  |
6 | impl Adventurer {
  |      ^^^^^^^^^^- help: indicate the anonymous lifetime: `&lt;'_&gt;`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæƒ³è®©æˆ‘ä»¬åŠ ä¸Šé‚£ä¸ªåŒ¿åçš„ç”Ÿå‘½æœŸï¼Œä»¥è¡¨æ˜æœ‰ä¸€ä¸ªå¼•ç”¨è¢«ä½¿ç”¨ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¿™æ ·å†™ï¼Œå®ƒå°±ä¼šå¾ˆé«˜å…´ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">take_damage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} has {} hit points left!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªç”Ÿå‘½æœŸæ˜¯ä¸ºäº†è®©ä½ ä¸å¿…æ€»æ˜¯å†™è¯¸å¦‚<code>impl&lt;'a&gt; Adventurer&lt;'a&gt;</code>è¿™æ ·çš„ä¸œè¥¿ï¼Œå› ä¸ºç»“æ„å·²ç»æ˜¾ç¤ºäº†ç”Ÿå‘½æœŸã€‚</p>
<p>åœ¨Rustä¸­ï¼Œç”Ÿå‘½æœŸæ˜¯å¾ˆå›°éš¾çš„ï¼Œä½†è¿™é‡Œæœ‰ä¸€äº›æŠ€å·§å¯ä»¥é¿å…å¯¹å®ƒä»¬å¤ªè¿‡ç´§å¼ ã€‚</p>
<ul>
<li>ä½ å¯ä»¥ç»§ç»­ä½¿ç”¨è‡ªæœ‰ç±»å‹ï¼Œä½¿ç”¨å…‹éš†ç­‰ï¼Œå¦‚æœä½ æƒ³æš‚æ—¶é¿å…å®ƒä»¬ã€‚</li>
<li>å¾ˆå¤šæ—¶å€™ï¼Œå½“ç¼–è¯‘å™¨æƒ³è¦lifetimeçš„æ—¶å€™ï¼Œä½ åªè¦åœ¨è¿™é‡Œå’Œé‚£é‡Œå†™ä¸Š&lt;â€™a&gt;å°±å¯ä»¥äº†ã€‚è¿™åªæ˜¯ä¸€ç§ â€œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä¸ä¼šç»™ä½ ä»»ä½•ä¸å¤Ÿé•¿å¯¿çš„ä¸œè¥¿â€çš„è¯´æ³•ã€‚</li>
<li>ä½ å¯ä»¥æ¯æ¬¡åªæ¢ç´¢ä¸€ä¸‹ç”Ÿå‘½æœŸã€‚å†™ä¸€äº›æ‹¥æœ‰å€¼çš„ä»£ç ï¼Œç„¶åæŠŠä¸€ä¸ªä»£ç å˜æˆä¸€ä¸ªå¼•ç”¨ã€‚ç¼–è¯‘å™¨ä¼šå¼€å§‹æŠ±æ€¨ï¼Œä½†ä¹Ÿä¼šç»™å‡ºä¸€äº›å»ºè®®ã€‚å¦‚æœå®ƒå˜å¾—å¤ªå¤æ‚ï¼Œä½ å¯ä»¥æ’¤é”€å®ƒï¼Œä¸‹æ¬¡å†è¯•ã€‚</li>
</ul>
<p>è®©æˆ‘ä»¬ç”¨æˆ‘ä»¬çš„ä»£ç æ¥åšè¿™ä¸ªï¼Œçœ‹çœ‹ç¼–è¯‘å™¨æ€ä¹ˆè¯´ã€‚é¦–å…ˆæˆ‘ä»¬å›å»æŠŠç”Ÿå‘½æœŸæ‹¿å‡ºæ¥ï¼ŒåŒæ—¶å®ç°<code>Display</code>ã€‚<code>Display</code>å°±æ‰“å°<code>Adventurer</code>çš„åå­—ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Adventurer</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Adventurer</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">take_damage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} has {} hit points left!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Adventurer</span> <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
            <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} has {} hit points."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¬¬ä¸€ä¸ªæŠ±æ€¨å°±æ˜¯è¿™ä¸ª:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0106]: missing lifetime specifier
 --&gt; src\main.rs:2:11
  |
2 |     name: &amp;str,
  |           ^ expected named lifetime parameter
  |
help: consider introducing a named lifetime parameter
  |
1 | struct Adventurer&lt;'a&gt; {
2 |     name: &amp;'a str,
  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒå»ºè®®æ€ä¹ˆåš:åœ¨Adventureråé¢åŠ ä¸Š<code>&lt;'a&gt;</code>ï¼Œä»¥åŠ<code>&amp;'a str</code>ã€‚æ‰€ä»¥æˆ‘ä»¬å°±è¿™ä¹ˆåšã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Adventurer</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">take_damage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} has {} hit points left!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Adventurer</span> <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
            <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} has {} hit points."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å®ƒå¯¹è¿™äº›éƒ¨åˆ†å¾ˆæ»¡æ„ï¼Œä½†å¯¹<code>impl</code>å—æ„Ÿåˆ°å¥‡æ€ªã€‚å®ƒå¸Œæœ›æˆ‘ä»¬æåˆ°å®ƒåœ¨ä½¿ç”¨å¼•ç”¨ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0726]: implicit elided lifetime not allowed here
 --&gt; src\main.rs:6:6
  |
6 | impl Adventurer {
  |      ^^^^^^^^^^- help: indicate the anonymous lifetime: `&lt;'_&gt;`

error[E0726]: implicit elided lifetime not allowed here
  --&gt; src\main.rs:12:28
   |
12 | impl std::fmt::Display for Adventurer {
   |                            ^^^^^^^^^^- help: indicate the anonymous lifetime: `&lt;'_&gt;`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¥½äº†ï¼Œæˆ‘ä»¬å°†è¿™äº›å†™è¿›å»â€¦â€¦ç°åœ¨å®ƒå·¥ä½œäº†ï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>Adventurer</code>ï¼Œç„¶åç”¨å®ƒåšä¸€äº›äº‹æƒ…:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">take_damage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points <span class="token operator">-=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} has {} hit points left!"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Adventurer</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>

        <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
            <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} has {} hit points."</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>hit_points<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> billy <span class="token operator">=</span> <span class="token class-name">Adventurer</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">,</span>
        hit_points<span class="token punctuation">:</span> <span class="token number">100_000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> billy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    billy<span class="token punctuation">.</span><span class="token function">take_damage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Billy has 100000 hit points.
Billy has 99980 hit points left!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ï¼Œlifetimeså¾€å¾€åªæ˜¯ç¼–è¯‘å™¨æƒ³è¦ç¡®å®šã€‚è€Œä¸”å®ƒé€šå¸¸å¾ˆèªæ˜ï¼Œå‡ ä¹å¯ä»¥çŒœåˆ°ä½ æƒ³è¦çš„ç”Ÿå‘½æœŸï¼Œåªéœ€è¦ä½ å‘Šè¯‰å®ƒï¼Œå®ƒå°±å¯ä»¥ç¡®å®šäº†ã€‚</p>
<h2 id="å†…éƒ¨å¯å˜æ€§"><a href="#å†…éƒ¨å¯å˜æ€§" class="headerlink" title="å†…éƒ¨å¯å˜æ€§"></a>å†…éƒ¨å¯å˜æ€§</h2><h3 id="Cell"><a href="#Cell" class="headerlink" title="Cell"></a>Cell</h3><p><strong>å†…éƒ¨å¯å˜æ€§</strong>çš„æ„æ€æ˜¯åœ¨å†…éƒ¨æœ‰ä¸€ç‚¹å¯å˜æ€§ã€‚è¿˜è®°å¾—åœ¨Rustä¸­ï¼Œä½ éœ€è¦ç”¨<code>mut</code>æ¥æ”¹å˜ä¸€ä¸ªå˜é‡å—ï¼Ÿä¹Ÿæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥ä¸ç”¨<code>mut</code>è¿™ä¸ªè¯æ¥æ”¹å˜å®ƒä»¬ã€‚è¿™æ˜¯å› ä¸ºRustæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è®©ä½ å®‰å…¨åœ°åœ¨ä¸€ä¸ªä¸å¯å˜çš„ç»“æ„é‡Œé¢æ”¹å˜å€¼ã€‚æ¯ä¸€ç§æ–¹æ³•éƒ½éµå¾ªä¸€äº›è§„åˆ™ï¼Œç¡®ä¿æ”¹å˜å€¼ä»ç„¶æ˜¯å®‰å…¨çš„ã€‚</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¼šæƒ³è¦è¿™æ ·åš:æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªå«<code>PhoneModel</code>çš„ç»“æ„ä½“æœ‰å¾ˆå¤šå­—æ®µ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">PhoneModel</span> <span class="token punctuation">{</span>
    company_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    model_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    screen_size<span class="token punctuation">:</span> <span class="token keyword">f32</span><span class="token punctuation">,</span>
    memory<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
    date_issued<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    on_sale<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> super_phone_3000 <span class="token operator">=</span> <span class="token class-name">PhoneModel</span> <span class="token punctuation">{</span>
        company_name<span class="token punctuation">:</span> <span class="token string">"YY Electronics"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        model_name<span class="token punctuation">:</span> <span class="token string">"Super Phone 3000"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        screen_size<span class="token punctuation">:</span> <span class="token number">7.5</span><span class="token punctuation">,</span>
        memory<span class="token punctuation">:</span> <span class="token number">4_000_000</span><span class="token punctuation">,</span>
        date_issued<span class="token punctuation">:</span> <span class="token number">2020</span><span class="token punctuation">,</span>
        on_sale<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>PhoneModel</code>ä¸­çš„å­—æ®µæœ€å¥½æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›æ•°æ®æ”¹å˜ã€‚æ¯”å¦‚è¯´<code>date_issued</code>å’Œ<code>screen_size</code>æ°¸è¿œä¸ä¼šå˜ã€‚</p>
<p>ä½†æ˜¯é‡Œé¢æœ‰ä¸€ä¸ªå­—æ®µå«<code>on_sale</code>ã€‚ä¸€ä¸ªæ‰‹æœºå‹å·å…ˆæ˜¯ä¼šæœ‰é”€å”®(<code>true</code>)ï¼Œä½†æ˜¯åæ¥å…¬å¸ä¼šåœæ­¢é”€å”®ã€‚æˆ‘ä»¬èƒ½ä¸èƒ½åªè®©è¿™ä¸€ä¸ªå­—æ®µå¯å˜ï¼Ÿå› ä¸ºæˆ‘ä»¬ä¸æƒ³å†™<code>let mut super_phone_3000</code>ã€‚å¦‚æœæˆ‘ä»¬è¿™æ ·åšï¼Œé‚£ä¹ˆæ¯ä¸ªå­—æ®µéƒ½ä¼šå˜å¾—å¯å˜ã€‚</p>
<p>Rustæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è®©ä¸€äº›ä¸å¯å˜çš„ä¸œè¥¿é‡Œé¢æœ‰ä¸€äº›å®‰å…¨çš„å¯å˜æ€§ï¼Œæœ€ç®€å•çš„æ–¹æ³•å«åš<code>Cell</code>ã€‚é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>use std::cell::Cell</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ¯æ¬¡åªå†™<code>Cell</code>è€Œä¸æ˜¯<code>std::cell::Cell</code>ã€‚</p>
<p>ç„¶åæˆ‘ä»¬æŠŠ<code>on_sale: bool</code>æ”¹æˆ<code>on_sale: Cell&lt;bool&gt;</code>ã€‚ç°åœ¨å®ƒä¸æ˜¯ä¸€ä¸ªbool:å®ƒæ˜¯ä¸€ä¸ª<code>Cell</code>ï¼Œå®¹çº³äº†ä¸€ä¸ª<code>bool</code>ã€‚</p>
<p><code>Cell</code>æœ‰ä¸€ä¸ªå«åš<code>.set()</code>çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥æ”¹å˜å€¼ã€‚æˆ‘ä»¬ç”¨<code>.set()</code>æŠŠ<code>on_sale: true</code>æ”¹ä¸º<code>on_sale: Cell::new(true)</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token class-name">Cell</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">PhoneModel</span> <span class="token punctuation">{</span>
    company_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    model_name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    screen_size<span class="token punctuation">:</span> <span class="token keyword">f32</span><span class="token punctuation">,</span>
    memory<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
    date_issued<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    on_sale<span class="token punctuation">:</span> <span class="token class-name">Cell</span><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> super_phone_3000 <span class="token operator">=</span> <span class="token class-name">PhoneModel</span> <span class="token punctuation">{</span>
        company_name<span class="token punctuation">:</span> <span class="token string">"YY Electronics"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        model_name<span class="token punctuation">:</span> <span class="token string">"Super Phone 3000"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        screen_size<span class="token punctuation">:</span> <span class="token number">7.5</span><span class="token punctuation">,</span>
        memory<span class="token punctuation">:</span> <span class="token number">4_000_000</span><span class="token punctuation">,</span>
        date_issued<span class="token punctuation">:</span> <span class="token number">2020</span><span class="token punctuation">,</span>
        on_sale<span class="token punctuation">:</span> <span class="token class-name">Cell</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 10 years later, super_phone_3000 is not on sale anymore</span>
    super_phone_3000<span class="token punctuation">.</span>on_sale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Cell</code> é€‚ç”¨äºæ‰€æœ‰ç±»å‹ï¼Œä½†å¯¹ç®€å•çš„ Copy ç±»å‹æ•ˆæœæœ€å¥½ï¼Œå› ä¸ºå®ƒç»™å‡ºçš„æ˜¯å€¼ï¼Œè€Œä¸æ˜¯å¼•ç”¨ã€‚<code>Cell</code>æœ‰ä¸€ä¸ªå«åš<code>get()</code>çš„æ–¹æ³•ï¼Œå®ƒåªå¯¹Copyç±»å‹æœ‰æ•ˆã€‚</p>
<p>å¦ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„ç±»å‹æ˜¯ <code>RefCell</code>ã€‚</p>
<h3 id="RefCell"><a href="#RefCell" class="headerlink" title="RefCell"></a>RefCell</h3><p><code>RefCell</code>æ˜¯å¦ä¸€ç§æ— éœ€å£°æ˜<code>mut</code>è€Œæ”¹å˜å€¼çš„æ–¹æ³•ã€‚å®ƒçš„æ„æ€æ˜¯ â€œå¼•ç”¨å•å…ƒæ ¼â€ï¼Œå°±åƒ <code>Cell</code>ï¼Œä½†ä½¿ç”¨å¼•ç”¨è€Œä¸æ˜¯å‰¯æœ¬ã€‚</p>
<p>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª <code>User</code> ç»“æ„ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒä¸ <code>Cell</code> ç±»ä¼¼ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token class-name">RefCell</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    year_registered<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    active<span class="token punctuation">:</span> <span class="token class-name">RefCell</span><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token comment">// Many other fields</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user_1 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        year_registered<span class="token punctuation">:</span> <span class="token number">2020</span><span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> <span class="token string">"User 1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token class-name">RefCell</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> user_1<span class="token punctuation">.</span>active<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°å‡º<code>RefCell { value: true }</code>ã€‚</p>
<p><code>RefCell</code>çš„æ–¹æ³•æœ‰å¾ˆå¤šã€‚å…¶ä¸­ä¸¤ç§æ˜¯<code>.borrow()</code>å’Œ<code>.borrow_mut()</code>ã€‚ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œä½ å¯ä»¥åšä¸<code>&amp;</code>å’Œ<code>&amp;mut</code>ç›¸åŒçš„äº‹æƒ…ã€‚è§„åˆ™éƒ½æ˜¯ä¸€æ ·çš„:</p>
<ul>
<li>å¤šä¸ªä¸å¯å˜å€Ÿç”¨å¯ä»¥</li>
<li>ä¸€ä¸ªå¯å˜çš„å€Ÿç”¨å¯ä»¥</li>
<li>ä½†mutableå’Œimmutableå€Ÿç”¨åœ¨ä¸€èµ·æ˜¯ä¸è¡Œçš„</li>
</ul>
<p>æ‰€ä»¥æ”¹å˜<code>RefCell</code>ä¸­çš„å€¼æ˜¯éå¸¸å®¹æ˜“çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
user_1<span class="token punctuation">.</span>active<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> user_1<span class="token punctuation">.</span>active<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è€Œä¸”è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚<code>replace_with</code>ä½¿ç”¨çš„æ˜¯é—­åŒ…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token number">2020</span><span class="token punctuation">;</span>

user_1
    <span class="token punctuation">.</span>active
    <span class="token punctuation">.</span><span class="token function">replace_with</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>_<span class="token closure-punctuation punctuation">|</span></span> <span class="token keyword">if</span> date <span class="token operator">&lt;</span> <span class="token number">2000</span> <span class="token punctuation">{</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> user_1<span class="token punctuation">.</span>active<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>ä½†æ˜¯ä½ è¦å°å¿ƒä½¿ç”¨<code>RefCell</code>ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨è¿è¡Œæ—¶è€Œä¸æ˜¯ç¼–è¯‘æ—¶æ£€æŸ¥å€Ÿç”¨ã€‚è¿è¡Œæ—¶æ˜¯æŒ‡ç¨‹åºå®é™…è¿è¡Œçš„æ—¶å€™(ç¼–è¯‘å)ã€‚æ‰€ä»¥è¿™å°†ä¼šè¢«ç¼–è¯‘ï¼Œå³ä½¿å®ƒæ˜¯é”™è¯¯çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token class-name">RefCell</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    year_registered<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    active<span class="token punctuation">:</span> <span class="token class-name">RefCell</span><span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token comment">// Many other fields</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user_1 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        year_registered<span class="token punctuation">:</span> <span class="token number">2020</span><span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> <span class="token string">"User 1"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token class-name">RefCell</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> borrow_one <span class="token operator">=</span> user_1<span class="token punctuation">.</span>active<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// first mutable borrow - okay</span>
    <span class="token keyword">let</span> borrow_two <span class="token operator">=</span> user_1<span class="token punctuation">.</span>active<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// second mutable borrow - not okay</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†å¦‚æœä½ è¿è¡Œå®ƒï¼Œå®ƒå°±ä¼šç«‹å³å´©æºƒã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">thread 'main' panicked at 'already borrowed: BorrowMutError', C:\Users\mithr\.rustup\toolchains\stable-x86_64-pc-windows-msvc\lib/rustlib/src/rust\src\libcore\cell.rs:877:9
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: process didn't exit successfully: `target\debug\rust_book.exe` (exit code: 101)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>already borrowed: BorrowMutError</code>æ˜¯é‡è¦çš„éƒ¨åˆ†ã€‚æ‰€ä»¥å½“ä½ ä½¿ç”¨<code>RefCell</code>æ—¶ï¼Œå¥½ç¼–è¯‘<strong>å¹¶</strong>è¿è¡Œæ£€æŸ¥ã€‚</p>
<h3 id="Mutex"><a href="#Mutex" class="headerlink" title="Mutex"></a>Mutex</h3><p><code>Mutex</code>æ˜¯å¦ä¸€ç§æ”¹å˜æ•°å€¼çš„æ–¹æ³•ï¼Œä¸éœ€è¦å£°æ˜<code>mut</code>ã€‚Mutexçš„æ„æ€æ˜¯<code>mutual exclusion</code>ï¼Œä¹Ÿå°±æ˜¯ â€œä¸€æ¬¡åªèƒ½æ”¹ä¸€ä¸ªâ€ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ<code>Mutex</code>æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒæ¯æ¬¡åªè®©ä¸€ä¸ªè¿›ç¨‹æ”¹å˜å®ƒã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œå®ƒä½¿ç”¨äº†<code>.lock()</code>ã€‚<code>Lock</code>å°±åƒä»é‡Œé¢é”ä¸Šä¸€æ‰‡é—¨ã€‚ä½ è¿›å…¥ä¸€ä¸ªæˆ¿é—´ï¼Œé”ä¸Šé—¨ï¼Œç°åœ¨ä½ å¯ä»¥åœ¨æˆ¿é—´é‡Œé¢æ”¹å˜ä¸œè¥¿ã€‚åˆ«äººä¸èƒ½è¿›æ¥é˜»æ­¢ä½ ï¼Œå› ä¸ºä½ æŠŠé—¨é”ä¸Šäº†ã€‚</p>
<p><code>Mutex</code>é€šè¿‡ä¾‹å­æ›´å®¹æ˜“ç†è§£:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// A new Mutex&lt;i32&gt;. We don't need to say mut</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// mutex_changer is a MutexGuard</span>
                                                     <span class="token comment">// It has to be mut because we will change it</span>
                                                     <span class="token comment">// Now it has access to the Mutex</span>
                                                     <span class="token comment">// Let's print my_mutex to see:</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This prints "Mutex { data: &lt;locked&gt; }"</span>
                                <span class="token comment">// So we can't access the data with my_mutex now,</span>
                                <span class="token comment">// only with mutex_changer</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> mutex_changer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This prints 5. Let's change it to 6.</span>

    <span class="token operator">*</span>mutex_changer <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// mutex_changer is a MutexGuard&lt;i32&gt; so we use * to change the i32</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> mutex_changer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it says 6</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯<code>mutex_changer</code>åšå®Œåè¿˜æ˜¯æœ‰é”ã€‚æˆ‘ä»¬è¯¥å¦‚ä½•é˜»æ­¢å®ƒå‘¢ï¼Ÿ<code>Mutex</code>åœ¨<code>MutexGuard</code>è¶…å‡ºèŒƒå›´æ—¶å°±ä¼šè¢«è§£é”ã€‚â€è¶…å‡ºèŒƒå›´â€è¡¨ç¤ºè¯¥ä»£ç å—å·²ç»å®Œæˆã€‚æ¯”å¦‚è¯´:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span>mutex_changer <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">// mutex_changer goes out of scope - now it is gone. It is not locked anymore</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it says: Mutex { data: 6 }</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ä¸åŒçš„<code>{}</code>ä»£ç å—ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>std::mem::drop(mutex_changer)</code>ã€‚<code>std::mem::drop</code>çš„æ„æ€æ˜¯ â€œè®©è¿™ä¸ªè¶…å‡ºèŒƒå›´â€ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>mutex_changer <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">drop</span><span class="token punctuation">(</span>mutex_changer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// drop mutex_changer - it is gone now</span>
                                   <span class="token comment">// and my_mutex is unlocked</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it says: Mutex { data: 6 }</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¿…é¡»å°å¿ƒä½¿ç”¨ <code>Mutex</code>ï¼Œå› ä¸ºå¦‚æœå¦ä¸€ä¸ªå˜é‡è¯•å›¾ <code>lock</code>å®ƒï¼Œå®ƒä¼šç­‰å¾…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// mutex_changer has the lock</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> other_mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// other_mutex_changer wants the lock</span>
                                                            <span class="token comment">// the program is waiting</span>
                                                            <span class="token comment">// and waiting</span>
                                                            <span class="token comment">// and will wait forever.</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This will never print..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯<code>try_lock()</code>ã€‚ç„¶åå®ƒä¼šè¯•ä¸€æ¬¡ï¼Œå¦‚æœæ²¡èƒ½é”ä¸Šå°±ä¼šæ”¾å¼ƒã€‚<code>try_lock().unwrap()</code>å°±ä¸è¦åšäº†ï¼Œå› ä¸ºå¦‚æœä¸æˆåŠŸå®ƒå°±ä¼šå´©æºƒã€‚<code>if let</code>æˆ–<code>match</code>æ¯”è¾ƒå¥½ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> other_mutex_changer <span class="token operator">=</span> my_mutex<span class="token punctuation">.</span><span class="token function">try_lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// try to get the lock</span>

    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=</span> other_mutex_changer <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The MutexGuard has: {}"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Didn't get the lock"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–ï¼Œä½ ä¸éœ€è¦åˆ›å»ºä¸€ä¸ªå˜é‡æ¥æ”¹å˜<code>Mutex</code>ã€‚ä½ å¯ä»¥ç›´æ¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">*</span>my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>*my_mutex.lock().unwrap() = 6;</code>çš„æ„æ€æ˜¯ â€œè§£é”my_mutexå¹¶ä½¿å…¶æˆä¸º6â€ã€‚æ²¡æœ‰ä»»ä½•å˜é‡æ¥ä¿å­˜å®ƒï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦è°ƒç”¨ <code>std::mem::drop</code>ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥åš100æ¬¡â€“è¿™å¹¶ä¸é‡è¦ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">Mutex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_mutex <span class="token operator">=</span> <span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>my_mutex<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// locks and unlocks 100 times</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_mutex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="RwLock"><a href="#RwLock" class="headerlink" title="RwLock"></a>RwLock</h3><p><code>RwLock</code>çš„æ„æ€æ˜¯ â€œè¯»å†™é”â€ã€‚å®ƒåƒ<code>Mutex</code>ï¼Œä½†ä¹Ÿåƒ<code>RefCell</code>ã€‚ä½ ç”¨<code>.write().unwrap()</code>ä»£æ›¿<code>.lock().unwrap()</code>æ¥æ”¹å˜å®ƒã€‚ä½†ä½ ä¹Ÿå¯ä»¥ç”¨<code>.read().unwrap()</code>æ¥è·å¾—è¯»æƒé™ã€‚å®ƒå’Œ<code>RefCell</code>ä¸€æ ·ï¼Œéµå¾ªè¿™äº›è§„åˆ™:</p>
<ul>
<li>å¾ˆå¤š<code>.read()</code>å˜é‡å¯ä»¥</li>
<li>ä¸€ä¸ª<code>.write()</code>å˜é‡å¯ä»¥</li>
<li>ä½†å¤šä¸ª<code>.write()</code>æˆ–<code>.read()</code>ä¸<code>.write()</code>ä¸€èµ·æ˜¯ä¸è¡Œçš„</li>
</ul>
<p>å¦‚æœåœ¨æ— æ³•è®¿é—®çš„æƒ…å†µä¸‹å°è¯•<code>.write()</code>ï¼Œç¨‹åºå°†æ°¸è¿œè¿è¡Œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">RwLock</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_rwlock <span class="token operator">=</span> <span class="token class-name">RwLock</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> read1 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// one .read() is fine</span>
    <span class="token keyword">let</span> read2 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// two .read()s is also fine</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}"</span><span class="token punctuation">,</span> read1<span class="token punctuation">,</span> read2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> write1 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// uh oh, now the program will wait forever</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥æˆ‘ä»¬ç”¨<code>std::mem::drop</code>ï¼Œå°±åƒç”¨<code>Mutex</code>ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">RwLock</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span>drop<span class="token punctuation">;</span> <span class="token comment">// We will use drop() many times</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_rwlock <span class="token operator">=</span> <span class="token class-name">RwLock</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> read1 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> read2 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {:?}"</span><span class="token punctuation">,</span> read1<span class="token punctuation">,</span> read2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">drop</span><span class="token punctuation">(</span>read1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">drop</span><span class="token punctuation">(</span>read2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// we dropped both, so we can use .write() now</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> write1 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>write1 <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token function">drop</span><span class="token punctuation">(</span>write1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_rwlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œä¸”ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>try_read()</code>å’Œ<code>try_write()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token class-name">RwLock</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_rwlock <span class="token operator">=</span> <span class="token class-name">RwLock</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> read1 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> read2 <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token keyword">mut</span> number<span class="token punctuation">)</span> <span class="token operator">=</span> my_rwlock<span class="token punctuation">.</span><span class="token function">try_write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token operator">*</span>number <span class="token operator">+=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Now the number is {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Couldn't get write access, sorry!"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Cow"><a href="#Cow" class="headerlink" title="Cow"></a>Cow</h2><p>Cowæ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„æšä¸¾ã€‚å®ƒçš„æ„æ€æ˜¯ â€œå†™æ—¶å…‹éš†â€ï¼Œå¦‚æœä½ ä¸éœ€è¦<code>String</code>ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ª<code>&amp;str</code>ï¼Œå¦‚æœä½ éœ€è¦ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ª<code>String</code>ã€‚(å®ƒä¹Ÿå¯ä»¥å¯¹æ•°ç»„ä¸Vecç­‰åšåŒæ ·çš„å¤„ç†)ã€‚</p>
<p>ä¸ºäº†ç†è§£å®ƒï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ç­¾åã€‚å®ƒè¯´</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">Cow</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token class-name">B</span><span class="token operator">&gt;</span>
<span class="token keyword">where</span>
    <span class="token class-name">B</span><span class="token punctuation">:</span> <span class="token lifetime-annotation symbol">'a</span> <span class="token operator">+</span> <span class="token class-name">ToOwned</span> <span class="token operator">+</span> <span class="token operator">?</span><span class="token class-name">Sized</span><span class="token punctuation">,</span>
 <span class="token punctuation">{</span>
    <span class="token class-name">Borrowed</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">B</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Owned</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token class-name">B</span> <span class="token keyword">as</span> <span class="token class-name">ToOwned</span><span class="token operator">&gt;</span><span class="token punctuation">::</span><span class="token class-name">Owned</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ é©¬ä¸Šå°±çŸ¥é“ï¼Œ<code>'a</code>æ„å‘³ç€å®ƒå¯ä»¥å’Œå¼•ç”¨ä¸€èµ·å·¥ä½œã€‚<code>ToOwned</code>çš„ç‰¹æ€§æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå¯ä»¥å˜æˆæ‹¥æœ‰ç±»å‹çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ<code>str</code>é€šå¸¸æ˜¯ä¸€ä¸ªå¼•ç”¨(<code>&amp;str</code>)ï¼Œä½ å¯ä»¥æŠŠå®ƒå˜æˆä¸€ä¸ªæ‹¥æœ‰çš„<code>String</code>ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯<code>?Sized</code>ã€‚è¿™æ„å‘³ç€ â€œä¹Ÿè®¸æ˜¯Sizedï¼Œä½†ä¹Ÿè®¸ä¸æ˜¯â€ã€‚Rustä¸­å‡ ä¹æ¯ä¸ªç±»å‹éƒ½æ˜¯Sizedçš„ï¼Œä½†åƒ<code>str</code>è¿™æ ·çš„ç±»å‹å´ä¸æ˜¯ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ª <code>&amp;</code> æ¥ä»£æ›¿ <code>str</code>ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸çŸ¥é“å¤§å°ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ªå¯ä»¥ä½¿ç”¨ <code>str</code> è¿™æ ·çš„traitï¼Œä½ å¯ä»¥æ·»åŠ  <code>?Sized.</code></p>
<p>æ¥ä¸‹æ¥æ˜¯<code>enum</code>çš„å˜ç§ã€‚å®ƒä»¬æ˜¯ <code>Borrowed</code> å’Œ <code>Owned</code>ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªè¿”å› <code>Cow&lt;'static, str&gt;</code> çš„å‡½æ•°ã€‚å¦‚æœä½ å‘Šè¯‰å‡½æ•°è¿”å›<code>"My message".into()</code>ï¼Œå®ƒå°±ä¼šæŸ¥çœ‹ç±»å‹:â€My messageâ€æ˜¯<code>str</code>. è¿™æ˜¯ä¸€ä¸ª<code>Borrowed</code>çš„ç±»å‹ï¼Œæ‰€ä»¥å®ƒé€‰æ‹©<code>Borrowed(&amp;'a B)</code>ã€‚æ‰€ä»¥å®ƒå°±å˜æˆäº†<code>Cow::Borrowed(&amp;'static str)</code>ã€‚</p>
<p>è€Œå¦‚æœä½ ç»™å®ƒä¸€ä¸ª<code>format!("{}", "My message").into()</code>ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæŸ¥çœ‹ç±»å‹ã€‚è¿™æ¬¡æ˜¯ä¸€ä¸ª<code>String</code>ï¼Œå› ä¸º<code>format!</code>åˆ›å»ºäº†<code>String</code>ã€‚æ‰€ä»¥è¿™æ¬¡ä¼šé€‰æ‹© â€œOwnedâ€ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•<code>Cow</code>çš„ä¾‹å­ã€‚æˆ‘ä»¬å°†æŠŠä¸€ä¸ªæ•°å­—æ”¾å…¥ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè¿”å›ä¸€ä¸ª<code>Cow&lt;'static, str&gt;</code>ã€‚æ ¹æ®è¿™ä¸ªæ•°å­—ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ª<code>&amp;str</code>æˆ–<code>String</code>ã€‚ç„¶åå®ƒä½¿ç”¨<code>.into()</code>å°†å…¶å˜æˆ<code>Cow</code>ã€‚è¿™æ ·åšçš„æ—¶å€™ï¼Œå®ƒå°±ä¼šé€‰æ‹©<code>Cow::Borrowed</code>æˆ–è€…<code>Cow::Owned</code>ã€‚é‚£æˆ‘ä»¬å°±åŒ¹é…ä¸€ä¸‹ï¼Œçœ‹çœ‹å®ƒé€‰çš„æ˜¯å“ªä¸€ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>borrow<span class="token punctuation">::</span></span><span class="token class-name">Cow</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">modulo_3</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Cow</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'static</span><span class="token punctuation">,</span> <span class="token keyword">str</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> input <span class="token operator">%</span> <span class="token number">3</span> <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token string">"Remainder is 0"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token string">"Remainder is 1"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        remainder <span class="token operator">=&gt;</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"Remainder is {}"</span><span class="token punctuation">,</span> remainder<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token number">1</span><span class="token punctuation">..=</span><span class="token number">6</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token function">modulo_3</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Cow</span><span class="token punctuation">::</span><span class="token class-name">Borrowed</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} went in. The Cow is borrowed with this message: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Cow</span><span class="token punctuation">::</span><span class="token class-name">Owned</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} went in. The Cow is owned with this message: {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">1 went in. The Cow is borrowed with this message: Remainder is 1
2 went in. The Cow is owned with this message: Remainder is 2
3 went in. The Cow is borrowed with this message: Remainder is 0
4 went in. The Cow is borrowed with this message: Remainder is 1
5 went in. The Cow is owned with this message: Remainder is 2
6 went in. The Cow is borrowed with this message: Remainder is 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Cow</code>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚<code>into_owned</code> æˆ–è€… <code>into_borrowed</code>ï¼Œè¿™æ ·å¦‚æœä½ éœ€è¦çš„è¯ï¼Œä½ å¯ä»¥æ”¹å˜å®ƒã€‚</p>
<h2 id="ç±»å‹åˆ«å"><a href="#ç±»å‹åˆ«å" class="headerlink" title="ç±»å‹åˆ«å"></a>ç±»å‹åˆ«å</h2><p>ç±»å‹åˆ«åçš„æ„æ€æ˜¯ â€œç»™æŸä¸ªç±»å‹ä¸€ä¸ªæ–°çš„åå­—â€ã€‚ç±»å‹åˆ«åéå¸¸ç®€å•ã€‚é€šå¸¸ï¼Œå½“æ‚¨æœ‰ä¸€ä¸ªå¾ˆé•¿çš„ç±»å‹ï¼Œè€Œåˆä¸æƒ³æ¯æ¬¡éƒ½å†™å®ƒæ—¶ï¼Œæ‚¨å°±ä¼šä½¿ç”¨å®ƒä»¬ã€‚å½“æ‚¨æƒ³ç»™ä¸€ä¸ªç±»å‹èµ·ä¸€ä¸ªæ›´å¥½çš„åå­—ï¼Œä¾¿äºè®°å¿†æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªç±»å‹åˆ«åçš„ä¾‹å­ã€‚</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªä¸éš¾çš„ç±»å‹ï¼Œä½†æ˜¯ä½ æƒ³è®©ä½ çš„ä»£ç æ›´å®¹æ˜“è¢«å…¶ä»–äºº(æˆ–è€…ä½ )ç†è§£ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">type</span> <span class="token class-name">CharacterVec</span> <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<p>è¿™æ˜¯ä¸€ç§éå¸¸éš¾è¯»çš„ç±»å‹:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// this return type is extremely long</span>
<span class="token keyword">fn</span> <span class="token function-definition function">returns</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token class-name">Take</span><span class="token operator">&lt;</span><span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token class-name">Skip</span><span class="token operator">&lt;</span><span class="token namespace">std<span class="token punctuation">::</span>slice<span class="token punctuation">::</span></span><span class="token class-name">Iter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥æ”¹æˆè¿™æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">type</span> <span class="token class-name">SkipFourTakeFive</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token class-name">Take</span><span class="token operator">&lt;</span><span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token class-name">Skip</span><span class="token operator">&lt;</span><span class="token namespace">std<span class="token punctuation">::</span>slice<span class="token punctuation">::</span></span><span class="token class-name">Iter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">returns</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">SkipFourTakeFive</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å¯¼å…¥å…ƒç´ ï¼Œè®©ç±»å‹æ›´çŸ­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Take</span><span class="token punctuation">,</span> <span class="token class-name">Skip</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>slice<span class="token punctuation">::</span></span><span class="token class-name">Iter</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">returns</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Take</span><span class="token operator">&lt;</span><span class="token class-name">Skip</span><span class="token operator">&lt;</span><span class="token class-name">Iter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥å†³å®šåœ¨ä½ çš„ä»£ç ä¸­ä»€ä¹ˆæ˜¯æœ€å¥½çœ‹çš„ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œè¿™å¹¶æ²¡æœ‰åˆ›å»ºä¸€ä¸ªå®é™…çš„æ–°ç±»å‹ã€‚å®ƒåªæ˜¯ä¸€ä¸ªä»£æ›¿ç°æœ‰ç±»å‹çš„åç§°ã€‚æ‰€ä»¥å¦‚æœä½ å†™äº† <code>type File = String;</code>ï¼Œç¼–è¯‘å™¨åªä¼šçœ‹åˆ° <code>String</code>ã€‚æ‰€ä»¥è¿™å°†æ‰“å°å‡º <code>true</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">type</span> <span class="token class-name">File</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_file <span class="token operator">==</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆå¦‚æœä½ æƒ³è¦ä¸€ä¸ªå®é™…çš„æ–°ç±»å‹å‘¢ï¼Ÿ</p>
<p>å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ–°çš„æ–‡ä»¶ç±»å‹ï¼Œè€Œç¼–è¯‘å™¨çœ‹åˆ°çš„æ˜¯<code>File</code>ï¼Œä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨ä¸€ä¸ªç»“æ„ä¸­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// File is a wrapper around String</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨è¿™æ ·å°±ä¸è¡Œäº†ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸¤ç§ä¸åŒçš„ç±»å‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// File is a wrapper around String</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_file <span class="token operator">==</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âš ï¸ cannot compare File with String</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ æƒ³æ¯”è¾ƒé‡Œé¢çš„Stringï¼Œå¯ä»¥ç”¨my_file.0:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I am file contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_file<span class="token number">.0</span> <span class="token operator">==</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// my_file.0 is a String, so this prints true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="åœ¨å‡½æ•°ä¸­å¯¼å…¥å’Œé‡å‘½å"><a href="#åœ¨å‡½æ•°ä¸­å¯¼å…¥å’Œé‡å‘½å" class="headerlink" title="åœ¨å‡½æ•°ä¸­å¯¼å…¥å’Œé‡å‘½å"></a>åœ¨å‡½æ•°ä¸­å¯¼å…¥å’Œé‡å‘½å</h3><p>é€šå¸¸ä½ ä¼šåœ¨ç¨‹åºçš„é¡¶éƒ¨å†™ä¸Š<code>use</code>ï¼Œåƒè¿™æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Cell</span><span class="token punctuation">,</span> <span class="token class-name">RefCell</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½†æˆ‘ä»¬çœ‹åˆ°ï¼Œä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¿™æ ·åšï¼Œç‰¹åˆ«æ˜¯åœ¨å‡½æ•°ä¸­ä½¿ç”¨åç§°è¾ƒé•¿çš„enumã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">MapDirection</span> <span class="token punctuation">{</span>
    <span class="token class-name">North</span><span class="token punctuation">,</span>
    <span class="token class-name">NorthEast</span><span class="token punctuation">,</span>
    <span class="token class-name">East</span><span class="token punctuation">,</span>
    <span class="token class-name">SouthEast</span><span class="token punctuation">,</span>
    <span class="token class-name">South</span><span class="token punctuation">,</span>
    <span class="token class-name">SouthWest</span><span class="token punctuation">,</span>
    <span class="token class-name">West</span><span class="token punctuation">,</span>
    <span class="token class-name">NorthWest</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">give_direction</span><span class="token punctuation">(</span>direction<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">MapDirection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> direction <span class="token punctuation">{</span>
        <span class="token class-name">MapDirection</span><span class="token punctuation">::</span><span class="token class-name">North</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You are heading north."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">MapDirection</span><span class="token punctuation">::</span><span class="token class-name">NorthEast</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You are heading northeast."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// So much more left to type...</span>
        <span class="token comment">// âš ï¸ because we didn't write every possible variant</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬è¦åœ¨å‡½æ•°é‡Œé¢å¯¼å…¥MapDirectionã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å‡½æ•°é‡Œé¢ä½ å¯ä»¥ç›´æ¥å†™<code>North</code>ç­‰ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">MapDirection</span> <span class="token punctuation">{</span>
    <span class="token class-name">North</span><span class="token punctuation">,</span>
    <span class="token class-name">NorthEast</span><span class="token punctuation">,</span>
    <span class="token class-name">East</span><span class="token punctuation">,</span>
    <span class="token class-name">SouthEast</span><span class="token punctuation">,</span>
    <span class="token class-name">South</span><span class="token punctuation">,</span>
    <span class="token class-name">SouthWest</span><span class="token punctuation">,</span>
    <span class="token class-name">West</span><span class="token punctuation">,</span>
    <span class="token class-name">NorthWest</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">give_direction</span><span class="token punctuation">(</span>direction<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">MapDirection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">MapDirection</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// Import everything in MapDirection</span>
    <span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token string">"You are heading"</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> direction <span class="token punctuation">{</span>
        <span class="token class-name">North</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} north."</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">NorthEast</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} northeast."</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// This is a bit better</span>
        <span class="token comment">// âš ï¸</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å·²ç»çœ‹åˆ°<code>::*</code>çš„æ„æ€æ˜¯ â€œå¯¼å…¥::ä¹‹åçš„æ‰€æœ‰å†…å®¹â€ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™æ„å‘³ç€<code>North</code>ï¼Œ<code>NorthEast</code>â€¦â€¦ä¸€ç›´åˆ°<code>NorthWest</code>ã€‚å½“ä½ å¯¼å…¥åˆ«äººçš„ä»£ç æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥è¿™æ ·åšï¼Œä½†å¦‚æœä»£ç éå¸¸å¤§ï¼Œä½ å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚å¦‚æœå®ƒæœ‰ä¸€äº›å…ƒç´ å’Œä½ çš„ä»£ç æ˜¯ä¸€æ ·çš„å‘¢ï¼Ÿæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹æœ€å¥½ä¸è¦ä¸€ç›´ä½¿ç”¨<code>::*</code>ï¼Œé™¤éä½ æœ‰æŠŠæ¡ã€‚å¾ˆå¤šæ—¶å€™ä½ åœ¨åˆ«äººçš„ä»£ç é‡Œçœ‹åˆ°ä¸€ä¸ªå«<code>prelude</code>çš„éƒ¨åˆ†ï¼Œé‡Œé¢æœ‰ä½ å¯èƒ½éœ€è¦çš„æ‰€æœ‰ä¸»è¦å…ƒç´ ã€‚é‚£ä¹ˆä½ é€šå¸¸ä¼šè¿™æ ·ä½¿ç”¨:<code>name::prelude::*</code>ã€‚ æˆ‘ä»¬å°†åœ¨ <code>modules</code> å’Œ <code>crates</code> çš„ç« èŠ‚ä¸­æ›´å¤šåœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p>
<p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>as</code> æ¥æ›´æ”¹åç§°ã€‚ä¾‹å¦‚ï¼Œä¹Ÿè®¸ä½ æ­£åœ¨ä½¿ç”¨åˆ«äººçš„ä»£ç ï¼Œè€Œä½ ä¸èƒ½æ”¹å˜æšä¸¾ä¸­çš„åç§°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">FileState</span> <span class="token punctuation">{</span>
    <span class="token class-name">CannotAccessFile</span><span class="token punctuation">,</span>
    <span class="token class-name">FileOpenedAndReady</span><span class="token punctuation">,</span>
    <span class="token class-name">NoSuchFileExists</span><span class="token punctuation">,</span>
    <span class="token class-name">SimilarFileNameInNextDirectory</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆä½ å°±å¯ä»¥</p>
<ol>
<li>å¯¼å…¥æ‰€æœ‰çš„ä¸œè¥¿</li>
<li>æ›´æ”¹åç§°</li>
</ol>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">FileState</span> <span class="token punctuation">{</span>
    <span class="token class-name">CannotAccessFile</span><span class="token punctuation">,</span>
    <span class="token class-name">FileOpenedAndReady</span><span class="token punctuation">,</span>
    <span class="token class-name">NoSuchFileExists</span><span class="token punctuation">,</span>
    <span class="token class-name">SimilarFileNameInNextDirectory</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">give_filestate</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">FileState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">FileState</span><span class="token punctuation">::</span><span class="token punctuation">{</span>
        <span class="token class-name">CannotAccessFile</span> <span class="token keyword">as</span> <span class="token class-name">NoAccess</span><span class="token punctuation">,</span>
        <span class="token class-name">FileOpenedAndReady</span> <span class="token keyword">as</span> <span class="token class-name">Good</span><span class="token punctuation">,</span>
        <span class="token class-name">NoSuchFileExists</span> <span class="token keyword">as</span> <span class="token class-name">NoFile</span><span class="token punctuation">,</span>
        <span class="token class-name">SimilarFileNameInNextDirectory</span> <span class="token keyword">as</span> <span class="token class-name">OtherDirectory</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> input <span class="token punctuation">{</span>
        <span class="token class-name">NoAccess</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Can't access file."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Good</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Here is your file"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">NoFile</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Sorry, there is no file by that name."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">OtherDirectory</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Please check the other directory."</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨ä½ å¯ä»¥å†™<code>OtherDirectory</code>è€Œä¸æ˜¯<code>FileState::SimilarFileNameInNextDirectory</code>ã€‚</p>
<h2 id="todo-å®"><a href="#todo-å®" class="headerlink" title="todo!å®"></a>todo!å®</h2><p>æœ‰æ—¶ä½ æƒ³ç²—ç•¥å†™ç‚¹å†™ä»£ç å¸®åŠ©ä½ æƒ³è±¡ä½ çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸ªç®€å•çš„é¡¹ç›®ï¼Œç”¨ä¹¦ç±åšä¸€äº›äº‹æƒ…ã€‚ä¸‹é¢æ˜¯ä½ å†™çš„æ—¶å€™çš„æƒ³æ³•:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Book</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Okay, first I need a book struct.</span>
               <span class="token comment">// Nothing in there yet - will add later</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">BookType</span> <span class="token punctuation">{</span> <span class="token comment">// A book can be hardcover or softcover, so add an enum</span>
    <span class="token class-name">HardCover</span><span class="token punctuation">,</span>
    <span class="token class-name">SoftCover</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">get_book</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Book</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// âš ï¸ get_book should take a &amp;Book and return an Option&lt;String&gt;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">delete_book</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> <span class="token class-name">Book</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// delete_book should take a Book and return a Result...</span>
                                                    <span class="token comment">// TODO: impl block and make these functions methods...</span>
<span class="token keyword">fn</span> <span class="token function-definition function">check_book_type</span><span class="token punctuation">(</span>book_type<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">BookType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Let's make sure the match statement works</span>
    <span class="token keyword">match</span> book_type <span class="token punctuation">{</span>
        <span class="token class-name">BookType</span><span class="token punctuation">::</span><span class="token class-name">HardCover</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's hardcover"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">BookType</span><span class="token punctuation">::</span><span class="token class-name">SoftCover</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's softcover"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> book_type <span class="token operator">=</span> <span class="token class-name">BookType</span><span class="token punctuation">::</span><span class="token class-name">HardCover</span><span class="token punctuation">;</span>
    <span class="token function">check_book_type</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>book_type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Okay, let's check this function!</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†Rustå¯¹<code>get_book</code>å’Œ<code>delete_book</code>ä¸æ»¡æ„ã€‚å®ƒè¯´</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0308]: mismatched types
  --&gt; src\main.rs:32:29
   |
32 | fn get_book(book: &amp;Book) -&gt; Option&lt;String&gt; {}
   |    --------                 ^^^^^^^^^^^^^^ expected enum `std::option::Option`, found `()`
   |    |
   |    implicitly returns `()` as its body has no tail or `return` expression
   |
   = note:   expected enum `std::option::Option&lt;std::string::String&gt;`
           found unit type `()`

error[E0308]: mismatched types
  --&gt; src\main.rs:34:31
   |
34 | fn delete_book(book: Book) -&gt; Result&lt;(), String&gt; {}
   |    -----------                ^^^^^^^^^^^^^^^^^^ expected enum `std::result::Result`, found `()`
   |    |
   |    implicitly returns `()` as its body has no tail or `return` expression
   |
   = note:   expected enum `std::result::Result&lt;(), std::string::String&gt;`
           found unit type `()`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯ä½ ç°åœ¨ä¸å…³å¿ƒ<code>get_book</code>å’Œ<code>delete_book</code>ã€‚è¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨<code>todo!()</code>ã€‚å¦‚æœä½ æŠŠè¿™ä¸ªåŠ åˆ°å‡½æ•°ä¸­ï¼ŒRustä¸ä¼šæŠ±æ€¨ï¼Œè€Œä¸”ä¼šç¼–è¯‘ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Book</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">get_book</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Book</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// todo means "I will do it later, please be quiet"</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">delete_book</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> <span class="token class-name">Book</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨ä»£ç ç¼–è¯‘ï¼Œä½ å¯ä»¥çœ‹åˆ°<code>check_book_type</code>çš„ç»“æœ:<code>It's hardcover</code>ã€‚</p>
<p>ä½†æ˜¯è¦å°å¿ƒï¼Œå› ä¸ºå®ƒåªæ˜¯ç¼–è¯‘â€“ä½ ä¸èƒ½ä½¿ç”¨å‡½æ•°ã€‚å¦‚æœä½ è°ƒç”¨é‡Œé¢æœ‰<code>todo!()</code>çš„å‡½æ•°ï¼Œå®ƒå°±ä¼šå´©æºƒã€‚</p>
<p>å¦å¤–ï¼Œ<code>todo!()</code>å‡½æ•°ä»ç„¶éœ€è¦çœŸå®çš„è¾“å…¥å’Œè¾“å‡ºç±»å‹ã€‚å¦‚æœä½ åªå†™è¿™ä¸ªï¼Œå®ƒå°†æ— æ³•ç¼–è¯‘ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Book</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">get_book</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Book</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">WorldsBestType</span> <span class="token punctuation">{</span> <span class="token comment">// âš ï¸</span>
    <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒä¼šè¯´</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0412]: cannot find type `WorldsBestType` in this scope
  --&gt; src\main.rs:32:29
   |
32 | fn get_book(book: &amp;Book) -&gt; WorldsBestType {
   |                             ^^^^^^^^^^^^^^ not found in this scope<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>todo!()</code>å…¶å®å’Œå¦ä¸€ä¸ªå®ä¸€æ ·ã€‚<code>unimplemented!()</code>. ç¨‹åºå‘˜ä»¬ç»å¸¸ä½¿ç”¨ <code>unimplemented!()</code>ï¼Œä½†æ‰“å­—æ—¶å¤ªé•¿äº†ï¼Œæ‰€ä»¥ä»–ä»¬åˆ›å»ºäº† <code>todo!()</code>ï¼Œå®ƒæ¯”è¾ƒçŸ­ã€‚</p>
<h2 id="Rc"><a href="#Rc" class="headerlink" title="Rc"></a>Rc</h2><p>Rcçš„æ„æ€æ˜¯ â€œreference counterâ€(å¼•ç”¨è®¡æ•°å™¨)ã€‚ä½ çŸ¥é“åœ¨Rustä¸­ï¼Œæ¯ä¸ªå˜é‡åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªä¸èƒ½å·¥ä½œçš„åŸå› :</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">takes_a_string</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It is: {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">also_takes_a_string</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It is: {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user_name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"User MacUserson"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">takes_a_string</span><span class="token punctuation">(</span>user_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">also_takes_a_string</span><span class="token punctuation">(</span>user_name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>takes_a_string</code>å–äº†<code>user_name</code>ä¹‹åï¼Œä½ å°±ä¸èƒ½å†ä½¿ç”¨äº†ã€‚è¿™é‡Œæ²¡æœ‰é—®é¢˜:ä½ å¯ä»¥ç›´æ¥ç»™å®ƒ<code>user_name.clone()</code>ã€‚ä½†æœ‰æ—¶ä¸€ä¸ªå˜é‡æ˜¯ä¸€ä¸ªç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿè®¸ä½ ä¸èƒ½å…‹éš†è¿™ä¸ªç»“æ„ã€‚æˆ–è€…<code>String</code>çœŸçš„å¾ˆé•¿ï¼Œä½ ä¸æƒ³å…‹éš†å®ƒã€‚è¿™äº›éƒ½æ˜¯<code>Rc</code>çš„ä¸€äº›åŸå› ï¼Œå®ƒè®©ä½ æ‹¥æœ‰å¤šä¸ªæ‰€æœ‰è€…ã€‚<code>Rc</code>å°±åƒä¸€ä¸ªä¼˜ç§€çš„åŠå…¬äººå‘˜ã€‚<code>Rc</code>å†™ä¸‹è°æ‹¥æœ‰æ‰€æœ‰æƒï¼Œä»¥åŠæœ‰å¤šå°‘ä¸ªã€‚ç„¶åä¸€æ—¦æ‰€æœ‰è€…çš„æ•°é‡ä¸‹é™åˆ°0ï¼Œè¿™ä¸ªå˜é‡å°±å¯ä»¥æ¶ˆå¤±äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨<code>Rc</code>ã€‚é¦–å…ˆæƒ³è±¡ä¸¤ä¸ªç»“æ„:ä¸€ä¸ªå« <code>City</code>ï¼Œå¦ä¸€ä¸ªå« <code>CityData</code>ã€‚<code>City</code>æœ‰ä¸€ä¸ªåŸå¸‚çš„ä¿¡æ¯ï¼Œè€Œ<code>CityData</code>æŠŠæ‰€æœ‰çš„åŸå¸‚éƒ½æ”¾åœ¨<code>Vec</code>ä¸­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    city_history<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">CityData</span> <span class="token punctuation">{</span>
    names<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    histories<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> calgary <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Calgary"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        population<span class="token punctuation">:</span> <span class="token number">1_200_000</span><span class="token punctuation">,</span>
           <span class="token comment">// Pretend that this string is very very long</span>
        city_history<span class="token punctuation">:</span> <span class="token string">"Calgary began as a fort called Fort Calgary that..."</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> canada_cities <span class="token operator">=</span> <span class="token class-name">CityData</span> <span class="token punctuation">{</span>
        names<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>calgary<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// This is using calgary.name, which is short</span>
        histories<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>calgary<span class="token punctuation">.</span>city_history<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// But this String is very long</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Calgary's history is: {}"</span><span class="token punctuation">,</span> calgary<span class="token punctuation">.</span>city_history<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸º<code>canada_cities</code>ç°åœ¨æ‹¥æœ‰æ•°æ®ï¼Œè€Œ<code>calgary</code>æ²¡æœ‰ã€‚å®ƒè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0382]: borrow of moved value: `calgary.city_history`
  --&gt; src\main.rs:27:42
   |
24 |         histories: vec![calgary.city_history], // But this String is very long
   |                         -------------------- value moved here
...
27 |     println!("Calgary's history is: {}", calgary.city_history);  // âš ï¸
   |                                          ^^^^^^^^^^^^^^^^^^^^ value borrowed here after move
   |
   = note: move occurs because `calgary.city_history` has type `std::string::String`, which does not implement the `Copy` trait<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥å…‹éš†åç§°:<code>names: vec![calgary.name.clone()]</code>ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³å…‹éš†<code>city_history</code>ï¼Œå› ä¸ºå®ƒå¾ˆé•¿ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª<code>Rc</code>ã€‚</p>
<p>å¢åŠ <code>use</code>çš„å£°æ˜ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>rc<span class="token punctuation">::</span></span><span class="token class-name">Rc</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åç”¨<code>Rc</code>æŠŠ<code>String</code>åŒ…å›´èµ·æ¥:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>rc<span class="token punctuation">::</span></span><span class="token class-name">Rc</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    city_history<span class="token punctuation">:</span> <span class="token class-name">Rc</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">CityData</span> <span class="token punctuation">{</span>
    names<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    histories<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Rc</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¦æ·»åŠ ä¸€ä¸ªæ–°çš„å¼•ç”¨ï¼Œä½ å¿…é¡»<code>clone</code> <code>Rc</code>ã€‚ä½†æ˜¯ç­‰ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸æ˜¯æƒ³é¿å…ä½¿ç”¨<code>.clone()</code>å—ï¼Ÿä¸å®Œå…¨æ˜¯:æˆ‘ä»¬ä¸æƒ³å…‹éš†æ•´ä¸ªStringã€‚ä½†æ˜¯ä¸€ä¸ª<code>Rc</code>çš„å…‹éš†åªæ˜¯å…‹éš†äº†æŒ‡é’ˆâ€“å®ƒåŸºæœ¬ä¸Šæ˜¯å…è´¹çš„ã€‚è¿™å°±åƒåœ¨ä¸€ç›’ä¹¦ä¸Šè´´ä¸Šä¸€ä¸ªåå­—è´´çº¸ï¼Œä»¥è¡¨æ˜æœ‰ä¸¤ä¸ªäººæ‹¥æœ‰å®ƒï¼Œè€Œä¸æ˜¯åšä¸€ç›’å…¨æ–°çš„ä¹¦ã€‚</p>
<p>ä½ å¯ä»¥ç”¨<code>item.clone()</code>æˆ–è€…ç”¨<code>Rc::clone(&amp;item)</code>æ¥å…‹éš†ä¸€ä¸ªå«<code>item</code>çš„<code>Rc</code>ã€‚æ‰€ä»¥calgary.city_historyæœ‰ä¸¤ä¸ªæ‰€æœ‰è€…ã€‚<br> æˆ‘ä»¬å¯ä»¥ç”¨<code>Rc::strong_count(&amp;item)</code>æŸ¥è¯¢æ‹¥æœ‰è€…æ•°é‡ã€‚å¦å¤–æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªæ–°çš„æ‰€æœ‰è€…ã€‚ç°åœ¨æˆ‘ä»¬çš„ä»£ç æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>rc<span class="token punctuation">::</span></span><span class="token class-name">Rc</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    city_history<span class="token punctuation">:</span> <span class="token class-name">Rc</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// String inside an Rc</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">CityData</span> <span class="token punctuation">{</span>
    names<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    histories<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Rc</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span> <span class="token comment">// A Vec of Strings inside Rcs</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> calgary <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Calgary"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        population<span class="token punctuation">:</span> <span class="token number">1_200_000</span><span class="token punctuation">,</span>
           <span class="token comment">// Pretend that this string is very very long</span>
        city_history<span class="token punctuation">:</span> <span class="token class-name">Rc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Calgary began as a fort called Fort Calgary that..."</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Rc::new() to make the Rc</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> canada_cities <span class="token operator">=</span> <span class="token class-name">CityData</span> <span class="token punctuation">{</span>
        names<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>calgary<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span>
        histories<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>calgary<span class="token punctuation">.</span>city_history<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// .clone() to increase the count</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Calgary's history is: {}"</span><span class="token punctuation">,</span> calgary<span class="token punctuation">.</span>city_history<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token class-name">Rc</span><span class="token punctuation">::</span><span class="token function">strong_count</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>calgary<span class="token punctuation">.</span>city_history<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> new_owner <span class="token operator">=</span> calgary<span class="token punctuation">.</span>city_history<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ‰“å°å‡ºäº†<code>2</code>ã€‚è€Œ<code>new_owner</code>ç°åœ¨æ˜¯<code>Rc&lt;String&gt;</code>ã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬ç”¨<code>println!("{}", Rc::strong_count(&amp;calgary.city_history));</code>ï¼Œæˆ‘ä»¬å¾—åˆ°<code>3</code>ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœæœ‰å¼ºæŒ‡é’ˆï¼Œæ˜¯å¦æœ‰å¼±æŒ‡é’ˆå‘¢ï¼Ÿæ˜¯çš„ï¼Œæœ‰ã€‚å¼±æŒ‡é’ˆæ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå¦‚æœä¸¤ä¸ª<code>Rc</code>äº’ç›¸æŒ‡å‘å¯¹æ–¹ï¼Œå®ƒä»¬å°±ä¸ä¼šæ­»ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ â€œå¼•ç”¨å¾ªç¯â€ã€‚å¦‚æœç¬¬1é¡¹å¯¹ç¬¬2é¡¹æœ‰ä¸€ä¸ªRcï¼Œè€Œç¬¬2é¡¹å¯¹ç¬¬1é¡¹æœ‰ä¸€ä¸ªRcï¼Œå®ƒä»¬ä¸èƒ½åˆ°0ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ è¦ä½¿ç”¨å¼±å¼•ç”¨ã€‚é‚£ä¹ˆ<code>Rc</code>å°±ä¼šå¯¹å¼•ç”¨è¿›è¡Œè®¡æ•°ï¼Œä½†å¦‚æœåªæœ‰å¼±å¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæ­»æ‰ã€‚ä½ ä½¿ç”¨<code>Rc::downgrade(&amp;item)</code>è€Œä¸æ˜¯<code>Rc::clone(&amp;item)</code>æ¥åˆ›å»ºå¼±å¼•ç”¨ã€‚å¦å¤–ï¼Œä½ ç”¨<code>Rc::weak_count(&amp;item)</code>æ¥æŸ¥çœ‹å¼±å¼•ç”¨æ•°ã€‚</p>
<h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h2><p>å¦‚æœä½ ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ï¼Œä½ å¯ä»¥åŒæ—¶åšå¾ˆå¤šäº‹æƒ…ã€‚ç°ä»£è®¡ç®—æœºæœ‰ä¸€ä¸ªä»¥ä¸Šçš„æ ¸å¿ƒï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥åŒæ—¶åšå¤šä»¶äº‹æƒ…ï¼ŒRustè®©ä½ ä½¿ç”¨å®ƒä»¬ã€‚Rustä½¿ç”¨çš„çº¿ç¨‹è¢«ç§°ä¸º â€œOSçº¿ç¨‹â€ã€‚OSçº¿ç¨‹æ„å‘³ç€æ“ä½œç³»ç»Ÿåœ¨ä¸åŒçš„æ ¸ä¸Šåˆ›å»ºçº¿ç¨‹ã€‚(å…¶ä»–ä¸€äº›è¯­è¨€ä½¿ç”¨ â€œgreen threadsâ€ï¼ŒåŠŸèƒ½è¾ƒå°‘)</p>
<p>ä½ ç”¨<code>std::thread::spawn</code>åˆ›å»ºçº¿ç¨‹ï¼Œç„¶åç”¨ä¸€ä¸ªé—­åŒ…æ¥å‘Šè¯‰å®ƒè¯¥æ€ä¹ˆåšã€‚çº¿ç¨‹å¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒä»¬åŒæ—¶è¿è¡Œï¼Œä½ å¯ä»¥æµ‹è¯•å®ƒï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ è¿è¡Œè¿™ä¸ªï¼Œæ¯æ¬¡éƒ½ä¼šä¸ä¸€æ ·ã€‚æœ‰æ—¶ä¼šæ‰“å°ï¼Œæœ‰æ—¶ä¸ä¼šæ‰“å°(è¿™ä¹Ÿå–å†³äºä½ çš„ç”µè„‘é€Ÿåº¦)ã€‚è¿™æ˜¯å› ä¸ºæœ‰æ—¶<code>main()</code>åœ¨çº¿ç¨‹å®Œæˆä¹‹å‰å°±å®Œæˆäº†ã€‚è€Œå½“<code>main()</code>å®Œæˆåï¼Œç¨‹åºå°±ç»“æŸäº†ã€‚è¿™åœ¨<code>for</code>å¾ªç¯ä¸­æ›´å®¹æ˜“çœ‹åˆ°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span> <span class="token comment">// set up ten threads</span>
        <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>   <span class="token comment">// Now the threads start.</span>
<span class="token punctuation">}</span>       <span class="token comment">// How many can finish before main() ends here?</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€šå¸¸åœ¨<code>main</code>ç»“æŸä¹‹å‰ï¼Œå¤§çº¦ä¼šæ‰“å°å‡ºå››æ¡çº¿ç¨‹ï¼Œä½†æ€»æ˜¯ä¸ä¸€æ ·ã€‚å¦‚æœä½ çš„ç”µè„‘é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œé‚£ä¹ˆå¯èƒ½å°±ä¸ä¼šæ‰“å°äº†ã€‚å¦å¤–ï¼Œæœ‰æ—¶çº¿ç¨‹ä¼šå´©æºƒã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">thread 'thread 'I am printing something
thread '&lt;unnamed&gt;&lt;unnamed&gt;thread '' panicked at '&lt;unnamed&gt;I am printing something
' panicked at 'thread '&lt;unnamed&gt;cannot access stdout during shutdown' panicked at '&lt;unnamed&gt;thread 'cannot access stdout during
shutdown<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯åœ¨ç¨‹åºå…³é—­æ—¶ï¼Œçº¿ç¨‹è¯•å›¾åšä¸€äº›æ­£ç¡®çš„äº‹æƒ…æ—¶å‡ºç°çš„é”™è¯¯ã€‚</p>
<p>ä½ å¯ä»¥ç»™ç”µè„‘åšä¸€äº›äº‹æƒ…ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šé©¬ä¸Šå…³é—­äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
        <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">1_000_000</span> <span class="token punctuation">{</span> <span class="token comment">// make the program declare "let x = 9" one million times</span>
                            <span class="token comment">// It has to finish this before it can exit the main function</span>
        <span class="token keyword">let</span> _x <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†è¿™æ˜¯ä¸€ä¸ªè®©çº¿ç¨‹æœ‰æ—¶é—´å®Œæˆçš„æ„šè ¢æ–¹æ³•ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯å°†çº¿ç¨‹ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸Šã€‚å¦‚æœä½ åŠ ä¸Š <code>let</code>ï¼Œä½ å°±èƒ½åˆ›å»ºä¸€ä¸ª <code>JoinHandle</code>ã€‚ä½ å¯ä»¥åœ¨<code>spawn</code>çš„ç­¾åä¸­çœ‹åˆ°è¿™ä¸€ç‚¹:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">pub fn spawn&lt;F, T&gt;(f: F) -&gt; JoinHandle&lt;T&gt;
where
    F: FnOnce() -&gt; T,
    F: Send + 'static,
    T: Send + 'static,<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(<code>f</code>æ˜¯é—­åŒ…â€“æˆ‘ä»¬å°†åœ¨åé¢å­¦ä¹ å¦‚ä½•å°†é—­åŒ…æ”¾å…¥æˆ‘ä»¬çš„å‡½æ•°ä¸­)</p>
<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æ¯æ¬¡éƒ½æœ‰<code>JoinHandle</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>handle</code>ç°åœ¨æ˜¯<code>JoinHandle</code>ã€‚æˆ‘ä»¬æ€ä¹ˆå¤„ç†å®ƒå‘¢ï¼Ÿæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå«åš <code>.join()</code> çš„æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•çš„æ„æ€æ˜¯ â€œç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆâ€(å®ƒç­‰å¾…çº¿ç¨‹åŠ å…¥å®ƒ)ã€‚æ‰€ä»¥ç°åœ¨åªè¦å†™<code>handle.join()</code>ï¼Œå®ƒå°±ä¼šç­‰å¾…æ¯ä¸ªçº¿ç¨‹å®Œæˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Wait for the threads to finish</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹ä¸‰ç§ç±»å‹çš„é—­åŒ…ã€‚è¿™ä¸‰ç§ç±»å‹æ˜¯</p>
<ul>
<li><code>FnOnce</code>: å–æ•´ä¸ªå€¼</li>
<li><code>FnMut</code>: å–ä¸€ä¸ªå¯å˜å¼•ç”¨</li>
<li><code>Fn</code>: å–ä¸€ä¸ªæ™®é€šå¼•ç”¨</li>
</ul>
<p>å¦‚æœå¯ä»¥çš„è¯ï¼Œé—­åŒ…ä¼šå°½é‡ä½¿ç”¨<code>Fn</code>ã€‚ä½†å¦‚æœå®ƒéœ€è¦æ”¹å˜å€¼ï¼Œå®ƒå°†ä½¿ç”¨ <code>FnMut</code>ï¼Œè€Œå¦‚æœå®ƒéœ€è¦å–æ•´ä¸ªå€¼ï¼Œå®ƒå°†ä½¿ç”¨ <code>FnOnce</code>ã€‚<code>FnOnce</code>æ˜¯ä¸ªå¥½åå­—ï¼Œå› ä¸ºå®ƒè§£é‡Šäº†å®ƒçš„ä½œç”¨:å®ƒå–ä¸€æ¬¡å€¼ï¼Œç„¶åå°±ä¸èƒ½å†å–äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I will go into the closure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>String</code>ä¸æ˜¯<code>Copy</code>ï¼Œæ‰€ä»¥<code>my_closure()</code>æ˜¯<code>Fn</code>: å®ƒæ‹¿åˆ°ä¸€ä¸ªå¼•ç”¨</p>
<p>å¦‚æœæˆ‘ä»¬æ”¹å˜<code>my_string</code>ï¼Œå®ƒå˜æˆ<code>FnMut</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"I will go into the closure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        my_string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">" now"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">I will go into the closure now
I will go into the closure now now<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è€Œå¦‚æœæŒ‰å€¼è·å–ï¼Œåˆ™æ˜¯<code>FnOnce</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_closure <span class="token operator">=</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        my_vec
            <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// into_iter takes ownership</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token keyword">as</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token comment">// turn it into u8</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// multiply by 2</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// collect into a Vec</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> new_vec <span class="token operator">=</span> <span class="token function">my_closure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬æ˜¯æŒ‰å€¼å–çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å¤šè·‘<code>my_closure()</code>æ¬¡ã€‚è¿™å°±æ˜¯åå­—çš„ç”±æ¥ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨å›åˆ°çº¿ç¨‹ã€‚è®©æˆ‘ä»¬è¯•ç€ä»å¤–éƒ¨å¼•å…¥ä¸€ä¸ªå€¼:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Can I go inside the thread?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´è¿™ä¸ªä¸è¡Œã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0373]: closure may outlive the current function, but it borrows `my_string`, which is owned by the current function
  --&gt; src\main.rs:28:37
   |
28 |     let handle = std::thread::spawn(|| {
   |                                     ^^ may outlive borrowed value `my_string`
29 |         println!("{}", my_string);
   |                        --------- `my_string` is borrowed here
   |
note: function requires argument type to outlive `'static`
  --&gt; src\main.rs:28:18
   |
28 |       let handle = std::thread::spawn(|| {
   |  __________________^
29 | |         println!("{}", my_string);
30 | |     });
   | |______^
help: to force the closure to take ownership of `my_string` (and any other referenced variables), use the `move` keyword
   |
28 |     let handle = std::thread::spawn(move || {
   |                                     ^^^^^^^<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ¡ä¿¡æ¯å¾ˆé•¿ï¼Œä½†å¾ˆæœ‰ç”¨:å®ƒè¯´åˆ°<code>use the `move` keyword</code>ã€‚é—®é¢˜æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨çº¿ç¨‹ä½¿ç”¨<code>my_string</code>æ—¶å¯¹å®ƒåšä»»ä½•äº‹æƒ…ï¼Œä½†çº¿ç¨‹å¹¶ä¸æ‹¥æœ‰å®ƒã€‚è¿™å°†æ˜¯ä¸å®‰å…¨çš„ã€‚</p>
<p>è®©æˆ‘ä»¬è¯•è¯•å…¶ä»–è¡Œä¸é€šçš„ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Can I go inside the thread?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// now my_string is being used as a reference</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">drop</span><span class="token punctuation">(</span>my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âš ï¸ We try to drop it here. But the thread still needs it.</span>

    handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ è¦ç”¨<code>move</code>æ¥å–å€¼ï¼Œç°åœ¨å®‰å…¨äº†:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Can I go inside the thread?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span><span class="token function">drop</span><span class="token punctuation">(</span>my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âš ï¸ we can't drop, because handle has it. So this won't work</span>

    handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥æˆ‘ä»¬æŠŠ<code>std::mem::drop</code>åˆ æ‰ï¼Œç°åœ¨å°±å¯ä»¥äº†ã€‚<code>handle</code>å–<code>my_string</code>ï¼Œæˆ‘ä»¬çš„ä»£ç å°±å®‰å…¨äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Can I go inside the thread?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥åªè¦è®°ä½:å¦‚æœä½ åœ¨çº¿ç¨‹ä¸­éœ€è¦ä¸€ä¸ªæ¥è‡ªçº¿ç¨‹å¤–çš„å€¼ï¼Œä½ éœ€è¦ä½¿ç”¨<code>move</code>ã€‚</p>
<h2 id="å‡½æ•°ä¸­çš„é—­åŒ…"><a href="#å‡½æ•°ä¸­çš„é—­åŒ…" class="headerlink" title="å‡½æ•°ä¸­çš„é—­åŒ…"></a>å‡½æ•°ä¸­çš„é—­åŒ…</h2><p>é—­åŒ…æ˜¯ä¼Ÿå¤§çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æŠŠå®ƒä»¬æ”¾åˆ°è‡ªå·±çš„å‡½æ•°ä¸­å‘¢ï¼Ÿ</p>
<p>ä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„å‡½æ•°æ¥æ¥å—é—­åŒ…ï¼Œä½†æ˜¯åœ¨å‡½æ•°é‡Œé¢å°±ä¸é‚£ä¹ˆè‡ªç”±äº†ï¼Œä½ å¿…é¡»å†³å®šç±»å‹ã€‚åœ¨å‡½æ•°å¤–éƒ¨ï¼Œä¸€ä¸ªé—­åŒ…å¯ä»¥åœ¨<code>Fn</code>ã€<code>FnMut</code>å’Œ<code>FnOnce</code>ä¹‹é—´è‡ªè¡Œå†³å®šï¼Œä½†åœ¨å‡½æ•°å†…éƒ¨ä½ å¿…é¡»é€‰æ‹©ä¸€ä¸ªã€‚æœ€å¥½çš„ç†è§£æ–¹å¼æ˜¯çœ‹å‡ ä¸ªå‡½æ•°ç­¾åã€‚<br> è¿™é‡Œæ˜¯<code>.all()</code>çš„é‚£ä¸ªã€‚æˆ‘ä»¬è®°å¾—ï¼Œå®ƒæ£€æŸ¥ä¸€ä¸ªè¿­ä»£å™¨ï¼Œçœ‹çœ‹æ‰€æœ‰çš„ä¸œè¥¿æ˜¯å¦æ˜¯<code>true</code>(å–å†³äºä½ å†³å®šæ˜¯<code>true</code>è¿˜æ˜¯<code>false</code>)ã€‚å®ƒçš„éƒ¨åˆ†ç­¾åæ˜¯è¿™æ ·è¯´çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">all</span><span class="token operator">&lt;</span><span class="token class-name">F</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span>    <span class="token comment">// ğŸš§</span>
<span class="token keyword">where</span>
    <span class="token class-name">F</span><span class="token punctuation">:</span> <span class="token class-name">FnMut</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Item</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>fn all&lt;F&gt;</code>:è¿™å‘Šè¯‰ä½ æœ‰ä¸€ä¸ªé€šç”¨ç±»å‹<code>F</code>ã€‚ä¸€ä¸ªé—­åŒ…æ€»æ˜¯æ³›å‹ï¼Œå› ä¸ºæ¯æ¬¡éƒ½æ˜¯ä¸åŒçš„ç±»å‹ã€‚</p>
<p><code>(&amp;mut self, f: F)</code>:<code>&amp;mut self</code>å‘Šè¯‰ä½ è¿™æ˜¯ä¸€ä¸ªæ–¹æ³•ã€‚<code>f: F</code>é€šå¸¸ä½ çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªé—­åŒ…:è¿™æ˜¯å˜é‡åå’Œç±»å‹ã€‚ å½“ç„¶ï¼Œ<code>f</code>å’Œ<code>F</code>å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸åŒçš„åå­—ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥å†™<code>my_closure: Closure</code>â€“è¿™å¹¶ä¸é‡è¦ã€‚ä½†åœ¨ç­¾åä¸­ï¼Œä½ å‡ ä¹æ€»æ˜¯çœ‹åˆ°<code>f: F</code>ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯å…³äºé—­åŒ…çš„éƒ¨åˆ†:<code>F: FnMut(Self::Item) -&gt; bool</code>ã€‚åœ¨è¿™é‡Œï¼Œå®ƒå†³å®šäº†é—­åŒ…æ˜¯ <code>FnMut</code>ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ”¹å˜å€¼ã€‚å®ƒæ”¹å˜äº†<code>Self::Item</code>çš„å€¼ï¼Œè¿™æ˜¯å®ƒæ‰€å–çš„è¿­ä»£å™¨ã€‚è€Œä¸”å®ƒå¿…é¡»è¿”å› <code>true</code> æˆ– <code>false</code>ã€‚</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ›´ç®€å•çš„ç­¾åï¼Œæœ‰ä¸€ä¸ªé—­åŒ…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">do_something</span><span class="token operator">&lt;</span><span class="token class-name">F</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>f<span class="token punctuation">:</span> <span class="token class-name">F</span><span class="token punctuation">)</span>    <span class="token comment">// ğŸš§</span>
<span class="token keyword">where</span>
    <span class="token class-name">F</span><span class="token punctuation">:</span> <span class="token class-name">FnOnce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™åªæ˜¯è¯´å®ƒæ¥å—ä¸€ä¸ªé—­åŒ…ï¼Œå–å€¼(<code>FnOnce</code>=å–å€¼)ï¼Œè€Œä¸è¿”å›ä»»ä½•ä¸œè¥¿ã€‚æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥è°ƒç”¨è¿™ä¸ªä»€ä¹ˆéƒ½ä¸å–çš„é—­åŒ…ï¼Œåšæˆ‘ä»¬å–œæ¬¢åšçš„äº‹æƒ…ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª <code>Vec</code>ï¼Œç„¶åå¯¹å®ƒè¿›è¡Œè¿­ä»£ï¼Œåªæ˜¯ä¸ºäº†å±•ç¤ºæˆ‘ä»¬ç°åœ¨å¯ä»¥åšä»€ä¹ˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">do_something</span><span class="token operator">&lt;</span><span class="token class-name">F</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>f<span class="token punctuation">:</span> <span class="token class-name">F</span><span class="token punctuation">)</span>
<span class="token keyword">where</span>
    <span class="token class-name">F</span><span class="token punctuation">:</span> <span class="token class-name">FnOnce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">do_something</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> some_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        some_vec
            <span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is: {}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€ä¸ªæ›´çœŸå®çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°†å†æ¬¡åˆ›å»ºä¸€ä¸ª <code>City</code> ç»“æ„ä½“ã€‚è¿™æ¬¡ <code>City</code> ç»“æ„ä½“æœ‰æ›´å¤šå…³äºå¹´ä»½å’Œäººå£çš„æ•°æ®ã€‚å®ƒæœ‰ä¸€ä¸ª <code>Vec&lt;u32&gt;</code> æ¥è¡¨ç¤ºæ‰€æœ‰çš„å¹´ä»½ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>Vec&lt;u32&gt;</code> æ¥è¡¨ç¤ºæ‰€æœ‰çš„äººå£ã€‚</p>
<p><code>City</code>æœ‰ä¸¤ä¸ªå‡½æ•°:<code>new()</code>ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„<code>City</code>, <code>.city_data()</code>æœ‰ä¸ªé—­åŒ…. å½“æˆ‘ä»¬ä½¿ç”¨ <code>.city_data()</code> æ—¶ï¼Œå®ƒç»™æˆ‘ä»¬æä¾›äº†å¹´ä»½å’Œäººå£ä»¥åŠä¸€ä¸ªé—­åŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®åšæˆ‘ä»¬æƒ³åšçš„äº‹æƒ…ã€‚é—­åŒ…ç±»å‹æ˜¯ <code>FnMut</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¹å˜æ•°æ®ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    years<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    populations<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> years<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> populations<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>

        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            years<span class="token punctuation">,</span>
            populations<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">city_data</span><span class="token operator">&lt;</span><span class="token class-name">F</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token keyword">mut</span> f<span class="token punctuation">:</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token comment">// We bring in self, but only f is generic F. f is the closure</span>

    <span class="token keyword">where</span>
        <span class="token class-name">F</span><span class="token punctuation">:</span> <span class="token class-name">FnMut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// The closure takes mutable vectors of u32</span>
                                                <span class="token comment">// which are the year and population data</span>
    <span class="token punctuation">{</span>
        <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span>years<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span>populations<span class="token punctuation">)</span> <span class="token comment">// Finally this is the actual function. It says</span>
                                                  <span class="token comment">// "use a closure on self.years and self.populations"</span>
                                                  <span class="token comment">// We can do whatever we want with the closure</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> years <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token number">1372</span><span class="token punctuation">,</span> <span class="token number">1834</span><span class="token punctuation">,</span> <span class="token number">1851</span><span class="token punctuation">,</span> <span class="token number">1881</span><span class="token punctuation">,</span> <span class="token number">1897</span><span class="token punctuation">,</span> <span class="token number">1925</span><span class="token punctuation">,</span> <span class="token number">1959</span><span class="token punctuation">,</span> <span class="token number">1989</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2010</span><span class="token punctuation">,</span> <span class="token number">2020</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> populations <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token number">3_250</span><span class="token punctuation">,</span> <span class="token number">15_300</span><span class="token punctuation">,</span> <span class="token number">24_000</span><span class="token punctuation">,</span> <span class="token number">45_900</span><span class="token punctuation">,</span> <span class="token number">58_800</span><span class="token punctuation">,</span> <span class="token number">119_800</span><span class="token punctuation">,</span> <span class="token number">283_071</span><span class="token punctuation">,</span> <span class="token number">478_974</span><span class="token punctuation">,</span> <span class="token number">400_378</span><span class="token punctuation">,</span> <span class="token number">401_694</span><span class="token punctuation">,</span>
        <span class="token number">406_703</span><span class="token punctuation">,</span> <span class="token number">437_619</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Now we can create our city</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> tallinn <span class="token operator">=</span> <span class="token class-name">City</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Tallinn"</span><span class="token punctuation">,</span> years<span class="token punctuation">,</span> populations<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Now we have a .city_data() method that has a closure. We can do anything we want.</span>

    <span class="token comment">// First let's put the data for 5 years together and print it.</span>
    tallinn<span class="token punctuation">.</span><span class="token function">city_data</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>city_years<span class="token punctuation">,</span> city_populations<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// We can call the input anything we want</span>
        <span class="token keyword">let</span> new_vec <span class="token operator">=</span> city_years
            <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>city_populations<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Zip the two together</span>
            <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>                           <span class="token comment">// but only take the first 5</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Tell Rust to decide the type inside the tuple</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Now let's add some data for the year 2030</span>
    tallinn<span class="token punctuation">.</span><span class="token function">city_data</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token punctuation">,</span> y<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// This time we just call the input x and y</span>
        x<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2030</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        y<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">500_000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// We don't want the 1834 data anymore</span>
    tallinn<span class="token punctuation">.</span><span class="token function">city_data</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token punctuation">,</span> y<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> position_option <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">position</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>x <span class="token operator">==</span> <span class="token number">1834</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span> <span class="token operator">=</span> position_option <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span>
                <span class="token string">"Going to delete {} at position {:?} now."</span><span class="token punctuation">,</span>
                x<span class="token punctuation">[</span>position<span class="token punctuation">]</span><span class="token punctuation">,</span> position
            <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Confirm that we delete the right item</span>
            x<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
            y<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"Years left are {:?}\nPopulations left are {:?}"</span><span class="token punctuation">,</span>
        tallinn<span class="token punctuation">.</span>years<span class="token punctuation">,</span> tallinn<span class="token punctuation">.</span>populations
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡ºæˆ‘ä»¬è°ƒç”¨<code>.city_data().</code>çš„æ‰€æœ‰æ—¶é—´çš„ç»“æœ:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[(1372, 3250), (1834, 15300), (1851, 24000), (1881, 45900), (1897, 58800)]
Going to delete 1834 at position 1 now.
Years left are [1372, 1851, 1881, 1897, 1925, 1959, 1989, 2000, 2005, 2010, 2020, 2030]
Populations left are [3250, 24000, 45900, 58800, 119800, 283071, 478974, 400378, 401694, 406703, 437619, 500000]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


<h2 id="impl-Trait"><a href="#impl-Trait" class="headerlink" title="impl Trait"></a>impl Trait</h2><p><code>impl Trait</code>ä¸æ³›å‹ç±»ä¼¼ã€‚ä½ è¿˜è®°å¾—ï¼Œæ³›å‹ä½¿ç”¨ä¸€ä¸ªç±»å‹ <code>T</code>(æˆ–ä»»ä½•å…¶ä»–åç§°)ï¼Œç„¶ååœ¨ç¨‹åºç¼–è¯‘æ—¶å†³å®šã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ç±»å‹:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">gives_higher_i32</span><span class="token punctuation">(</span>one<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> two<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> higher <span class="token operator">=</span> <span class="token keyword">if</span> one <span class="token operator">&gt;</span> two <span class="token punctuation">{</span> one <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> two <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is higher."</span><span class="token punctuation">,</span> higher<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">gives_higher_i32</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:<code>10 is higher.</code>.</p>
<p>ä½†æ˜¯è¿™ä¸ªåªæ¥å—<code>i32</code>ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬è¦æŠŠå®ƒåšæˆé€šç”¨çš„ã€‚æˆ‘ä»¬éœ€è¦æ¯”è¾ƒï¼Œæˆ‘ä»¬éœ€è¦ç”¨<code>{}</code>æ‰“å°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç±»å‹Téœ€è¦<code>PartialOrd</code>å’Œ<code>Display</code>ã€‚è®°ä½ï¼Œè¿™æ„å‘³ç€ â€œåªæ¥å—å·²ç»å®ç°<code>PartialOrd</code>å’Œ<code>Display</code>çš„ç±»å‹â€ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">gives_higher_i32</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">PartialOrd</span> <span class="token operator">+</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>one<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> two<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> higher <span class="token operator">=</span> <span class="token keyword">if</span> one <span class="token operator">&gt;</span> two <span class="token punctuation">{</span> one <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> two <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} is higher."</span><span class="token punctuation">,</span> higher<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">gives_higher_i32</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹<code>impl Trait</code>ï¼Œå®ƒä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸€ä¸ªç±»å‹ <code>impl Trait</code>ï¼Œè€Œä¸æ˜¯ <code>T</code>ã€‚ç„¶åå®ƒå°†å¸¦å…¥ä¸€ä¸ªå®ç°è¯¥ç‰¹æ€§çš„ç±»å‹ã€‚è¿™å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">prints_it</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">impl</span> <span class="token class-name">Into</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token operator">+</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Takes anything that can turn into a String and has Display</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You can print many things, including {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">"Tuon"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> string_name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Tuon"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_it</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_it</span><span class="token punctuation">(</span>string_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶è€Œï¼Œæ›´æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿”å› <code>impl Trait</code>ï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥è¿”å›é—­åŒ…ï¼Œå› ä¸ºå®ƒä»¬çš„å‡½æ•°ç­¾åæ˜¯traitã€‚ä½ å¯ä»¥åœ¨æœ‰å®ƒä»¬çš„æ–¹æ³•çš„ç­¾åä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ <code>.map()</code> çš„ç­¾åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">map</span><span class="token operator">&lt;</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token class-name">F</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">F</span><span class="token operator">&gt;</span>     <span class="token comment">// ğŸš§</span>
    <span class="token keyword">where</span>
        <span class="token keyword">Self</span><span class="token punctuation">:</span> <span class="token class-name">Sized</span><span class="token punctuation">,</span>
        <span class="token class-name">F</span><span class="token punctuation">:</span> <span class="token class-name">FnMut</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Item</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">B</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>fn map&lt;B, F&gt;(self, f: F)</code>çš„æ„æ€æ˜¯ï¼Œå®ƒéœ€è¦ä¸¤ä¸ªé€šç”¨ç±»å‹ã€‚<code>F</code>æ˜¯æŒ‡ä»å®ç°<code>.map()</code>çš„å®¹å™¨ä¸­å–ä¸€ä¸ªå…ƒç´ çš„å‡½æ•°ï¼Œ<code>B</code>æ˜¯è¯¥å‡½æ•°çš„è¿”å›ç±»å‹ã€‚ç„¶ååœ¨<code>where</code>ä¹‹åï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯trait boundã€‚(â€œtrait boundâ€çš„æ„æ€æ˜¯ â€œå®ƒå¿…é¡»æœ‰è¿™ä¸ªtraitâ€ã€‚)ä¸€ä¸ªæ˜¯<code>Sized</code>ï¼Œæ¥ä¸‹æ¥æ˜¯é—­åŒ…ç­¾åã€‚å®ƒå¿…é¡»æ˜¯ä¸€ä¸ª <code>FnMut</code>ï¼Œå¹¶åœ¨ <code>Self::Item</code> ä¸Šåšé—­åŒ…ï¼Œä¹Ÿå°±æ˜¯ä½ ç»™å®ƒçš„è¿­ä»£å™¨ã€‚ç„¶åå®ƒè¿”å›<code>B</code>ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•æ¥è¿”å›ä¸€ä¸ªé—­åŒ…ã€‚è¦è¿”å›ä¸€ä¸ªé—­åŒ…ï¼Œä½¿ç”¨ <code>impl</code>ï¼Œç„¶åä½¿ç”¨é—­åŒ…ç­¾åã€‚ä¸€æ—¦ä½ è¿”å›å®ƒï¼Œä½ å°±å¯ä»¥åƒå‡½æ•°ä¸€æ ·ä½¿ç”¨å®ƒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå‡½æ•°çš„å°ä¾‹å­ï¼Œå®ƒæ ¹æ®ä½ è¾“å…¥çš„æ•°å­—ç»™ä½ ä¸€ä¸ªé—­åŒ…ã€‚å¦‚æœä½ è¾“å…¥çš„æ˜¯ 2 æˆ– 40ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå°†å…¶ç›¸ä¹˜ï¼Œå¦åˆ™å°±ä¼šç»™ä½ ç›¸åŒçš„æ•°å­—ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åšä»»ä½•æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿæ‰“å°ä¸€æ¡ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">returns_a_closure</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">impl</span> <span class="token class-name">FnMut</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> input <span class="token punctuation">{</span>
        <span class="token number">2</span> <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token keyword">mut</span> number<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            number <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your number is {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
            number
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token number">40</span> <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token keyword">mut</span> number<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            number <span class="token operator">*=</span> <span class="token number">40</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your number is {}"</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
            number
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>number<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Sorry, it's the same: {}."</span><span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
            number
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token comment">// Make three closures</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> give_two <span class="token operator">=</span> <span class="token function">returns_a_closure</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> give_forty <span class="token operator">=</span> <span class="token function">returns_a_closure</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> give_fifty <span class="token operator">=</span> <span class="token function">returns_a_closure</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">give_two</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">give_forty</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">give_fifty</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¯”è¾ƒé•¿çš„ä¾‹å­ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸€ä¸ªæ¸¸æˆä¸­ï¼Œä½ çš„è§’è‰²é¢å¯¹çš„æ˜¯æ™šä¸Šæ¯”è¾ƒå¼ºçš„æ€ªç‰©ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå«<code>TimeOfDay</code>çš„æšä¸¾æ¥è®°å½•ä¸€å¤©çš„æƒ…å†µã€‚ä½ çš„è§’è‰²å«è¥¿è’™ï¼Œæœ‰ä¸€ä¸ªå«<code>character_fear</code>çš„æ•°å­—ï¼Œä¹Ÿå°±æ˜¯<code>f64</code>ã€‚å®ƒæ™šä¸Šä¸Šå‡ï¼Œç™½å¤©ä¸‹é™ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<code>change_fear</code>å‡½æ•°ï¼Œæ”¹å˜ä»–çš„ææƒ§ï¼Œä½†ä¹Ÿåšå…¶ä»–äº‹æƒ…ï¼Œå¦‚å†™æ¶ˆæ¯ã€‚å®ƒå¤§æ¦‚æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">TimeOfDay</span> <span class="token punctuation">{</span> <span class="token comment">// just a simple enum</span>
    <span class="token class-name">Dawn</span><span class="token punctuation">,</span>
    <span class="token class-name">Day</span><span class="token punctuation">,</span>
    <span class="token class-name">Sunset</span><span class="token punctuation">,</span>
    <span class="token class-name">Night</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">change_fear</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">TimeOfDay</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">impl</span> <span class="token class-name">FnMut</span><span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">f64</span> <span class="token punctuation">{</span> <span class="token comment">// The function takes a TimeOfDay. It returns a closure.</span>
                                                             <span class="token comment">// We use impl FnMut(64) -&gt; f64 to say that it needs to</span>
                                                             <span class="token comment">// change the value, and also gives the same type back.</span>
    <span class="token keyword">use</span> <span class="token class-name">TimeOfDay</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// So we only have to write Dawn, Day, Sunset, Night</span>
                      <span class="token comment">// Instead of TimeOfDay::Dawn, TimeOfDay::Day, etc.</span>
    <span class="token keyword">match</span> input <span class="token punctuation">{</span>
        <span class="token class-name">Dawn</span> <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// This is the variable character_fear that we give it later</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The morning sun has vanquished the horrible night. You no longer feel afraid."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your fear is now {}"</span><span class="token punctuation">,</span> x <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            x <span class="token operator">*</span> <span class="token number">0.5</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token class-name">Day</span> <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"What a nice day. Maybe put your feet up and rest a bit."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your fear is now {}"</span><span class="token punctuation">,</span> x <span class="token operator">*</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            x <span class="token operator">*</span> <span class="token number">0.2</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token class-name">Sunset</span> <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The sun is almost down! This is no good."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your fear is now {}"</span><span class="token punctuation">,</span> x <span class="token operator">*</span> <span class="token number">1.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            x <span class="token operator">*</span> <span class="token number">1.4</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token class-name">Night</span> <span class="token operator">=&gt;</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"What a horrible night to have a curse."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Your fear is now {}"</span><span class="token punctuation">,</span> x <span class="token operator">*</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            x <span class="token operator">*</span> <span class="token number">5.0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">TimeOfDay</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> character_fear <span class="token operator">=</span> <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token comment">// Start Simon with 10</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> daytime <span class="token operator">=</span> <span class="token function">change_fear</span><span class="token punctuation">(</span><span class="token class-name">Day</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make four closures here to call every time we want to change Simon's fear.</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> sunset <span class="token operator">=</span> <span class="token function">change_fear</span><span class="token punctuation">(</span><span class="token class-name">Sunset</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> night <span class="token operator">=</span> <span class="token function">change_fear</span><span class="token punctuation">(</span><span class="token class-name">Night</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> morning <span class="token operator">=</span> <span class="token function">change_fear</span><span class="token punctuation">(</span><span class="token class-name">Dawn</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    character_fear <span class="token operator">=</span> <span class="token function">daytime</span><span class="token punctuation">(</span>character_fear<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Call the closures on Simon's fear. They give a message and change the fear number.</span>
                                              <span class="token comment">// In real life we would have a Character struct and use it as a method instead,</span>
                                              <span class="token comment">// like this: character_fear.daytime()</span>
    character_fear <span class="token operator">=</span> <span class="token function">sunset</span><span class="token punctuation">(</span>character_fear<span class="token punctuation">)</span><span class="token punctuation">;</span>
    character_fear <span class="token operator">=</span> <span class="token function">night</span><span class="token punctuation">(</span>character_fear<span class="token punctuation">)</span><span class="token punctuation">;</span>
    character_fear <span class="token operator">=</span> <span class="token function">morning</span><span class="token punctuation">(</span>character_fear<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">What a nice day. Maybe put your feet up and rest a bit.
Your fear is now 2
The sun is almost down! This is no good.
Your fear is now 2.8
What a horrible night to have a curse.
Your fear is now 14
The morning sun has vanquished the horrible night. You no longer feel afraid.
Your fear is now 7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Arc"><a href="#Arc" class="headerlink" title="Arc"></a>Arc</h2><p>ä½ è¿˜è®°å¾—æˆ‘ä»¬ç”¨<code>Rc</code>æ¥ç»™ä¸€ä¸ªå˜é‡ä¸€ä¸ªä»¥ä¸Šçš„æ‰€æœ‰è€…ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åšåŒæ ·çš„äº‹æƒ…ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª <code>Arc</code>ã€‚<code>Arc</code>çš„æ„æ€æ˜¯ â€œatomic reference counterâ€(åŸå­å¼•ç”¨è®¡æ•°å™¨)ã€‚åŸå­çš„æ„æ€æ˜¯å®ƒä½¿ç”¨è®¡ç®—æœºçš„å¤„ç†å™¨ï¼Œæ‰€ä»¥æ¯æ¬¡åªå†™ä¸€æ¬¡æ•°æ®ã€‚è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å†™å…¥æ•°æ®ï¼Œä½ ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ èƒ½åœ¨Rustä¸­åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">let</span> <span class="token keyword">mut</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span> <span class="token comment">// Thread 1</span>
    x <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span> <span class="token comment">// Thread 2</span>
    x <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>å¦‚æœçº¿ç¨‹1å’Œçº¿ç¨‹2ä¸€èµ·å¯åŠ¨ï¼Œä¹Ÿè®¸å°±ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚</p>
<ul>
<li>çº¿ç¨‹1çœ‹åˆ°10ï¼Œå†™ä¸‹11ï¼Œç„¶åçº¿ç¨‹2çœ‹åˆ°11ï¼Œå†™ä¸‹12 ç„¶åçº¿ç¨‹2çœ‹åˆ°11ï¼Œå†™å…¥12ã€‚åˆ°ç›®å‰ä¸ºæ­¢æ²¡æœ‰é—®é¢˜ã€‚</li>
<li>çº¿ç¨‹1çœ‹åˆ°12ã€‚åŒæ—¶ï¼Œçº¿ç¨‹2çœ‹åˆ°12ã€‚çº¿ç¨‹ä¸€çœ‹åˆ°13ï¼Œå†™ä¸‹13 çº¿ç¨‹2ä¹Ÿå†™äº†13 ç°åœ¨æˆ‘ä»¬æœ‰13ä¸ªï¼Œä½†åº”è¯¥æ˜¯14ä¸ª Now we have 13, but it should be 14. è¿™æ˜¯ä¸ªå¤§é—®é¢˜ã€‚</li>
</ul>
<p><code>Arc</code>ä½¿ç”¨å¤„ç†å™¨æ¥ç¡®ä¿è¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿï¼Œæ‰€ä»¥å½“ä½ æœ‰çº¿ç¨‹æ—¶å¿…é¡»ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ä¸è¿‡ä¸å»ºè®®å•çº¿ç¨‹ä¸Šç”¨<code>Arc</code>ï¼Œå› ä¸º<code>Rc</code>æ›´å¿«ä¸€äº›ã€‚</p>
<p>ä¸è¿‡ä½ ä¸èƒ½åªç”¨ä¸€ä¸ª<code>Arc</code>æ¥æ”¹å˜æ•°æ®ã€‚æ‰€ä»¥ä½ ç”¨ä¸€ä¸ª<code>Mutex</code>æŠŠæ•°æ®åŒ…èµ·æ¥ï¼Œç„¶åç”¨ä¸€ä¸ª<code>Arc</code>æŠŠ<code>Mutex</code>åŒ…èµ·æ¥ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç”¨ä¸€ä¸ª<code>Mutex</code>åœ¨ä¸€ä¸ª<code>Arc</code>é‡Œé¢æ¥æ”¹å˜ä¸€ä¸ªæ•°å­—çš„å€¼ã€‚é¦–å…ˆæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªçº¿ç¨‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The thread is working!"</span><span class="token punctuation">)</span> <span class="token comment">// Just testing the thread</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make the thread wait here until it is done</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Exiting the program"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªåªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The thread is working!
Exiting the program<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å¾ˆå¥½ï¼Œç°åœ¨è®©æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨<code>for</code>çš„å¾ªç¯ä¸­ï¼Œè¿›è¡Œ<code>0..5</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The thread is working!"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Exiting the program"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚æˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ç»“æœ:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">The thread is working!
The thread is working!
The thread is working!
The thread is working!
The thread is working!
Exiting the program<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬å†åŠ ä¸€ä¸ªçº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåšåŒæ ·çš„äº‹æƒ…ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›çº¿ç¨‹æ˜¯åœ¨åŒä¸€æ—¶é—´å·¥ä½œçš„ã€‚æœ‰æ—¶ä¼šå…ˆæ‰“å°<code>Thread 1 is working!</code>ï¼Œä½†å…¶ä»–æ—¶å€™<code>Thread 2 is working!</code>å…ˆæ‰“å°ã€‚è¿™å°±æ˜¯æ‰€è°“çš„<strong>å¹¶å‘</strong>ï¼Œä¹Ÿå°±æ˜¯ â€œä¸€èµ·è¿è¡Œâ€çš„æ„æ€ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> thread1 <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Thread 1 is working!"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> thread2 <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Thread 2 is working!"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    thread1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thread2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Exiting the program"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Thread 1 is working!
Thread 1 is working!
Thread 1 is working!
Thread 1 is working!
Thread 1 is working!
Thread 2 is working!
Thread 2 is working!
Thread 2 is working!
Thread 2 is working!
Thread 2 is working!
Exiting the program<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬è¦æ”¹å˜<code>my_number</code>çš„æ•°å€¼ã€‚ç°åœ¨å®ƒæ˜¯ä¸€ä¸ª<code>i32</code>ã€‚æˆ‘ä»¬å°†æŠŠå®ƒæ”¹ä¸º <code>Arc&lt;Mutex&lt;i32&gt;&gt;</code>:ä¸€ä¸ªå¯ä»¥æ”¹å˜çš„ <code>i32</code>ï¼Œç”± <code>Arc</code> ä¿æŠ¤ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥å…‹éš†å®ƒã€‚æ¯ä¸ªå…‹éš†å¯ä»¥è¿›å…¥ä¸åŒçš„çº¿ç¨‹ã€‚æˆ‘ä»¬æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åšä¸¤ä¸ªå…‹éš†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> my_number1 <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This clone goes into Thread 1</span>
<span class="token keyword">let</span> my_number2 <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This clone goes into Thread 2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å°†å®‰å…¨å…‹éš†è¿æ¥åˆ°<code>my_number</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬<code>move</code>åˆ°å…¶ä»–çº¿ç¨‹ä¸­ï¼Œæ²¡æœ‰é—®é¢˜ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Arc</span><span class="token punctuation">,</span> <span class="token class-name">Mutex</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> my_number1 <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_number2 <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> thread1 <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// Only the clone goes into Thread 1</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
            <span class="token operator">*</span>my_number1<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Lock the Mutex, change the value</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> thread2 <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// Only the clone goes into Thread 2</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
            <span class="token operator">*</span>my_number2<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    thread1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thread2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Value is: {:?}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Exiting the program"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¨‹åºæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Value is: Mutex { data: 20 }
Exiting the program<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªæˆåŠŸçš„æ¡ˆä¾‹ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªçº¿ç¨‹è¿æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ª<code>for</code>å¾ªç¯ï¼Œå¹¶ä½¿ä»£ç æ›´å°ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä¿å­˜å¥æŸ„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å¾ªç¯å¤–å¯¹æ¯ä¸ªçº¿ç¨‹è°ƒç”¨<code>.join()</code>ã€‚å¦‚æœæˆ‘ä»¬åœ¨å¾ªç¯å†…è¿™æ ·åšï¼Œå®ƒå°†ç­‰å¾…ç¬¬ä¸€ä¸ªçº¿ç¨‹å®Œæˆåå†å¯åŠ¨æ–°çš„çº¿ç¨‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Arc</span><span class="token punctuation">,</span> <span class="token class-name">Mutex</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> handle_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// JoinHandles will go in here</span>

    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span> <span class="token comment">// do this twice</span>
        <span class="token keyword">let</span> my_number_clone <span class="token operator">=</span> <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make the clone before starting the thread</span>
        <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// Put the clone in</span>
            <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
                <span class="token operator">*</span>my_number_clone<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        handle_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// save the handle so we can call join on it outside of the loop</span>
                                 <span class="token comment">// If we don't push it in the vec, it will just die here</span>
    <span class="token punctuation">}</span>

    handle_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>handle<span class="token closure-punctuation punctuation">|</span></span> handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// call join on all handles</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€åè¿™ä¸ªæ‰“å°<code>Mutex { data: 20 }</code>ã€‚</p>
<p>è¿™çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†<code>Arc&lt;Mutex&lt;SomeType&gt;&gt;&gt;</code>åœ¨Rustä¸­ä½¿ç”¨çš„é¢‘ç‡å¾ˆé«˜ï¼Œæ‰€ä»¥å®ƒå˜å¾—å¾ˆè‡ªç„¶ã€‚å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥éšæ—¶å†™ä½ çš„ä»£ç ï¼Œè®©å®ƒæ›´å¹²å‡€ã€‚è¿™é‡Œæ˜¯åŒæ ·çš„ä»£ç ï¼Œå¤šäº†ä¸€æ¡<code>use</code>è¯­å¥å’Œä¸¤ä¸ªå‡½æ•°ã€‚è¿™äº›å‡½æ•°å¹¶æ²¡æœ‰åšä»»ä½•æ–°çš„äº‹æƒ…ï¼Œä½†æ˜¯å®ƒä»¬æŠŠä¸€äº›ä»£ç ä»<code>main()</code>ä¸­ç§»å‡ºã€‚å¦‚æœä½ å¾ˆéš¾è¯»æ‡‚çš„è¯ï¼Œå¯ä»¥å°è¯•é‡å†™è¿™æ ·çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Arc</span><span class="token punctuation">,</span> <span class="token class-name">Mutex</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span>spawn<span class="token punctuation">;</span> <span class="token comment">// Now we just write spawn</span>

<span class="token keyword">fn</span> <span class="token function-definition function">make_arc</span><span class="token punctuation">(</span>number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">Mutex</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// Just a function to make a Mutex in an Arc</span>
    <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Mutex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">new_clone</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">Mutex</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">Mutex</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// Just a function so we can write new_clone</span>
    <span class="token class-name">Arc</span><span class="token punctuation">::</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>input<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Now main() is easier to read</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> handle_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// each handle will go in here</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token function">make_arc</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">2</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> my_number_clone <span class="token operator">=</span> <span class="token function">new_clone</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> <span class="token keyword">mut</span> value_inside <span class="token operator">=</span> my_number_clone<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token operator">*</span>value_inside <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        handle_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// the handle is done, so put it in the vector</span>
    <span class="token punctuation">}</span>

    handle_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>handle<span class="token closure-punctuation punctuation">|</span></span> handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make each one wait</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Channels"><a href="#Channels" class="headerlink" title="Channels"></a>Channels</h2><p>A channel is an easy way to use many threads that send to one place.å®ƒä»¬ç›¸å½“æµè¡Œï¼Œå› ä¸ºå®ƒä»¬å¾ˆå®¹æ˜“ç»„åˆåœ¨ä¸€èµ·ã€‚ä½ å¯ä»¥åœ¨Rustä¸­ç”¨<code>std::sync::mpsc</code>åˆ›å»ºä¸€ä¸ªchannelã€‚<code>mpsc</code>çš„æ„æ€æ˜¯ â€œå¤šä¸ªç”Ÿäº§è€…ï¼Œå•ä¸ªæ¶ˆè´¹è€…â€ï¼Œæ‰€ä»¥ â€œmany threads sending to one placeâ€ã€‚è¦å¯åŠ¨ä¸€ä¸ªé€šé“ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>channel()</code>ã€‚è¿™å°†åˆ›å»ºä¸€ä¸ª <code>Sender</code> å’Œä¸€ä¸ª <code>Receiver</code>ï¼Œå®ƒä»¬è¢«ç»‘åœ¨ä¸€èµ·ã€‚ä½ å¯ä»¥åœ¨å‡½æ•°ç­¾åä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">channel</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">Sender</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Receiver</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ è¦é€‰æ‹©ä¸€ä¸ªå‘é€è€…çš„åå­—å’Œä¸€ä¸ªæ¥æ”¶è€…çš„åå­—ã€‚é€šå¸¸ä½ ä¼šçœ‹åˆ°åƒ<code>let (sender, receiver) = channel();</code>è¿™æ ·çš„å¼€å¤´ã€‚å› ä¸ºå®ƒæ˜¯æ³›å‹ï¼Œå¦‚æœä½ åªå†™è¿™ä¸ªï¼ŒRustä¸ä¼šçŸ¥é“ç±»å‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨è¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0282]: type annotations needed for `(std::sync::mpsc::Sender&lt;T&gt;, std::sync::mpsc::Receiver&lt;T&gt;)`
  --&gt; src\main.rs:30:30
   |
30 |     let (sender, receiver) = channel();
   |         ------------------   ^^^^^^^ cannot infer type for type parameter `T` declared on the function `channel`
   |         |
   |         consider giving this pattern the explicit type `(std::sync::mpsc::Sender&lt;T&gt;, std::sync::mpsc::Receiver&lt;T&gt;)`, where
the type parameter `T` is specified<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒå»ºè®®ä¸º<code>Sender</code>å’Œ<code>Receiver</code>æ·»åŠ ä¸€ä¸ªç±»å‹ã€‚å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œå¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span><span class="token punctuation">{</span>channel<span class="token punctuation">,</span> <span class="token class-name">Sender</span><span class="token punctuation">,</span> <span class="token class-name">Receiver</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Added Sender and Receiver here</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Sender</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Receiver</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†ä½ ä¸å¿…è¿™æ ·åš: ä¸€æ—¦ä½ å¼€å§‹ä½¿ç”¨<code>Sender</code>å’Œ<code>Receiver</code>ï¼ŒRustå°±èƒ½çŒœåˆ°ç±»å‹ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœ€ç®€å•çš„ä½¿ç”¨é€šé“çš„æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    sender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    receiver<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// recv = receive, not "rec v"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ç¼–è¯‘å™¨çŸ¥é“ç±»å‹äº†ã€‚<code>sender</code>æ˜¯<code>Result&lt;(), SendError&lt;i32&gt;&gt;</code>ï¼Œ<code>receiver</code>æ˜¯<code>Result&lt;i32, RecvError&gt;</code>ã€‚æ‰€ä»¥ä½ å¯ä»¥ç”¨<code>.unwrap()</code>æ¥çœ‹çœ‹å‘é€æ˜¯å¦æœ‰æ•ˆï¼Œæˆ–è€…ä½¿ç”¨æ›´å¥½çš„é”™è¯¯å¤„ç†ã€‚æˆ‘ä»¬åŠ ä¸Š<code>.unwrap()</code>ï¼Œä¹ŸåŠ ä¸Š<code>println!</code>ï¼Œçœ‹çœ‹å¾—åˆ°ä»€ä¹ˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    sender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> receiver<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°å‡º<code>5</code>ã€‚</p>
<p><code>channel</code>å°±åƒ<code>Arc</code>ä¸€æ ·ï¼Œå› ä¸ºä½ å¯ä»¥å…‹éš†å®ƒï¼Œå¹¶å°†å…‹éš†çš„å†…å®¹å‘é€åˆ°å…¶ä»–çº¿ç¨‹ä¸­ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†å€¼å‘é€åˆ°<code>receiver</code>ã€‚è¿™æ®µä»£ç å¯ä»¥å·¥ä½œï¼Œä½†å®ƒå¹¶ä¸å®Œå…¨æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> sender_clone <span class="token operator">=</span> sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// move sender in</span>
        sender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Send a &amp;str this time"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// move sender_clone in</span>
        sender_clone<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"And here is another &amp;str"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> receiver<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸¤ä¸ªçº¿ç¨‹å¼€å§‹å‘é€ï¼Œç„¶åæˆ‘ä»¬<code>println!</code>ã€‚å®ƒå¯èƒ½ä¼šæ‰“å° <code>Send a &amp;str this time</code> æˆ– <code>And here is another &amp;str</code>ï¼Œè¿™å–å†³äºå“ªä¸ªçº¿ç¨‹å…ˆå®Œæˆã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªjoinå¥æŸ„æ¥ç­‰å¾…å®ƒä»¬å®Œæˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> sender_clone <span class="token operator">=</span> sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> handle_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Put our handles in here</span>

    handle_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>  <span class="token comment">// push this into the vec</span>
        sender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Send a &amp;str this time"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    handle_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>  <span class="token comment">// and push this into the vec</span>
        sender_clone<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"And here is another &amp;str"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> _ <span class="token keyword">in</span> handle_vec <span class="token punctuation">{</span> <span class="token comment">// now handle_vec has 2 items. Let's print them</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> receiver<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">"Send a &amp;str this time"
"And here is another &amp;str"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬ä¸æ‰“å°ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>results_vec</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> sender_clone <span class="token operator">=</span> sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> handle_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> results_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    handle_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        sender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Send a &amp;str this time"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    handle_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        sender_clone<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"And here is another &amp;str"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> _ <span class="token keyword">in</span> handle_vec <span class="token punctuation">{</span>
        results_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> results_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ç»“æœåœ¨æˆ‘ä»¬çš„vecä¸­:<code>["Send a &amp;str this time", "And here is another &amp;str"]</code>ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰å¾ˆå¤šå·¥ä½œè¦åšï¼Œå¹¶ä¸”æƒ³è¦ä½¿ç”¨çº¿ç¨‹ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤§çš„VECï¼Œé‡Œé¢æœ‰1000ä¸ªå…ƒç´ ï¼Œéƒ½æ˜¯0ï¼Œæˆ‘ä»¬æƒ³æŠŠæ¯ä¸ª0éƒ½å˜æˆ1ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨10ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å°†åšååˆ†ä¹‹ä¸€çš„å·¥ä½œã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„VECï¼Œå¹¶ä½¿ç”¨<code>.extend()</code>æ¥æ”¶é›†ç»“æœã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>sync<span class="token punctuation">::</span>mpsc<span class="token punctuation">::</span></span>channel<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> hugevec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> newvec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">10</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> sender_clone <span class="token operator">=</span> sender<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> <span class="token keyword">mut</span> work<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span>hugevec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// new vec to put the work in. 1/10th the size</span>
        work<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hugevec<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">..</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// first part gets 0..100, next gets 100..200, etc.</span>
        <span class="token keyword">let</span> handle <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span> <span class="token comment">// make a handle</span>

            <span class="token keyword">for</span> number <span class="token keyword">in</span> work<span class="token punctuation">.</span><span class="token function">iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// do the actual work</span>
                <span class="token operator">*</span>number <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            sender_clone<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>work<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// use the sender_clone to send the work to the receiver</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        handle<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// stop the thread until it's done</span>
        newvec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>receiver<span class="token punctuation">.</span><span class="token function">recv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// push the results from receiver.recv() into the vec</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Now we have a Vec&lt;Vec&lt;u8&gt;&gt;. To put it together we can use .flatten()</span>
    <span class="token keyword">let</span> newvec <span class="token operator">=</span> newvec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flatten</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it's one vec of 1000 u8 numbers</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ æ‰“å°è¿™ä¸ªï¼Œä½ å¯ä»¥çœ‹åˆ°1000ä¸ª1ã€‚</p>
<h2 id="é˜…è¯»Rustæ–‡æ¡£"><a href="#é˜…è¯»Rustæ–‡æ¡£" class="headerlink" title="é˜…è¯»Rustæ–‡æ¡£"></a>é˜…è¯»Rustæ–‡æ¡£</h2><p>çŸ¥é“å¦‚ä½•é˜…è¯»Rustä¸­çš„æ–‡æ¡£æ˜¯å¾ˆé‡è¦çš„ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç†è§£å…¶ä»–äººå†™çš„ä¸œè¥¿ã€‚è¿™é‡Œæœ‰ä¸€äº›Rustæ–‡æ¡£ä¸­éœ€è¦çŸ¥é“çš„äº‹æƒ…ã€‚</p>
<h3 id="assert-eq"><a href="#assert-eq" class="headerlink" title="assert_eq!"></a>assert_eq!</h3><p>ä½ åœ¨åšæµ‹è¯•çš„æ—¶å€™çœ‹åˆ°<code>assert_eq!</code>æ˜¯ç”¨çš„ã€‚ä½ æŠŠä¸¤ä¸ªå…ƒç´ æ”¾åœ¨å‡½æ•°é‡Œé¢ï¼Œå¦‚æœå®ƒä»¬ä¸ç›¸ç­‰ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¶æ•°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">prints_number</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">prints_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>input <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number must be equal.</span>
                              <span class="token comment">// If number % 2 is not 0, it panics</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The number is not odd. It is {}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¹Ÿè®¸ä½ æ²¡æœ‰ä»»ä½•è®¡åˆ’åœ¨ä½ çš„ä»£ç ä¸­ä½¿ç”¨<code>assert_eq!</code>ï¼Œä½†å®ƒåœ¨Rustæ–‡æ¡£ä¸­éšå¤„å¯è§ã€‚è¿™æ˜¯å› ä¸ºåœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­ï¼Œä½ éœ€è¦å¾ˆå¤§çš„ç©ºé—´æ¥<code>println!</code>ä¸€åˆ‡ã€‚å¦å¤–ï¼Œä½ ä¼šéœ€è¦<code>Display</code>æˆ–<code>Debug</code>æ¥æ‰“å°ä½ æƒ³æ‰“å°çš„ä¸œè¥¿ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ–‡æ¡£ä¸­åˆ°å¤„éƒ½æœ‰<code>assert_eq!</code>çš„åŸå› ã€‚ä¸‹é¢æ˜¯è¿™é‡Œçš„ä¸€ä¸ªä¾‹å­<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/vec/struct.Vec.html">https://doc.rust-lang.org/std/vec/struct.Vec.html</a>ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Vecã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    vec<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">copied</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token operator">&amp;</span>vec <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥åªæŠŠ<code>assert_eq!(a, b)</code>çœ‹æˆæ˜¯åœ¨è¯´ â€œaæ˜¯bâ€ã€‚ç°åœ¨çœ‹çœ‹å³è¾¹å¸¦æœ‰æ³¨é‡Šçš„åŒä¸€ä¸ªä¾‹å­ã€‚æ³¨é‡Šæ˜¾ç¤ºäº†å®ƒçš„å®é™…å«ä¹‰ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> vec <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "The vec length is 2"</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "vec[0] is 1"</span>

    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "When you use .pop(), you get Some()"</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "The vec length is now 1"</span>

    vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Vec[0] is 7"</span>

    vec<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">copied</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token operator">&amp;</span>vec <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>vec<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "The vec now has [7, 1, 2, 3]"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h3><p>Rust æ–‡æ¡£çš„é¡¶éƒ¨æ æ˜¯æœç´¢æ ã€‚å®ƒåœ¨ä½ è¾“å…¥æ—¶æ˜¾ç¤ºç»“æœã€‚å½“ä½ å¾€ä¸‹ç¿»æ—¶ï¼Œä½ ä¸èƒ½å†çœ‹åˆ°æœç´¢æ ï¼Œä½†å¦‚æœä½ æŒ‰é”®ç›˜ä¸Šçš„<strong>s</strong>é”®ï¼Œä½ å¯ä»¥å†æ¬¡æœç´¢ã€‚æ‰€ä»¥åœ¨ä»»ä½•åœ°æ–¹æŒ‰<strong>s</strong>é”®å¯ä»¥è®©ä½ é©¬ä¸Šæœç´¢ã€‚</p>
<h3 id="src-æŒ‰é’®"><a href="#src-æŒ‰é’®" class="headerlink" title="[src] æŒ‰é’®"></a>[src] æŒ‰é’®</h3><p>é€šå¸¸ä¸€ä¸ªæ–¹æ³•ã€ç»“æ„ä½“ç­‰çš„ä»£ç ä¸ä¼šæ˜¯å®Œæ•´çš„ã€‚è¿™æ˜¯å› ä¸ºä½ é€šå¸¸ä¸éœ€è¦çœ‹åˆ°å®Œæ•´çš„æºç å°±èƒ½çŸ¥é“å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè€Œå®Œæ•´çš„ä»£ç å¯èƒ½ä¼šè®©äººå›°æƒ‘ã€‚ä½†å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šï¼Œä½ å¯ä»¥ç‚¹å‡»[src]å°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œåœ¨<code>String</code>çš„é¡µé¢ä¸Šï¼Œä½ å¯ä»¥çœ‹åˆ°<code>.with_capacity()</code>çš„è¿™ä¸ªç­¾åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">with_capacity</span><span class="token punctuation">(</span>capacity<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å¥½äº†ï¼Œä½ è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œå®ƒç»™ä½ ä¸€ä¸ª<code>String</code>ã€‚è¿™å¾ˆç®€å•ï¼Œä½†ä¹Ÿè®¸æˆ‘ä»¬å¾ˆå¥½å¥‡ï¼Œæƒ³çœ‹æ›´å¤šã€‚å¦‚æœä½ ç‚¹å‡»[src]ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">with_capacity</span><span class="token punctuation">(</span>capacity<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token punctuation">{</span> vec<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span>capacity<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰è¶£çš„æ˜¯ï¼Œç°åœ¨ä½ å¯ä»¥çœ‹åˆ°ï¼Œå­—ç¬¦ä¸²æ˜¯<code>Vec</code>çš„ä¸€ç§ã€‚è€Œå®é™…ä¸Šä¸€ä¸ª<code>String</code>æ˜¯ä¸€ä¸ª<code>u8</code>å­—èŠ‚çš„å‘é‡ï¼Œè¿™å¾ˆæœ‰æ„æ€ã€‚ä½ ä¸éœ€è¦çŸ¥é“ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>with_capacity</code>çš„æ–¹æ³•ï¼Œä½ åªæœ‰ç‚¹å‡»[src]æ‰èƒ½çœ‹åˆ°ã€‚æ‰€ä»¥å¦‚æœæ–‡æ¡£æ²¡æœ‰å¤ªå¤šç»†èŠ‚ï¼Œè€Œä½ åˆæƒ³çŸ¥é“æ›´å¤šçš„è¯ï¼Œç‚¹å‡»[src]æ˜¯ä¸ªå¥½ä¸»æ„ã€‚</p>
<h3 id="traitä¿¡æ¯"><a href="#traitä¿¡æ¯" class="headerlink" title="traitä¿¡æ¯"></a>traitä¿¡æ¯</h3><p>traitæ–‡æ¡£çš„é‡è¦éƒ¨åˆ†æ˜¯å·¦è¾¹çš„ â€œRequired Methodsâ€ã€‚å¦‚æœä½ çœ‹åˆ° â€œRequired Methodsâ€ï¼Œå¯èƒ½æ„å‘³ç€ä½ å¿…é¡»è‡ªå·±ç¼–å†™æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¯¹äº <code>Iterator</code>ï¼Œä½ éœ€è¦å†™ <code>.next()</code> æ–¹æ³•ã€‚è€Œå¯¹äº<code>From</code>ï¼Œä½ éœ€è¦å†™<code>.from()</code>æ–¹æ³•ã€‚ä½†æ˜¯æœ‰äº›traitåªéœ€è¦ä¸€ä¸ª<strong>å±æ€§</strong>å°±å¯ä»¥å®ç°ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨<code>#[derive(Debug)]</code>ä¸­çœ‹åˆ°çš„ã€‚<code>Debug</code>éœ€è¦<code>.fmt()</code>æ–¹æ³•ï¼Œä½†é€šå¸¸ä½ åªéœ€è¦ä½¿ç”¨<code>#[derive(Debug)]</code>ï¼Œé™¤éä½ æƒ³è‡ªå·±åšã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨<code>std::fmt::Debug</code>çš„é¡µé¢ä¸Šè¯´ â€œä¸€èˆ¬æ¥è¯´ï¼Œä½ åº”è¯¥ç›´æ¥æ´¾ç”Ÿå‡ºä¸€ä¸ªDebugå®ç°â€ã€‚</p>
<h2 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h2><p>ä½ ä»¥å‰è§è¿‡<code>#[derive(Debug)]</code>è¿™æ ·çš„ä»£ç :è¿™ç§ç±»å‹çš„ä»£ç å«åš<em>å±æ€§</em>ã€‚è¿™äº›å±æ€§æ˜¯ç»™ç¼–è¯‘å™¨æä¾›ä¿¡æ¯çš„å°æ®µä»£ç ã€‚å®ƒä»¬ä¸å®¹æ˜“åˆ›å»ºï¼Œä½†ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚å¦‚æœä½ åªç”¨<code>#</code>å†™ä¸€ä¸ªå±æ€§ï¼Œé‚£ä¹ˆå®ƒå°†å½±å“ä¸‹ä¸€è¡Œçš„ä»£ç ã€‚ä½†å¦‚æœä½ ç”¨<code>#!</code>æ¥å†™ï¼Œé‚£ä¹ˆå®ƒå°†å½±å“è‡ªå·±ç©ºé—´é‡Œçš„ä¸€åˆ‡ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€äº›ä½ ä¼šç»å¸¸çœ‹åˆ°çš„å±æ€§ã€‚</p>
<p><code>#[allow(dead_code)]</code> å’Œ <code>#[allow(unused_variables)]</code>. å¦‚æœä½ å†™äº†ä¸ç”¨çš„ä»£ç ï¼ŒRustä»ç„¶ä¼šç¼–è¯‘ï¼Œä½†ä¼šè®©ä½ çŸ¥é“ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œé‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåªæœ‰ä¸€ä¸ªå˜é‡ã€‚æˆ‘ä»¬ä¸ä½¿ç”¨å®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">JustAStruct</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_char <span class="token operator">=</span> <span class="token char string">'ã‚“'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ è¿™æ ·å†™ï¼ŒRustä¼šæé†’ä½ ï¼Œä½ æ²¡æœ‰ä½¿ç”¨å®ƒä»¬ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">warning: unused variable: `some_char`
 --&gt; src\main.rs:4:9
  |
4 |     let some_char = 'ã‚“';
  |         ^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_some_char`
  |
  = note: `#[warn(unused_variables)]` on by default

warning: struct is never constructed: `JustAStruct`
 --&gt; src\main.rs:1:8
  |
1 | struct JustAStruct {}
  |        ^^^^^^^^^^^
  |
  = note: `#[warn(dead_code)]` on by default<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯ä»¥åœ¨åå­—å‰å†™ä¸€ä¸ª<code>_</code>ï¼Œè®©ç¼–è¯‘å™¨å®‰é™ä¸‹æ¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">_JustAStruct</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _some_char <span class="token operator">=</span> <span class="token char string">'ã‚“'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å±æ€§ã€‚ä½ ä¼šæ³¨æ„åˆ°åœ¨æ¶ˆæ¯ä¸­ï¼Œå®ƒä½¿ç”¨äº†<code>#[warn(unused_variables)]</code>å’Œ<code>#[warn(dead_code)]</code>ã€‚åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œ<code>JustAStruct</code>æ˜¯æ­»ä»£ç ï¼Œè€Œ<code>some_char</code>æ˜¯ä¸€ä¸ªæœªä½¿ç”¨çš„å˜é‡ã€‚<code>warn</code>çš„åä¹‰è¯æ˜¯<code>allow</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼Œå®ƒä¸ä¼šè¯´ä»€ä¹ˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#![allow(dead_code)]</span>
<span class="token attribute attr-name">#![allow(unused_variables)]</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Struct1</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Create five structs</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Struct2</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Struct3</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Struct4</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Struct5</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> char1 <span class="token operator">=</span> <span class="token char string">'ã‚“'</span><span class="token punctuation">;</span> <span class="token comment">// and four variables. We don't use any of them but the compiler is quiet</span>
    <span class="token keyword">let</span> char2 <span class="token operator">=</span> <span class="token char string">';'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> some_str <span class="token operator">=</span> <span class="token string">"I'm just a regular &amp;str"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> some_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"am"</span><span class="token punctuation">,</span> <span class="token string">"just"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"vec"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œå¤„ç†æ­»ä»£ç å’Œæœªä½¿ç”¨çš„å˜é‡æ˜¯å¾ˆé‡è¦çš„ã€‚ä½†æœ‰æ—¶ä½ å¸Œæœ›ç¼–è¯‘å™¨å®‰é™ä¸€æ®µæ—¶é—´ã€‚æˆ–è€…æ‚¨å¯èƒ½éœ€è¦å±•ç¤ºä¸€äº›ä»£ç æˆ–æ•™äººä»¬Rustï¼Œä½†åˆä¸æƒ³ç”¨ç¼–è¯‘å™¨çš„ä¿¡æ¯æ¥è¿·æƒ‘ä»–ä»¬ã€‚</p>
<p><code>#[derive(TraitName)]</code>è®©ä½ å¯ä»¥ä¸ºä½ åˆ›å»ºçš„ç»“æ„å’Œæšä¸¾æ´¾ç”Ÿä¸€äº›traitã€‚è¿™é€‚ç”¨äºè®¸å¤šå¯ä»¥è‡ªåŠ¨æ´¾ç”Ÿçš„å¸¸è§traitã€‚æœ‰äº›åƒ <code>Display</code> è¿™æ ·çš„ç‰¹æ€§ä¸èƒ½è‡ªåŠ¨è¡ç”Ÿï¼Œå› ä¸ºå¯¹äº <code>Display</code>ï¼Œä½ å¿…é¡»é€‰æ‹©å¦‚ä½•æ˜¾ç¤ºã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token attribute attr-name">#[derive(Display)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">HoldsAString</span> <span class="token punctuation">{</span>
    the_string<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">HoldsAString</span> <span class="token punctuation">{</span>
        the_string<span class="token punctuation">:</span> <span class="token string">"Here I am!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é”™è¯¯ä¿¡æ¯ä¼šå‘Šè¯‰ä½ :</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error: cannot find derive macro `Display` in this scope
 --&gt; src\main.rs:2:10
  |
2 | #[derive(Display)]
  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¯¹äºå¯ä»¥è‡ªåŠ¨æ¨å¯¼å‡ºçš„traitï¼Œä½ å¯ä»¥éšå¿ƒæ‰€æ¬²çš„æ”¾è¿›å»ã€‚è®©æˆ‘ä»¬ç»™<code>HoldsAString</code>åœ¨ä¸€è¡Œä¸­åŠ å…¥ä¸ƒä¸ªtraitï¼Œåªæ˜¯ä¸ºäº†å¥½ç©ï¼Œå°½ç®¡å®ƒåªéœ€è¦ä¸€ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug, PartialEq, Eq, Ord, PartialOrd, Hash, Clone)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">HoldsAString</span> <span class="token punctuation">{</span>
    the_string<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">HoldsAString</span> <span class="token punctuation">{</span>
        the_string<span class="token punctuation">:</span> <span class="token string">"Here I am!"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–ï¼Œå¦‚æœ(ä¹Ÿåªæœ‰åœ¨)å®ƒçš„å­—æ®µéƒ½æ˜¯<code>Copy</code>çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>Copy</code>ç»“æ„ã€‚<code>HoldsAString</code>æœ‰<code>String</code>ï¼Œå®ƒä¸æ˜¯<code>Copy</code>ï¼Œæ‰€ä»¥ä½ ä¸èƒ½å¯¹å®ƒä½¿ç”¨<code>#[derive(Copy)]</code>ã€‚ä½†æ˜¯å¯¹äºè¿™ä¸ªç»“æ„ä½ å¯ä»¥:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Clone, Copy)]</span> <span class="token comment">// You also need Clone to use Copy</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">NumberAndBool</span> <span class="token punctuation">{</span>
    number<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token comment">// i32 is Copy</span>
    true_or_false<span class="token punctuation">:</span> <span class="token keyword">bool</span> <span class="token comment">// bool is also Copy. So no problem</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">does_nothing</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">NumberAndBool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_and_bool <span class="token operator">=</span> <span class="token class-name">NumberAndBool</span> <span class="token punctuation">{</span>
        number<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        true_or_false<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">does_nothing</span><span class="token punctuation">(</span>number_and_bool<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">does_nothing</span><span class="token punctuation">(</span>number_and_bool<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// If it didn't have copy, this would make an error</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p><code>#[cfg()]</code>çš„æ„æ€æ˜¯é…ç½®ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨æ˜¯å¦è¿è¡Œä»£ç ã€‚å®ƒé€šå¸¸æ˜¯è¿™æ ·çš„:<code>#[cfg(test)]</code>ã€‚ä½ åœ¨å†™æµ‹è¯•å‡½æ•°çš„æ—¶å€™ç”¨è¿™ä¸ªï¼Œè¿™æ ·å®ƒå°±çŸ¥é“é™¤éä½ åœ¨æµ‹è¯•ï¼Œå¦åˆ™ä¸è¦è¿è¡Œå®ƒä»¬ã€‚é‚£ä¹ˆä½ å¯ä»¥åœ¨ä½ çš„ä»£ç é™„è¿‘æœ‰æµ‹è¯•ï¼Œä½†ç¼–è¯‘å™¨ä¸ä¼šè¿è¡Œå®ƒä»¬ï¼Œé™¤éä½ å‘Šè¯‰å®ƒã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªä½¿ç”¨<code>cfg</code>çš„ä¾‹å­æ˜¯<code>#[cfg(target_os = "windows")]</code>ã€‚æœ‰äº†å®ƒï¼Œä½ å¯ä»¥å‘Šè¯‰ç¼–è¯‘å™¨åªåœ¨Windowsï¼Œæˆ–Linuxï¼Œæˆ–å…¶ä»–æŸä¸ªå¹³å°è¿è¡Œä»£ç ã€‚</p>
<p><code>#![no_std]</code>æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å±æ€§ï¼Œå®ƒå‘Šè¯‰Rustä¸è¦å¼•å…¥æ ‡å‡†åº“ã€‚è¿™æ„å‘³ç€ä½ æ²¡æœ‰<code>Vec</code>ï¼Œ<code>String</code>ï¼Œä»¥åŠæ ‡å‡†åº“ä¸­çš„å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚ä½ ä¼šåœ¨é‚£äº›æ²¡æœ‰å¤šå°‘å†…å­˜æˆ–ç©ºé—´çš„å°å‹è®¾å¤‡çš„ä»£ç ä¸­çœ‹åˆ°è¿™ä¸ªã€‚</p>
<p>ä½ å¯ä»¥çœ‹åˆ°æ›´å¤šçš„å±æ€§<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/reference/attributes.html">è¿™é‡Œ</a>ã€‚</p>
<h2 id="Box"><a href="#Box" class="headerlink" title="Box"></a>Box</h2><p><code>Box</code> æ˜¯ Rust ä¸­ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ç±»å‹ã€‚å½“ä½ ä½¿ç”¨<code>Box</code>æ—¶ï¼Œä½ å¯ä»¥æŠŠä¸€ä¸ªç±»å‹æ”¾åœ¨å †ä¸Šè€Œä¸æ˜¯æ ˆä¸Šã€‚è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Box</code>ï¼Œåªéœ€ä½¿ç”¨ <code>Box::new()</code> å¹¶å°†å…ƒç´ æ”¾åœ¨é‡Œé¢å³å¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">just_takes_a_variable</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Takes anything and drops it.</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// This is an i32</span>
    <span class="token function">just_takes_a_variable</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">just_takes_a_variable</span><span class="token punctuation">(</span>my_number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Using this function twice is no problem, because it's Copy</span>

    <span class="token keyword">let</span> my_box <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a Box&lt;i32&gt;</span>
    <span class="token function">just_takes_a_variable</span><span class="token punctuation">(</span>my_box<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Without .clone() the second function would make an error</span>
    <span class="token function">just_takes_a_variable</span><span class="token punctuation">(</span>my_box<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// because Box is not Copy</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€å¼€å§‹å¾ˆéš¾æƒ³è±¡åœ¨å“ªé‡Œä½¿ç”¨å®ƒï¼Œä½†ä½ åœ¨Rustä¸­ç»å¸¸ä½¿ç”¨å®ƒã€‚ä½ è®°å¾—<code>&amp;</code>æ˜¯ç”¨äº<code>str</code>çš„ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸çŸ¥é“<code>str</code>çš„å¤§å°:å®ƒå¯ä»¥æ˜¯ä»»ä½•é•¿åº¦ã€‚ä½†æ˜¯<code>&amp;</code>çš„å¼•ç”¨æ€»æ˜¯ç›¸åŒçš„é•¿åº¦ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¯ä»¥ä½¿ç”¨å®ƒã€‚<code>Box</code>ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨<code>Box</code>ä¸Šä½¿ç”¨<code>*</code>æ¥è·å–å€¼ï¼Œå°±åƒä½¿ç”¨<code>&amp;</code>ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_box <span class="token operator">=</span> <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a Box&lt;i32&gt;</span>
    <span class="token keyword">let</span> an_integer <span class="token operator">=</span> <span class="token operator">*</span>my_box<span class="token punctuation">;</span> <span class="token comment">// This is an i32</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_box<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> an_integer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆBoxè¢«ç§°ä¸º â€œæ™ºèƒ½æŒ‡é’ˆâ€çš„åŸå› ï¼Œå› ä¸ºå®ƒå°±åƒ<code>&amp;</code>çš„å¼•ç”¨(æŒ‡é’ˆçš„ä¸€ç§)ï¼Œä½†å¯ä»¥åšæ›´å¤šçš„äº‹æƒ…ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Boxæ¥åˆ›å»ºé‡Œé¢æœ‰ç›¸åŒç»“æ„çš„ç»“æ„ä½“ã€‚è¿™äº›ç»“æ„è¢«ç§°ä¸º<em>é€’å½’</em>ï¼Œè¿™æ„å‘³ç€åœ¨Struct Aé‡Œé¢ä¹Ÿè®¸æ˜¯å¦ä¸€ä¸ªStruct Aï¼Œæœ‰æ—¶ä½ å¯ä»¥ä½¿ç”¨Boxæ¥åˆ›å»ºé“¾è¡¨ï¼Œå°½ç®¡è¿™åœ¨Rustä¸­å¹¶ä¸ååˆ†æµè¡Œã€‚ä½†å¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªé€’å½’ç»“æ„ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>Box</code>ã€‚å¦‚æœä½ è¯•ç€ä¸ç”¨ <code>Box</code> ä¼šå‘ç”Ÿä»€ä¹ˆ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">List</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">List</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// âš ï¸</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªç®€å•çš„<code>List</code>æœ‰ä¸€é¡¹ï¼Œå¯èƒ½æ˜¯<code>Some&lt;List&gt;</code>(å¦ä¸€ä¸ªåˆ—è¡¨)ï¼Œä¹Ÿå¯èƒ½æ˜¯<code>None</code>ã€‚å› ä¸ºä½ å¯ä»¥é€‰æ‹©<code>None</code>ï¼Œæ‰€ä»¥å®ƒä¸ä¼šæ°¸è¿œé€’å½’ã€‚ä½†æ˜¯ç¼–è¯‘å™¨è¿˜æ˜¯ä¸çŸ¥é“å¤§å°ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0072]: recursive type `List` has infinite size
  --&gt; src\main.rs:16:1
   |
16 | struct List {
   | ^^^^^^^^^^^ recursive type has infinite size
17 |     item: Option&lt;List&gt;,
   |     ------------------ recursive without indirection
   |
   = help: insert indirection (e.g., a `Box`, `Rc`, or `&amp;`) at some point to make `List` representable<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒç”šè‡³å»ºè®®å°è¯•<code>Box</code>ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨<code>Box</code>æŠŠListåŒ…è£¹èµ·æ¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">List</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token class-name">List</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ç¼–è¯‘å™¨ç”¨<code>List</code>å°±å¯ä»¥äº†ï¼Œå› ä¸ºæ‰€æœ‰çš„ä¸œè¥¿éƒ½åœ¨<code>Box</code>åé¢ï¼Œè€Œä¸”å®ƒçŸ¥é“<code>Box</code>çš„å¤§å°ã€‚é‚£ä¹ˆä¸€ä¸ªéå¸¸ç®€å•çš„åˆ—è¡¨å¯èƒ½æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">List</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token class-name">List</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">List</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">List</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span> <span class="token punctuation">{</span>
            item<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">List</span> <span class="token punctuation">{</span> item<span class="token punctuation">:</span> <span class="token class-name">None</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_list <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å³ä½¿æ²¡æœ‰æ•°æ®ä¹Ÿæœ‰ç‚¹å¤æ‚ï¼ŒRustå¹¶ä¸æ€ä¹ˆä½¿ç”¨è¿™ç§ç±»å‹çš„æ¨¡å¼ã€‚è¿™æ˜¯å› ä¸ºRustå¯¹å€Ÿç”¨å’Œæ‰€æœ‰æƒæœ‰ä¸¥æ ¼çš„è§„å®šï¼Œä½ çŸ¥é“çš„ã€‚ä½†å¦‚æœä½ æƒ³å¯åŠ¨ä¸€ä¸ªè¿™æ ·çš„åˆ—è¡¨(é“¾è¡¨)ï¼Œ<code>Box</code>å¯ä»¥å¸®åŠ©ä½ ã€‚</p>
<p><code>Box</code>è¿˜å¯ä»¥è®©ä½ åœ¨ä¸Šé¢ä½¿ç”¨<code>std::mem::drop</code>ï¼Œå› ä¸ºå®ƒåœ¨å †ä¸Šã€‚è¿™æœ‰æ—¶ä¼šå¾ˆæ–¹ä¾¿ã€‚</p>
<h2 id="Box-around-traits"><a href="#Box-around-traits" class="headerlink" title="Box around traits"></a>Box around traits</h2><p><code>Box</code>å¯¹äºè¿”å›traitéå¸¸æœ‰ç”¨ã€‚ä½ å¯ä»¥åƒè¿™ä¸ªä¾‹å­ä¸€æ ·ç”¨æ³›å‹å‡½æ•°å†™trait:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">DoesntImplementDisplay</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">displays_it</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªåªèƒ½æ¥å—<code>Display</code>çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å®ƒä¸èƒ½æ¥å—æˆ‘ä»¬çš„<code>DoesntImplementDisplay</code>ç»“æ„ã€‚ä½†æ˜¯å®ƒå¯ä»¥æ¥å—å¾ˆå¤šå…¶ä»–çš„ä¸œè¥¿ï¼Œæ¯”å¦‚<code>String</code>ã€‚</p>
<p>ä½ ä¹Ÿçœ‹åˆ°äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>impl Trait</code> æ¥è¿”å›å…¶ä»–çš„traitï¼Œæˆ–è€…é—­åŒ…ã€‚<code>Box</code>ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹å¼ä½¿ç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>Box</code>ï¼Œå¦åˆ™ç¼–è¯‘å™¨å°†ä¸çŸ¥é“å€¼çš„å¤§å°ã€‚è¿™ä¸ªä¾‹å­è¡¨æ˜ï¼Œtraitå¯ä»¥ç”¨åœ¨ä»»ä½•å¤§å°çš„ä¸œè¥¿ä¸Š:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#![allow(dead_code)]</span> <span class="token comment">// Tell the compiler to be quiet</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>mem<span class="token punctuation">::</span></span>size_of<span class="token punctuation">;</span> <span class="token comment">// This gives the size of a type</span>

<span class="token keyword">trait</span> <span class="token class-name">JustATrait</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// We will implement this on everything</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">EnumOfNumbers</span> <span class="token punctuation">{</span>
    <span class="token constant">I8</span><span class="token punctuation">(</span><span class="token keyword">i8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">AnotherI8</span><span class="token punctuation">(</span><span class="token keyword">i8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">OneMoreI8</span><span class="token punctuation">(</span><span class="token keyword">i8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">JustATrait</span> <span class="token keyword">for</span> <span class="token class-name">EnumOfNumbers</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">StructOfNumbers</span> <span class="token punctuation">{</span>
    an_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    another_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    one_more_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">JustATrait</span> <span class="token keyword">for</span> <span class="token class-name">StructOfNumbers</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">EnumOfOtherTypes</span> <span class="token punctuation">{</span>
    <span class="token constant">I8</span><span class="token punctuation">(</span><span class="token keyword">i8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">AnotherI8</span><span class="token punctuation">(</span><span class="token keyword">i8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Collection</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">JustATrait</span> <span class="token keyword">for</span> <span class="token class-name">EnumOfOtherTypes</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">StructOfOtherTypes</span> <span class="token punctuation">{</span>
    an_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    another_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    a_collection<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">JustATrait</span> <span class="token keyword">for</span> <span class="token class-name">StructOfOtherTypes</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">ArrayAndI8</span> <span class="token punctuation">{</span>
    array<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">i8</span><span class="token punctuation">;</span> <span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// This one will be very large</span>
    an_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    in_u8<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">impl</span> <span class="token class-name">JustATrait</span> <span class="token keyword">for</span> <span class="token class-name">ArrayAndI8</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"{}, {}, {}, {}, {}"</span><span class="token punctuation">,</span>
        <span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">EnumOfNumbers</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">StructOfNumbers</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">EnumOfOtherTypes</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">StructOfOtherTypes</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">ArrayAndI8</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“æˆ‘ä»¬æ‰“å°è¿™äº›ä¸œè¥¿çš„sizeçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—åˆ°<code>2, 3, 32, 32, 1002</code>ã€‚æ‰€ä»¥å¦‚æœä½ è¦è¿™æ ·åšçš„è¯ï¼Œä¼šç»™å‡ºä¸€ä¸ªé”™è¯¯:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">returns_just_a_trait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">JustATrait</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_enum <span class="token operator">=</span> <span class="token class-name">EnumOfNumbers</span><span class="token punctuation">::</span><span class="token constant">I8</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    some_enum
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0746]: return type cannot have an unboxed trait object
  --&gt; src\main.rs:53:30
   |
53 | fn returns_just_a_trait() -&gt; JustATrait {
   |                              ^^^^^^^^^^ doesn't have a size known at compile-time<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œè¿™æ˜¯çœŸçš„ï¼Œå› ä¸ºsizeå¯ä»¥æ˜¯2ï¼Œ3ï¼Œ32ï¼Œ1002ï¼Œæˆ–è€…å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨ä¸€ä¸ª<code>Box</code>ä¸­ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è¿˜è¦åŠ ä¸Š<code>dyn</code>è¿™ä¸ªå…³é”®è¯ã€‚<code>dyn</code>è¿™ä¸ªè¯å‘Šè¯‰ä½ ï¼Œä½ è¯´çš„æ˜¯ä¸€ä¸ªtraitï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç»“æ„ä½“æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚</p>
<p>æ‰€ä»¥ä½ å¯ä»¥æŠŠå‡½æ•°æ”¹æˆè¿™æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">fn</span> <span class="token function-definition function">returns_just_a_trait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">JustATrait</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_enum <span class="token operator">=</span> <span class="token class-name">EnumOfNumbers</span><span class="token punctuation">::</span><span class="token constant">I8</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>some_enum<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å®ƒå·¥ä½œäº†ï¼Œå› ä¸ºåœ¨å †æ ˆä¸Šåªæ˜¯ä¸€ä¸ª<code>Box</code>ï¼Œæˆ‘ä»¬çŸ¥é“<code>Box</code>çš„å¤§å°ã€‚</p>
<p>ä½ ä¼šç»å¸¸çœ‹åˆ°è¿™ç§å½¢å¼<code>Box&lt;dyn Error&gt;</code>ï¼Œå› ä¸ºæœ‰æ—¶ä½ å¯èƒ½ä¼šæœ‰å¤šä¸ªå¯èƒ½çš„é”™è¯¯ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å¿«é€Ÿåˆ›å»ºä¸¤ä¸ªé”™è¯¯ç±»å‹æ¥æ˜¾ç¤ºè¿™ä¸€ç‚¹ã€‚è¦åˆ›å»ºä¸€ä¸ªæ­£å¼çš„é”™è¯¯ç±»å‹ï¼Œä½ å¿…é¡»ä¸ºå®ƒå®ç°<code>std::error::Error</code>ã€‚è¿™éƒ¨åˆ†å¾ˆå®¹æ˜“:åªè¦å†™å‡º impl <code>std::error::Error {}</code>ã€‚ä½†é”™è¯¯è¿˜éœ€è¦<code>Debug</code>å’Œ<code>Display</code>ï¼Œè¿™æ ·æ‰èƒ½ç»™å‡ºé—®é¢˜çš„ä¿¡æ¯ã€‚<code>Debug</code>åªè¦åŠ ä¸Š<code>#[derive(Debug)]</code>å°±è¡Œï¼Œå¾ˆå®¹æ˜“ï¼Œä½†<code>Display</code>éœ€è¦<code>.fmt()</code>æ–¹æ³•ã€‚æˆ‘ä»¬ä¹‹å‰åšè¿‡ä¸€æ¬¡ã€‚</p>
<p>ä»£ç æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>error<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">ErrorOne</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Error</span> <span class="token keyword">for</span> <span class="token class-name">ErrorOne</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// Now it is an error type with Debug. Time for Display:</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">ErrorOne</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"You got the first error!"</span><span class="token punctuation">)</span> <span class="token comment">// All it does is write this message</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token attribute attr-name">#[derive(Debug)]</span> <span class="token comment">// Do the same thing with ErrorTwo</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">ErrorTwo</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Error</span> <span class="token keyword">for</span> <span class="token class-name">ErrorTwo</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">ErrorTwo</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"You got the second error!"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Make a function that just returns a String or an error</span>
<span class="token keyword">fn</span> <span class="token function-definition function">returns_errors</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token class-name">Error</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// With Box&lt;dyn Error&gt; you can return anything that has the Error trait</span>

    <span class="token keyword">match</span> input <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">ErrorOne</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Don't forget to put it in a box</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">ErrorTwo</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token string">"Looks fine to me"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// This is the success type</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> vec_of_u8s <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0_u8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Three numbers to try out</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> vec_of_u8s <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token function">returns_errors</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Err</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You got the first error!
You got the second error!
Looks fine to me<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæˆ‘ä»¬æ²¡æœ‰<code>Box&lt;dyn Error&gt;</code>ï¼Œå†™äº†è¿™ä¸ªï¼Œæˆ‘ä»¬å°±æœ‰é—®é¢˜äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">returns_errors</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> input <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">ErrorOne</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token number">1</span> <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">ErrorTwo</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token string">"Looks fine to me"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒä¼šå‘Šè¯‰ä½ ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">21  | fn returns_errors(input: u8) -&gt; Result&lt;String, Error&gt; {
    |                                 ^^^^^^^^^^^^^^^^^^^^^ doesn't have a size known at compile-time<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¿™å¹¶ä¸å¥‡æ€ªï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªtraitå¯ä»¥ä½œç”¨äºå¾ˆå¤šä¸œè¥¿ï¼Œè€Œä¸”å®ƒä»¬å„è‡ªæœ‰ä¸åŒçš„å¤§å°ã€‚</p>
<h2 id="é»˜è®¤å€¼å’Œæ„å»ºè€…æ¨¡å¼"><a href="#é»˜è®¤å€¼å’Œæ„å»ºè€…æ¨¡å¼" class="headerlink" title="é»˜è®¤å€¼å’Œæ„å»ºè€…æ¨¡å¼"></a>é»˜è®¤å€¼å’Œæ„å»ºè€…æ¨¡å¼</h2><p>ä½ å¯ä»¥å®ç° <code>Default</code> traitï¼Œç»™ä½ è®¤ä¸ºæœ€å¸¸è§çš„ <code>struct</code> æˆ– <code>enum</code> èµ‹å€¼ã€‚æ„å»ºå™¨æ¨¡å¼å¯ä»¥å¾ˆå¥½åœ°ä¸ä¹‹é…åˆï¼Œè®©ç”¨æˆ·åœ¨éœ€è¦æ—¶è½»æ¾åœ°è¿›è¡Œä¿®æ”¹ã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹<code>Default</code>ã€‚å®é™…ä¸Šï¼ŒRustä¸­çš„å¤§å¤šæ•°é€šç”¨ç±»å‹å·²ç»æœ‰<code>Default</code>ã€‚å®ƒä»¬å¹¶ä¸å¥‡æ€ªã€‚0, â€œâ€(ç©ºå­—ç¬¦ä¸²), <code>false</code>, ç­‰ç­‰ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> default_i8<span class="token punctuation">:</span> <span class="token keyword">i8</span> <span class="token operator">=</span> <span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> default_str<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> default_bool<span class="token punctuation">:</span> <span class="token keyword">bool</span> <span class="token operator">=</span> <span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"'{}', '{}', '{}'"</span><span class="token punctuation">,</span> default_i8<span class="token punctuation">,</span> default_str<span class="token punctuation">,</span> default_bool<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°<code>'0', '', 'false'</code>ã€‚</p>
<p>æ‰€ä»¥<code>Default</code>å°±åƒ<code>new</code>å‡½æ•°ä¸€æ ·ï¼Œé™¤äº†ä½ ä¸éœ€è¦è¾“å…¥ä»»ä½•ä¸œè¥¿ã€‚é¦–å…ˆæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª<code>struct</code>ï¼Œå®ƒè¿˜æ²¡æœ‰å®ç°<code>Default</code>ã€‚å®ƒæœ‰ä¸€ä¸ª<code>new</code>å‡½æ•°ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªåä¸ºBillyçš„è§’è‰²ï¼Œå¹¶æä¾›ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">LifeState</span> <span class="token punctuation">{</span>
    <span class="token class-name">Alive</span><span class="token punctuation">,</span>
    <span class="token class-name">Dead</span><span class="token punctuation">,</span>
    <span class="token class-name">NeverAlive</span><span class="token punctuation">,</span>
    <span class="token class-name">Uncertain</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> alive<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">,</span>
            age<span class="token punctuation">,</span>
            height<span class="token punctuation">,</span>
            weight<span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token keyword">if</span> alive <span class="token punctuation">{</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Dead</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> character_1 <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†ä¹Ÿè®¸åœ¨æˆ‘ä»¬çš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬å¸Œæœ›å¤§éƒ¨åˆ†è§’è‰²éƒ½å«æ¯”åˆ©ï¼Œå¹´é¾„15å²ï¼Œèº«é«˜170ï¼Œä½“é‡70ï¼Œè¿˜æ´»ç€ã€‚æˆ‘ä»¬å¯ä»¥å®ç°<code>Default</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å†™<code>Character::default()</code>ã€‚å®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">LifeState</span> <span class="token punctuation">{</span>
    <span class="token class-name">Alive</span><span class="token punctuation">,</span>
    <span class="token class-name">Dead</span><span class="token punctuation">,</span>
    <span class="token class-name">NeverAlive</span><span class="token punctuation">,</span>
    <span class="token class-name">Uncertain</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> alive<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">,</span>
            age<span class="token punctuation">,</span>
            height<span class="token punctuation">,</span>
            weight<span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token keyword">if</span> alive <span class="token punctuation">{</span>
                <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Dead</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Default</span> <span class="token keyword">for</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
            weight<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> character_1 <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"The character {:?} is {:?} years old."</span><span class="token punctuation">,</span>
        character_1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> character_1<span class="token punctuation">.</span>age
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰“å°å‡º<code>The character "Billy" is 15 years old.</code>ï¼Œç®€å•å¤šäº†!</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹å»ºé€ è€…æ¨¡å¼ã€‚æˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šBillyï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä¿ç•™é»˜è®¤çš„ã€‚ä½†æ˜¯å¾ˆå¤šå…¶ä»–è§’è‰²åªä¼šæœ‰ä¸€ç‚¹ä¸åŒã€‚æ„å»ºå™¨æ¨¡å¼è®©æˆ‘ä»¬å¯ä»¥é“¾æ¥éå¸¸å°çš„æ–¹æ³•ï¼Œæ¯æ¬¡æ”¹å˜ä¸€ä¸ªå€¼ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ª<code>Character</code>çš„æ–¹æ³•:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">height</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>    <span class="token comment">// ğŸš§</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
    <span class="token keyword">self</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€å®šè¦æ³¨æ„ï¼Œå®ƒå–çš„æ˜¯<code>mut self</code>ã€‚æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°è¿‡ä¸€æ¬¡ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªå¯å˜å¼•ç”¨(<code>&amp;mut self</code>)ã€‚å®ƒå ç”¨äº†<code>Self</code>çš„æ‰€æœ‰æƒï¼Œæœ‰äº†<code>mut</code>ï¼Œå®ƒå°†æ˜¯å¯å˜çš„ï¼Œå³ä½¿å®ƒä¹‹å‰ä¸æ˜¯å¯å˜çš„ã€‚è¿™æ˜¯å› ä¸º<code>.height()</code>æ‹¥æœ‰å®Œå…¨çš„æ‰€æœ‰æƒï¼Œåˆ«äººä¸èƒ½ç¢°å®ƒï¼Œæ‰€ä»¥å®ƒæ˜¯å®‰å…¨çš„ï¼Œå¯å˜ã€‚å®ƒåªæ˜¯æ”¹å˜<code>self.height</code>ï¼Œç„¶åè¿”å›<code>Self</code>(å°±æ˜¯<code>Character</code>)ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸‰ä¸ªè¿™æ ·çš„æ„å»ºæ–¹æ³•ã€‚å®ƒä»¬å‡ ä¹æ˜¯ä¸€æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">height</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>     <span class="token comment">// ğŸš§</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
    <span class="token keyword">self</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">weight</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight<span class="token punctuation">;</span>
    <span class="token keyword">self</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">name</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">self</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¯ä¸€ä¸ªéƒ½ä¼šæ”¹å˜ä¸€ä¸ªå˜é‡ï¼Œå¹¶å›é¦ˆç»™<code>Self</code>:è¿™å°±æ˜¯ä½ åœ¨æ„å»ºå™¨æ¨¡å¼ä¸­çœ‹åˆ°çš„ã€‚æ‰€ä»¥ç°åœ¨æˆ‘ä»¬ç±»ä¼¼è¿™æ ·å†™æ¥åˆ›å»ºä¸€ä¸ªè§’è‰²:<code>let character_1 = Character::default().height(180).weight(60).name("Bobby");</code>ã€‚å¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªåº“ç»™åˆ«äººä½¿ç”¨ï¼Œè¿™å¯ä»¥è®©ä»–ä»¬å¾ˆå®¹æ˜“ã€‚å¯¹æœ€ç»ˆç”¨æˆ·æ¥è¯´å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒå‡ ä¹çœ‹èµ·æ¥åƒè‡ªç„¶çš„è‹±è¯­ã€‚â€ç»™æˆ‘ä¸€ä¸ªé»˜è®¤è§’è‰²ï¼Œèº«é«˜ä¸º180ï¼Œä½“é‡ä¸º60ï¼Œåå­—ä¸ºBobby.â€ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ä»£ç çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">LifeState</span> <span class="token punctuation">{</span>
    <span class="token class-name">Alive</span><span class="token punctuation">,</span>
    <span class="token class-name">Dead</span><span class="token punctuation">,</span>
    <span class="token class-name">NeverAlive</span><span class="token punctuation">,</span>
    <span class="token class-name">Uncertain</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> alive<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">,</span>
            age<span class="token punctuation">,</span>
            height<span class="token punctuation">,</span>
            weight<span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token keyword">if</span> alive <span class="token punctuation">{</span>
                <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Dead</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">height</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">weight</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight<span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">name</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Default</span> <span class="token keyword">for</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
            weight<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> character_1 <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Bobby"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> character_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€åä¸€ä¸ªè¦æ·»åŠ çš„æ–¹æ³•é€šå¸¸å«<code>.build()</code>ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ç§æœ€ç»ˆæ£€æŸ¥ã€‚å½“ä½ ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªåƒ<code>.height()</code>è¿™æ ·çš„æ–¹æ³•æ—¶ï¼Œä½ å¯ä»¥ç¡®ä¿ä»–ä»¬åªè¾“å…¥ä¸€ä¸ª<code>u32()</code>ï¼Œä½†æ˜¯å¦‚æœä»–ä»¬è¾“å…¥5000çš„èº«é«˜æ€ä¹ˆåŠï¼Ÿè¿™åœ¨ä½ æ­£åœ¨åšçš„æ¸¸æˆä¸­å¯èƒ½å°±ä¸å¯¹äº†ã€‚æˆ‘ä»¬æœ€åå°†ä½¿ç”¨ä¸€ä¸ªåä¸º<code>.build()</code>çš„æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª<code>Result</code>ã€‚åœ¨å®ƒé‡Œé¢æˆ‘ä»¬å°†æ£€æŸ¥ç”¨æˆ·è¾“å…¥æ˜¯å¦æ­£å¸¸ï¼Œå¦‚æœæ­£å¸¸ï¼Œæˆ‘ä»¬å°†è¿”å›ä¸€ä¸ª <code>Ok(Self)</code>ã€‚</p>
<p>ä¸è¿‡é¦–å…ˆæˆ‘ä»¬è¦æ”¹å˜<code>.new()</code>æ–¹æ³•ã€‚æˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·å†è‡ªç”±åˆ›å»ºä»»ä½•ä¸€ç§è§’è‰²ã€‚æ‰€ä»¥æˆ‘ä»¬å°†æŠŠ<code>impl Default</code>çš„å€¼ç§»åˆ°<code>.new()</code>ã€‚è€Œç°åœ¨<code>.new()</code>ä¸æ¥å—ä»»ä½•è¾“å…¥ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>    <span class="token comment">// ğŸš§</span>
    <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
        weight<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>
        lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ„å‘³ç€æˆ‘ä»¬ä¸å†éœ€è¦<code>impl Default</code>äº†ï¼Œå› ä¸º<code>.new()</code>æœ‰æ‰€æœ‰çš„é»˜è®¤å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ é™¤<code>impl Default</code>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">LifeState</span> <span class="token punctuation">{</span>
    <span class="token class-name">Alive</span><span class="token punctuation">,</span>
    <span class="token class-name">Dead</span><span class="token punctuation">,</span>
    <span class="token class-name">NeverAlive</span><span class="token punctuation">,</span>
    <span class="token class-name">Uncertain</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
            weight<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">height</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">weight</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight<span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">name</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> character_1 <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Bobby"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> character_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯ä¸€æ ·çš„:<code>Character { name: "Bobby", age: 15, height: 180, weight: 60, lifestate: Alive }</code>ã€‚</p>
<p>æˆ‘ä»¬å‡ ä¹å·²ç»å‡†å¤‡å¥½å†™<code>.build()</code>æ–¹æ³•äº†ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜:å¦‚ä½•è®©ç”¨æˆ·ä½¿ç”¨å®ƒï¼Ÿç°åœ¨ç”¨æˆ·å¯ä»¥å†™<code>let x = Character::new().height(76767);</code>ï¼Œç„¶åå¾—åˆ°ä¸€ä¸ª<code>Character</code>ã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¹Ÿè®¸ä½ èƒ½æƒ³å‡ºè‡ªå·±çš„æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬ä¼šåœ¨<code>Character</code>ä¸­å¢åŠ ä¸€ä¸ª<code>can_use: bool</code>çš„å€¼ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>       <span class="token comment">// ğŸš§</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">,</span>
    can_use<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span> <span class="token comment">// Set whether the user can use the character</span>
<span class="token punctuation">}</span>

\\ <span class="token class-name">Cut</span> other code

    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
            weight<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span><span class="token punctuation">,</span>
            can_use<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// .new() always gives a good character, so it's true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œå¯¹äºå…¶ä»–çš„æ–¹æ³•ï¼Œæ¯”å¦‚<code>.height()</code>ï¼Œæˆ‘ä»¬ä¼šå°†<code>can_use</code>è®¾ç½®ä¸º<code>false</code>ã€‚åªæœ‰<code>.build()</code>ä¼šå†æ¬¡è®¾ç½®ä¸º<code>true</code>ï¼Œæ‰€ä»¥ç°åœ¨ç”¨æˆ·è¦ç”¨<code>.build()</code>åšæœ€åçš„æ£€æŸ¥ã€‚æˆ‘ä»¬è¦ç¡®ä¿<code>height</code>ä¸é«˜äº200ï¼Œ<code>weight</code>ä¸é«˜äº300ã€‚å¦å¤–ï¼Œåœ¨æˆ‘ä»¬çš„æ¸¸æˆä¸­ï¼Œæœ‰ä¸€ä¸ªä¸å¥½çš„å­—å«<code>smurf</code>ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä»»ä½•è§’è‰²ä½¿ç”¨å®ƒã€‚</p>
<p>æˆ‘ä»¬çš„<code>.build()</code>æ–¹æ³•æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">build</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>      <span class="token comment">// ğŸš§</span>
    <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&lt;</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>weight <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"smurf"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>can_use <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token string">"Could not create character. Characters must have:
1) Height below 200
2) Weight below 300
3) A name that is not Smurf (that is a bad word)"</span>
            <span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>!self.name.to_lowercase().contains("smurf")</code> ç¡®ä¿ç”¨æˆ·ä¸ä¼šå†™å‡ºç±»ä¼¼ â€œSMURFâ€æˆ– â€œIamSmurfâ€çš„å­—æ ·ã€‚å®ƒè®©æ•´ä¸ª <code>String</code> éƒ½å˜æˆå°å†™(å°å­—æ¯)ï¼Œå¹¶æ£€æŸ¥ <code>.contains()</code> è€Œä¸æ˜¯ <code>==</code>ã€‚è€Œå‰é¢çš„<code>!</code>è¡¨ç¤º â€œä¸æ˜¯â€ã€‚</p>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å°±æŠŠ<code>can_use</code>è®¾ç½®ä¸º<code>true</code>ï¼Œç„¶åæŠŠ<code>Ok</code>é‡Œé¢çš„å­—ç¬¦ç»™ç”¨æˆ·ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„ä»£ç å·²ç»å®Œæˆäº†ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸‰ä¸ªä¸å·¥ä½œçš„è§’è‰²ï¼Œå’Œä¸€ä¸ªå·¥ä½œçš„è§’è‰²ã€‚æœ€åçš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">,</span>
    can_use<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span> <span class="token comment">// Here is the new value</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">LifeState</span> <span class="token punctuation">{</span>
    <span class="token class-name">Alive</span><span class="token punctuation">,</span>
    <span class="token class-name">Dead</span><span class="token punctuation">,</span>
    <span class="token class-name">NeverAlive</span><span class="token punctuation">,</span>
    <span class="token class-name">Uncertain</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span>
            weight<span class="token punctuation">:</span> <span class="token number">70</span><span class="token punctuation">,</span>
            lifestate<span class="token punctuation">:</span> <span class="token class-name">LifeState</span><span class="token punctuation">::</span><span class="token class-name">Alive</span><span class="token punctuation">,</span>
            can_use<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// .new() makes a fine character, so it is true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">height</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>can_use <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// Now the user can't use the character</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">weight</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> weight<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight<span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>can_use <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">name</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>can_use <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">self</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">build</span><span class="token punctuation">(</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&lt;</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>weight <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"smurf"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>can_use <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>   <span class="token comment">// Everything is okay, so set to true</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span>               <span class="token comment">// and return the character</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token string">"Could not create character. Characters must have:
1) Height below 200
2) Weight below 300
3) A name that is not Smurf (that is a bad word)"</span>
                <span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> character_with_smurf <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Lol I am Smurf!!"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This one contains "smurf" - not okay</span>
    <span class="token keyword">let</span> character_too_tall <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Too tall - not okay</span>
    <span class="token keyword">let</span> character_too_heavy <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Too heavy - not okay</span>
    <span class="token keyword">let</span> okay_character <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Billybrobby"</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">weight</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// This character is okay. Name is fine, height and weight are fine</span>

    <span class="token comment">// Now they are not Character, they are Result&lt;Character, String&gt;. So let's put them in a Vec so we can see them:</span>
    <span class="token keyword">let</span> character_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>character_with_smurf<span class="token punctuation">,</span> character_too_tall<span class="token punctuation">,</span> character_too_heavy<span class="token punctuation">,</span> okay_character<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> character <span class="token keyword">in</span> character_vec <span class="token punctuation">{</span> <span class="token comment">// Now we will print the character if it's Ok, and print the error if it's Err</span>
        <span class="token keyword">match</span> character <span class="token punctuation">{</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span>character_info<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> character_info<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Err</span><span class="token punctuation">(</span>err_info<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> err_info<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Then add one more line</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Could not create character. Characters must have:
1) Height below 200
2) Weight below 300
3) A name that is not Smurf (that is a bad word)

Could not create character. Characters must have:
1) Height below 200
2) Weight below 300
3) A name that is not Smurf (that is a bad word)

Could not create character. Characters must have:
1) Height below 200
2) Weight below 300
3) A name that is not Smurf (that is a bad word)

Character { name: "Billybrobby", age: 15, height: 180, weight: 100, lifestate: Alive, can_use: true }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Derefå’ŒDerefMut"><a href="#Derefå’ŒDerefMut" class="headerlink" title="Derefå’ŒDerefMut"></a>Derefå’ŒDerefMut</h2><p><code>Deref</code>æ˜¯è®©ä½ ç”¨<code>*</code>æ¥è§£å¼•ç”¨æŸäº›ä¸œè¥¿çš„traitã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªå¼•ç”¨å’Œä¸€ä¸ªå€¼æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">// This is an i32</span>
    <span class="token keyword">let</span> reference <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">// This is a &amp;i32</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> value <span class="token operator">==</span> reference<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€ŒRustè¿<code>false</code>éƒ½ä¸ç»™ï¼Œå› ä¸ºå®ƒç”šè‡³ä¸ä¼šæ¯”è¾ƒä¸¤è€…ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: can't compare `{integer}` with `&amp;{integer}`
 --&gt; src\main.rs:4:26
  |
4 |     println!("{}", value == reference);
  |                          ^^ no implementation for `{integer} == &amp;{integer}`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ç„¶ï¼Œè¿™é‡Œçš„è§£æ³•æ˜¯ä½¿ç”¨<code>*</code>ã€‚æ‰€ä»¥è¿™å°†æ‰“å°å‡º<code>true</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> reference <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> value <span class="token operator">==</span> <span class="token operator">*</span>reference<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>ç°åœ¨è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªç®€å•çš„ç±»å‹ï¼Œå®ƒåªæ˜¯å®¹çº³ä¸€ä¸ªæ•°å­—ã€‚å®ƒå°±åƒä¸€ä¸ª<code>Box</code>ï¼Œæˆ‘ä»¬æœ‰ä¸€äº›æƒ³æ³•ä¸ºå®ƒæä¾›ä¸€äº›é¢å¤–çš„åŠŸèƒ½ã€‚ä½†å¦‚æœæˆ‘ä»¬åªæ˜¯ç»™å®ƒä¸€ä¸ªæ•°å­—ï¼Œ<br> å®ƒå°±ä¸èƒ½åšé‚£ä¹ˆå¤šäº†ã€‚</p>
<p>æˆ‘ä»¬ä¸èƒ½åƒä½¿ç”¨<code>Box</code>é‚£æ ·ä½¿ç”¨<code>*</code>:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token operator">*</span>my_number <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é”™è¯¯ä¿¡æ¯æ˜¯:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0614]: type `HoldsANumber` cannot be dereferenced
  --&gt; src\main.rs:24:22
   |
24 |     println!("{:?}", *my_number + 20);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å½“ç„¶å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚<code>println!("{:?}", my_number.0 + 20);</code>. ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨20çš„åŸºç¡€ä¸Šå†å•ç‹¬åŠ ä¸€ä¸ª<code>u8</code>ã€‚å¦‚æœæˆ‘ä»¬èƒ½æŠŠå®ƒä»¬åŠ åœ¨ä¸€èµ·å°±æ›´å¥½äº†ã€‚<code>cannot be dereferenced</code>è¿™ä¸ªæ¶ˆæ¯ç»™äº†æˆ‘ä»¬ä¸€ä¸ªçº¿ç´¢:æˆ‘ä»¬éœ€è¦å®ç°<code>Deref</code>ã€‚å®ç°<code>Deref</code>çš„ç®€å•ä¸œè¥¿æœ‰æ—¶è¢«ç§°ä¸º â€œæ™ºèƒ½æŒ‡é’ˆâ€ã€‚ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆå¯ä»¥æŒ‡å‘å®ƒçš„å…ƒç´ ï¼Œæœ‰å®ƒçš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å®ƒçš„æ–¹æ³•ã€‚å› ä¸ºç°åœ¨æˆ‘ä»¬å¯ä»¥æ·»åŠ <code>my_number.0</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª<code>u8</code>ï¼Œä½†æˆ‘ä»¬ä¸èƒ½ç”¨<code>HoldsANumber</code>åšå…¶ä»–çš„äº‹æƒ…:åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå®ƒåªæœ‰<code>Debug</code>ã€‚</p>
<p>æœ‰è¶£çš„æ˜¯:<code>String</code>å…¶å®æ˜¯<code>&amp;str</code>çš„æ™ºèƒ½æŒ‡é’ˆï¼Œ<code>Vec</code>æ˜¯æ•°ç»„(æˆ–å…¶ä»–ç±»å‹)çš„æ™ºèƒ½æŒ‡é’ˆã€‚æ‰€ä»¥æˆ‘ä»¬å…¶å®ä»ä¸€å¼€å§‹å°±åœ¨ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆã€‚</p>
<p>å®ç°<code>Deref</code>å¹¶ä¸éš¾ï¼Œæ ‡å‡†åº“ä¸­çš„ä¾‹å­ä¹Ÿå¾ˆç®€å•ã€‚<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/ops/trait.Deref.html">ä¸‹é¢æ˜¯æ ‡å‡†åº“ä¸­çš„ç¤ºä¾‹ä»£ç </a>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Deref</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">DerefExample</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token class-name">T</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">DerefExample</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token class-name">T</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token class-name">DerefExample</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token char string">'a'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">,</span> <span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>æ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªæ¥ï¼Œç°åœ¨æˆ‘ä»¬çš„<code>Deref</code>æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">impl</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token keyword">u8</span><span class="token punctuation">;</span> <span class="token comment">// Remember, this is the "associated type": the type that goes together.</span>
                      <span class="token comment">// You have to use the right type Target = (the type you want to return)</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span> <span class="token comment">// Rust calls .deref() when you use *. We just defined Target as a u8 so this is easy to understand</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>   <span class="token comment">// We chose &amp;self.0 because it's a tuple struct. In a named struct it would be something like "&amp;self.number"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨<code>*</code>æ¥åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Deref</span><span class="token punctuation">;</span>
<span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token keyword">u8</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token operator">*</span>my_number <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“å°å‡º<code>40</code>ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†™<code>my_number.0</code>ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¾—åˆ°äº† <code>u8</code> çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º <code>HoldsANumber</code> å†™å‡ºæˆ‘ä»¬è‡ªå·±çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†æ·»åŠ è‡ªå·±çš„ç®€å•æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬ä»<code>u8</code>ä¸­å¾—åˆ°çš„å¦ä¸€ä¸ªæ–¹æ³•ï¼Œç§°ä¸º<code>.checked_sub()</code>ã€‚<code>.checked_sub()</code>æ–¹æ³•æ˜¯ä¸€ä¸ªå®‰å…¨çš„å‡æ³•ï¼Œå®ƒèƒ½è¿”å›ä¸€ä¸ª<code>Option</code>ã€‚å¦‚æœå®ƒèƒ½åšå‡æ³•ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šåœ¨<code>Some</code>é‡Œé¢ç»™ä½ ï¼Œå¦‚æœå®ƒä¸èƒ½åšå‡æ³•ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šç»™å‡ºä¸€ä¸ª<code>None</code>ã€‚è®°ä½ï¼Œ<code>u8</code>ä¸èƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥è¿˜æ˜¯<code>.checked_sub()</code>æ¯”è¾ƒå®‰å…¨ï¼Œè¿™æ ·å°±ä¸ä¼šå´©æºƒäº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Deref</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">prints_the_number_times_two</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token keyword">u8</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">.</span><span class="token function">checked_sub</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This method comes from u8</span>
    my_number<span class="token punctuation">.</span><span class="token function">prints_the_number_times_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is our own method</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">None
40<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°<code>DerefMut</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>*</code>æ¥æ”¹å˜æ•°å€¼ã€‚å®ƒçœ‹èµ·æ¥å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚åœ¨å®ç°<code>DerefMut</code>ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®ç°<code>Deref</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Deref</span><span class="token punctuation">,</span> <span class="token class-name">DerefMut</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token keyword">u8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">prints_the_number_times_two</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token keyword">u8</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">DerefMut</span> <span class="token keyword">for</span> <span class="token class-name">HoldsANumber</span> <span class="token punctuation">{</span> <span class="token comment">// You don't need type Target = u8; here because it already knows thanks to Deref</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">deref_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span> <span class="token comment">// Everything else is the same except it says mut everywhere</span>
        <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_number <span class="token operator">=</span> <span class="token class-name">HoldsANumber</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>my_number <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">// DerefMut lets us do this</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_number<span class="token punctuation">.</span><span class="token function">checked_sub</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_number<span class="token punctuation">.</span><span class="token function">prints_the_number_times_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ï¼Œ<code>Deref</code>ç»™ä½ çš„ç±»å‹æä¾›äº†å¼ºå¤§çš„åŠ›é‡ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ ‡å‡†åº“è¯´:<code>Deref should only be implemented for smart pointers to avoid confusion</code>ã€‚è¿™æ˜¯å› ä¸ºå¯¹äºä¸€ä¸ªå¤æ‚çš„ç±»å‹ï¼Œä½ å¯ä»¥ç”¨ <code>Deref</code> åšä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªéå¸¸æ··ä¹±çš„ä¾‹å­æ¥ç†è§£å®ƒä»¬çš„å«ä¹‰ã€‚æˆ‘ä»¬å°†ä»ä¸€ä¸ªæ¸¸æˆçš„ <code>Character</code> ç»“æ„å¼€å§‹ã€‚ä¸€ä¸ªæ–°çš„<code>Character</code>éœ€è¦ä¸€äº›æ•°æ®ï¼Œæ¯”å¦‚æ™ºåŠ›å’ŒåŠ›é‡ã€‚æ‰€ä»¥è¿™é‡Œæ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªè§’è‰²ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    strength<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    dexterity<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    health<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    intelligence<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    wisdom<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    charm<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    alignment<span class="token punctuation">:</span> <span class="token class-name">Alignment</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
        strength<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        dexterity<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        health<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        intelligence<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        wisdom<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        charm<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        hit_points<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
        alignment<span class="token punctuation">:</span> <span class="token class-name">Alignment</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">,</span>
            strength<span class="token punctuation">,</span>
            dexterity<span class="token punctuation">,</span>
            health<span class="token punctuation">,</span>
            intelligence<span class="token punctuation">,</span>
            wisdom<span class="token punctuation">,</span>
            charm<span class="token punctuation">,</span>
            hit_points<span class="token punctuation">,</span>
            alignment<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">Alignment</span> <span class="token punctuation">{</span>
    <span class="token class-name">Good</span><span class="token punctuation">,</span>
    <span class="token class-name">Neutral</span><span class="token punctuation">,</span>
    <span class="token class-name">Evil</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> billy <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">Alignment</span><span class="token punctuation">::</span><span class="token class-name">Good</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¦æŠŠäººç‰©çš„hit pointsæ”¾åœ¨ä¸€ä¸ªå¤§çš„vecé‡Œã€‚ä¹Ÿè®¸æˆ‘ä»¬ä¼šæŠŠæ€ªç‰©æ•°æ®ä¹Ÿæ”¾è¿›å»ï¼ŒæŠŠå®ƒæ”¾åœ¨ä¸€èµ·ã€‚ç”±äº <code>hit_points</code> æ˜¯ä¸€ä¸ª <code>i8</code>ï¼Œæˆ‘ä»¬å®ç°äº† <code>Deref</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œå„ç§è®¡ç®—ã€‚ä½†æ˜¯çœ‹çœ‹ç°åœ¨æˆ‘ä»¬çš„<code>main()</code>å‡½æ•°ä¸­ï¼Œå®ƒçœ‹èµ·æ¥å¤šä¹ˆå¥‡æ€ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Deref</span><span class="token punctuation">;</span>

<span class="token comment">// All the other code is the same until after the enum Alignment</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    strength<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    dexterity<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    health<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    intelligence<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    wisdom<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    charm<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    hit_points<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
    alignment<span class="token punctuation">:</span> <span class="token class-name">Alignment</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
        strength<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        dexterity<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        health<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        intelligence<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        wisdom<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        charm<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
        hit_points<span class="token punctuation">:</span> <span class="token keyword">i8</span><span class="token punctuation">,</span>
        alignment<span class="token punctuation">:</span> <span class="token class-name">Alignment</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">,</span>
            strength<span class="token punctuation">,</span>
            dexterity<span class="token punctuation">,</span>
            health<span class="token punctuation">,</span>
            intelligence<span class="token punctuation">,</span>
            wisdom<span class="token punctuation">,</span>
            charm<span class="token punctuation">,</span>
            hit_points<span class="token punctuation">,</span>
            alignment<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token type-definition class-name">Alignment</span> <span class="token punctuation">{</span>
    <span class="token class-name">Good</span><span class="token punctuation">,</span>
    <span class="token class-name">Neutral</span><span class="token punctuation">,</span>
    <span class="token class-name">Evil</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span> <span class="token comment">// impl Deref for Character. Now we can do any integer math we want!</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token keyword">i8</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>hit_points
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> billy <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">Alignment</span><span class="token punctuation">::</span><span class="token class-name">Good</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Create two characters, billy and brandy</span>
    <span class="token keyword">let</span> brandy <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Brandy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">Alignment</span><span class="token punctuation">::</span><span class="token class-name">Good</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> hit_points_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Put our hit points data in here</span>
    hit_points_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">*</span>billy<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Push *billy?</span>
    hit_points_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">*</span>brandy<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Push *brandy?</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> hit_points_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™åªæ‰“å°äº†<code>[5, 5]</code>ã€‚æˆ‘ä»¬çš„ä»£ç ç°åœ¨è®©äººè¯»èµ·æ¥æ„Ÿè§‰éå¸¸å¥‡æ€ªã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>main()</code>ä¸Šé¢çœ‹åˆ°<code>Deref</code>ï¼Œç„¶åå¼„æ¸…æ¥š<code>*billy</code>çš„æ„æ€æ˜¯<code>i8</code>ï¼Œä½†æ˜¯å¦‚æœæœ‰å¾ˆå¤šä»£ç å‘¢ï¼Ÿå¯èƒ½æˆ‘ä»¬çš„ä»£ç æœ‰2000è¡Œï¼Œçªç„¶è¦å¼„æ¸…æ¥šä¸ºä»€ä¹ˆè¦<code>.push()</code> <code>*billy</code>ã€‚<code>Character</code>å½“ç„¶ä¸ä»…ä»…æ˜¯<code>i8</code>çš„æ™ºèƒ½æŒ‡é’ˆã€‚</p>
<p>å½“ç„¶ï¼Œå†™<code>hit_points_vec.push(*billy)</code>å¹¶ä¸è¿æ³•ï¼Œä½†è¿™è®©ä»£ç çœ‹èµ·æ¥éå¸¸å¥‡æ€ªã€‚ä¹Ÿè®¸ä¸€ä¸ªç®€å•çš„<code>.get_hp()</code>æ–¹æ³•ä¼šå¥½å¾—å¤šï¼Œæˆ–è€…å¦ä¸€ä¸ªå­˜æ”¾è§’è‰²çš„ç»“æ„ä½“ã€‚ç„¶åä½ å¯ä»¥è¿­ä»£å¹¶æ¨é€æ¯ä¸ªè§’è‰²çš„ <code>hit_points</code>ã€‚<code>Deref</code>æä¾›äº†å¾ˆå¤šåŠŸèƒ½ï¼Œä½†æœ€å¥½ç¡®ä¿ä»£ç çš„é€»è¾‘æ€§ã€‚</p>
<h2 id="Crateå’Œæ¨¡å—"><a href="#Crateå’Œæ¨¡å—" class="headerlink" title="Crateå’Œæ¨¡å—"></a>Crateå’Œæ¨¡å—</h2><p>æ¯æ¬¡ä½ åœ¨ Rust ä¸­å†™ä»£ç æ—¶ï¼Œä½ éƒ½æ˜¯åœ¨ <code>crate</code> ä¸­å†™çš„ã€‚<code>crate</code>æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œä¸€èµ·ä¸ºä½ çš„ä»£ç æœåŠ¡ã€‚åœ¨ä½ å†™çš„æ–‡ä»¶é‡Œé¢ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ª<code>mod</code>ã€‚<code>mod</code>æ˜¯å­˜æ”¾å‡½æ•°ã€ç»“æ„ç­‰çš„ç©ºé—´ã€‚å› ä¸ºè¿™äº›åŸå› è¢«ä½¿ç”¨:</p>
<ul>
<li>æ„å»ºä½ çš„ä»£ç :å®ƒå¯ä»¥å¸®åŠ©ä½ æ€è€ƒä»£ç çš„æ€»ä½“ç»“æ„ã€‚å½“ä½ çš„ä»£ç è¶Šæ¥è¶Šå¤§æ—¶ï¼Œè¿™ä¸€ç‚¹å¯èƒ½å¾ˆé‡è¦ã€‚</li>
<li>é˜…è¯»ä½ çš„ä»£ç :äººä»¬å¯ä»¥æ›´å®¹æ˜“ç†è§£ä½ çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œ<code>std::collections::HashMap</code>è¿™ä¸ªåå­—å‘Šè¯‰ä½ ï¼Œå®ƒåœ¨<code>std</code>çš„æ¨¡å—<code>collections</code>é‡Œé¢ã€‚è¿™ç»™äº†ä½ ä¸€ä¸ªæç¤ºï¼Œä¹Ÿè®¸<code>collections</code>é‡Œé¢è¿˜æœ‰æ›´å¤šçš„é›†åˆç±»å‹ï¼Œä½ å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</li>
<li>ç§å¯†æ€§:æ‰€æœ‰çš„ä¸œè¥¿ä¸€å¼€å§‹éƒ½æ˜¯ç§æœ‰çš„ã€‚è¿™æ ·å¯ä»¥è®©ä½ ä¸è®©ç”¨æˆ·ç›´æ¥ä½¿ç”¨å‡½æ•°ã€‚</li>
</ul>
<p>è¦åˆ›å»ºä¸€ä¸ª<code>mod</code>ï¼Œåªéœ€è¦å†™<code>mod</code>ï¼Œç„¶åç”¨<code>{}</code>å¼€å§‹ä¸€ä¸ªä»£ç å—ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º<code>print_things</code>çš„modï¼Œå®ƒæœ‰ä¸€äº›æ‰“å°ç›¸å…³çš„åŠŸèƒ½ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">mod</span> <span class="token module-declaration namespace">print_things</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">prints_one_thing</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Print anything that implements Display</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠ<code>use std::fmt::Display;</code>å†™åœ¨<code>print_things</code>é‡Œé¢ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç©ºé—´ã€‚å¦‚æœä½ æŠŠ<code>use std::fmt::Display;</code>å†™åœ¨<code>main()</code>é‡Œé¢ä¹Ÿæ²¡ç”¨ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬ç°åœ¨ä¹Ÿä¸èƒ½ä»<code>main()</code>é‡Œé¢è°ƒç”¨ã€‚å¦‚æœåœ¨<code>fn</code>å‰é¢æ²¡æœ‰<code>pub</code>è¿™ä¸ªå…³é”®å­—ï¼Œå®ƒå°±ä¼šä¿æŒç§å¯†æ€§ã€‚è®©æˆ‘ä»¬è¯•ç€åœ¨æ²¡æœ‰<code>pub</code>çš„æƒ…å†µä¸‹è°ƒç”¨å®ƒã€‚è¿™é‡Œæœ‰ä¸€ç§å†™æ³•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>print_things<span class="token punctuation">::</span></span><span class="token function">prints_one_thing</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


<p><code>crate</code>çš„æ„æ€æ˜¯ â€œåœ¨è¿™ä¸ªé¡¹ç›®é‡Œâ€ï¼Œä½†å¯¹äºæˆ‘ä»¬ç®€å•çš„ä¾‹å­æ¥è¯´ï¼Œå®ƒå’Œ â€œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢â€æ˜¯ä¸€æ ·çš„ã€‚æ¥ç€æ˜¯<code>print_things</code>è¿™ä¸ªmodï¼Œæœ€åæ˜¯<code>prints_one_thing()</code>å‡½æ•°ã€‚ä½ å¯ä»¥æ¯æ¬¡éƒ½å†™è¿™ä¸ªï¼Œä¹Ÿå¯ä»¥å†™<code>use</code>æ¥å¯¼å…¥ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯´å®ƒæ˜¯ç§æœ‰çš„é”™è¯¯:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">print_things</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">prints_one_thing</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>print_things<span class="token punctuation">::</span></span>prints_one_thing<span class="token punctuation">;</span>

    <span class="token function">prints_one_thing</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_one_thing</span><span class="token punctuation">(</span><span class="token string">"Trying to print a string..."</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯é”™è¯¯çš„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0603]: function `prints_one_thing` is private
  --&gt; src\main.rs:10:30
   |
10 |     use crate::print_things::prints_one_thing;
   |                              ^^^^^^^^^^^^^^^^ private function
   |
note: the function `prints_one_thing` is defined here
  --&gt; src\main.rs:4:5
   |
4  |     fn prints_one_thing&lt;T: Display&gt;(input: T) {
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å¾ˆå®¹æ˜“ç†è§£ï¼Œå‡½æ•°<code>print_one_thing</code>æ˜¯ç§æœ‰çš„ã€‚å®ƒè¿˜ç”¨<code>src\main.rs:4:5</code>å‘Šè¯‰æˆ‘ä»¬åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°è¿™ä¸ªå‡½æ•°ã€‚è¿™å¾ˆæœ‰å¸®åŠ©ï¼Œå› ä¸ºä½ ä¸ä»…å¯ä»¥åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å†™<code>mod</code>ï¼Œè¿˜å¯ä»¥åœ¨å¾ˆå¤šæ–‡ä»¶ä¸­å†™<code>mod</code>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬åªéœ€è¦å†™<code>pub fn</code>è€Œä¸æ˜¯<code>fn</code>ï¼Œä¸€åˆ‡å°±éƒ½å¯ä»¥äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">mod</span> <span class="token module-declaration namespace">print_things</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">prints_one_thing</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>print_things<span class="token punctuation">::</span></span>prints_one_thing<span class="token punctuation">;</span>

    <span class="token function">prints_one_thing</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">prints_one_thing</span><span class="token punctuation">(</span><span class="token string">"Trying to print a string..."</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">6
Trying to print a string...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>pub</code>å¯¹ç»“æ„ä½“ã€æšä¸¾ã€traitæˆ–æ¨¡å—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ<code>pub</code>å¯¹å®ƒä»¬æ¥è¯´æ˜¯è¿™æ ·çš„:</p>
<ul>
<li><code>pub</code>å¯¹äºä¸€ä¸ªç»“æ„: å®ƒä½¿ç»“æ„å…¬å¼€ï¼Œä½†æˆå‘˜ä¸æ˜¯å…¬å¼€çš„ã€‚è¦æƒ³è®©ä¸€ä¸ªæˆå‘˜å…¬å¼€ï¼Œä½ ä¹Ÿè¦ä¸ºæ¯ä¸ªæˆå‘˜å†™<code>pub</code>ã€‚</li>
<li><code>pub</code> å¯¹äºä¸€ä¸ªæšä¸¾æˆ–trait:æ‰€æœ‰çš„ä¸œè¥¿éƒ½å˜æˆäº†å…¬å…±çš„ã€‚è¿™æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºtraitsæ˜¯å…³äºç»™æŸé¡¹èµ‹äºˆç›¸åŒçš„è¡Œä¸ºã€‚è€Œæšä¸¾æ˜¯å…³äºå…ƒç´ ä¹‹é—´çš„é€‰æ‹©ï¼Œä½ éœ€è¦çœ‹åˆ°æ‰€æœ‰çš„å…ƒç´ æ‰èƒ½é€‰æ‹©å®ƒä»¬ã€‚</li>
<li><code>pub</code>å¯¹äºä¸€ä¸ªæ¨¡å—æ¥è¯´:ä¸€ä¸ªé¡¶å±‚çš„æ¨¡å—ä¼šæ˜¯<code>pub</code>ï¼Œå› ä¸ºå¦‚æœå®ƒä¸æ˜¯pubï¼Œé‚£ä¹ˆæ ¹æœ¬æ²¡æœ‰äººå¯ä»¥ç¢°é‡Œé¢çš„ä»»ä½•ä¸œè¥¿ã€‚ä½†æ˜¯æ¨¡å—é‡Œé¢çš„æ¨¡å—éœ€è¦ä½¿ç”¨<code>pub</code>æ‰èƒ½æˆä¸ºå…¬å…±çš„ã€‚</li>
</ul>
<p>æˆ‘ä»¬åœ¨<code>print_things</code>é‡Œé¢æ”¾ä¸€ä¸ªåä¸º<code>Billy</code>çš„ç»“æ„ä½“ã€‚è¿™ä¸ªç»“æ„ä½“å‡ ä¹éƒ½ä¼šæ˜¯publicçš„ï¼Œä½†ä¹Ÿä¸å°½ç„¶ã€‚è¿™ä¸ªç»“æ„æ˜¯å…¬å…±çš„ï¼Œæ‰€ä»¥å®ƒä¼šè¯´<code>pub struct Billy</code>ã€‚é‡Œé¢ä¼šæœ‰ä¸€ä¸ª <code>name</code> å’Œ <code>times_to_print</code>ã€‚<code>name</code>ä¸ä¼šæ˜¯å…¬å…±çš„ï¼Œå› ä¸ºæˆ‘ä»¬åªæƒ³è®©ç”¨æˆ·åˆ›å»ºåä¸º<code>"Billy".to_string()</code>çš„ç»“æ„ã€‚ä½†æ˜¯ç”¨æˆ·å¯ä»¥é€‰æ‹©æ‰“å°çš„æ¬¡æ•°ï¼Œæ‰€ä»¥è¿™å°†æ˜¯å…¬å¼€çš„ã€‚å®ƒçš„æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">mod</span> <span class="token module-declaration namespace">print_things</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Display</span><span class="token punctuation">,</span> <span class="token class-name">Debug</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[derive(Debug)]</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Billy</span> <span class="token punctuation">{</span> <span class="token comment">// Billy is public</span>
        name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token comment">// but name is private.</span>
        <span class="token keyword">pub</span> times_to_print<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">impl</span> <span class="token class-name">Billy</span> <span class="token punctuation">{</span>
        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>times_to_print<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span> <span class="token comment">// That means the user needs to use new to create a Billy. The user can only change the number of times_to_print</span>
            <span class="token keyword">Self</span> <span class="token punctuation">{</span>
                name<span class="token punctuation">:</span> <span class="token string">"Billy"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// We choose the name - the user can't</span>
                times_to_print<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">print_billy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// This function prints a Billy</span>
            <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token keyword">self</span><span class="token punctuation">.</span>times_to_print <span class="token punctuation">{</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">prints_one_thing</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>print_things<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// Now we use *. This imports everything from print_things</span>

    <span class="token keyword">let</span> my_billy <span class="token operator">=</span> <span class="token class-name">Billy</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_billy<span class="token punctuation">.</span><span class="token function">print_billy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">"Billy"
"Billy"
"Billy"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¯¹äº†ï¼Œå¯¼å…¥ä¸€åˆ‡çš„<code>*</code>å«åš â€œglobè¿ç®—ç¬¦â€ã€‚Globçš„æ„æ€æ˜¯ â€œå…¨å±€â€ï¼Œæ‰€ä»¥å®ƒæ„å‘³ç€ä¸€åˆ‡ã€‚</p>
<p>åœ¨<code>mod</code>é‡Œé¢ä½ å¯ä»¥åˆ›å»ºå…¶ä»–modã€‚ä¸€ä¸ªå­ mod(modé‡Œçš„mod)æ€»æ˜¯å¯ä»¥ä½¿ç”¨çˆ¶ mod å†…éƒ¨çš„ä»»ä½•ä¸œè¥¿ã€‚ä½ å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªä¾‹å­ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åœ¨ <code>mod province</code> é‡Œé¢æœ‰ä¸€ä¸ª <code>mod city</code>ï¼Œè€Œ<code>mod province</code>åœ¨ <code>mod country</code> é‡Œé¢ã€‚</p>
<p>ä½ å¯ä»¥è¿™æ ·æƒ³:å³ä½¿ä½ åœ¨ä¸€ä¸ªå›½å®¶ï¼Œä½ å¯èƒ½ä¸åœ¨ä¸€ä¸ªçœã€‚è€Œå³ä½¿ä½ åœ¨ä¸€ä¸ªçœï¼Œä½ ä¹Ÿå¯èƒ½ä¸åœ¨ä¸€ä¸ªå¸‚ã€‚ä½†å¦‚æœä½ åœ¨ä¸€ä¸ªåŸå¸‚ï¼Œä½ å°±åœ¨è¿™ä¸ªåŸå¸‚çš„çœä»½å’Œå®ƒçš„å›½å®¶ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">mod</span> <span class="token module-declaration namespace">country</span> <span class="token punctuation">{</span> <span class="token comment">// The main mod doesn't need pub</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Note: this function isn't public</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"We are in the country of {}"</span><span class="token punctuation">,</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">province</span> <span class="token punctuation">{</span> <span class="token comment">// Make this mod public</span>

        <span class="token keyword">fn</span> <span class="token function-definition function">print_province</span><span class="token punctuation">(</span>province<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Note: this function isn't public</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"in the province of {}"</span><span class="token punctuation">,</span> province<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">city</span> <span class="token punctuation">{</span> <span class="token comment">// Make this mod public</span>
            <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">print_city</span><span class="token punctuation">(</span>country<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> province<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> city<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// This function is public though</span>
                <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>country<span class="token punctuation">::</span></span><span class="token function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>country<span class="token punctuation">::</span>province<span class="token punctuation">::</span></span><span class="token function">print_province</span><span class="token punctuation">(</span>province<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"in the city of {}"</span><span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>country<span class="token punctuation">::</span>province<span class="token punctuation">::</span>city<span class="token punctuation">::</span></span><span class="token function">print_city</span><span class="token punctuation">(</span><span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"New Brunswick"</span><span class="token punctuation">,</span> <span class="token string">"Moncton"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰è¶£çš„æ˜¯ï¼Œ<code>print_city</code>å¯ä»¥è®¿é—®<code>print_province</code>å’Œ<code>print_country</code>ã€‚è¿™æ˜¯å› ä¸º<code>mod city</code>åœ¨å…¶ä»–modé‡Œé¢ã€‚å®ƒä¸éœ€è¦<code>pub</code>åœ¨<code>print_province</code>å‰é¢æ‰èƒ½ä½¿ç”¨ã€‚è¿™ä¹Ÿæ˜¯æœ‰é“ç†çš„:ä¸€ä¸ªåŸå¸‚ä¸éœ€è¦åšä»€ä¹ˆï¼Œå®ƒæœ¬æ¥å°±åœ¨ä¸€ä¸ªçœé‡Œï¼Œåœ¨ä¸€ä¸ªå›½å®¶é‡Œã€‚</p>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°ï¼Œ<code>crate::country::province::print_province(province);</code>éå¸¸é•¿ã€‚å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªæ¨¡å—é‡Œé¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>super</code>ä»ä¸Šé¢å¼•å…¥å…ƒç´ ã€‚å…¶å®superè¿™ä¸ªè¯æœ¬èº«å°±æ˜¯â€ä¸Šé¢â€çš„æ„æ€ï¼Œæ¯”å¦‚ â€œä¸Šçº§â€ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªç”¨äº†ä¸€æ¬¡å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœä½ ç”¨çš„æ¯”è¾ƒå¤šçš„è¯ï¼Œé‚£ä¹ˆæœ€å¥½æ˜¯å¯¼å…¥ã€‚å¦‚æœå®ƒèƒ½è®©ä½ çš„ä»£ç æ›´å®¹æ˜“é˜…è¯»ï¼Œé‚£ä¹Ÿæ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå³ä½¿ä½ åªç”¨äº†ä¸€æ¬¡å‡½æ•°ã€‚ç°åœ¨çš„ä»£ç å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œä½†æ›´å®¹æ˜“é˜…è¯»ä¸€äº›ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">mod</span> <span class="token module-declaration namespace">country</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"We are in the country of {}"</span><span class="token punctuation">,</span> country<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">province</span> <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> <span class="token function-definition function">print_province</span><span class="token punctuation">(</span>province<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"in the province of {}"</span><span class="token punctuation">,</span> province<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">city</span> <span class="token punctuation">{</span>
            <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>super<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// use everything in "above above": that means mod country</span>
            <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>        <span class="token comment">// use everything in "above": that means mod province</span>

            <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">print_city</span><span class="token punctuation">(</span>country<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> province<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> city<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">print_country</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">print_province</span><span class="token punctuation">(</span>province<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"in the city of {}"</span><span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>country<span class="token punctuation">::</span>province<span class="token punctuation">::</span>city<span class="token punctuation">::</span></span>print_city<span class="token punctuation">;</span> <span class="token comment">// bring in the function</span>

    <span class="token function">print_city</span><span class="token punctuation">(</span><span class="token string">"Canada"</span><span class="token punctuation">,</span> <span class="token string">"New Brunswick"</span><span class="token punctuation">,</span> <span class="token string">"Moncton"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_city</span><span class="token punctuation">(</span><span class="token string">"Korea"</span><span class="token punctuation">,</span> <span class="token string">"Gyeonggi-do"</span><span class="token punctuation">,</span> <span class="token string">"Gwangju"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it's less work to use it again</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æµ‹è¯•æ˜¯ä¸€é—¨å¾ˆå¥½çš„å­¦ç§‘ï¼Œç°åœ¨æˆ‘ä»¬äº†è§£äº†æ¨¡å—ã€‚åœ¨Rustä¸­æµ‹è¯•ä½ çš„ä»£ç æ˜¯éå¸¸å®¹æ˜“çš„ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨ä½ çš„ä»£ç æ—è¾¹å†™æµ‹è¯•ã€‚</p>
<p>å¼€å§‹æµ‹è¯•çš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°ä¸Šé¢æ·»åŠ <code>#[test]</code>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[test]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">two_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†å¦‚æœä½ è¯•å›¾åœ¨playgroundä¸­è¿è¡Œå®ƒï¼Œå®ƒç»™å‡ºäº†ä¸€ä¸ªé”™è¯¯ã€‚<code>error[E0601]: `main` function not found in crate `playground</code>. è¿™æ˜¯å› ä¸ºä½ ä¸ä½¿ç”¨ _Run_ æ¥è¿›è¡Œæµ‹è¯•ï¼Œä½ ä½¿ç”¨ _Test_ ã€‚å¦å¤–ï¼Œä½ ä¸ä½¿ç”¨ <code>main()</code> å‡½æ•°è¿›è¡Œæµ‹è¯• - å®ƒä»¬åœ¨å¤–é¢è¿è¡Œã€‚è¦åœ¨Playgroundä¸­è¿è¡Œè¿™ä¸ªï¼Œç‚¹å‡» _RUN_ æ—è¾¹çš„<code>Â·Â·Â·</code>ï¼Œç„¶åæŠŠå®ƒæ”¹ä¸º _Test_ ã€‚ç°åœ¨å¦‚æœä½ ç‚¹å‡»å®ƒï¼Œå®ƒå°†è¿è¡Œæµ‹è¯•ã€‚(å¦‚æœä½ å·²ç»å®‰è£…äº† Rustï¼Œä½ å°†è¾“å…¥ <code>cargo test</code> æ¥åšè¿™ä¸ªæµ‹è¯•)</p>
<p>è¿™é‡Œæ˜¯è¾“å‡º:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 1 test
test two_is_two ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®©æˆ‘ä»¬æŠŠ<code>assert_eq!(2, 2)</code>æ”¹æˆ<code>assert_eq!(2, 3)</code>ï¼Œçœ‹çœ‹ä¼šæœ‰ä»€ä¹ˆç»“æœã€‚å½“æµ‹è¯•å¤±è´¥æ—¶ï¼Œä½ ä¼šå¾—åˆ°æ›´å¤šçš„ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 1 test
test two_is_two ... FAILED

failures:

---- two_is_two stdout ----
thread 'two_is_two' panicked at 'assertion failed: `(left == right)`
  left: `2`,
 right: `3`', src/lib.rs:3:5
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace


failures:
    two_is_two

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>assert_eq!(left, right)</code>æ˜¯Rustä¸­æµ‹è¯•ä¸€ä¸ªå‡½æ•°çš„ä¸»è¦æ–¹æ³•ã€‚å¦‚æœå®ƒä¸å·¥ä½œï¼Œå®ƒå°†æ˜¾ç¤ºä¸åŒçš„å€¼:å·¦è¾¹æœ‰2ï¼Œä½†å³è¾¹æœ‰3ã€‚</p>
<p><code>RUST_BACKTRACE=1</code>æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿™æ˜¯è®¡ç®—æœºä¸Šçš„ä¸€ä¸ªè®¾ç½®ï¼Œå¯ä»¥æä¾›æ›´å¤šå…³äºé”™è¯¯çš„ä¿¡æ¯ã€‚å¹¸å¥½playgroundä¹Ÿæœ‰:ç‚¹å‡»<code>STABLE</code>æ—è¾¹çš„<code>Â·Â·Â·</code>ï¼Œç„¶åè®¾ç½®å›æº¯ä¸º<code>ENABLED</code>ã€‚å¦‚æœä½ è¿™æ ·åšï¼Œå®ƒä¼šç»™ä½ <em>å¾ˆå¤š</em>çš„ä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 1 test
test two_is_two ... FAILED

failures:

---- two_is_two stdout ----
thread 'two_is_two' panicked at 'assertion failed: 2 == 3', src/lib.rs:3:5
stack backtrace:
   0: backtrace::backtrace::libunwind::trace
             at /cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.46/src/backtrace/libunwind.rs:86
   1: backtrace::backtrace::trace_unsynchronized
             at /cargo/registry/src/github.com-1ecc6299db9ec823/backtrace-0.3.46/src/backtrace/mod.rs:66
   2: std::sys_common::backtrace::_print_fmt
             at src/libstd/sys_common/backtrace.rs:78
   3: &lt;std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display&gt;::fmt
             at src/libstd/sys_common/backtrace.rs:59
   4: core::fmt::write
             at src/libcore/fmt/mod.rs:1076
   5: std::io::Write::write_fmt
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libstd/io/mod.rs:1537
   6: std::io::impls::&lt;impl std::io::Write for alloc::boxed::Box&lt;W&gt;&gt;::write_fmt
             at src/libstd/io/impls.rs:176
   7: std::sys_common::backtrace::_print
             at src/libstd/sys_common/backtrace.rs:62
   8: std::sys_common::backtrace::print
             at src/libstd/sys_common/backtrace.rs:49
   9: std::panicking::default_hook::{{closure}}
             at src/libstd/panicking.rs:198
  10: std::panicking::default_hook
             at src/libstd/panicking.rs:215
  11: std::panicking::rust_panic_with_hook
             at src/libstd/panicking.rs:486
  12: std::panicking::begin_panic
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libstd/panicking.rs:410
  13: playground::two_is_two
             at src/lib.rs:3
  14: playground::two_is_two::{{closure}}
             at src/lib.rs:2
  15: core::ops::function::FnOnce::call_once
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libcore/ops/function.rs:232
  16: &lt;alloc::boxed::Box&lt;F&gt; as core::ops::function::FnOnce&lt;A&gt;&gt;::call_once
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/liballoc/boxed.rs:1076
  17: &lt;std::panic::AssertUnwindSafe&lt;F&gt; as core::ops::function::FnOnce&lt;()&gt;&gt;::call_once
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libstd/panic.rs:318
  18: std::panicking::try::do_call
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libstd/panicking.rs:297
  19: std::panicking::try
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libstd/panicking.rs:274
  20: std::panic::catch_unwind
             at /rustc/c367798cfd3817ca6ae908ce675d1d99242af148/src/libstd/panic.rs:394
  21: test::run_test_in_process
             at src/libtest/lib.rs:541
  22: test::run_test::run_test_inner::{{closure}}
             at src/libtest/lib.rs:450
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.


failures:
    two_is_two

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™¤éä½ çœŸçš„æ‰¾ä¸åˆ°é—®é¢˜æ‰€åœ¨ï¼Œå¦åˆ™ä½ ä¸éœ€è¦ä½¿ç”¨å›æº¯ã€‚ä½†å¹¸è¿çš„æ˜¯ä½ ä¹Ÿä¸éœ€è¦å…¨éƒ¨ç†è§£ã€‚ å¦‚æœä½ ç»§ç»­é˜…è¯»ï¼Œä½ æœ€ç»ˆä¼šçœ‹åˆ°ç¬¬13è¡Œï¼Œé‚£é‡Œå†™ç€<code>playground</code>â€“é‚£æ˜¯å®ƒè°ˆè®ºä½ çš„ä»£ç çš„åœ°æ–¹ã€‚å…¶ä»–çš„éƒ½æ˜¯å…³äºRustä¸ºäº†è¿è¡Œä½ çš„ç¨‹åº,åœ¨å…¶ä»–åº“ä¸­æ‰€åšçš„äº‹æƒ…ã€‚ä½†æ˜¯è¿™ä¸¤è¡Œå‘Šè¯‰ä½ ï¼Œå®ƒçœ‹çš„æ˜¯playgroundçš„ç¬¬2è¡Œå’Œç¬¬3è¡Œï¼Œè¿™æ˜¯ä¸€ä¸ªæç¤ºï¼Œè¦æ£€æŸ¥é‚£é‡Œã€‚è¿™é‡Œæ˜¯é‚£ä¸ªéƒ¨åˆ†:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">13: playground::two_is_two
           at src/lib.rs:3
14: playground::two_is_two::{{closure}}
           at src/lib.rs:2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥æˆ‘ä»¬å†æŠŠbacktraceå…³é—­ï¼Œå›åˆ°å¸¸è§„æµ‹è¯•ã€‚ç°åœ¨æˆ‘ä»¬è¦å†™ä¸€äº›å…¶ä»–å‡½æ•°ï¼Œå¹¶ä½¿ç”¨æµ‹è¯•å‡½æ•°æ¥æµ‹è¯•å®ƒä»¬ã€‚è¿™é‡Œæœ‰å‡ ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i8</span> <span class="token punctuation">{</span>
    <span class="token number">2</span>
<span class="token punctuation">}</span>
# <span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">it_returns_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">return_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">return_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i8</span> <span class="token punctuation">{</span>
    <span class="token number">4</span> <span class="token operator">+</span> <span class="token function">return_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
# <span class="token punctuation">[</span>test<span class="token punctuation">]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">it_returns_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">return_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œéƒ½èƒ½è¿è¡Œ:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 2 tests
test it_returns_two ... ok
test it_returns_six ... ok

test result: ok. 2 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸æ˜¯å¤ªéš¾ã€‚</p>
<p>é€šå¸¸ä½ ä¼šæƒ³æŠŠä½ çš„æµ‹è¯•æ”¾åœ¨è‡ªå·±çš„æ¨¡å—ä¸­ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¯·ä½¿ç”¨ç›¸åŒçš„ <code>mod</code> å…³é”®å­—ï¼Œå¹¶åœ¨å…¶ä¸Šæ–¹æ·»åŠ  <code>#[cfg(test)]</code>(è®°ä½:<code>cfg</code> çš„æ„æ€æ˜¯ â€œé…ç½®â€)ã€‚ä½ è¿˜è¦åœ¨æ¯ä¸ªæµ‹è¯•ä¸Šé¢ç»§ç»­å†™<code>#[test]</code>ã€‚è¿™æ˜¯å› ä¸ºä»¥åå½“ä½ å®‰è£…Rustæ—¶ï¼Œä½ å¯ä»¥åšæ›´å¤æ‚çš„æµ‹è¯•ã€‚ä½ å°†å¯ä»¥è¿è¡Œä¸€ä¸ªæµ‹è¯•ï¼Œæˆ–è€…æ‰€æœ‰çš„æµ‹è¯•ï¼Œæˆ–è€…è¿è¡Œå‡ ä¸ªæµ‹è¯•ã€‚å¦å¤–åˆ«å¿˜äº†å†™<code>use super::*;</code>ï¼Œå› ä¸ºæµ‹è¯•æ¨¡å—éœ€è¦ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°ã€‚ç°åœ¨å®ƒçœ‹èµ·æ¥ä¼šæ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">return_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i8</span> <span class="token punctuation">{</span>
    <span class="token number">2</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">return_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i8</span> <span class="token punctuation">{</span>
    <span class="token number">4</span> <span class="token operator">+</span> <span class="token function">return_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

# <span class="token punctuation">[</span><span class="token function">cfg</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">it_returns_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">return_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">it_returns_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">return_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æµ‹è¯•é©±åŠ¨çš„å¼€å‘"><a href="#æµ‹è¯•é©±åŠ¨çš„å¼€å‘" class="headerlink" title="æµ‹è¯•é©±åŠ¨çš„å¼€å‘"></a>æµ‹è¯•é©±åŠ¨çš„å¼€å‘</h3><p>åœ¨é˜…è¯»Rustæˆ–å…¶ä»–è¯­è¨€æ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ° â€œæµ‹è¯•é©±åŠ¨å¼€å‘â€è¿™ä¸ªè¯ã€‚è¿™æ˜¯ç¼–å†™ç¨‹åºçš„ä¸€ç§æ–¹å¼ï¼Œæœ‰äº›äººå–œæ¬¢å®ƒï¼Œè€Œæœ‰äº›äººåˆ™å–œæ¬¢å…¶ä»–çš„æ–¹å¼ã€‚â€æµ‹è¯•é©±åŠ¨å¼€å‘â€çš„æ„æ€æ˜¯ â€œå…ˆå†™æµ‹è¯•ï¼Œå†å†™ä»£ç â€ã€‚å½“ä½ è¿™æ ·åšçš„æ—¶å€™ï¼Œä½ ä¼šæœ‰å¾ˆå¤šå…³äºä½ æƒ³è¦ä½ çš„ä»£ç åšçš„æ‰€æœ‰äº‹æƒ…æµ‹è¯•ä»£ç ã€‚ç„¶åä½ å¼€å§‹å†™ä»£ç ï¼Œå¹¶è¿è¡Œæµ‹è¯•ï¼Œçœ‹çœ‹ä½ æ˜¯å¦åšå¯¹äº†ã€‚ç„¶åï¼Œå½“ä½ æ·»åŠ å’Œé‡å†™ä»£ç æ—¶ï¼Œå¦‚æœæœ‰ä»€ä¹ˆåœ°æ–¹å‡ºäº†é—®é¢˜ï¼Œæµ‹è¯•ä»£ç ä¼šä¸€ç›´åœ¨é‚£é‡Œå‘ä½ å±•ç¤ºã€‚è¿™åœ¨Rustä¸­æ˜¯éå¸¸å®¹æ˜“çš„ï¼Œå› ä¸ºç¼–è¯‘å™¨ç»™å‡ºäº†å¾ˆå¤šå¾…ä¿®å¤å†…å®¹çš„ä¿¡æ¯ã€‚è®©æˆ‘ä»¬å†™ä¸€ä¸ªæµ‹è¯•é©±åŠ¨å¼€å‘çš„å°ä¾‹å­ï¼Œçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</p>
<p>è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªæ¥å—ç”¨æˆ·è¾“å…¥çš„è®¡ç®—å™¨ã€‚å®ƒå¯ä»¥åŠ (+)ï¼Œä¹Ÿå¯ä»¥å‡(-)ã€‚å¦‚æœç”¨æˆ·å†™ â€œ5+6â€ï¼Œå®ƒåº”è¯¥è¿”å›11ï¼Œå¦‚æœç”¨æˆ·å†™ â€œ5+6-7â€ï¼Œå®ƒåº”è¯¥è¿”å›4ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆä»æµ‹è¯•å‡½æ•°å¼€å§‹ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæµ‹è¯•ä¸­çš„å‡½æ•°åé€šå¸¸éƒ½ç›¸å½“é•¿ã€‚è¿™æ˜¯å› ä¸ºä½ å¯èƒ½ä¼šè¿è¡Œå¾ˆå¤šæµ‹è¯•ï¼Œä½ æƒ³äº†è§£å“ªäº›æµ‹è¯•å¤±è´¥äº†ã€‚</p>
<p>æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªåä¸º<code>math()</code>çš„å‡½æ•°å°±å¯ä»¥å®Œæˆæ‰€æœ‰çš„å·¥ä½œã€‚å®ƒå°†è¿”å›ä¸€ä¸ª <code>i32</code>(æˆ‘ä»¬ä¸ä¼šä½¿ç”¨æµ®ç‚¹æ•°)ã€‚å› ä¸ºå®ƒéœ€è¦è¿”å›ä¸€äº›ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡éƒ½åªè¿”å› <code>6</code>ã€‚ç„¶åæˆ‘ä»¬å°†å†™ä¸‰ä¸ªæµ‹è¯•å‡½æ•°ã€‚å½“ç„¶ï¼Œå®ƒä»¬éƒ½ä¼šå¤±è´¥ã€‚ç°åœ¨çš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">math</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token number">6</span>
<span class="token punctuation">}</span>

# <span class="token punctuation">[</span><span class="token function">cfg</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_plus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 + 1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_two_is_minus_one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - 2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_minus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span>"<span class="token number">1</span> <span class="token operator">-</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒç»™äº†æˆ‘ä»¬è¿™ä¸ªä¿¡æ¯ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 3 tests
test tests::one_minus_minus_one_is_two ... FAILED
test tests::one_minus_two_is_minus_one ... FAILED
test tests::one_plus_one_is_two ... FAILED<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»¥åŠ<code>thread 'tests::one_plus_one_is_two' panicked at 'assertion failed: `(left == right)` </code>çš„æ‰€æœ‰ä¿¡æ¯ã€‚æˆ‘ä»¬ä¸éœ€è¦åœ¨è¿™é‡Œå…¨éƒ¨æ‰“å°å‡ºæ¥ã€‚</p>
<p>ç°åœ¨è¦è€ƒè™‘å¦‚ä½•åˆ›å»ºè®¡ç®—å™¨ã€‚æˆ‘ä»¬å°†æ¥å—ä»»ä½•æ•°å­—ï¼Œä»¥åŠç¬¦å·<code>+-</code>ã€‚æˆ‘ä»¬å°†å…è®¸ç©ºæ ¼ï¼Œä½†ä¸å…è®¸å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ä»åŒ…å«æ‰€æœ‰æ•°å€¼çš„<code>const</code>å¼€å§‹ã€‚ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨ <code>.chars()</code> æŒ‰å­—ç¬¦è¿›è¡Œè¿­ä»£ï¼Œå¹¶ä½¿ç”¨ <code>.all()</code> ç¡®ä¿å®ƒä»¬éƒ½åœ¨é‡Œé¢ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªä¼šå´©æºƒçš„æµ‹è¯•ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ·»åŠ  <code>#[should_panic]</code> å±æ€§:ç°åœ¨å¦‚æœå®ƒå´©æºƒï¼Œæµ‹è¯•å°†æˆåŠŸã€‚</p>
<p>ç°åœ¨ä»£ç çœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">const</span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"1234567890+- "</span><span class="token punctuation">;</span> <span class="token comment">// Don't forget the space at the end</span>

<span class="token keyword">fn</span> <span class="token function-definition function">math</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token boolean">false</span> <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>character<span class="token closure-punctuation punctuation">|</span></span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"Please only input numbers, +-, or spaces"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token number">6</span> <span class="token comment">// we still return a 6 for now</span>
<span class="token punctuation">}</span>

# <span class="token punctuation">[</span><span class="token function">cfg</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_plus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 + 1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_two_is_minus_one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - 2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_minus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - -1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic]</span>  <span class="token comment">// Here is our new test - it should panic</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">panics_when_characters_not_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"7 + seven"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œå½“æˆ‘ä»¬è¿è¡Œæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™æ ·çš„ç»“æœã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 4 tests
test tests::one_minus_two_is_minus_one ... FAILED
test tests::one_minus_minus_one_is_two ... FAILED
test tests::panics_when_characters_not_right ... ok
test tests::one_plus_one_is_two ... FAILED<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€ä¸ªæˆåŠŸäº†! æˆ‘ä»¬çš„<code>math()</code>å‡½æ•°ç°åœ¨åªèƒ½æ¥å—å¥½çš„è¾“å…¥äº†ã€‚</p>
<p>ä¸‹ä¸€æ­¥æ˜¯ç¼–å†™å®é™…çš„è®¡ç®—å™¨ã€‚è¿™å°±æ˜¯å…ˆæœ‰æµ‹è¯•çš„æœ‰è¶£ä¹‹å¤„:å®é™…çš„ä»£ç è¦æ™šå¾ˆå¤šã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŠŠè®¡ç®—å™¨çš„é€»è¾‘æ”¾åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬è¦åšåˆ°ä»¥ä¸‹å‡ ç‚¹ã€‚</p>
<ul>
<li>æ‰€æœ‰çš„ç©ºä½éƒ½åº”è¯¥è¢«åˆ é™¤ã€‚è¿™åœ¨<code>.filter()</code>ä¸­å¾ˆå®¹æ˜“å®ç°ã€‚</li>
<li>æ‰€æœ‰è¾“å…¥åº”è¯¥å˜æˆä¸€ä¸ª<code>Vec</code>ã€‚<code>+</code>ä¸éœ€è¦æˆä¸ºè¾“å…¥ï¼Œä½†æ˜¯å½“ç¨‹åºçœ‹åˆ°<code>+</code>æ—¶ï¼Œåº”è¯¥çŸ¥é“è¿™ä¸ªæ•°å­—å·²ç»å®Œæˆäº†ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥<code>+</code>åº”è¯¥è¿™æ ·åš:<ol>
<li>çœ‹åˆ°<code>1</code>ï¼ŒæŠŠå®ƒæ¨åˆ°ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ä¸­ã€‚</li>
<li>çœ‹åˆ°å¦ä¸€ä¸ª1ï¼ŒæŠŠå®ƒæ¨å…¥å­—ç¬¦ä¸²ä¸­(ç°åœ¨æ˜¯ â€œ11â€)ã€‚</li>
<li>çœ‹åˆ°ä¸€ä¸ª<code>+</code>ï¼ŒçŸ¥é“è¿™ä¸ªæ•°å­—å·²ç»ç»“æŸã€‚å®ƒä¼šæŠŠå­—ç¬¦ä¸²æ¨å…¥vecä¸­ï¼Œç„¶åæ¸…ç©ºå­—ç¬¦ä¸²ã€‚</li>
</ol>
</li>
<li>ç¨‹åºå¿…é¡»è®¡ç®—å‡º<code>-</code>çš„æ•°é‡ã€‚å¥‡æ•°(1ï¼Œ3ï¼Œ5â€¦)è¡¨ç¤ºå‡æ³•ï¼Œå¶æ•°(2ï¼Œ4ï¼Œ6â€¦)è¡¨ç¤ºåŠ æ³•ã€‚æ‰€ä»¥ â€œ1â€“9â€åº”è¯¥æ˜¯10ï¼Œè€Œä¸æ˜¯-8ã€‚</li>
<li>ç¨‹åºåº”è¯¥åˆ é™¤æœ€åä¸€ä¸ªæ•°å­—åé¢çš„ä»»ä½•ä¸œè¥¿ã€‚<code>5+5+++++----</code>æ˜¯ç”±<code>OKAY_CHARACTERS</code>ä¸­çš„æ‰€æœ‰å­—ç¬¦ç»„æˆçš„ï¼Œä½†å®ƒåº”è¯¥å˜æˆ<code>5+5</code>ã€‚<code>.trim_end_matches()</code>å°±å¾ˆç®€å•äº†ï¼Œä½ æŠŠ<code>&amp;str</code>æœ«å°¾ç¬¦åˆçš„ä¸œè¥¿éƒ½å»æ‰ã€‚</li>
</ul>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œ<code>.trim_end_matches()</code>å’Œ<code>.trim_start_matches()</code>æ›¾ç»æ˜¯<code>trim_right_matches()</code>å’Œ<code>trim_left_matches()</code>ã€‚ä½†åæ¥äººä»¬æ³¨æ„åˆ°æœ‰äº›è¯­è¨€æ˜¯ä»å³åˆ°å·¦(æ³¢æ–¯è¯­ã€å¸Œä¼¯æ¥è¯­ç­‰)ï¼Œæ‰€ä»¥å·¦å³éƒ½æ˜¯é”™çš„ã€‚ä½ å¯èƒ½è¿˜èƒ½åœ¨ä¸€äº›ä»£ç ä¸­çœ‹åˆ°æ—§çš„åå­—ï¼Œä½†å®ƒä»¬æ˜¯ä¸€æ ·çš„)ã€‚)</p>
<p>é¦–å…ˆæˆ‘ä»¬åªæƒ³é€šè¿‡æ‰€æœ‰çš„æµ‹è¯•ã€‚é€šè¿‡æµ‹è¯•åï¼Œæˆ‘ä»¬å°±å¯ä»¥ â€œé‡æ„â€äº†ã€‚é‡æ„çš„æ„æ€æ˜¯è®©ä»£ç å˜å¾—æ›´å¥½ï¼Œé€šå¸¸æ˜¯é€šè¿‡ç»“æ„ã€æšä¸¾å’Œæ–¹æ³•ç­‰æ–¹å¼ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬ä½¿æµ‹è¯•é€šè¿‡çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">const</span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"1234567890+- "</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">math</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token boolean">false</span> <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>character<span class="token closure-punctuation punctuation">|</span></span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"Please only input numbers, +-, or spaces"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">trim_end_matches</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token string">"+-"</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>x <span class="token operator">!=</span> <span class="token char string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Remove + and - at the end, and all spaces</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> result_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Results go in here</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> push_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is the string we push in every time. We will keep reusing it in the loop.</span>
    <span class="token keyword">for</span> character <span class="token keyword">in</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> character <span class="token punctuation">{</span>
            <span class="token char string">'+'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token operator">!</span>push_string<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// If the string is empty, we don't want to push "" into result_vec</span>
                    result_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>push_string<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// But if it's not empty, it will be a number. Push it into the vec</span>
                    push_string<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Then clear the string</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token char string">'-'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// If we get a -,</span>
                <span class="token keyword">if</span> push_string<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token operator">||</span> push_string<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// check to see if it's empty or has a -</span>
                    push_string<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span> <span class="token comment">// if so, then push it in</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// otherwise, it will contain a number</span>
                result_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>push_string<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// so push the number into result_vec, clear it and then push -</span>
                push_string<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                push_string<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            number <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// number here means "anything else that matches". We selected the name here</span>
                <span class="token keyword">if</span> push_string<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// We might have some - characters to push in first</span>
                    result_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>push_string<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    push_string<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    push_string<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// But if we don't, that means we can push the number in</span>
                    push_string<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    result_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>push_string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Push one last time after the loop is over. Don't need to .clone() because we don't use it anymore</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// Now it's time to do math. Start with a total</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> adds <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// true = add, false = subtract</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> math_iter <span class="token operator">=</span> result_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span> <span class="token operator">=</span> math_iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Iter through the items</span>
        <span class="token keyword">if</span> entry<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// If it has a - character, check if it's even or odd</span>
            <span class="token keyword">if</span> entry<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                adds <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Go to the next item</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> adds <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token punctuation">{</span>
            total <span class="token operator">+=</span> entry<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// If there is no '-', it must be a number. So we are safe to unwrap</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            total <span class="token operator">-=</span> entry<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            adds <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// After subtracting, reset adds to true.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    total <span class="token comment">// Finally, return the total</span>
<span class="token punctuation">}</span>
   <span class="token comment">/// We'll add a few more tests just to make sure</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_plus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 + 1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_two_is_minus_one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - 2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_minus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - -1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">nine_plus_nine_minus_nine_minus_nine_is_zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"9+9-9-9"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a new test</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eight_minus_nine_plus_nine_is_eight_even_with_characters_on_the_end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"8  - 9     +9-----+++++"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is a new test</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">panics_when_characters_not_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"7 + seven"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æµ‹è¯•é€šè¿‡äº†!</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 6 tests
test tests::one_minus_minus_one_is_two ... ok
test tests::nine_plus_nine_minus_nine_minus_nine_is_zero ... ok
test tests::one_minus_two_is_minus_one ... ok
test tests::eight_minus_nine_plus_nine_is_eight_even_with_characters_on_the_end ... ok
test tests::one_plus_one_is_two ... ok
test tests::panics_when_characters_not_right ... ok

test result: ok. 6 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æµ‹è¯•é©±åŠ¨çš„å¼€å‘ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¥å›çš„è¿‡ç¨‹ã€‚å®ƒæ˜¯è¿™æ ·çš„ã€‚</p>
<ul>
<li>é¦–å…ˆä½ è¦å†™å‡ºæ‰€æœ‰ä½ èƒ½æƒ³åˆ°çš„æµ‹è¯•</li>
<li>ç„¶åä½ å¼€å§‹å†™ä»£ç ã€‚</li>
<li>å½“ä½ å†™ä»£ç çš„æ—¶å€™ï¼Œä½ ä¼šæœ‰å…¶ä»–æµ‹è¯•çš„æƒ³æ³•ã€‚</li>
<li>ä½ æ·»åŠ æµ‹è¯•ï¼Œä½ çš„æµ‹è¯•éšç€ä½ çš„å‘å±•è€Œå¢é•¿ã€‚ä½ çš„æµ‹è¯•è¶Šå¤šï¼Œä½ çš„ä»£ç è¢«æ£€æŸ¥çš„æ¬¡æ•°å°±è¶Šå¤šã€‚</li>
</ul>
<p>å½“ç„¶ï¼Œæµ‹è¯•å¹¶ä¸èƒ½æ£€æŸ¥æ‰€æœ‰çš„ä¸œè¥¿ï¼Œè®¤ä¸º â€œé€šè¿‡æ‰€æœ‰æµ‹è¯•=ä»£ç æ˜¯å®Œç¾çš„â€æ˜¯é”™è¯¯çš„ã€‚ä½†æ˜¯ï¼Œæµ‹è¯•å¯¹äºä½ ä¿®æ”¹ä»£ç çš„æ—¶å€™æ˜¯éå¸¸å¥½çš„ã€‚å¦‚æœä½ ä»¥åä¿®æ”¹äº†ä»£ç ï¼Œç„¶åè¿è¡Œæµ‹è¯•ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæµ‹è¯•ä¸æˆåŠŸï¼Œä½ å°±ä¼šçŸ¥é“è¯¥æ€ä¹ˆä¿®å¤ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥é‡å†™(é‡æ„)ä¸€ä¸‹ä»£ç ã€‚ä¸€ä¸ªå¥½çš„æ–¹æ³•æ˜¯ç”¨clippyå¼€å§‹ã€‚å¦‚æœä½ å®‰è£…äº†Rustï¼Œé‚£ä¹ˆä½ å¯ä»¥è¾“å…¥<code>cargo clippy</code>ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Playgroundï¼Œé‚£ä¹ˆç‚¹å‡»<code>TOOLS</code>ï¼Œé€‰æ‹©Clippyã€‚Clippyä¼šæŸ¥çœ‹ä½ çš„ä»£ç ï¼Œå¹¶ç»™ä½ æç¤ºï¼Œè®©ä½ çš„ä»£ç æ›´ç®€å•ã€‚æˆ‘ä»¬çš„ä»£ç æ²¡æœ‰ä»»ä½•é”™è¯¯ï¼Œä½†å®ƒå¯ä»¥æ›´å¥½ã€‚</p>
<p>Clippyä¼šå‘Šè¯‰æˆ‘ä»¬ä¸¤ä»¶äº‹ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">warning: this loop could be written as a `for` loop
  --&gt; src/lib.rs:44:5
   |
44 |     while let Some(entry) = math_iter.next() { // Iter through the items
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ help: try: `for entry in math_iter`
   |
   = note: `#[warn(clippy::while_let_on_iterator)]` on by default
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#while_let_on_iterator

warning: equality checks against true are unnecessary
  --&gt; src/lib.rs:53:12
   |
53 |         if adds == true {
   |            ^^^^^^^^^^^^ help: try simplifying it as shown: `adds`
   |
   = note: `#[warn(clippy::bool_comparison)]` on by default
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#bool_comparison<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯çœŸçš„:<code>for entry in math_iter</code>æ¯”<code>while let Some(entry) = math_iter.next()</code>ç®€å•å¾—å¤šã€‚è€Œ<code>for</code>å¾ªç¯å®é™…ä¸Šæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰ä»»ä½•ç†ç”±å†™<code>.iter()</code>ã€‚è°¢è°¢ä½ ï¼Œclippy! è€Œä¸”æˆ‘ä»¬ä¹Ÿä¸éœ€è¦åš<code>math_iter</code>:æˆ‘ä»¬å¯ä»¥ç›´æ¥å†™<code>for entry in result_vec</code>ã€‚</p>
<p>è€Œç¬¬äºŒç‚¹ä¹Ÿæ˜¯çœŸçš„:<code>if adds == true</code>å¯ä»¥ç›´æ¥å†™æˆ<code>if adds</code>(å› ä¸º<code>adds</code>=<code>true</code>)ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°†å¼€å§‹ä¸€äº›çœŸæ­£çš„é‡æ„ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª <code>Calculator</code> ç»“æ„ä½“ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„å˜é‡ã€‚è¿™å°†æ‹¥æœ‰æˆ‘ä»¬ä½¿ç”¨çš„æ‰€æœ‰å˜é‡ã€‚æˆ‘ä»¬å°†æ”¹å˜ä¸¤ä¸ªåå­—ä»¥ä½¿å…¶æ›´åŠ æ¸…æ™°ã€‚<code>result_vec</code>å°†å˜æˆ<code>results</code>ï¼Œ<code>push_string</code>å°†å˜æˆ<code>current_input</code>(currentçš„æ„æ€æ˜¯ â€œç°åœ¨â€)ã€‚è€Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œå®ƒåªæœ‰ä¸€ç§æ–¹æ³•:newã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token attribute attr-name">#[derive(Clone)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Calculator</span> <span class="token punctuation">{</span>
    results<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    current_input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    total<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    adds<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            results<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            current_input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            total<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            adds<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æˆ‘ä»¬çš„ä»£ç å…¶å®æ¯”è¾ƒé•¿ï¼Œä½†æ›´å®¹æ˜“è¯»æ‡‚ã€‚æ¯”å¦‚ï¼Œ<code>if adds</code>ç°åœ¨æ˜¯<code>if calculator.adds</code>ï¼Œè¿™å°±è·Ÿè¯»è‹±æ–‡å®Œå…¨ä¸€æ ·ã€‚å®ƒçš„æ ·å­æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Clone)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Calculator</span> <span class="token punctuation">{</span>
    results<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    current_input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    total<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    adds<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            results<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            current_input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            total<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            adds<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"1234567890+- "</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">math</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token boolean">false</span> <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>character<span class="token closure-punctuation punctuation">|</span></span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"Please only input numbers, +-, or spaces"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">trim_end_matches</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token string">"+-"</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>x <span class="token operator">!=</span> <span class="token char string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> calculator <span class="token operator">=</span> <span class="token class-name">Calculator</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> character <span class="token keyword">in</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> character <span class="token punctuation">{</span>
            <span class="token char string">'+'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token operator">!</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token char string">'-'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token operator">||</span> calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            number <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> entry <span class="token keyword">in</span> calculator<span class="token punctuation">.</span>results <span class="token punctuation">{</span>
        <span class="token keyword">if</span> entry<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> entry<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                calculator<span class="token punctuation">.</span>adds <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> calculator<span class="token punctuation">.</span>adds <span class="token punctuation">{</span>
            calculator<span class="token punctuation">.</span>total <span class="token operator">+=</span> entry<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            calculator<span class="token punctuation">.</span>total <span class="token operator">-=</span> entry<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            calculator<span class="token punctuation">.</span>adds <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    calculator<span class="token punctuation">.</span>total
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_plus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 + 1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_two_is_minus_one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - 2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_minus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - -1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">nine_plus_nine_minus_nine_minus_nine_is_zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"9+9-9-9"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eight_minus_nine_plus_nine_is_eight_even_with_characters_on_the_end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"8  - 9     +9-----+++++"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">panics_when_characters_not_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"7 + seven"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€åæˆ‘ä»¬å¢åŠ ä¸¤ä¸ªæ–°æ–¹æ³•ã€‚ä¸€ä¸ªå«åš <code>.clear()</code>ï¼Œæ¸…é™¤ <code>current_input()</code>ã€‚å¦ä¸€ä¸ªå«åš <code>push_char()</code>ï¼ŒæŠŠè¾“å…¥æ¨åˆ° <code>current_input()</code> ä¸Šã€‚è¿™æ˜¯æˆ‘ä»¬é‡æ„åçš„ä»£ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Clone)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Calculator</span> <span class="token punctuation">{</span>
    results<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    current_input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    total<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    adds<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Calculator</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            results<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            current_input<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            total<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            adds<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">clear</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">push_char</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> character<span class="token punctuation">:</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"1234567890+- "</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">math</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token boolean">false</span> <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>character<span class="token closure-punctuation punctuation">|</span></span> <span class="token constant">OKAY_CHARACTERS</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"Please only input numbers, +-, or spaces"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">trim_end_matches</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token string">"+-"</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>x<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>x <span class="token operator">!=</span> <span class="token char string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> calculator <span class="token operator">=</span> <span class="token class-name">Calculator</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> character <span class="token keyword">in</span> input<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> character <span class="token punctuation">{</span>
            <span class="token char string">'+'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token operator">!</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    calculator<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token char string">'-'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token operator">||</span> calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span><span class="token function">push_char</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                calculator<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                calculator<span class="token punctuation">.</span><span class="token function">push_char</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            number <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    calculator<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    calculator<span class="token punctuation">.</span><span class="token function">push_char</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    calculator<span class="token punctuation">.</span><span class="token function">push_char</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    calculator<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>calculator<span class="token punctuation">.</span>current_input<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> entry <span class="token keyword">in</span> calculator<span class="token punctuation">.</span>results <span class="token punctuation">{</span>
        <span class="token keyword">if</span> entry<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> entry<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">{</span>
                calculator<span class="token punctuation">.</span>adds <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> calculator<span class="token punctuation">.</span>adds <span class="token punctuation">{</span>
            calculator<span class="token punctuation">.</span>total <span class="token operator">+=</span> entry<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            calculator<span class="token punctuation">.</span>total <span class="token operator">-=</span> entry<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            calculator<span class="token punctuation">.</span>adds <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    calculator<span class="token punctuation">.</span>total
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_plus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 + 1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_two_is_minus_one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - 2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">one_minus_minus_one_is_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"1 - -1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">nine_plus_nine_minus_nine_minus_nine_is_zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"9+9-9-9"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eight_minus_nine_plus_nine_is_eight_even_with_characters_on_the_end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"8  - 9     +9-----+++++"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">panics_when_characters_not_right</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">math</span><span class="token punctuation">(</span><span class="token string">"7 + seven"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å¤§æ¦‚å·²ç»å¤Ÿå¥½äº†ã€‚æˆ‘ä»¬å¯ä»¥å†™æ›´å¤šçš„æ–¹æ³•ï¼Œä½†æ˜¯åƒ<code>calculator.results.push(calculator.current_input.clone());</code>è¿™æ ·çš„è¡Œå·²ç»å¾ˆæ¸…æ¥šäº†ã€‚é‡æ„æœ€å¥½æ˜¯åœ¨ä½ å®Œæˆåè¿˜èƒ½è½»æ¾é˜…è¯»ä»£ç çš„æ—¶å€™ã€‚ä½ ä¸å¸Œæœ›åªæ˜¯ä¸ºäº†è®©ä»£ç å˜çŸ­è€Œé‡æ„:ä¾‹å¦‚ï¼Œ<code>clc.clr()</code>å°±æ¯”<code>calculator.clear()</code>å·®å¾ˆå¤šã€‚</p>
<h2 id="å¤–éƒ¨crate"><a href="#å¤–éƒ¨crate" class="headerlink" title="å¤–éƒ¨crate"></a>å¤–éƒ¨crate</h2><p>å¤–éƒ¨crateçš„æ„æ€æ˜¯ â€œåˆ«äººçš„crateâ€ã€‚</p>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ <em>å·®ä¸å¤š</em>éœ€è¦å®‰è£…Rustï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥åªä½¿ç”¨Playgroundã€‚ç°åœ¨æˆ‘ä»¬è¦å­¦ä¹ å¦‚ä½•å¯¼å…¥åˆ«äººå†™çš„crateã€‚è¿™åœ¨Rustä¸­å¾ˆé‡è¦ï¼ŒåŸå› æœ‰äºŒã€‚</p>
<ul>
<li>å¯¼å…¥å…¶ä»–çš„crateå¾ˆå®¹æ˜“ï¼Œå¹¶ä¸”â€¦</li>
<li>Rustæ ‡å‡†åº“æ˜¯ç›¸å½“å°çš„ã€‚</li>
</ul>
<p>è¿™æ„å‘³ç€ï¼Œåœ¨Rustä¸­ï¼Œå¾ˆå¤šåŸºæœ¬åŠŸèƒ½éƒ½éœ€è¦ç”¨åˆ°å¤–éƒ¨Crateï¼Œè¿™å¾ˆæ­£å¸¸ã€‚æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼Œå¦‚æœä½¿ç”¨å¤–éƒ¨Crateå¾ˆæ–¹ä¾¿ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€‰æ‹©æœ€å¥½çš„ä¸€ä¸ªã€‚ä¹Ÿè®¸ä¸€ä¸ªäººä¼šä¸ºä¸€ä¸ªåŠŸèƒ½åˆ›å»ºä¸€ä¸ªcrateï¼Œç„¶åå…¶ä»–äººä¼šåˆ›å»ºä¸€ä¸ªæ›´å¥½çš„crateã€‚</p>
<p>åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬åªçœ‹æœ€æµè¡Œçš„crateï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªä½¿ç”¨Rustçš„äººéƒ½çŸ¥é“çš„crateã€‚</p>
<p>è¦å¼€å§‹å­¦ä¹ å¤–éƒ¨Crateï¼Œæˆ‘ä»¬å°†ä»æœ€å¸¸è§çš„Crateå¼€å§‹ã€‚<code>rand</code>.</p>
<h3 id="rand"><a href="#rand" class="headerlink" title="rand"></a>rand</h3><p>ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰ä½¿ç”¨ä»»ä½•éšæœºæ•°ï¼Ÿé‚£æ˜¯å› ä¸ºéšæœºæ•°ä¸åœ¨æ ‡å‡†åº“ä¸­ã€‚ä½†æ˜¯æœ‰å¾ˆå¤šcrate â€œå‡ ä¹æ˜¯æ ‡å‡†åº“â€ï¼Œå› ä¸ºå¤§å®¶éƒ½åœ¨ä½¿ç”¨å®ƒä»¬ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå¸¦å…¥ä¸€ä¸ª crate æ˜¯éå¸¸å®¹æ˜“çš„ã€‚å¦‚æœä½ çš„ç”µè„‘ä¸Šæœ‰Rustï¼Œæœ‰ä¸€ä¸ªå«<code>Cargo.toml</code>çš„æ–‡ä»¶ï¼Œé‡Œé¢æœ‰è¿™äº›ä¿¡æ¯ã€‚<code>Cargo.toml</code>æ–‡ä»¶åœ¨ä½ å¯åŠ¨æ—¶æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[package]
name = "rust_book"
version = "0.1.0"
authors = ["David MacLeod"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ï¼Œå¦‚æœä½ æƒ³æ·»åŠ <code>rand</code> crateï¼Œåœ¨<code>crates.io</code>ä¸Šæœç´¢å®ƒï¼Œè¿™æ˜¯æ‰€æœ‰crateçš„å»å¤„ã€‚è¿™å°†å¸¦ä½ åˆ°<code>https://crates.io/crates/rand</code>ã€‚å½“ä½ ç‚¹å‡»é‚£ä¸ªï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå±å¹•ï¼Œä¸Šé¢å†™ç€<code>Cargo.toml   rand = "0.7.3"</code>ã€‚ä½ æ‰€è¦åšçš„å°±æ˜¯åœ¨[dependencies]ä¸‹æ·»åŠ è¿™æ ·çš„å†…å®¹:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[package]
name = "rust_book"
version = "0.1.0"
authors = ["David MacLeod"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
rand = "0.7.3"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åCargoä¼šå¸®ä½ å®Œæˆå‰©ä¸‹çš„å·¥ä½œã€‚ç„¶åä½ å°±å¯ä»¥åœ¨<code>rand</code>æ–‡æ¡£ç½‘ç«™ä¸Šå¼€å§‹ç¼–å†™åƒ<a target="_blank" rel="noopener" href="https://docs.rs/rand/0.7.3/rand/">æœ¬ä¾‹ä»£ç </a>è¿™æ ·çš„ä»£ç ã€‚è¦æƒ³è¿›å…¥æ–‡æ¡£ï¼Œä½ å¯ä»¥ç‚¹å‡»<a target="_blank" rel="noopener" href="https://crates.io/crates/rand">crates.ioä¸Šçš„é¡µé¢</a>ä¸­çš„<code>docs</code>æŒ‰é’®ã€‚</p>
<p>å…³äºCargoçš„ä»‹ç»å°±åˆ°è¿™é‡Œäº†:æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„è¿˜åªæ˜¯playgroundã€‚å¹¸è¿çš„æ˜¯ï¼Œplaygroundå·²ç»å®‰è£…äº†å‰100ä¸ªcrateã€‚æ‰€ä»¥ä½ è¿˜ä¸éœ€è¦å†™è¿›<code>Cargo.toml</code>ã€‚åœ¨playgroundä¸Šï¼Œä½ å¯ä»¥æƒ³è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ªè¿™æ ·çš„é•¿é•¿çš„åˆ—è¡¨ï¼Œæœ‰100ä¸ªcrateã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[dependencies]
rand = "0.7.3"
some_other_crate = "0.1.0"
another_nice_crate = "1.7"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¦ä½¿ç”¨<code>rand</code>ï¼Œä½ å¯ä»¥ç›´æ¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> rand<span class="token punctuation">;</span> <span class="token comment">// This means the whole crate rand</span>
          <span class="token comment">// On your computer you can't just write this;</span>
          <span class="token comment">// you need to write in the Cargo.toml file first</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> random_u16 <span class="token operator">=</span> <span class="token namespace">rand<span class="token punctuation">::</span></span><span class="token function">random</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">u16</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> random_u16<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¯æ¬¡éƒ½ä¼šæ‰“å°ä¸åŒçš„<code>u16</code>å·ç ï¼Œæ¯”å¦‚<code>42266 52873 56528 46927 6867</code>ã€‚</p>
<p><code>rand</code>ä¸­çš„ä¸»è¦åŠŸèƒ½æ˜¯<code>random</code>å’Œ<code>thread_rng</code>(rngçš„æ„æ€æ˜¯ â€œéšæœºæ•°å‘ç”Ÿå™¨â€)ã€‚è€Œå®é™…ä¸Šå¦‚æœä½ çœ‹<code>random</code>ï¼Œå®ƒè¯´:â€è¿™åªæ˜¯<code>thread_rng().gen()</code>çš„ä¸€ä¸ªå¿«æ·æ–¹å¼â€ã€‚æ‰€ä»¥å…¶å®æ˜¯<code>thread_rng</code>åŸºæœ¬åšå®Œäº†ä¸€åˆ‡ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä»1åˆ°10çš„æ•°å­—ã€‚ä¸ºäº†å¾—åˆ°è¿™äº›æ•°å­—ï¼Œæˆ‘ä»¬åœ¨1åˆ°11ä¹‹é—´ä½¿ç”¨<code>.gen_range()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">rand<span class="token punctuation">::</span></span><span class="token punctuation">{</span>thread_rng<span class="token punctuation">,</span> <span class="token class-name">Rng</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Or just use rand::*; if we are lazy</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> number_maker <span class="token operator">=</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> number_maker<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º<code>7 2 4 8 6</code>è¿™æ ·çš„ä¸œè¥¿ã€‚</p>
<p>ç”¨éšæœºæ•°æˆ‘ä»¬å¯ä»¥åšä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼Œæ¯”å¦‚ä¸ºæ¸¸æˆåˆ›å»ºè§’è‰²ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code>rand</code>å’Œå…¶ä»–ä¸€äº›æˆ‘ä»¬çŸ¥é“çš„ä¸œè¥¿æ¥åˆ›å»ºå®ƒä»¬ã€‚åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œæˆ‘ä»¬çš„è§’è‰²æœ‰å…­ç§çŠ¶æ€ï¼Œç”¨ä¸€ä¸ªd6æ¥è¡¨ç¤ºä»–ä»¬ã€‚d6æ˜¯ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œå½“ä½ æŠ•æ·å®ƒæ—¶ï¼Œå®ƒèƒ½ç»™å‡º1ã€2ã€3ã€4ã€5æˆ–6ã€‚æ¯ä¸ªè§’è‰²éƒ½ä¼šæ·ä¸‰æ¬¡d6ï¼Œæ‰€ä»¥æ¯ä¸ªç»Ÿè®¡éƒ½åœ¨3åˆ°18ä¹‹é—´ã€‚</p>
<p>ä½†æ˜¯æœ‰æ—¶å€™å¦‚æœä½ çš„è§’è‰²æœ‰ä¸€äº›ä½çš„ä¸œè¥¿ï¼Œæ¯”å¦‚3æˆ–4ï¼Œé‚£å°±ä¸å…¬å¹³äº†ã€‚æ¯”å¦‚è¯´ä½ çš„åŠ›é‡æ˜¯3ï¼Œä½ å°±ä¸èƒ½æ‹¿ä¸œè¥¿ã€‚æ‰€ä»¥è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç”¨d6å››æ¬¡ã€‚ä½ æ·å››æ¬¡ï¼Œç„¶åæ‰”æ‰æœ€ä½çš„æ•°å­—ã€‚æ‰€ä»¥å¦‚æœä½ æ·3ï¼Œ3ï¼Œ1ï¼Œ6ï¼Œé‚£ä¹ˆä½ ä¿ç•™3ï¼Œ3ï¼Œ6=12ã€‚æˆ‘ä»¬ä¹Ÿä¼šæŠŠè¿™ä¸ªæ–¹æ³•åšå‡ºæ¥ï¼Œæ‰€ä»¥æ¸¸æˆçš„ä¸»äººå¯ä»¥å†³å®šã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬ç®€å•çš„è§’è‰²åˆ›å»ºå™¨ã€‚æˆ‘ä»¬ä¸ºæ•°æ®ç»Ÿè®¡åˆ›å»ºäº†ä¸€ä¸ª<code>Character</code>ç»“æ„ï¼Œç”šè‡³è¿˜å®ç°äº†<code>Display</code>æ¥æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼æ‰“å°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">rand<span class="token punctuation">::</span></span><span class="token punctuation">{</span>thread_rng<span class="token punctuation">,</span> <span class="token class-name">Rng</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Or just use rand::*; if we are lazy</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span> <span class="token comment">// Going to impl Display for our character</span>


<span class="token keyword">struct</span> <span class="token type-definition class-name">Character</span> <span class="token punctuation">{</span>
    strength<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    dexterity<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>    <span class="token comment">// This means "body quickness"</span>
    constitution<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token comment">// This means "health"</span>
    intelligence<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    wisdom<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
    charisma<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> <span class="token comment">// This means "popularity with people"</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u8</span> <span class="token punctuation">{</span> <span class="token comment">// A "die" is the thing you throw to get the number</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> generator <span class="token operator">=</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Create our random number generator</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> stat <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// This is the total</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">3</span> <span class="token punctuation">{</span>
        stat <span class="token operator">+=</span> generator<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Add each time</span>
    <span class="token punctuation">}</span>
    stat <span class="token comment">// Return the total</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u8</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> generator <span class="token operator">=</span> <span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> results <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// First put the numbers in a vec</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">4</span> <span class="token punctuation">{</span>
        results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>generator<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    results<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now a result like [4, 3, 2, 6] becomes [2, 3, 4, 6]</span>
    results<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now it would be [3, 4, 6]</span>
    results<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Return this result</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>three_dice<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span> <span class="token comment">// true for three dice, false for four</span>
        <span class="token keyword">match</span> three_dice <span class="token punctuation">{</span>
            <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
                strength<span class="token punctuation">:</span> <span class="token function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                dexterity<span class="token punctuation">:</span> <span class="token function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                constitution<span class="token punctuation">:</span> <span class="token function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                intelligence<span class="token punctuation">:</span> <span class="token function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                wisdom<span class="token punctuation">:</span> <span class="token function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                charisma<span class="token punctuation">:</span> <span class="token function">three_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
                strength<span class="token punctuation">:</span> <span class="token function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                dexterity<span class="token punctuation">:</span> <span class="token function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                constitution<span class="token punctuation">:</span> <span class="token function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                intelligence<span class="token punctuation">:</span> <span class="token function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                wisdom<span class="token punctuation">:</span> <span class="token function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                charisma<span class="token punctuation">:</span> <span class="token function">four_die_six</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">display</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// We can do this because we implemented Display below</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Character</span> <span class="token punctuation">{</span> <span class="token comment">// Just follow the code for in https://doc.rust-lang.org/std/fmt/trait.Display.html and change it a bit</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>
            f<span class="token punctuation">,</span>
            <span class="token string">"Your character has these stats:
strength: {}
dexterity: {}
constitution: {}
intelligence: {}
wisdom: {}
charisma: {}"</span><span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>strength<span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>dexterity<span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>constitution<span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>intelligence<span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>wisdom<span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>charisma
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> weak_billy <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> strong_billy <span class="token operator">=</span> <span class="token class-name">Character</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    weak_billy<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    strong_billy<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒä¼šæ‰“å°å‡ºè¿™æ ·çš„ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token class-name">Your</span> character has these stats<span class="token punctuation">:</span>
strength<span class="token punctuation">:</span> <span class="token number">9</span>
dexterity<span class="token punctuation">:</span> <span class="token number">15</span>
constitution<span class="token punctuation">:</span> <span class="token number">15</span>
intelligence<span class="token punctuation">:</span> <span class="token number">8</span>
wisdom<span class="token punctuation">:</span> <span class="token number">11</span>
charisma<span class="token punctuation">:</span> <span class="token number">9</span>

<span class="token class-name">Your</span> character has these stats<span class="token punctuation">:</span>
strength<span class="token punctuation">:</span> <span class="token number">9</span>
dexterity<span class="token punctuation">:</span> <span class="token number">13</span>
constitution<span class="token punctuation">:</span> <span class="token number">14</span>
intelligence<span class="token punctuation">:</span> <span class="token number">16</span>
wisdom<span class="token punctuation">:</span> <span class="token number">16</span>
charisma<span class="token punctuation">:</span> <span class="token number">10</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ‰å››ä¸ªéª°å­çš„è§’è‰²é€šå¸¸åœ¨å¤§å¤šæ•°äº‹æƒ…ä¸Šéƒ½ä¼šå¥½ä¸€ç‚¹ã€‚</p>
<h3 id="rayon"><a href="#rayon" class="headerlink" title="rayon"></a>rayon</h3><p><code>rayon</code> æ˜¯ä¸€ä¸ªæµè¡Œçš„crateï¼Œå®ƒå¯ä»¥è®©ä½ åŠ å¿« Rust ä»£ç çš„é€Ÿåº¦ã€‚å®ƒä¹‹æ‰€ä»¥å—æ¬¢è¿ï¼Œæ˜¯å› ä¸ºå®ƒæ— éœ€åƒ <code>thread::spawn</code> è¿™æ ·çš„ä¸œè¥¿å°±èƒ½åˆ›å»ºçº¿ç¨‹ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä¹‹æ‰€ä»¥å—æ¬¢è¿æ˜¯å› ä¸ºå®ƒæ—¢æœ‰æ•ˆåˆå®¹æ˜“ç¼–å†™ã€‚æ¯”å¦‚è¯´</p>
<ul>
<li><code>.iter()</code>, <code>.iter_mut()</code>, <code>into_iter()</code>åœ¨rayonä¸­æ˜¯è¿™æ ·å†™çš„:</li>
<li><code>.par_iter()</code>, <code>.par_iter_mut()</code>, <code>par_into_iter()</code>. æ‰€ä»¥ä½ åªè¦åŠ ä¸Š<code>par_</code>ï¼Œä½ çš„ä»£ç å°±ä¼šå˜å¾—å¿«å¾ˆå¤šã€‚(parçš„æ„æ€æ˜¯ â€œå¹¶è¡Œâ€)</li>
</ul>
<p>å…¶ä»–æ–¹æ³•ä¹Ÿä¸€æ ·:<code>.chars()</code>å°±æ˜¯<code>.par_chars()</code>ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>è¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼Œä¸€æ®µç®€å•çš„ä»£ç ï¼Œå´è®©è®¡ç®—æœºåšäº†å¾ˆå¤šå·¥ä½œã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">200_000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>number<span class="token operator">+=</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>my_vec<span class="token punctuation">[</span><span class="token number">5000</span><span class="token punctuation">..</span><span class="token number">5005</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒåˆ›å»ºäº†ä¸€ä¸ªæœ‰20ä¸‡é¡¹çš„å‘é‡:æ¯ä¸€é¡¹éƒ½æ˜¯0ï¼Œç„¶åè°ƒç”¨<code>.enumerate()</code>æ¥è·å–æ¯ä¸ªæ•°å­—çš„ç´¢å¼•ï¼Œå¹¶å°†0æ”¹ä¸ºç´¢å¼•å·ã€‚å®ƒçš„æ‰“å°æ—¶é—´å¤ªé•¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ‰“å°5000åˆ°5004é¡¹ã€‚è¿™åœ¨Rustä¸­è¿˜æ˜¯éå¸¸å¿«çš„ï¼Œä½†å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥ç”¨Rayonè®©å®ƒæ›´å¿«ã€‚ä»£ç å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">rayon<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span> <span class="token comment">// Import rayon</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token number">200_000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">par_iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">*</span>number<span class="token operator">+=</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add par_ to iter_mut</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>my_vec<span class="token punctuation">[</span><span class="token number">5000</span><span class="token punctuation">..</span><span class="token number">5005</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°±è¿™æ ·äº†ã€‚<code>rayon</code>è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„æ–¹æ³•æ¥å®šåˆ¶ä½ æƒ³åšçš„äº‹æƒ…ï¼Œä½†æœ€ç®€å•çš„å°±æ˜¯ â€œæ·»åŠ <code>_par</code>ï¼Œè®©ä½ çš„ç¨‹åºæ›´å¿«â€ã€‚</p>
<h3 id="serde"><a href="#serde" class="headerlink" title="serde"></a>serde</h3><p><code>serde</code>æ˜¯ä¸€ä¸ªæµè¡Œçš„crateï¼Œå®ƒå¯ä»¥è®©åœ¨JSONã€YAMLç­‰æ ¼å¼é—´ç›¸äº’è½¬æ¢ã€‚æœ€å¸¸è§çš„ä½¿ç”¨æ–¹æ³•æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ª<code>struct</code>ï¼Œä¸Šé¢æœ‰ä¸¤ä¸ªå±æ€§ã€‚<a target="_blank" rel="noopener" href="https://serde.rs/">å®ƒçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„</a>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[derive(Serialize, Deserialize, Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Serialize</code>å’Œ<code>Deserialize</code>traitæ˜¯ä½¿è½¬æ¢å˜å¾—ç®€å•çš„åŸå› ã€‚(è¿™ä¹Ÿæ˜¯<code>serde</code>è¿™ä¸ªåå­—çš„ç”±æ¥)å¦‚æœä½ çš„ç»“æ„ä½“ä¸Šæœ‰è¿™ä¸¤ä¸ªtraitï¼Œé‚£ä¹ˆä½ åªéœ€è¦è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±å¯ä»¥æŠŠå®ƒè½¬åŒ–ä¸ºJSONæˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚</p>
<h3 id="regex"><a href="#regex" class="headerlink" title="regex"></a>regex</h3><p><a target="_blank" rel="noopener" href="https://crates.io/crates/regex">regex</a> crate å¯ä»¥è®©ä½ ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Regular_expression">æ­£åˆ™è¡¨è¾¾å¼</a> æœç´¢æ–‡æœ¬ã€‚æœ‰äº†å®ƒï¼Œä½ å¯ä»¥é€šè¿‡ä¸€æ¬¡æœç´¢å¾—åˆ°è¯¸å¦‚ <code>colour</code>, <code>color</code>, <code>colours</code> å’Œ <code>colors</code> çš„åŒ¹é…ä¿¡æ¯ã€‚æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦ä¸€é—¨è¯­è¨€ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å®ƒä»¬ï¼Œä¹Ÿå¿…é¡»å­¦ä¼šã€‚</p>
<h3 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h3><p><a target="_blank" rel="noopener" href="https://crates.io/crates/chrono">chrono</a>æ˜¯ä¸ºé‚£äº›éœ€è¦æ›´å¤šæ—¶é—´åŠŸèƒ½çš„äººå‡†å¤‡çš„ä¸»è¦crateã€‚æˆ‘ä»¬ç°åœ¨æ¥çœ‹ä¸€ä¸‹æ ‡å‡†åº“ï¼Œå®ƒæœ‰æ—¶é—´çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦æ›´å¤šçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™ä¸ªcrateæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p>
<h2 id="æ ‡å‡†åº“ä¹‹æ—…"><a href="#æ ‡å‡†åº“ä¹‹æ—…" class="headerlink" title="æ ‡å‡†åº“ä¹‹æ—…"></a>æ ‡å‡†åº“ä¹‹æ—…</h2><p>ç°åœ¨ä½ å·²ç»çŸ¥é“äº†å¾ˆå¤šRustçš„çŸ¥è¯†ï¼Œä½ å°†èƒ½å¤Ÿç†è§£æ ‡å‡†åº“é‡Œé¢çš„å¤§éƒ¨åˆ†ä¸œè¥¿ã€‚å®ƒé‡Œé¢çš„ä»£ç å·²ç»ä¸æ˜¯é‚£ä¹ˆå¯æ€•äº†ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒé‡Œé¢ä¸€äº›æˆ‘ä»¬è¿˜æ²¡æœ‰å­¦è¿‡çš„éƒ¨åˆ†ã€‚æœ¬ç¯‡æ¸¸è®°å°†ä»‹ç»æ ‡å‡†åº“çš„å¤§éƒ¨åˆ†éƒ¨åˆ†ï¼Œä½ ä¸éœ€è¦å®‰è£…Rustã€‚æˆ‘ä»¬å°†é‡æ¸©å¾ˆå¤šæˆ‘ä»¬å·²ç»çŸ¥é“çš„å†…å®¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ›´æ·±å…¥åœ°å­¦ä¹ å®ƒä»¬ã€‚</p>
<h3 id="æ•°ç»„-1"><a href="#æ•°ç»„-1" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>å…³äºæ•°ç»„éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå®ƒä»¬æ²¡æœ‰å®ç°<code>Iterator.</code>ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œä½ ä¸èƒ½ä½¿ç”¨<code>for</code>ã€‚ä½†æ˜¯ä½ å¯ä»¥å¯¹å®ƒä»¬ä½¿ç”¨ <code>.iter()</code> è¿™æ ·çš„æ–¹æ³•ã€‚æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨<code>&amp;</code>æ¥å¾—åˆ°ä¸€ä¸ªç‰‡æ–­ã€‚å®é™…ä¸Šï¼Œå¦‚æœä½ å°è¯•ä½¿ç”¨<code>for</code>ï¼Œç¼–è¯‘å™¨ä¼šå‡†ç¡®åœ°å‘Šè¯‰ä½ ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// âš ï¸</span>
    <span class="token keyword">let</span> my_cities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Beirut"</span><span class="token punctuation">,</span> <span class="token string">"Tel Aviv"</span><span class="token punctuation">,</span> <span class="token string">"Nicosia"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> city <span class="token keyword">in</span> my_cities <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¶ˆæ¯æ˜¯:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: `[&amp;str; 3]` is not an iterator
 --&gt; src\main.rs:5:17
  |
  |                 ^^^^^^^^^ borrow the array with `&amp;` or call `.iter()` on it to iterate over it<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è®©æˆ‘ä»¬è¯•è¯•è¿™ä¸¤ç§æ–¹æ³•ã€‚å®ƒä»¬çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_cities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Beirut"</span><span class="token punctuation">,</span> <span class="token string">"Tel Aviv"</span><span class="token punctuation">,</span> <span class="token string">"Nicosia"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> city <span class="token keyword">in</span> <span class="token operator">&amp;</span>my_cities <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> city <span class="token keyword">in</span> my_cities<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> city<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Beirut
Tel Aviv
Nicosia
Beirut
Tel Aviv
Nicosia<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>å¦‚æœä½ æƒ³ä»ä¸€ä¸ªæ•°ç»„ä¸­è·å–å˜é‡ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬çš„åå­—æ”¾åœ¨ <code>[]</code> ä¸­æ¥è§£æ„å®ƒã€‚è¿™ä¸åœ¨ <code>match</code> è¯­å¥ä¸­ä½¿ç”¨å…ƒç»„æˆ–ä»ç»“æ„ä½“ä¸­è·å–å˜é‡æ˜¯ä¸€æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_cities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Beirut"</span><span class="token punctuation">,</span> <span class="token string">"Tel Aviv"</span><span class="token punctuation">,</span> <span class="token string">"Nicosia"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span>city1<span class="token punctuation">,</span> city2<span class="token punctuation">,</span> city3<span class="token punctuation">]</span> <span class="token operator">=</span> my_cities<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> city1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰“å°å‡º<code>Beirut</code>.</p>
<h3 id="char"><a href="#char" class="headerlink" title="char"></a>char</h3><p>æ‚¨å¯ä»¥ä½¿ç”¨<code>.escape_unicode()</code>çš„æ–¹æ³•æ¥è·å–<code>char</code>çš„Unicodeå·ç ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> korean_word <span class="token operator">=</span> <span class="token string">"ì²­ì¶˜ì˜ˆì°¬"</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> character <span class="token keyword">in</span> korean_word<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> character<span class="token punctuation">.</span><span class="token function">escape_unicode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>è¿™å°†æ‰“å°å‡º <code>u{ccad} u{cd98} u{c608} u{cc2c}</code>ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>From</code> traitä» <code>u8</code> ä¸­å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ï¼Œä½†å¯¹äº <code>u32</code>ï¼Œä½ ä½¿ç”¨ <code>TryFrom</code>ï¼Œå› ä¸ºå®ƒå¯èƒ½æ— æ³•å·¥ä½œã€‚<code>u32</code>ä¸­çš„æ•°å­—æ¯”Unicodeä¸­çš„å­—ç¬¦å¤šå¾ˆå¤šã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºæ¥äº†è§£ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">TryFrom</span><span class="token punctuation">;</span> <span class="token comment">// You need to bring TryFrom in to use it</span>
<span class="token keyword">use</span> <span class="token namespace">rand<span class="token punctuation">::</span>prelude<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>      <span class="token comment">// We will use random numbers too</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_character <span class="token operator">=</span> <span class="token keyword">char</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This one is easy - no need for TryFrom</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> some_character<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> random_generator <span class="token operator">=</span> <span class="token namespace">rand<span class="token punctuation">::</span></span><span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// This will try 40,000 times to make a char from a u32.</span>
    <span class="token comment">// The range is 0 (std::u32::MIN) to u32's highest number (std::u32::MAX). If it doesn't work, we will give it '-'.</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">40_000</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> bigger_character <span class="token operator">=</span> <span class="token keyword">char</span><span class="token punctuation">::</span><span class="token function">try_from</span><span class="token punctuation">(</span>random_generator<span class="token punctuation">.</span><span class="token function">gen_range</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u32</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">u32</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token char string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> bigger_character<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‡ ä¹æ¯æ¬¡éƒ½ä¼šç”Ÿæˆä¸€ä¸ª<code>-</code>ã€‚è¿™æ˜¯ä½ ä¼šçœ‹åˆ°çš„é‚£ç§è¾“å‡ºçš„ä¸€éƒ¨åˆ†ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">------------------------------------------------------------------------ğ¤’°---------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-------------------------------------------------------------ì¶—--------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
------------ò‡œ----------------------------------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œä½ è¦ç”¨<code>TryFrom</code>æ˜¯ä»¶å¥½äº‹ã€‚</p>
<p>å¦å¤–ï¼Œä»2020å¹´8æœˆåº•å¼€å§‹ï¼Œä½ ç°åœ¨å¯ä»¥ä»<code>char</code>ä¸­å¾—åˆ°ä¸€ä¸ª<code>String</code>ã€‚(<code>String</code>å®ç°äº†<code>From&lt;char&gt;</code>)åªè¦å†™<code>String::from()</code>ï¼Œç„¶ååœ¨é‡Œé¢æ”¾ä¸€ä¸ª<code>char</code>ã€‚</p>
<h3 id="æ•´æ•°"><a href="#æ•´æ•°" class="headerlink" title="æ•´æ•°"></a>æ•´æ•°</h3><p>è¿™äº›ç±»å‹çš„æ•°å­¦æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå¦å¤–è¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€äº›æœ€æœ‰ç”¨çš„ã€‚</p>
<p><code>.checked_add()</code>, <code>.checked_sub()</code>, <code>.checked_mul()</code>, <code>.checked_div()</code>. å¦‚æœä½ è®¤ä¸ºä½ å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªä¸é€‚åˆç±»å‹çš„æ•°å­—ï¼Œè¿™äº›éƒ½æ˜¯ä¸é”™çš„æ–¹æ³•ã€‚å®ƒä»¬ä¼šè¿”å›ä¸€ä¸ª <code>Option</code>ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å®‰å…¨åœ°æ£€æŸ¥ä½ çš„æ•°å­¦è®¡ç®—æ˜¯å¦æ­£å¸¸ï¼Œè€Œä¸ä¼šè®©ç¨‹åºå´©æºƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> some_number <span class="token operator">=</span> <span class="token number">200_u8</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> other_number <span class="token operator">=</span> <span class="token number">200_u8</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> some_number<span class="token punctuation">.</span><span class="token function">checked_add</span><span class="token punctuation">(</span>other_number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> some_number<span class="token punctuation">.</span><span class="token function">checked_add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">None
Some(201)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>ä½ ä¼šæ³¨æ„åˆ°ï¼Œåœ¨æ•´æ•°çš„é¡µé¢ä¸Šï¼Œç»å¸¸è¯´<code>rhs</code>ã€‚è¿™æ„å‘³ç€ â€œå³æ‰‹â€ï¼Œä¹Ÿå°±æ˜¯ä½ åšä¸€äº›æ•°å­¦è¿ç®—æ—¶çš„å³æ‰‹ã€‚æ¯”å¦‚åœ¨<code>5 + 6</code>ä¸­ï¼Œ<code>5</code>åœ¨å·¦è¾¹ï¼Œ<code>6</code>åœ¨å³è¾¹ï¼Œæ‰€ä»¥<code>6</code>å°±æ˜¯<code>rhs</code>ã€‚è¿™ä¸ªä¸æ˜¯å…³é”®è¯ï¼Œä½†æ˜¯ä½ ä¼šç»å¸¸çœ‹åˆ°ï¼Œæ‰€ä»¥çŸ¥é“å°±å¥½ã€‚</p>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•å®ç°<code>Add</code>ã€‚åœ¨ä½ å®ç°äº†<code>Add</code>ä¹‹åï¼Œä½ å¯ä»¥åœ¨ä½ åˆ›å»ºçš„ç±»å‹ä¸Šä½¿ç”¨<code>+</code>ã€‚ä½ éœ€è¦è‡ªå·±å®ç°<code>Add</code>ï¼Œå› ä¸ºaddå¯ä»¥æ„å‘³ç€å¾ˆå¤šä¸œè¥¿ã€‚è¿™æ˜¯æ ‡å‡†åº“é¡µé¢ä¸­çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Add</span><span class="token punctuation">;</span> <span class="token comment">// first bring in Add</span>

<span class="token attribute attr-name">#[derive(Debug, Copy, Clone, PartialEq)]</span> <span class="token comment">// PartialEq is probably the most important part here. You want to be able to compare numbers</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Add</span> <span class="token keyword">for</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Output</span> <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">;</span> <span class="token comment">// Remember, this is called an "associated type": a "type that goes together".</span>
                        <span class="token comment">// In this case it's just another Point</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            x<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span>
            y<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨è®©æˆ‘ä»¬ä¸ºè‡ªå·±çš„ç±»å‹å®ç°<code>Add</code>ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³æŠŠä¸¤ä¸ªå›½å®¶åŠ åœ¨ä¸€èµ·ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ¯”è¾ƒå®ƒä»¬çš„ç»æµã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token class-name">Add</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Clone)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Country</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    gdp<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> <span class="token comment">// This is the size of the economy</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> population<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span> gdp<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            population<span class="token punctuation">,</span>
            gdp<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Add</span> <span class="token keyword">for</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Output</span> <span class="token operator">=</span> <span class="token keyword">Self</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{} and {}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> other<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// We will add the names together,</span>
            population<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>population <span class="token operator">+</span> other<span class="token punctuation">.</span>population<span class="token punctuation">,</span> <span class="token comment">// and the population,</span>
            gdp<span class="token punctuation">:</span> <span class="token keyword">self</span><span class="token punctuation">.</span>gdp <span class="token operator">+</span> other<span class="token punctuation">.</span>gdp<span class="token punctuation">,</span>   <span class="token comment">// and the GDP</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>
            f<span class="token punctuation">,</span>
            <span class="token string">"In {} are {} people and a GDP of ${}"</span><span class="token punctuation">,</span> <span class="token comment">// Then we can print them all with just {}</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>population<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>gdp
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> nauru <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Nauru"</span><span class="token punctuation">,</span> <span class="token number">10_670</span><span class="token punctuation">,</span> <span class="token number">160_000_000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> vanuatu <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Vanuatu"</span><span class="token punctuation">,</span> <span class="token number">307_815</span><span class="token punctuation">,</span> <span class="token number">820_000_000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> micronesia <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Micronesia"</span><span class="token punctuation">,</span> <span class="token number">104_468</span><span class="token punctuation">,</span> <span class="token number">367_000_000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// We could have given Country a &amp;str instead of a String for the name. But we would have to write lifetimes everywhere</span>
    <span class="token comment">// and that would be too much for a small example. Better to just clone them when we call println!.</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> nauru<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> nauru<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> vanuatu<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> nauru <span class="token operator">+</span> vanuatu <span class="token operator">+</span> micronesia<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">In Nauru are 10670 people and a GDP of $160000000
In Nauru and Vanuatu are 318485 people and a GDP of $980000000
In Nauru and Vanuatu and Micronesia are 422953 people and a GDP of $1347000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä»¥ååœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<code>.fmt()</code>æ”¹æˆæ›´å®¹æ˜“é˜…è¯»çš„æ•°å­—æ˜¾ç¤ºã€‚</p>
<p>å¦å¤–ä¸‰ä¸ªå«<code>Sub</code>ã€<code>Mul</code>å’Œ<code>Div</code>ï¼Œå®ç°èµ·æ¥åŸºæœ¬ä¸€æ ·ã€‚<code>+=</code>ã€<code>-=</code>ã€<code>*=</code>å’Œ<code>/=</code>ï¼Œåªè¦åŠ ä¸Š<code>Assign</code>:<code>AddAssign</code>ã€<code>SubAssign</code>ã€<code>MulAssign</code>å’Œ<code>DivAssign</code>å³å¯ã€‚ä½ å¯ä»¥çœ‹åˆ°å®Œæ•´çš„åˆ—è¡¨<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/ops/index.html#structs">è¿™é‡Œ</a>ï¼Œå› ä¸ºè¿˜æœ‰å¾ˆå¤šã€‚ä¾‹å¦‚ <code>%</code> è¢«ç§°ä¸º <code>Rem</code>, <code>-</code> è¢«ç§°ä¸º <code>Neg</code>, ç­‰ç­‰ã€‚</p>
<h3 id="æµ®ç‚¹æ•°-1"><a href="#æµ®ç‚¹æ•°-1" class="headerlink" title="æµ®ç‚¹æ•°"></a>æµ®ç‚¹æ•°</h3><p><code>f32</code>å’Œ<code>f64</code>æœ‰éå¸¸å¤šçš„æ–¹æ³•ï¼Œä½ åœ¨åšæ•°å­¦è®¡ç®—çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚æˆ‘ä»¬ä¸çœ‹è¿™äº›ï¼Œä½†è¿™é‡Œæœ‰ä¸€äº›ä½ å¯èƒ½ä¼šç”¨åˆ°çš„æ–¹æ³•ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ <code>.floor()</code>, <code>.ceil()</code>, <code>.round()</code>, å’Œ <code>.trunc()</code>. æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ª <code>f32</code> æˆ– <code>f64</code>ï¼Œå®ƒåƒä¸€ä¸ªæ•´æ•°ï¼Œå°æ•°ç‚¹åé¢æ˜¯ <code>0</code>ã€‚å®ƒä»¬æ˜¯è¿™æ ·åšçš„ã€‚</p>
<ul>
<li><code>.floor()</code>: ç»™ä½ ä¸‹ä¸€ä¸ªæœ€ä½çš„æ•´æ•°.</li>
<li><code>.ceil()</code>: ç»™ä½ ä¸‹ä¸€ä¸ªæœ€é«˜çš„æ•´æ•°ã€‚</li>
<li><code>.round()</code>: å¦‚æœå°æ•°éƒ¨åˆ†å¤§äºç­‰äº0.5ï¼Œè¿”å›æ•°å€¼åŠ 1;å¦‚æœå°æ•°éƒ¨åˆ†å°äº0.5ï¼Œè¿”å›ç›¸åŒæ•°å€¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„å››èˆäº”å…¥ï¼Œå› ä¸ºå®ƒç»™ä½ ä¸€ä¸ª â€œèˆå…¥â€çš„æ•°å­—(ä¸€ä¸ªæ•°å­—çš„ç®€çŸ­å½¢å¼)ã€‚</li>
<li><code>.trunc()</code>:åªæ˜¯æŠŠå°æ•°ç‚¹å·åçš„éƒ¨åˆ†æˆªæ‰ã€‚Truncateæ˜¯ â€œæˆªæ–­â€çš„æ„æ€ã€‚</li>
</ul>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥æ‰“å°å®ƒä»¬ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">four_operations</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span>
<span class="token string">"For the number {}:
floor: {}
ceiling: {}
rounded: {}
truncated: {}\n"</span><span class="token punctuation">,</span>
        input<span class="token punctuation">,</span>
        input<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        input<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        input<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        input<span class="token punctuation">.</span><span class="token function">trunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">four_operations</span><span class="token punctuation">(</span><span class="token number">9.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">four_operations</span><span class="token punctuation">(</span><span class="token number">100.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">four_operations</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">four_operations</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">19.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">For the number 9.1:
floor: 9
ceiling: 10
rounded: 9 // because less than 9.5
truncated: 9

For the number 100.7:
floor: 100
ceiling: 101
rounded: 101 // because more than 100.5
truncated: 100

For the number -1.1:
floor: -2
ceiling: -1
rounded: -1
truncated: -1

For the number -19.9:
floor: -20
ceiling: -19
rounded: -20
truncated: -19<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>f32</code> å’Œ <code>f64</code> æœ‰ä¸€ä¸ªå«åš <code>.max()</code> å’Œ <code>.min()</code> çš„æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªæ•°å­—ä¸­è¾ƒå¤§æˆ–è¾ƒå°çš„æ•°å­—ã€‚(å¯¹äºå…¶ä»–ç±»å‹ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨<code>std::cmp::max</code>å’Œ<code>std::cmp::min</code>ã€‚)ä¸‹é¢æ˜¯ç”¨<code>.fold()</code>æ¥å¾—åˆ°æœ€é«˜æˆ–æœ€ä½æ•°çš„æ–¹æ³•ã€‚ä½ åˆå¯ä»¥çœ‹åˆ°ï¼Œ<code>.fold()</code>ä¸ä»…ä»…æ˜¯ç”¨æ¥åŠ æ•°å­—çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8.0_f64</span><span class="token punctuation">,</span> <span class="token number">7.6</span><span class="token punctuation">,</span> <span class="token number">9.4</span><span class="token punctuation">,</span> <span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token number">22.0</span><span class="token punctuation">,</span> <span class="token number">77.345</span><span class="token punctuation">,</span> <span class="token number">10.22</span><span class="token punctuation">,</span> <span class="token number">3.2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7.77</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> maximum <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fold</span><span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">::</span><span class="token constant">MIN</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>current_number<span class="token punctuation">,</span> next_number<span class="token closure-punctuation punctuation">|</span></span> current_number<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token operator">*</span>next_number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Note: start with the lowest possible number for an f64.</span>
    <span class="token keyword">let</span> minimum <span class="token operator">=</span> my_vec<span class="token punctuation">.</span><span class="token function">iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fold</span><span class="token punctuation">(</span><span class="token keyword">f64</span><span class="token punctuation">::</span><span class="token constant">MAX</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>current_number<span class="token punctuation">,</span> next_number<span class="token closure-punctuation punctuation">|</span></span> current_number<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token operator">*</span>next_number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// And here start with the highest possible number</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}, {}"</span><span class="token punctuation">,</span> maximum<span class="token punctuation">,</span> minimum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="bool"><a href="#bool" class="headerlink" title="bool"></a>bool</h3><p>åœ¨ Rust ä¸­ï¼Œå¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æŠŠ <code>bool</code> å˜æˆä¸€ä¸ªæ•´æ•°ï¼Œå› ä¸ºè¿™æ ·åšæ˜¯å®‰å…¨çš„ã€‚ä½†ä½ ä¸èƒ½åè¿‡æ¥åšã€‚å¦‚ä½ æ‰€è§ï¼Œ<code>true</code>å˜æˆäº†1ï¼Œ<code>false</code>å˜æˆäº†0ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> true_false <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} {}"</span><span class="token punctuation">,</span> true_false<span class="token number">.0</span> <span class="token keyword">as</span> <span class="token keyword">u8</span><span class="token punctuation">,</span> true_false<span class="token number">.1</span> <span class="token keyword">as</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º<code>1 0</code>ã€‚å¦‚æœä½ å‘Šè¯‰ç¼–è¯‘å™¨ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.into()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> true_false<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i128</span><span class="token punctuation">,</span> <span class="token keyword">u16</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{} {}"</span><span class="token punctuation">,</span> true_false<span class="token number">.0</span><span class="token punctuation">,</span> true_false<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°çš„æ˜¯ä¸€æ ·çš„ä¸œè¥¿ã€‚</p>
<h3 id="Vec"><a href="#Vec" class="headerlink" title="Vec"></a>Vec</h3><p>Vecæœ‰å¾ˆå¤šæ–¹æ³•æˆ‘ä»¬è¿˜æ²¡æœ‰çœ‹ã€‚å…ˆè¯´è¯´<code>.sort()</code>ã€‚<code>.sort()</code>ä¸€ç‚¹éƒ½ä¸å¥‡æ€ªã€‚å®ƒä½¿ç”¨<code>&amp;mut self</code>æ¥å¯¹ä¸€ä¸ªå‘é‡è¿›è¡Œæ’åºã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‰“å°å‡ºæ¥çš„æ˜¯<code>[0, 0, 0, 0, 0, 80, 90, 100]</code>ã€‚ä½†è¿˜æœ‰ä¸€ç§æ›´æœ‰è¶£çš„æ’åºæ–¹å¼å«<code>.sort_unstable()</code>ï¼Œå®ƒé€šå¸¸æ›´å¿«ã€‚å®ƒä¹‹æ‰€ä»¥æ›´å¿«ï¼Œæ˜¯å› ä¸ºå®ƒä¸åœ¨ä¹æ’åºå‰åç›¸åŒæ•°å­—çš„å…ˆåé¡ºåºã€‚åœ¨å¸¸è§„çš„<code>.sort()</code>ä¸­ï¼Œä½ çŸ¥é“æœ€åçš„<code>0, 0, 0, 0, 0</code>ä¼šåœ¨<code>.sort()</code>ä¹‹åçš„é¡ºåºç›¸åŒã€‚ä½†æ˜¯<code>.sort_unstable()</code>å¯èƒ½ä¼šæŠŠæœ€åä¸€ä¸ª0ç§»åˆ°ç´¢å¼•0ï¼Œç„¶åæŠŠç¬¬ä¸‰ä¸ªæœ€åçš„0ç§»åˆ°ç´¢å¼•2ï¼Œç­‰ç­‰ã€‚</p>
<p><code>.dedup()</code>çš„æ„æ€æ˜¯ â€œå»é‡å¤â€ã€‚å®ƒå°†åˆ é™¤ä¸€ä¸ªå‘é‡ä¸­ç›¸åŒçš„å…ƒç´ ï¼Œä½†åªæœ‰å½“å®ƒä»¬å½¼æ­¤ç›¸é‚»æ—¶æ‰ä¼šåˆ é™¤ã€‚æ¥ä¸‹æ¥è¿™æ®µä»£ç ä¸ä¼šåªæ‰“å°<code>"sun", "moon"</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"sun"</span><span class="token punctuation">,</span> <span class="token string">"sun"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">,</span> <span class="token string">"sun"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">dedup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>å®ƒåªæ˜¯æŠŠå¦ä¸€ä¸ª â€œsunâ€æ—è¾¹çš„ â€œsunâ€å»æ‰ï¼Œç„¶åæŠŠä¸€ä¸ª â€œmoonâ€æ—è¾¹çš„ â€œmoonâ€å»æ‰ï¼Œå†æŠŠå¦ä¸€ä¸ª â€œmoonâ€æ—è¾¹çš„ â€œmoonâ€å»æ‰ã€‚ç»“æœæ˜¯ <code>["sun", "moon", "sun", "moon"]</code>.</p>
<p>å¦‚æœä½ æƒ³æŠŠæ¯ä¸ªé‡å¤çš„ä¸œè¥¿éƒ½å»æ‰ï¼Œå°±å…ˆ<code>.sort()</code>:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"sun"</span><span class="token punctuation">,</span> <span class="token string">"sun"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">,</span> <span class="token string">"sun"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">,</span> <span class="token string">"moon"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_vec<span class="token punctuation">.</span><span class="token function">dedup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> my_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç»“æœ:<code>["moon", "sun"]</code>.</p>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>ä½ ä¼šè®°å¾—ï¼Œ<code>String</code>æœ‰ç‚¹åƒ<code>Vec</code>ã€‚å®ƒå¾ˆåƒ<code>Vec</code>ï¼Œä½ å¯ä»¥è°ƒç”¨å¾ˆå¤šç›¸åŒçš„æ–¹æ³•ã€‚æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥ç”¨<code>String::with_capacity()</code>åˆ›å»ºä¸€ä¸ªã€‚å¦‚æœä½ æ€»æ˜¯è¦ç”¨<code>.push()</code>æ¨ä¸€ä¸ª<code>char</code>ï¼Œæˆ–è€…ç”¨<code>.push_str()</code>æ¨ä¸€ä¸ª<code>&amp;str</code>ï¼Œä½ å°±è¦è¿™æ ·ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª<code>String</code>çš„ä¾‹å­ï¼Œå®ƒæœ‰å¤ªå¤šçš„å†…å­˜åˆ†é…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> push_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> capacity_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// capacity starts at 0</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100_000</span> <span class="token punctuation">{</span> <span class="token comment">// Do this 100,000 times</span>
        <span class="token keyword">if</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> capacity_counter <span class="token punctuation">{</span> <span class="token comment">// First check if capacity is different now</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// If it is, print it</span>
            capacity_counter <span class="token operator">=</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// then update the counter</span>
        <span class="token punctuation">}</span>
        push_string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"I'm getting pushed into the string!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// and push this in every time</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">35
70
140
280
560
1120
2240
4480
8960
17920
35840
71680
143360
286720
573440
1146880
2293760
4587520<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬ä¸å¾—ä¸é‡æ–°åˆ†é…(æŠŠæ‰€æœ‰ä¸œè¥¿å¤åˆ¶è¿‡æ¥)18æ¬¡ã€‚ä½†æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†æœ€ç»ˆçš„å®¹é‡ï¼Œæˆ‘ä»¬å¯ä»¥é©¬ä¸Šè®¾ç½®å®¹é‡ï¼Œä¸éœ€è¦é‡æ–°åˆ†é…:åªè®¾ç½®ä¸€æ¬¡<code>String</code>å®¹é‡å°±å¤Ÿäº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> push_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">4587520</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We know the exact number. Some different big number could work too</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> capacity_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100_000</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> capacity_counter <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            capacity_counter <span class="token operator">=</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        push_string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"I'm getting pushed into the string!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è€Œè¿™ä¸ªæ‰“å°<code>4587520</code>ã€‚å®Œç¾çš„! æˆ‘ä»¬å†ä¹Ÿä¸ç”¨åˆ†é…äº†ã€‚</p>
<p>å½“ç„¶ï¼Œå®é™…é•¿åº¦è‚¯å®šæ¯”è¿™ä¸ªå°ã€‚å¦‚æœä½ è¯•äº†100001æ¬¡ï¼Œ101000æ¬¡ç­‰ç­‰ï¼Œè¿˜æ˜¯ä¼šè¯´<code>4587520</code>ã€‚è¿™æ˜¯å› ä¸ºæ¯æ¬¡çš„å®¹é‡éƒ½æ˜¯ä¹‹å‰çš„2å€ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥ç”¨<code>.shrink_to_fit()</code>æ¥ç¼©å°å®ƒ(å’Œ<code>Vec</code>ä¸€æ ·)ã€‚æˆ‘ä»¬çš„<code>String</code>å·²ç»éå¸¸å¤§äº†ï¼Œæˆ‘ä»¬ä¸æƒ³å†ç»™å®ƒå¢åŠ ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç¼©å°ä¸€ç‚¹ã€‚ä½†æ˜¯åªæœ‰åœ¨ä½ æœ‰æŠŠæ¡çš„æƒ…å†µä¸‹æ‰å¯ä»¥è¿™æ ·åš:ä¸‹é¢æ˜¯åŸå› ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> push_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">with_capacity</span><span class="token punctuation">(</span><span class="token number">4587520</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> capacity_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">100_000</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> capacity_counter <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            capacity_counter <span class="token operator">=</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        push_string<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"I'm getting pushed into the string!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    push_string<span class="token punctuation">.</span><span class="token function">shrink_to_fit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    push_string<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    push_string<span class="token punctuation">.</span><span class="token function">shrink_to_fit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> push_string<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">4587520
3500000
7000000
3500001<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬çš„å¤§å°æ˜¯<code>4587520</code>ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰å…¨éƒ¨ä½¿ç”¨ã€‚æˆ‘ä»¬ç”¨äº†<code>.shrink_to_fit()</code>ï¼Œç„¶åæŠŠå¤§å°é™åˆ°äº†<code>3500000</code>ã€‚ä½†æ˜¯æˆ‘ä»¬å¿˜è®°äº†æˆ‘ä»¬éœ€è¦æ¨ä¸Šä¸€ä¸ª <code>a</code>ã€‚å½“æˆ‘ä»¬è¿™æ ·åšçš„æ—¶å€™ï¼ŒRust çœ‹åˆ°æˆ‘ä»¬éœ€è¦æ›´å¤šçš„ç©ºé—´ï¼Œç»™äº†æˆ‘ä»¬åŒå€çš„ç©ºé—´:ç°åœ¨æ˜¯ <code>7000000</code>ã€‚Whoops! æ‰€ä»¥æˆ‘ä»¬åˆè°ƒç”¨äº†<code>.shrink_to_fit()</code>ï¼Œç°åœ¨åˆå›åˆ°äº†<code>3500001</code>ã€‚</p>
<p><code>.pop()</code>å¯¹<code>String</code>æœ‰ç”¨ï¼Œå°±åƒå¯¹<code>Vec</code>ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">".daer ot drah tib elttil a si gnirts sihT"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> pop_result <span class="token operator">=</span> my_string<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">match</span> pop_result <span class="token punctuation">{</span>
            <span class="token class-name">Some</span><span class="token punctuation">(</span>character<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> character<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">None</span> <span class="token operator">=&gt;</span> <span class="token keyword">break</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ‰“å°çš„æ˜¯<code>This string is a little bit hard to read.</code>ï¼Œå› ä¸ºå®ƒæ˜¯ä»æœ€åä¸€ä¸ªå­—ç¬¦å¼€å§‹çš„ã€‚</p>
<p><code>.retain()</code>æ˜¯ä¸€ä¸ªä½¿ç”¨é—­åŒ…çš„æ–¹æ³•ï¼Œè¿™å¯¹<code>String</code>æ¥è¯´æ˜¯ç½•è§çš„ã€‚å°±åƒåœ¨è¿­ä»£å™¨ä¸Šçš„<code>.filter()</code>ä¸€æ ·ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Age: 20 Height: 194 Weight: 80"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    my_string<span class="token punctuation">.</span><span class="token function">retain</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>character<span class="token closure-punctuation punctuation">|</span></span> character<span class="token punctuation">.</span><span class="token function">is_alphabetic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> character <span class="token operator">==</span> <span class="token char string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Keep if a letter or a space</span>
    <span class="token macro property">dbg!</span><span class="token punctuation">(</span>my_string<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Let's use dbg!() for fun this time instead of println!</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src\main.rs:4] my_string = "Age  Height  Weight "<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<h3 id="OsStringå’ŒCString"><a href="#OsStringå’ŒCString" class="headerlink" title="OsStringå’ŒCString"></a>OsStringå’ŒCString</h3><p><code>std::ffi</code>æ˜¯<code>std</code>çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¸®åŠ©ä½ å°†Rustä¸å…¶ä»–è¯­è¨€æˆ–æ“ä½œç³»ç»Ÿä¸€èµ·ä½¿ç”¨ã€‚å®ƒæœ‰<code>OsString</code>å’Œ<code>CString</code>è¿™æ ·çš„ç±»å‹ï¼Œå®ƒä»¬å°±åƒæ“ä½œç³»ç»Ÿçš„<code>String</code>æˆ–è¯­è¨€Cçš„<code>String</code>ä¸€æ ·ï¼Œå®ƒä»¬å„è‡ªä¹Ÿæœ‰è‡ªå·±çš„<code>&amp;str</code>ç±»å‹:<code>OsStr</code>å’Œ<code>CStr</code>ã€‚<code>ffi</code>çš„æ„æ€æ˜¯ â€œforeign function interfaceâ€(å¤–éƒ¨å‡½æ•°æ¥å£)ã€‚</p>
<p>å½“ä½ å¿…é¡»ä¸ä¸€ä¸ªæ²¡æœ‰Unicodeçš„æ“ä½œç³»ç»Ÿä¸€èµ·å·¥ä½œæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>OsString</code>ã€‚æ‰€æœ‰çš„Rustå­—ç¬¦ä¸²éƒ½æ˜¯unicodeï¼Œä½†ä¸æ˜¯æ¯ä¸ªæ“ä½œç³»ç»Ÿæ”¯æŒã€‚ä¸‹é¢æ˜¯æ ‡å‡†åº“ä¸­å…³äºä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰<code>OsString</code>çš„ç®€å•è‹±æ–‡è§£é‡Šã€‚</p>
<ul>
<li>Unixç³»ç»Ÿ(Linuxç­‰)ä¸Šçš„å­—ç¬¦ä¸²å¯èƒ½æ˜¯å¾ˆå¤šæ²¡æœ‰0çš„å­—èŠ‚ç»„åˆåœ¨ä¸€èµ·ã€‚è€Œä¸”æœ‰æ—¶ä½ ä¼šæŠŠå®ƒä»¬è¯»æˆUnicode UTF-8ã€‚</li>
<li>Windowsä¸Šçš„å­—ç¬¦ä¸²å¯èƒ½æ˜¯ç”±éšæœºçš„16ä½å€¼ç»„æˆçš„ï¼Œæ²¡æœ‰0ã€‚æœ‰æ—¶ä½ ä¼šæŠŠå®ƒä»¬è¯»æˆUnicode UTF-16ã€‚</li>
<li>åœ¨Rustä¸­ï¼Œå­—ç¬¦ä¸²æ€»æ˜¯æœ‰æ•ˆçš„UTF-8ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«0ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œ<code>OsString</code>è¢«è®¾è®¡ä¸ºæ”¯æŒå®ƒä»¬è¯»å–ã€‚</p>
<p>ä½ å¯ä»¥ç”¨ä¸€ä¸ª<code>OsString</code>åšæ‰€æœ‰å¸¸è§„çš„äº‹æƒ…ï¼Œæ¯”å¦‚<code>OsString::from("Write something here")</code>ã€‚å®ƒè¿˜æœ‰ä¸€ä¸ªæœ‰è¶£çš„æ–¹æ³•ï¼Œå«åš <code>.into_string()</code>ï¼Œè¯•å›¾æŠŠå®ƒå˜æˆä¸€ä¸ªå¸¸è§„çš„ <code>String</code>ã€‚å®ƒè¿”å›ä¸€ä¸ª <code>Result</code>ï¼Œä½† <code>Err</code> éƒ¨åˆ†åªæ˜¯åŸæ¥çš„ <code>OsString</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">into_string</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">OsString</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å¦‚æœä¸è¡Œçš„è¯ï¼Œé‚£ä½ å°±æŠŠå®ƒæ‰¾å›æ¥ã€‚ä½ ä¸èƒ½è°ƒç”¨<code>.unwrap()</code>ï¼Œå› ä¸ºå®ƒä¼šå´©æºƒï¼Œä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨<code>match</code>æ¥æ‰¾å›<code>OsString</code>ã€‚æˆ‘ä»¬é€šè¿‡è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ffi<span class="token punctuation">::</span></span><span class="token class-name">OsString</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// âš ï¸</span>
    <span class="token keyword">let</span> os_string <span class="token operator">=</span> <span class="token class-name">OsString</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"This string works for your OS too."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> os_string<span class="token punctuation">.</span><span class="token function">into_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> valid<span class="token punctuation">.</span><span class="token function">thth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>           <span class="token comment">// Compiler: "What's .thth()??"</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>not_valid<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> not_valid<span class="token punctuation">.</span><span class="token function">occg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// Compiler: "What's .occg()??"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åç¼–è¯‘å™¨å‡†ç¡®åœ°å‘Šè¯‰æˆ‘ä»¬æˆ‘ä»¬æƒ³çŸ¥é“çš„ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0599]: no method named `thth` found for struct `std::string::String` in the current scope
 --&gt; src/main.rs:6:28
  |
6 |         Ok(valid) =&gt; valid.thth(),
  |                            ^^^^ method not found in `std::string::String`

error[E0599]: no method named `occg` found for struct `std::ffi::OsString` in the current scope
 --&gt; src/main.rs:7:37
  |
7 |         Err(not_valid) =&gt; not_valid.occg(),
  |                                     ^^^^ method not found in `std::ffi::OsString`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>valid</code>çš„ç±»å‹æ˜¯<code>String</code>ï¼Œ<code>not_valid</code>çš„ç±»å‹æ˜¯<code>OsString</code>ã€‚</p>
<h3 id="Mem"><a href="#Mem" class="headerlink" title="Mem"></a>Mem</h3><p><code>std::mem</code>æœ‰ä¸€äº›éå¸¸æœ‰è¶£çš„æ–¹æ³•ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸€äº›ï¼Œæ¯”å¦‚<code>.size_of()</code>ã€<code>.size_of_val()</code>å’Œ<code>.drop()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>mem<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">;</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">size_of_val</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>my_array<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> some_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"You can drop a String because it's on the heap"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">drop</span><span class="token punctuation">(</span>some_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// some_string.clear();   If we did this it would panic</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">4
200<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä¸‹é¢æ˜¯<code>mem</code>ä¸­çš„ä¸€äº›å…¶ä»–æ–¹æ³•ã€‚</p>
<p><code>swap()</code>: ç”¨è¿™ä¸ªæ–¹æ³•ä½ å¯ä»¥äº¤æ¢ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å€¼ã€‚ä½ å¯ä»¥é€šè¿‡ä¸ºæ¯ä¸ªå˜é‡åˆ›å»ºä¸€ä¸ªå¯å˜å¼•ç”¨æ¥åšã€‚å½“ä½ æœ‰ä¸¤ä¸ªä¸œè¥¿æƒ³äº¤æ¢ï¼Œè€ŒRustå› ä¸ºå€Ÿç”¨è§„åˆ™ä¸è®©ä½ äº¤æ¢æ—¶ï¼Œè¿™å¾ˆæœ‰å¸®åŠ©ã€‚æˆ–è€…åªæ˜¯å½“ä½ æƒ³å¿«é€Ÿåˆ‡æ¢ä¸¤ä¸ªä¸œè¥¿çš„æ—¶å€™ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token punctuation">{</span>mem<span class="token punctuation">,</span> fmt<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Ring</span> <span class="token punctuation">{</span> <span class="token comment">// Create a ring from Lord of the Rings</span>
    owner<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    former_owner<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    seeker<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token comment">// seeker means "person looking for it"</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Ring</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>owner<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> former_owner<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span> seeker<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            owner<span class="token punctuation">:</span> owner<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            former_owner<span class="token punctuation">:</span> former_owner<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            seeker<span class="token punctuation">:</span> seeker<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Ring</span> <span class="token punctuation">{</span> <span class="token comment">// Display to show who has it and who wants it</span>
        <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
            <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"{} has the ring, {} used to have it, and {} wants it"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>owner<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>former_owner<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>seeker<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> one_ring <span class="token operator">=</span> <span class="token class-name">Ring</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">"Frodo"</span><span class="token punctuation">,</span> <span class="token string">"Gollum"</span><span class="token punctuation">,</span> <span class="token string">"Sauron"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> one_ring<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> one_ring<span class="token punctuation">.</span>owner<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> one_ring<span class="token punctuation">.</span>former_owner<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Gollum got the ring back for a second</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> one_ring<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Frodo has the ring, Gollum used to have it, and Sauron wants it
Gollum has the ring, Frodo used to have it, and Sauron wants it<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>replace()</code>:è¿™ä¸ªå°±åƒswapä¸€æ ·ï¼Œå…¶å®é‡Œé¢ä¹Ÿç”¨äº†swapï¼Œä½ å¯ä»¥çœ‹åˆ°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">replace</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dest<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">mut</span> src<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token function">swap</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> src<span class="token punctuation">)</span><span class="token punctuation">;</span>
    src
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å®ƒåªæ˜¯åšäº†ä¸€ä¸ªäº¤æ¢ï¼Œç„¶åè¿”å›å¦ä¸€ä¸ªå…ƒç´ ã€‚æœ‰äº†è¿™ä¸ªï¼Œä½ å°±ç”¨ä½ æ”¾è¿›å»çš„å…¶ä»–ä¸œè¥¿æ¥æ›¿æ¢è¿™ä¸ªå€¼ã€‚å› ä¸ºå®ƒè¿”å›çš„æ˜¯æ—§çš„å€¼ï¼Œæ‰€ä»¥ä½ åº”è¯¥ç”¨<code>let</code>æ¥ä½¿ç”¨å®ƒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>mem<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">City</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">change_name</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> old_name <span class="token operator">=</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> name<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"The city once called {} is now called {}."</span><span class="token punctuation">,</span>
            old_name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>name
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> capital_city <span class="token operator">=</span> <span class="token class-name">City</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"Constantinople"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    capital_city<span class="token punctuation">.</span><span class="token function">change_name</span><span class="token punctuation">(</span><span class="token string">"Istanbul"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±ä¼šæ‰“å°å‡º<code>The city once called Constantinople is now called Istanbul.</code>ã€‚</p>
<p>æœ‰ä¸€ä¸ªå‡½æ•°å«<code>.take()</code>ï¼Œå’Œ<code>.replace()</code>ä¸€æ ·ï¼Œä½†å®ƒåœ¨å…ƒç´ ä¸­ç•™ä¸‹äº†é»˜è®¤å€¼ã€‚<br> ä½ ä¼šè®°å¾—ï¼Œé»˜è®¤å€¼é€šå¸¸æ˜¯0ã€â€â€ä¹‹ç±»çš„ä¸œè¥¿ã€‚è¿™é‡Œæ˜¯ç­¾åã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// ğŸš§</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">take</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>dest<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">T</span>
<span class="token keyword">where</span>
    <span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Default</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ä½ å¯ä»¥åšè¿™æ ·çš„äº‹æƒ…ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>mem<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> number_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> new_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    number_vec<span class="token punctuation">.</span><span class="token function">iter_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>number<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> taker <span class="token operator">=</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">take</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
        new_vec<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>taker<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}\n{:?}"</span><span class="token punctuation">,</span> number_vec<span class="token punctuation">,</span> new_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå°†æ‰€æœ‰æ•°å­—éƒ½æ›¿æ¢ä¸º0:æ²¡æœ‰åˆ é™¤ä»»ä½•ç´¢å¼•ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[0, 0, 0, 0, 0, 0]
[8, 7, 0, 2, 49, 9999]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>å½“ç„¶ï¼Œå¯¹äºä½ è‡ªå·±çš„ç±»å‹ï¼Œä½ å¯ä»¥æŠŠ<code>Default</code>å®ç°æˆä»»ä½•ä½ æƒ³è¦çš„ç±»å‹ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<code>Bank</code>å’Œä¸€ä¸ª<code>Robber</code>ã€‚æ¯æ¬¡ä»–æŠ¢äº†<code>Bank</code>ï¼Œä»–å°±ä¼šåœ¨æ¡Œå­ä¸Šæ‹¿åˆ°é’±ã€‚ä½†æ˜¯åŠå…¬æ¡Œå¯ä»¥éšæ—¶ä»åé¢æ‹¿é’±ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œæœ‰50ã€‚æˆ‘ä»¬å°†ä¸ºæ­¤è‡ªåˆ¶ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥å®ƒå°†æ°¸è¿œæœ‰50ã€‚ä¸‹é¢æ˜¯å®ƒçš„å·¥ä½œåŸç†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>mem<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>ops<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Deref</span><span class="token punctuation">,</span> <span class="token class-name">DerefMut</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// We will use this to get the power of u32</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Bank</span> <span class="token punctuation">{</span>
    money_inside<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    money_at_desk<span class="token punctuation">:</span> <span class="token class-name">DeskMoney</span><span class="token punctuation">,</span> <span class="token comment">// This is our "smart pointer" type. It has its own default, but it will use u32</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">DeskMoney</span><span class="token punctuation">(</span><span class="token keyword">u32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">impl</span> <span class="token class-name">Default</span> <span class="token keyword">for</span> <span class="token class-name">DeskMoney</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">Self</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token comment">// default is always 50, not 0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Deref</span> <span class="token keyword">for</span> <span class="token class-name">DeskMoney</span> <span class="token punctuation">{</span> <span class="token comment">// With this we can access the u32 using *</span>
    <span class="token keyword">type</span> <span class="token class-name">Target</span> <span class="token operator">=</span> <span class="token keyword">u32</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">deref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">DerefMut</span> <span class="token keyword">for</span> <span class="token class-name">DeskMoney</span> <span class="token punctuation">{</span> <span class="token comment">// And with this we can add, subtract, etc.</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">deref_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token class-name">Target</span> <span class="token punctuation">{</span>
        <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Bank</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">check_money</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"There is ${} in the back and ${} at the desk.\n"</span><span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>money_inside<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">self</span><span class="token punctuation">.</span>money_at_desk <span class="token comment">// Use * so we can just print the u32</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">Robber</span> <span class="token punctuation">{</span>
    money_in_pocket<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Robber</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">check_money</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The robber has ${} right now.\n"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>money_in_pocket<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">rob_bank</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> bank<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Bank</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> new_money <span class="token operator">=</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">take</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> bank<span class="token punctuation">.</span>money_at_desk<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Here it takes the money, and leaves 50 because that is the default</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>money_in_pocket <span class="token operator">+=</span> <span class="token operator">*</span>new_money<span class="token punctuation">;</span> <span class="token comment">// Use * because we can only add u32. DeskMoney can't add</span>
        bank<span class="token punctuation">.</span>money_inside <span class="token operator">-=</span> <span class="token operator">*</span>new_money<span class="token punctuation">;</span>    <span class="token comment">// Same here</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"She robbed the bank. She now has ${}!\n"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>money_in_pocket<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> bank_of_klezkavania <span class="token operator">=</span> <span class="token class-name">Bank</span> <span class="token punctuation">{</span> <span class="token comment">// Set up our bank</span>
        money_inside<span class="token punctuation">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
        money_at_desk<span class="token punctuation">:</span> <span class="token class-name">DeskMoney</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    bank_of_klezkavania<span class="token punctuation">.</span><span class="token function">check_money</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> robber <span class="token operator">=</span> <span class="token class-name">Robber</span> <span class="token punctuation">{</span> <span class="token comment">// Set up our robber</span>
        money_in_pocket<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    robber<span class="token punctuation">.</span><span class="token function">check_money</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    robber<span class="token punctuation">.</span><span class="token function">rob_bank</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> bank_of_klezkavania<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Rob, then check money</span>
    robber<span class="token punctuation">.</span><span class="token function">check_money</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bank_of_klezkavania<span class="token punctuation">.</span><span class="token function">check_money</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    robber<span class="token punctuation">.</span><span class="token function">rob_bank</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> bank_of_klezkavania<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Do it again</span>
    robber<span class="token punctuation">.</span><span class="token function">check_money</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bank_of_klezkavania<span class="token punctuation">.</span><span class="token function">check_money</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">There is $5000 in the back and $50 at the desk.

The robber has $50 right now.

She robbed the bank. She now has $100!

The robber has $100 right now.

There is $4950 in the back and $50 at the desk.

She robbed the bank. She now has $150!

The robber has $150 right now.

There is $4900 in the back and $50 at the desk.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°æ¡Œå­ä¸Šæ€»æ˜¯æœ‰50ç¾å…ƒã€‚</p>
<h3 id="Prelude"><a href="#Prelude" class="headerlink" title="Prelude"></a>Prelude</h3><p>æ ‡å‡†åº“ä¹Ÿæœ‰ä¸€ä¸ªpreludeï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ ä¸ç”¨å†™<code>use std::vec::Vec</code>è¿™æ ·çš„ä¸œè¥¿æ¥åˆ›å»ºä¸€ä¸ª<code>Vec</code>ã€‚ä½ å¯ä»¥<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/prelude/index.html#prelude-contents">åœ¨è¿™é‡Œ</a>çœ‹åˆ°æ‰€æœ‰è¿™äº›å…ƒç´ ï¼Œå¹¶ä¸”å¤§è‡´äº†è§£:</p>
<ul>
<li><code>std::marker::{Copy, Send, Sized, Sync, Unpin}</code>. ä½ ä»¥å‰æ²¡æœ‰è§è¿‡<code>Unpin</code>ï¼Œå› ä¸ºå‡ ä¹æ¯ä¸€ç§ç±»å‹éƒ½ä¼šç”¨åˆ°å®ƒ(æ¯”å¦‚<code>Sized</code>ï¼Œä¹Ÿå¾ˆå¸¸è§)ã€‚â€Pinâ€çš„æ„æ€æ˜¯ä¸è®©ä¸œè¥¿åŠ¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>Pin</code>æ„å‘³ç€å®ƒåœ¨å†…å­˜ä¸­ä¸èƒ½ç§»åŠ¨ï¼Œä½†å¤§å¤šæ•°å…ƒç´ éƒ½æœ‰<code>Unpin</code>ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç§»åŠ¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåƒ<code>std::mem::replace</code>è¿™æ ·çš„å‡½æ•°èƒ½ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰è¢«é’‰ä½ã€‚</li>
<li><code>std::ops::{Drop, Fn, FnMut, FnOnce}</code>.</li>
<li><code>std::mem::drop</code></li>
<li><code>std::boxed::Box</code>.</li>
<li><code>std::borrow::ToOwned</code>. ä½ ä¹‹å‰ç”¨<code>Cow</code>çœ‹åˆ°è¿‡ä¸€ç‚¹ï¼Œå®ƒå¯ä»¥æŠŠå€Ÿæ¥çš„å†…å®¹å˜æˆè‡ªå·±çš„ã€‚å®ƒä½¿ç”¨<code>.to_owned()</code>æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨<code>&amp;str</code>ä¸Šä½¿ç”¨<code>.to_owned()</code>ï¼Œå¾—åˆ°ä¸€ä¸ª<code>String</code>ï¼Œå¯¹äºå…¶ä»–å€Ÿæ¥çš„å€¼ä¹Ÿæ˜¯ä¸€æ ·ã€‚</li>
<li><code>std::clone::Clone</code></li>
<li><code>std::cmp::{PartialEq, PartialOrd, Eq, Ord}</code>.</li>
<li><code>std::convert::{AsRef, AsMut, Into, From}</code>.</li>
<li><code>std::default::Default</code>.</li>
<li><code>std::iter::{Iterator, Extend, IntoIterator, DoubleEndedIterator, ExactSizeIterator}</code>. æˆ‘ä»¬ä¹‹å‰ç”¨<code>.rev()</code>æ¥åšè¿­ä»£å™¨:è¿™å®é™…ä¸Šæ˜¯åšäº†ä¸€ä¸ª<code>DoubleEndedIterator</code>ã€‚<code>ExactSizeIterator</code>åªæ˜¯ç±»ä¼¼äº<code>0..10</code>çš„ä¸œè¥¿:å®ƒå·²ç»çŸ¥é“è‡ªå·±çš„<code>.len()</code>æ˜¯10ã€‚å…¶ä»–è¿­ä»£å™¨ä¸çŸ¥é“å®ƒä»¬çš„é•¿åº¦æ˜¯è‚¯å®šçš„ã€‚</li>
<li><code>std::option::Option::{self, Some, None}</code>.</li>
<li><code>std::result::Result::{self, Ok, Err}</code>.</li>
<li><code>std::string::{String, ToString}</code>.</li>
<li><code>std::vec::Vec</code>.</li>
</ul>
<p>å¦‚æœä½ å› ä¸ºæŸäº›åŸå› ä¸æƒ³è¦è¿™ä¸ªpreludeæ€ä¹ˆåŠï¼Ÿå°±åŠ å±æ€§<code>#![no_implicit_prelude]</code>ã€‚æˆ‘ä»¬æ¥è¯•ä¸€è¯•ï¼Œçœ‹ç¼–è¯‘å™¨çš„æŠ±æ€¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token attribute attr-name">#![no_implicit_prelude]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"This won't work"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {}"</span><span class="token punctuation">,</span> my_vec<span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨Rustæ ¹æœ¬ä¸çŸ¥é“ä½ æƒ³åšä»€ä¹ˆã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error: cannot find macro `println` in this scope
 --&gt; src/main.rs:5:5
  |
5 |     println!("{:?}, {}", my_vec, my_string);
  |     ^^^^^^^

error: cannot find macro `vec` in this scope
 --&gt; src/main.rs:3:18
  |
3 |     let my_vec = vec![8, 9, 10];
  |                  ^^^

error[E0433]: failed to resolve: use of undeclared type or module `String`
 --&gt; src/main.rs:4:21
  |
4 |     let my_string = String::from("This won't work");
  |                     ^^^^^^ use of undeclared type or module `String`

error: aborting due to 3 previous errors<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› æ­¤ï¼Œå¯¹äºè¿™ä¸ªç®€å•çš„ä»£ç ï¼Œä½ éœ€è¦å‘Šè¯‰Rustä½¿ç”¨<code>extern</code>(å¤–éƒ¨)crateï¼Œå«åš<code>std</code>ï¼Œç„¶åæ˜¯ä½ æƒ³è¦çš„å…ƒç´ ã€‚è¿™é‡Œæ˜¯æˆ‘ä»¬è¦åšçš„ä¸€åˆ‡ï¼Œåªæ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªVecå’Œä¸€ä¸ªStringï¼Œå¹¶æ‰“å°å®ƒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#![no_implicit_prelude]</span>

<span class="token keyword">extern</span> <span class="token keyword">crate</span> <span class="token module-declaration namespace">std</span><span class="token punctuation">;</span> <span class="token comment">// Now you have to tell Rust that you want to use a crate called std</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>vec<span class="token punctuation">;</span> <span class="token comment">// We need the vec macro</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>string<span class="token punctuation">::</span></span><span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// and string</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>convert<span class="token punctuation">::</span></span><span class="token class-name">From</span><span class="token punctuation">;</span> <span class="token comment">// and this to convert from a &amp;str to the String</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>println<span class="token punctuation">;</span> <span class="token comment">// and this to print</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"This won't work"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}, {}"</span><span class="token punctuation">,</span> my_vec<span class="token punctuation">,</span> my_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨ç»ˆäºæˆåŠŸäº†ï¼Œæ‰“å°å‡º<code>[8, 9, 10], This won't work</code>ã€‚æ‰€ä»¥ä½ å¯ä»¥æ˜ç™½ä¸ºä»€ä¹ˆRustè¦ç”¨preludeäº†ã€‚ä½†å¦‚æœä½ æ„¿æ„ï¼Œä½ ä¸éœ€è¦ä½¿ç”¨å®ƒã€‚è€Œä¸”ä½ ç”šè‡³å¯ä»¥ä½¿ç”¨<code>#![no_std]</code>(æˆ‘ä»¬æ›¾ç»çœ‹åˆ°è¿‡)ï¼Œç”¨äºä½ è¿å †æ ˆå†…å­˜è¿™ç§ä¸œè¥¿éƒ½ç”¨ä¸ä¸Šçš„æ—¶å€™ã€‚ä½†å¤§å¤šæ•°æ—¶å€™ï¼Œä½ æ ¹æœ¬ä¸ç”¨è€ƒè™‘ä¸ç”¨preludeæˆ–<code>std</code>ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¹‹å‰æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°<code>extern</code>è¿™ä¸ªå…³é”®å­—å‘¢ï¼Ÿæ˜¯å› ä¸ºä½ å·²ç»ä¸éœ€è¦å®ƒäº†ã€‚ä»¥å‰ï¼Œå½“å¸¦å…¥å¤–éƒ¨crateæ—¶ï¼Œä½ å¿…é¡»ä½¿ç”¨å®ƒã€‚æ‰€ä»¥ä»¥å‰è¦ä½¿ç”¨<code>rand</code>ï¼Œä½ å¿…é¡»è¦å†™æˆ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">extern</span> <span class="token keyword">crate</span> <span class="token module-declaration namespace">rand</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶åç”¨ <code>use</code> è¯­å¥æ¥è¡¨ç¤ºä½ æƒ³ä½¿ç”¨çš„ä¿®æ”¹ã€traitç­‰ã€‚ä½†ç°åœ¨Rustç¼–è¯‘å™¨å·²ç»ä¸éœ€è¦è¿™äº›å¸®åŠ©äº†â€“ä½ åªéœ€è¦ä½¿ç”¨<code>use</code>ï¼Œrustå°±çŸ¥é“åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°å®ƒã€‚æ‰€ä»¥ä½ å‡ ä¹å†ä¹Ÿä¸éœ€è¦<code>extern crate</code>äº†ï¼Œä½†åœ¨å…¶ä»–äººçš„Rustä»£ç ä¸­ï¼Œä½ å¯èƒ½ä»ç„¶ä¼šåœ¨é¡¶éƒ¨çœ‹åˆ°å®ƒã€‚</p>
<h3 id="Time"><a href="#Time" class="headerlink" title="Time"></a>Time</h3><p><code>std::time</code>æ˜¯ä½ å¯ä»¥æ‰¾åˆ°æ—¶é—´å‡½æ•°çš„åœ°æ–¹ã€‚(å¦‚æœä½ æƒ³è¦æ›´å¤šçš„åŠŸèƒ½ï¼Œ<code>chrono</code>è¿™æ ·çš„crateä¹Ÿå¯ä»¥ã€‚)æœ€ç®€å•çš„åŠŸèƒ½å°±æ˜¯ç”¨<code>Instant::now()</code>è·å–ç³»ç»Ÿæ—¶é—´å³å¯ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>time<span class="token punctuation">::</span></span><span class="token class-name">Instant</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ æ‰“å°å‡ºæ¥ï¼Œä½ ä¼šå¾—åˆ°è¿™æ ·çš„ä¸œè¥¿ã€‚<code>Instant { tv_sec: 2738771, tv_nsec: 685628140 }</code>. è¿™è¯´çš„æ˜¯ç§’å’Œçº³ç§’ï¼Œä½†ç”¨å¤„ä¸å¤§ã€‚æ¯”å¦‚ä½ çœ‹2738771ç§’(å†™äº8æœˆ)ï¼Œå°±æ˜¯31.70å¤©ã€‚è¿™å’Œæœˆä»½ã€æ—¥å­æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚ä½†æ˜¯<code>Instant</code>çš„é¡µé¢å‘Šè¯‰æˆ‘ä»¬ï¼Œå®ƒæœ¬èº«ä¸åº”è¯¥æœ‰ç”¨ã€‚å®ƒè¯´å®ƒæ˜¯ â€œä¸é€æ˜çš„ï¼Œåªæœ‰å’ŒDurationä¸€èµ·æ‰æœ‰ç”¨â€ã€‚Opaqueçš„æ„æ€æ˜¯ â€œä½ æä¸æ¸…æ¥šâ€ï¼Œè€ŒDurationçš„æ„æ€æ˜¯ â€œè¿‡äº†å¤šå°‘æ—¶é—´â€ã€‚æ‰€ä»¥å®ƒåªæœ‰åœ¨åšæ¯”è¾ƒæ—¶é—´è¿™æ ·çš„äº‹æƒ…æ—¶æ‰æœ‰ç”¨ã€‚</p>
<p>å¦‚æœä½ çœ‹å·¦è¾¹çš„traitï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯<code>Sub&lt;Instant&gt;</code>ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç”¨<code>-</code>æ¥å‡å»ä¸€ä¸ªã€‚è€Œå½“æˆ‘ä»¬ç‚¹å‡»[src]çœ‹å®ƒçš„ä½œç”¨æ—¶ï¼Œå®ƒè¯´ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">impl</span> <span class="token class-name">Sub</span><span class="token operator">&lt;</span><span class="token class-name">Instant</span><span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token class-name">Instant</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Output</span> <span class="token operator">=</span> <span class="token class-name">Duration</span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">sub</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token class-name">Instant</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Duration</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">duration_since</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å› æ­¤ï¼Œå®ƒéœ€è¦ä¸€ä¸ª<code>Instant</code>ï¼Œå¹¶ä½¿ç”¨<code>.duration_since()</code>ç»™å‡ºä¸€ä¸ª<code>Duration</code>ã€‚è®©æˆ‘ä»¬è¯•ç€æ‰“å°ä¸€ä¸‹ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªç›¸é‚»çš„ <code>Instant::now()</code>ï¼Œç„¶åè®©ç¨‹åºå¿™æ´»ä¸€ä¼šå„¿ï¼Œå†åˆ›å»ºä¸€ä¸ª <code>Instant::now()</code>ã€‚ç„¶åæˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ª<code>Instant::now()</code>. æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç”¨äº†å¤šé•¿æ—¶é—´ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>time<span class="token punctuation">::</span></span><span class="token class-name">Instant</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time1 <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> time2 <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// These two are right next to each other</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> new_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">loop</span> <span class="token punctuation">{</span>
        new_string<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char string">'áƒ¬'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make Rust push this Georgian letter onto the String</span>
        <span class="token keyword">if</span> new_string<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100_000</span> <span class="token punctuation">{</span> <span class="token comment">//  until it is 100,000 bytes long</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> time3 <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> time2 <span class="token operator">-</span> time1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> time3 <span class="token operator">-</span> time1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡ºè¿™æ ·çš„ä¸œè¥¿ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">1.025Âµs
683.378Âµs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ï¼Œè¿™åªæ˜¯1å¾®ç§’å¤šä¸683æ¯«ç§’ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒRustç¡®å®èŠ±äº†ä¸€äº›æ—¶é—´æ¥åšã€‚</p>
<p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª<code>Instant</code>åšä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ã€‚<br> æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå˜æˆ<code>String</code>ä¸<code>format!("{:?}", Instant::now());</code>ã€‚å®ƒçš„æ ·å­æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>time<span class="token punctuation">::</span></span><span class="token class-name">Instant</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time1 <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token class-name">Instant</span><span class="token punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> time1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±ä¼šæ‰“å°å‡ºç±»ä¼¼<code>Instant { tv_sec: 2740773, tv_nsec: 632821036 }</code>çš„ä¸œè¥¿ã€‚è¿™æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>.iter()</code> å’Œ <code>.rev()</code> ä»¥åŠ <code>.skip(2)</code>ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡æœ€åçš„ <code>}</code> å’Œ <code> </code>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªéšæœºæ•°å‘ç”Ÿå™¨ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>time<span class="token punctuation">::</span></span><span class="token class-name">Instant</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">bad_random_number</span><span class="token punctuation">(</span>digits<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> digits <span class="token operator">&gt;</span> <span class="token number">9</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"Random number can only be up to 9 digits"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> now <span class="token operator">=</span> <span class="token class-name">Instant</span><span class="token punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span><span class="token punctuation">;</span>

    output
        <span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">rev</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span>digits<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>character<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> character<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">bad_random_number</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bad_random_number</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bad_random_number</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bad_random_number</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±ä¼šæ‰“å°å‡ºç±»ä¼¼è¿™æ ·çš„å†…å®¹:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">6
4
967
180<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå‡½æ•°è¢«ç§°ä¸º<code>bad_random_number</code>ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„éšæœºæ•°ç”Ÿæˆå™¨ã€‚Rustæœ‰æ›´å¥½çš„crateï¼Œå¯ä»¥ç”¨æ¯”<code>rand</code>æ›´å°‘çš„ä»£ç åšå‡ºéšæœºæ•°ï¼Œæ¯”å¦‚<code>fastrand</code>ã€‚ä½†è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œä½ å¯ä»¥åˆ©ç”¨ä½ çš„æƒ³è±¡åŠ›ç”¨<code>Instant</code>æ¥åšä¸€äº›äº‹æƒ…ã€‚</p>
<p>å½“ä½ æœ‰ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>std::thread::sleep</code>ä½¿å®ƒåœæ­¢ä¸€æ®µæ—¶é—´ã€‚å½“ä½ è¿™æ ·åšæ—¶ï¼Œä½ å¿…é¡»ç»™å®ƒä¸€ä¸ªdurationã€‚ä½ ä¸å¿…åˆ›å»ºå¤šä¸ªçº¿ç¨‹æ¥åšè¿™ä»¶äº‹ï¼Œå› ä¸ºæ¯ä¸ªç¨‹åºè‡³å°‘åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚<code>sleep</code>è™½ç„¶éœ€è¦ä¸€ä¸ª<code>Duration</code>ï¼Œæ‰€ä»¥å®ƒå¯ä»¥çŸ¥é“è¦ç¡å¤šä¹…ã€‚ä½ å¯ä»¥è¿™æ ·é€‰å•ä½:<code>Duration::from_millis()</code>, <code>Duration::from_secs</code>, ç­‰ç­‰ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>time<span class="token punctuation">::</span></span><span class="token class-name">Duration</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>thread<span class="token punctuation">::</span></span>sleep<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> three_seconds <span class="token operator">=</span> <span class="token class-name">Duration</span><span class="token punctuation">::</span><span class="token function">from_secs</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I must sleep now."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sleep</span><span class="token punctuation">(</span>three_seconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Did I miss anything?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†åªæ‰“å°</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">I must sleep now.
Did I miss anything?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†çº¿ç¨‹åœ¨ä¸‰ç§’é’Ÿå†…ä»€ä¹ˆä¹Ÿä¸åšã€‚å½“ä½ æœ‰å¾ˆå¤šçº¿ç¨‹éœ€è¦ç»å¸¸å°è¯•ä¸€äº›äº‹æƒ…æ—¶ï¼Œæ¯”å¦‚è¿æ¥ï¼Œä½ é€šå¸¸ä¼šä½¿ç”¨<code>.sleep()</code>ã€‚ä½ ä¸å¸Œæœ›çº¿ç¨‹åœ¨ä¸€ç§’é’Ÿå†…ä½¿ç”¨ä½ çš„å¤„ç†å™¨å°è¯•10ä¸‡æ¬¡ï¼Œè€Œä½ åªæ˜¯æƒ³è®©å®ƒæœ‰æ—¶æ£€æŸ¥ä¸€ä¸‹ã€‚æ‰€ä»¥ï¼Œä½ å°±å¯ä»¥è®¾ç½®ä¸€ä¸ª<code>Duration</code>ï¼Œå®ƒå°±ä¼šåœ¨æ¯æ¬¡é†’æ¥çš„æ—¶å€™å°è¯•åšå®ƒçš„ä»»åŠ¡ã€‚</p>
<h3 id="å…¶ä»–å®"><a href="#å…¶ä»–å®" class="headerlink" title="å…¶ä»–å®"></a>å…¶ä»–å®</h3><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹å…¶ä»–ä¸€äº›å®ã€‚</p>
<p><code>unreachable!()</code></p>
<p>è¿™ä¸ªå®æœ‰ç‚¹åƒ<code>todo!()</code>ï¼Œé™¤äº†å®ƒæ˜¯é’ˆå¯¹ä½ æ°¸è¿œä¸ä¼šç”¨çš„ä»£ç ã€‚ä¹Ÿè®¸ä½ åœ¨ä¸€ä¸ªæšä¸¾ä¸­æœ‰ä¸€ä¸ª<code>match</code>ï¼Œä½ çŸ¥é“å®ƒæ°¸è¿œä¸ä¼šé€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥ä»£ç æ°¸è¿œæ— æ³•è¾¾åˆ°é‚£ä¸ªåˆ†æ”¯ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œä½ å¯ä»¥å†™<code>unreachable!()</code>ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±çŸ¥é“å¯ä»¥å¿½ç•¥è¿™éƒ¨åˆ†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªç¨‹åºï¼Œå½“ä½ é€‰æ‹©ä¸€ä¸ªåœ°æ–¹å±…ä½æ—¶ï¼Œå®ƒä¼šå†™ä¸€äº›ä¸œè¥¿ã€‚åœ¨ä¹Œå…‹å…°ï¼Œé™¤äº†åˆ‡å°”è¯ºè´åˆ©ï¼Œå…¶ä»–åœ°æ–¹éƒ½ä¸é”™ã€‚ä½ çš„ç¨‹åºä¸è®©ä»»ä½•äººé€‰æ‹©åˆ‡å°”è¯ºè´åˆ©ï¼Œå› ä¸ºå®ƒç°åœ¨ä¸æ˜¯ä¸€ä¸ªå¥½åœ°æ–¹ã€‚ä½†æ˜¯è¿™ä¸ªæšä¸¾æ˜¯å¾ˆæ—©ä»¥å‰åœ¨åˆ«äººçš„ä»£ç é‡Œåšçš„ï¼Œä½ æ— æ³•æ›´æ”¹ã€‚æ‰€ä»¥åœ¨<code>match</code>çš„åˆ†æ”¯ä¸­ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªå®ã€‚å®ƒæ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">enum</span> <span class="token type-definition class-name">UkrainePlaces</span> <span class="token punctuation">{</span>
    <span class="token class-name">Kiev</span><span class="token punctuation">,</span>
    <span class="token class-name">Kharkiv</span><span class="token punctuation">,</span>
    <span class="token class-name">Chernobyl</span><span class="token punctuation">,</span> <span class="token comment">// Pretend we can't change the enum - Chernobyl will always be here</span>
    <span class="token class-name">Odesa</span><span class="token punctuation">,</span>
    <span class="token class-name">Dnipro</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">choose_city</span><span class="token punctuation">(</span>place<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">UkrainePlaces</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token class-name">UkrainePlaces</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> place <span class="token punctuation">{</span>
        <span class="token class-name">Kiev</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You will live in Kiev"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Kharkiv</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You will live in Kharkiv"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Chernobyl</span> <span class="token operator">=&gt;</span> <span class="token macro property">unreachable!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Odesa</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You will live in Odesa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Dnipro</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You will live in Dnipro"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user_input <span class="token operator">=</span> <span class="token class-name">UkrainePlaces</span><span class="token punctuation">::</span><span class="token class-name">Kiev</span><span class="token punctuation">;</span> <span class="token comment">// Pretend the user input is made from some other function. The user can't choose Chernobyl, no matter what</span>
    <span class="token function">choose_city</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user_input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°å‡º <code>You will live in Kiev</code>ã€‚</p>
<p><code>unreachable!()</code>å¯¹ä½ æ¥è¯´ä¹Ÿå¾ˆå¥½è¯»ï¼Œå› ä¸ºå®ƒæé†’ä½ ä»£ç çš„æŸäº›éƒ¨åˆ†æ˜¯ä¸å¯è®¿é—®çš„ã€‚ä¸è¿‡ä½ å¿…é¡»ç¡®å®šä»£ç ç¡®å®æ˜¯ä¸å¯è®¿é—®çš„ã€‚å¦‚æœç¼–è¯‘å™¨è°ƒç”¨<code>unreachable!()</code>ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœä½ æ›¾ç»æœ‰ä¸å¯è¾¾çš„ä»£ç ï¼Œè€Œç¼–è¯‘å™¨çŸ¥é“ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> true_or_false <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> true_or_false <span class="token punctuation">{</span>
        <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's true"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token boolean">false</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's false"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token boolean">true</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"It's true"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Whoops, we wrote true again</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒä¼šè¯´</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">warning: unreachable pattern
 --&gt; src/main.rs:7:9
  |
7 |         true =&gt; println!("It's true"),
  |         ^^^^
  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯<code>unreachable!()</code>æ˜¯ç”¨äºç¼–è¯‘å™¨æ— æ³•çŸ¥é“çš„æ—¶å€™ï¼Œå°±åƒæˆ‘ä»¬å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<p><code>column!</code>, <code>line!</code>, <code>file!</code>, <code>module_path!</code></p>
<p>è¿™å››ä¸ªå®æœ‰ç‚¹åƒ<code>dbg!()</code>ï¼Œå› ä¸ºä½ åªæ˜¯æŠŠå®ƒä»¬æ”¾è¿›ä»£ç å»ç»™ä½ è°ƒè¯•ä¿¡æ¯ã€‚ä½†æ˜¯å®ƒä»¬ä¸éœ€è¦ä»»ä½•å˜é‡â€“ä½ åªéœ€è¦ç”¨å®ƒä»¬å’Œæ‹¬å·ä¸€èµ·ä½¿ç”¨ï¼Œè€Œæ²¡æœ‰å…¶ä»–çš„ä¸œè¥¿ã€‚å®ƒä»¬æ”¾åˆ°ä¸€èµ·å¾ˆå®¹æ˜“å­¦:</p>
<ul>
<li><code>column!()</code>ç»™ä½ å†™çš„é‚£ä¸€åˆ—</li>
<li><code>line!()</code>ç»™ä½ å†™çš„é‚£è¡Œå­—ï¼Œç„¶åæ˜¯</li>
<li><code>module_path!()</code>ç»™ä½ æ¨¡å—çš„ä½ç½®ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥çš„ä»£ç åœ¨ä¸€ä¸ªç®€å•çš„ä¾‹å­ä¸­å±•ç¤ºäº†è¿™ä¸‰è€…ã€‚æˆ‘ä»¬å°†å‡è£…æœ‰æ›´å¤šçš„ä»£ç (modé‡Œé¢çš„mod)ï¼Œå› ä¸ºè¿™å°±æ˜¯æˆ‘ä»¬è¦ä½¿ç”¨è¿™äº›å®çš„åŸå› ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªå¤§çš„Rustç¨‹åº,å®ƒæœ‰è®¸å¤šmodå’Œæ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">something</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">third_mod</span> <span class="token punctuation">{</span>
        <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">print_a_country</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span>
                <span class="token string">"The last country is {} inside the module {}"</span><span class="token punctuation">,</span>
                input<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token macro property">module_path!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token namespace">something<span class="token punctuation">::</span>third_mod<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> country_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token string">"Portugal"</span><span class="token punctuation">,</span> <span class="token string">"Czechia"</span><span class="token punctuation">,</span> <span class="token string">"Finland"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// do some stuff</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"On line {} we got the country {}"</span><span class="token punctuation">,</span>
        <span class="token macro property">line!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        country_vec<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// do some more stuff</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"The next country is {} on line {} and column {}."</span><span class="token punctuation">,</span>
        country_vec<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token macro property">line!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token macro property">column!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// lots more code</span>

    <span class="token function">print_a_country</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> country_vec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ‰“å°çš„æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">On line 20 we got the country Finland
The next country is Czechia on line 29 and column 9.
The last country is Portugal inside the module rust_book::something::third_mod<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<p><code>cfg!</code></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>#[cfg(test)]</code> å’Œ <code>#[cfg(windows)]</code> è¿™æ ·çš„å±æ€§æ¥å‘Šè¯‰ç¼–è¯‘å™¨åœ¨æŸäº›æƒ…å†µä¸‹è¯¥æ€ä¹ˆåšã€‚å½“ä½ æœ‰<code>test</code>æ—¶ï¼Œå½“ä½ åœ¨æµ‹è¯•æ¨¡å¼ä¸‹è¿è¡ŒRustæ—¶ï¼Œå®ƒä¼šè¿è¡Œä»£ç (å¦‚æœæ˜¯åœ¨ç”µè„‘ä¸Šï¼Œä½ è¾“å…¥<code>cargo test</code>)ã€‚è€Œå½“ä½ ä½¿ç”¨<code>windows</code>æ—¶ï¼Œå¦‚æœç”¨æˆ·ä½¿ç”¨çš„æ˜¯Windowsï¼Œå®ƒå°±ä¼šè¿è¡Œä»£ç ã€‚ä½†ä¹Ÿè®¸ä½ åªæ˜¯æƒ³æ ¹æ®ä¸åŒæ“ä½œç³»ç»Ÿå¯¹ä¾èµ–ç³»ç»Ÿçš„ä»£ç åšå¾ˆå°çš„ä¿®æ”¹ã€‚è¿™æ—¶å€™è¿™ä¸ªå®å°±å¾ˆæœ‰ç”¨äº†ã€‚å®ƒè¿”å›ä¸€ä¸ª<code>bool</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> helpful_message <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token macro property">cfg!</span><span class="token punctuation">(</span>windows<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token string">"backslash"</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token string">"slash"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span>
        <span class="token string">"...then in your hard drive, type the directory name followed by a {}. Then you..."</span><span class="token punctuation">,</span>
        helpful_message
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†ä»¥ä¸åŒçš„æ–¹å¼æ‰“å°ï¼Œå–å†³äºä½ çš„ç³»ç»Ÿã€‚Rust Playgroundåœ¨Linuxä¸Šè¿è¡Œï¼Œæ‰€ä»¥ä¼šæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">...then in your hard drive, type the directory name followed by a slash. Then you...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>cfg!()</code>é€‚ç”¨äºä»»ä½•ä¸€ç§é…ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå½“ä½ åœ¨æµ‹è¯•ä¸­ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒçš„è¿è¡Œæ–¹å¼ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token attribute attr-name">#[cfg(test)]</span> <span class="token comment">// cfg! will know to look for the word test</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">testing</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>
    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">check_if_five</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token function">bring_number</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This bring_number() function should return 5</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">bring_number</span><span class="token punctuation">(</span>should_run<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u32</span> <span class="token punctuation">{</span> <span class="token comment">// This function takes a bool as to whether it should run</span>
    <span class="token keyword">if</span> <span class="token macro property">cfg!</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> should_run <span class="token punctuation">{</span> <span class="token comment">// if it should run and has the configuration test, return 5</span>
        <span class="token number">5</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> should_run <span class="token punctuation">{</span> <span class="token comment">// if it's not a test but it should run, print something. When you run a test it ignores println! statements</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Returning 5. This is not a test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token number">5</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"This shouldn't run, returning 0."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// otherwise return 0</span>
        <span class="token number">0</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">bring_number</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bring_number</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨æ ¹æ®é…ç½®çš„ä¸åŒï¼Œå®ƒçš„è¿è¡Œæ–¹å¼ä¹Ÿä¼šä¸åŒã€‚å¦‚æœä½ åªæ˜¯è¿è¡Œç¨‹åºï¼Œå®ƒä¼šç»™ä½ è¿™æ ·çš„ç»“æœ:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Returning 5. This is not a test
This shouldn't run, returning 0.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†å¦‚æœä½ åœ¨æµ‹è¯•æ¨¡å¼ä¸‹è¿è¡Œå®ƒ(<code>cargo test</code>ï¼Œç”¨äºç”µè„‘ä¸Šçš„Rust)ï¼Œå®ƒå®é™…ä¸Šä¼šè¿è¡Œæµ‹è¯•ã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµ‹è¯•æ€»æ˜¯è¿”å›5ï¼Œæ‰€ä»¥å®ƒä¼šé€šè¿‡ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">running 1 test
test testing::check_if_five ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="ç¼–å†™å®"><a href="#ç¼–å†™å®" class="headerlink" title="ç¼–å†™å®"></a>ç¼–å†™å®</h2><p>ç¼–å†™å®æ˜¯éå¸¸å¤æ‚çš„ã€‚ä½ å¯èƒ½æ°¸è¿œéƒ½ä¸éœ€è¦å†™å®ï¼Œä½†æœ‰æ—¶ä½ å¯èƒ½ä¼šæƒ³å†™ï¼Œå› ä¸ºå®ƒä»¬éå¸¸æ–¹ä¾¿ã€‚å†™å®å¾ˆæœ‰è¶£ï¼Œå› ä¸ºå®ƒä»¬å‡ ä¹æ˜¯ä¸åŒçš„è¯­è¨€ã€‚è¦å†™ä¸€ä¸ªå®ï¼Œä½ å®é™…ä¸Šæ˜¯ç”¨å¦ä¸€ä¸ªå«<code>macro_rules!</code>çš„å®ã€‚ç„¶åä½ æ·»åŠ ä½ çš„å®åç§°ï¼Œå¹¶æ‰“å¼€ä¸€ä¸ª<code>{}</code>å—ã€‚é‡Œé¢æœ‰ç‚¹åƒ<code>match</code>è¯­å¥ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªåªå–<code>()</code>ï¼Œç„¶åè¿”å›6:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> give_six <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token number">6</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> six <span class="token operator">=</span> <span class="token macro property">give_six!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> six<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†è¿™å’Œ<code>match</code>è¯­å¥æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸ºå®å®é™…ä¸Šä¸ä¼šç¼–è¯‘ä»»ä½•ä¸œè¥¿ã€‚å®ƒåªæ˜¯æ¥å—ä¸€ä¸ªè¾“å…¥å¹¶ç»™å‡ºä¸€ä¸ªè¾“å‡ºã€‚ç„¶åç¼–è¯‘å™¨ä¼šæ£€æŸ¥å®ƒæ˜¯å¦æœ‰æ„ä¹‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®å°±åƒ â€œå†™ä»£ç çš„ä»£ç â€ã€‚ä½ ä¼šè®°å¾—ï¼Œä¸€ä¸ªçœŸæ­£çš„<code>match</code>è¯­å¥éœ€è¦ç»™å‡ºç›¸åŒçš„ç±»å‹ï¼Œæ‰€ä»¥è¿™ä¸ä¼šå·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// âš ï¸</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">match</span> my_number <span class="token punctuation">{</span>
        <span class="token number">10</span> <span class="token operator">=&gt;</span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You got a ten"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _ <span class="token operator">=&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒä¼šæŠ±æ€¨ä½ åœ¨ä¸€ç§æƒ…å†µä¸‹è¦è¿”å›<code>()</code>ï¼Œåœ¨å¦ä¸€ç§æƒ…å†µä¸‹è¦è¿”å›<code>i32</code>ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0308]: `match` arms have incompatible types
 --&gt; src\main.rs:5:14
  |
3 | /     match my_number {
4 | |         10 =&gt; println!("You got a ten"),
  | |               ------------------------- this is found to be of type `()`
5 | |         _ =&gt; 10,
  | |              ^^ expected `()`, found integer
6 | |     }
  | |_____- `match` arms have incompatible types<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†å®å¹¶ä¸å…³å¿ƒï¼Œå› ä¸ºå®ƒåªæ˜¯ç»™å‡ºä¸€ä¸ªè¾“å‡ºã€‚å®ƒä¸æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨â€“å®ƒæ˜¯ä»£ç å‰çš„ä»£ç ã€‚æ‰€ä»¥ä½ å¯ä»¥è¿™æ ·åš:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> six_or_print <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token number">6</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You didn't give me 6."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_number <span class="token operator">=</span> <span class="token macro property">six_or_print!</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">six_or_print!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°±å¥½åŠäº†ï¼Œæ‰“å°çš„æ˜¯<code>You didn't give me 6.</code>ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸æ˜¯åŒ¹é…åˆ†æ”¯ï¼Œå› ä¸ºæ²¡æœ‰<code>_</code>è¡Œã€‚æˆ‘ä»¬åªèƒ½ç»™å®ƒ<code>(6)</code>ï¼Œæˆ–è€…<code>()</code>ï¼Œå…¶ä»–çš„éƒ½ä¼šå‡ºé”™ã€‚è€Œæˆ‘ä»¬ç»™å®ƒçš„<code>6</code>ç”šè‡³ä¸æ˜¯<code>i32</code>ï¼Œåªæ˜¯ä¸€ä¸ªè¾“å…¥6ã€‚å…¶å®ä½ å¯ä»¥è®¾ç½®ä»»ä½•ä¸œè¥¿ä½œä¸ºå®çš„è¾“å…¥ï¼Œå› ä¸ºå®ƒåªæ˜¯çœ‹è¾“å…¥ï¼Œçœ‹å¾—åˆ°ä»€ä¹ˆã€‚æ¯”å¦‚è¯´:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> might_print <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token class-name">THis</span> is strange input í•˜í•˜ã¯ã¯å“ˆå“ˆ but it still works<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You guessed the secret message!"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You didn't guess it"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">might_print!</span><span class="token punctuation">(</span><span class="token class-name">THis</span> is strange input í•˜í•˜ã¯ã¯å“ˆå“ˆ but it still works<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">might_print!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™ä¸ªå¥‡æ€ªçš„å®åªå“åº”ä¸¤ä»¶äº‹ã€‚<code>()</code>å’Œ<code>(THis is strange input í•˜í•˜ã¯ã¯å“ˆå“ˆ but it still works)</code>. æ²¡æœ‰å…¶ä»–çš„ä¸œè¥¿ã€‚å®ƒæ‰“å°çš„æ˜¯:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You guessed the secret message!
You didn't guess it<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å®ä¸å®Œå…¨æ˜¯Rustè¯­æ³•ã€‚ä½†æ˜¯å®ä¹Ÿå¯ä»¥ç†è§£ä½ ç»™å®ƒçš„ä¸åŒç±»å‹çš„è¾“å…¥ã€‚æ‹¿è¿™ä¸ªä¾‹å­æ¥è¯´ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> might_print <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You gave me: {}"</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">might_print!</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°<code>You gave me: 6</code>ã€‚<code>$input:expr</code>éƒ¨åˆ†å¾ˆé‡è¦ã€‚å®ƒçš„æ„æ€æ˜¯ â€œå¯¹äºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œç»™å®ƒèµ·ä¸€ä¸ªå˜é‡å$inputâ€ã€‚åœ¨å®ä¸­ï¼Œå˜é‡ä»¥<code>$</code>å¼€å¤´ã€‚åœ¨è¿™ä¸ªå®ä¸­ï¼Œå¦‚æœä½ ç»™å®ƒä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒå°±ä¼šæ‰“å°å‡ºæ¥ã€‚æˆ‘ä»¬å†æ¥è¯•ä¸€è¯•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> might_print <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You gave me: {:?}"</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now we'll use {:?} because we will give it different kinds of expressions</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">might_print!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// give it a ()</span>
    <span class="token macro property">might_print!</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// give it a 6</span>
    <span class="token macro property">might_print!</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// give it a vec</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You gave me: ()
You gave me: 6
You gave me: [8, 9, 7, 10]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–æ³¨æ„ï¼Œæˆ‘ä»¬å†™äº†<code>{:?}</code>ï¼Œä½†å®ƒä¸ä¼šæ£€æŸ¥<code>&amp;input</code>æ˜¯å¦å®ç°äº†<code>Debug</code>ã€‚å®ƒåªä¼šå†™ä»£ç ï¼Œå¹¶å°è¯•è®©å®ƒç¼–è¯‘ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šç»™å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>é‚£ä¹ˆé™¤äº†<code>expr</code>ï¼Œå®è¿˜èƒ½çœ‹åˆ°ä»€ä¹ˆå‘¢ï¼Ÿå®ƒä»¬æ˜¯ <code>block | expr | ident | item | lifetime | literal  | meta | pat | path | stmt | tt | ty | vis</code>. è¿™å°±æ˜¯å¤æ‚çš„éƒ¨åˆ†ã€‚ä½ å¯ä»¥åœ¨<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/beta/reference/macros-by-example.html">è¿™é‡Œ</a>çœ‹åˆ°å®ƒä»¬å„è‡ªçš„æ„æ€ï¼Œè¿™é‡Œè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">item: an Item
block: a BlockExpression
stmt: a Statement without the trailing semicolon (except for item statements that require semicolons)
pat: a Pattern
expr: an Expression
ty: a Type
ident: an IDENTIFIER_OR_KEYWORD
path: a TypePath style path
tt: a TokenTree (a single token or tokens in matching delimiters (), [], or {})
meta: an Attr, the contents of an attribute
lifetime: a LIFETIME_TOKEN
vis: a possibly empty Visibility qualifier
literal: matches -?LiteralExpression<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦å¤–æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç½‘ç«™å«cheats.rsï¼Œåœ¨<a target="_blank" rel="noopener" href="https://cheats.rs/#macros-attributes">è¿™é‡Œ</a>è§£é‡Šäº†å®ƒä»¬ï¼Œå¹¶ä¸”æ¯ä¸ªéƒ½ç»™å‡ºäº†ä¾‹å­ã€‚</p>
<p>ç„¶è€Œï¼Œå¯¹äºå¤§å¤šæ•°å®ï¼Œä½ åªä¼šç”¨åˆ° <code>expr</code>ã€<code>ident</code> å’Œ <code>tt</code>ã€‚<code>ident</code> è¡¨ç¤ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå˜é‡æˆ–å‡½æ•°åç§°ã€‚<code>tt</code>è¡¨ç¤ºtokenæ ‘ï¼Œå’Œä»»ä½•ç±»å‹çš„è¾“å…¥ã€‚è®©æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸¤ä¸ªè¯åˆ›å»ºä¸€ä¸ªç®€å•çš„å®ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> check <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token variable">$input1</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">ident</span><span class="token punctuation">,</span> <span class="token variable">$input2</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span>
            <span class="token string">"Is {:?} equal to {:?}? {:?}"</span><span class="token punctuation">,</span>
            <span class="token variable">$input1</span><span class="token punctuation">,</span>
            <span class="token variable">$input2</span><span class="token punctuation">,</span>
            <span class="token variable">$input1</span> <span class="token operator">==</span> <span class="token variable">$input2</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> my_vec <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token macro property">check!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">check!</span><span class="token punctuation">(</span>my_vec<span class="token punctuation">,</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">check!</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™å°†å–ä¸€ä¸ª<code>ident</code>(åƒä¸€ä¸ªå˜é‡å)å’Œä¸€ä¸ªè¡¨è¾¾å¼ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦ç›¸åŒã€‚å®ƒçš„æ‰“å°ç»“æœæ˜¯</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Is 6 equal to 6? true
Is [7, 8, 9] equal to [7, 8, 9]? true
Is 6 equal to 10? false<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è€Œè¿™é‡Œæœ‰ä¸€ä¸ªå®ï¼Œè¾“å…¥<code>tt</code>ï¼Œç„¶åæŠŠå®ƒæ‰“å°å‡ºæ¥ã€‚å®ƒå…ˆç”¨ä¸€ä¸ªå«<code>stringify!</code>çš„å®åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> print_anything <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">tt</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token macro property">stringify!</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">print_anything!</span><span class="token punctuation">(</span>ththdoetd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">print_anything!</span><span class="token punctuation">(</span>87575oehq75onth<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">ththdoetd
87575oehq75onth<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç»™å®ƒä¸€äº›å¸¦æœ‰ç©ºæ ¼ã€é€—å·ç­‰çš„ä¸œè¥¿ï¼Œå®ƒå°±ä¸ä¼šæ‰“å°ã€‚å®ƒä¼šè®¤ä¸ºæˆ‘ä»¬ç»™äº†å®ƒä¸æ­¢ä¸€ä¸ªå…ƒç´ æˆ–é¢å¤–çš„ä¿¡æ¯ï¼Œæ‰€ä»¥å®ƒä¼šæ„Ÿåˆ°å›°æƒ‘ã€‚</p>
<p>è¿™å°±æ˜¯å®å¼€å§‹å˜å¾—å›°éš¾çš„åœ°æ–¹ã€‚</p>
<p>è¦ä¸€æ¬¡ç»™å®æä¾›å¤šä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸åŒçš„è¯­æ³•ã€‚ä¸è¦ç”¨<code>$input</code>ï¼Œè€Œæ˜¯<code>$($input1),*</code>ã€‚è¿™æ„å‘³ç€é›¶æˆ–æ›´å¤š(è¿™æ˜¯ * çš„æ„æ€)ï¼Œç”¨é€—å·åˆ†éš”ã€‚å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œè¯·ä½¿ç”¨ <code>+</code> è€Œä¸æ˜¯ <code>*</code>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„å®çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> print_anything <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$input1</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">tt</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token macro property">stringify!</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$input1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">print_anything!</span><span class="token punctuation">(</span>ththdoetd<span class="token punctuation">,</span> rcofe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">print_anything!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">print_anything!</span><span class="token punctuation">(</span>87575oehq75onth<span class="token punctuation">,</span> ntohe<span class="token punctuation">,</span> 987987o<span class="token punctuation">,</span> <span class="token number">097</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å®ƒæ¥å—ä»»ä½•ç”¨é€—å·éš”å¼€çš„tokenæ ‘ï¼Œå¹¶ä½¿ç”¨ <code>stringify!</code> æŠŠå®ƒå˜æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ç„¶åæ‰“å°å‡ºæ¥ã€‚å®ƒçš„æ‰“å°ç»“æœæ˜¯:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">ththdoetd, rcofe

87575oehq75onth, ntohe, 987987o, 097<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>+</code>è€Œä¸æ˜¯<code>*</code>ï¼Œå®ƒä¼šç»™å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæœ‰ä¸€æ¬¡æˆ‘ä»¬æ²¡æœ‰ç»™å®ƒè¾“å…¥ã€‚æ‰€ä»¥<code>*</code>æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®‰å…¨çš„é€‰æ‹©ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹çœ‹åˆ°å®çš„å¨åŠ›äº†ã€‚åœ¨æ¥ä¸‹æ¥çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å‡½æ•°:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> make_a_function <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">ident</span><span class="token punctuation">,</span> $<span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">tt</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// First you give it one name for the function, then it checks everything else</span>
        <span class="token keyword">fn</span> <span class="token variable">$name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token macro property">stringify!</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// It makes everything else into a string</span>
            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">make_a_function!</span><span class="token punctuation">(</span>print_it<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token class-name">I</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// We want a function called print_it() that prints everything else we give it</span>
    <span class="token function">print_it</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">make_a_function!</span><span class="token punctuation">(</span>say_its_nice<span class="token punctuation">,</span> this<span class="token punctuation">,</span> is<span class="token punctuation">,</span> really<span class="token punctuation">,</span> nice<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Same here but we change the function name</span>
    <span class="token function">say_its_nice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">5, 5, 6, I
this, is, really, nice<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹äº†è§£å…¶ä»–çš„å®äº†ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨çš„ä¸€äº›å®éå¸¸ç®€å•ã€‚è¿™é‡Œæ˜¯æˆ‘ä»¬ç”¨æ¥å†™å…¥æ–‡ä»¶çš„<code>write!</code>çš„é‚£ä¸ª:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> write <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token variable">$dst</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">,</span> $<span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">tt</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token variable">$dst</span><span class="token punctuation">.</span><span class="token function">write_fmt</span><span class="token punctuation">(</span><span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">format_args!</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¦ä½¿ç”¨å®ƒï¼Œä½ å°±è¾“å…¥è¿™ä¸ª:</p>
<ul>
<li>ä¸€ä¸ªè¡¨è¾¾å¼(<code>expr</code>) å¾—åˆ°å˜é‡å<code>$dst</code>.</li>
<li>ä¹‹åçš„ä¸€åˆ‡ã€‚å¦‚æœå®ƒå†™çš„æ˜¯<code>$arg:tt</code>ï¼Œé‚£ä¹ˆå®ƒåªä¼šå–1ä¸ªï¼Œä½†æ˜¯å› ä¸ºå®ƒå†™çš„æ˜¯<code>$($arg:tt)*</code>ï¼Œæ‰€ä»¥å®ƒå–0ï¼Œ1ï¼Œæˆ–è€…ä»»æ„å¤šä¸ªã€‚</li>
</ul>
<p>ç„¶åå®ƒå–<code>$dst</code>ï¼Œå¹¶å¯¹å®ƒä½¿ç”¨äº†ä¸€ä¸ªå«åš<code>write_fmt</code>çš„æ–¹æ³•ã€‚åœ¨è¿™é‡Œé¢ï¼Œå®ƒä½¿ç”¨äº†å¦ä¸€ä¸ªå«åš<code>format_args!</code>çš„å®ï¼Œå®ƒæ¥å—æ‰€æœ‰çš„<code>$($arg)*</code>ï¼Œæˆ–è€…æˆ‘ä»¬è¾“å…¥çš„æ‰€æœ‰å‚æ•°ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>todo!</code>è¿™ä¸ªå®ã€‚å½“ä½ æƒ³è®©ç¨‹åºç¼–è¯‘ä½†è¿˜æ²¡æœ‰å†™å‡ºä½ çš„ä»£ç æ—¶ï¼Œå°±ä¼šç”¨åˆ°è¿™ä¸ªå®ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> todo <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"not yet implemented"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">tt</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">"not yet implemented: {}"</span><span class="token punctuation">,</span> <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">format_args!</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæœ‰ä¸¤ä¸ªé€‰é¡¹:ä½ å¯ä»¥è¾“å…¥<code>()</code>ï¼Œä¹Ÿå¯ä»¥è¾“å…¥ä¸€äº›tokenæ ‘(<code>tt</code>)ã€‚</p>
<ul>
<li>å¦‚æœä½ è¾“å…¥<code>()</code>ï¼Œå®ƒåªæ˜¯<code>panic!</code>ï¼Œå¹¶åŠ ä¸Šä¸€ä¸ªä¿¡æ¯ã€‚æ‰€ä»¥å…¶å®ä½ å¯ä»¥ç›´æ¥å†™<code>panic!("not yet implemented")</code>ï¼Œè€Œä¸æ˜¯<code>todo!</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</li>
<li>å¦‚æœä½ è¾“å…¥ä¸€äº›å‚æ•°ï¼Œå®ƒä¼šå°è¯•æ‰“å°å®ƒä»¬ã€‚ä½ å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰åŒæ ·çš„<code>format_args!</code>å®ï¼Œå®ƒçš„å·¥ä½œåŸç†å’Œ<code>println!</code>ä¸€æ ·ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œå¦‚æœä½ å†™äº†è¿™ä¸ªï¼Œå®ƒä¹Ÿä¼šå·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">not_done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> reason <span class="token operator">=</span> <span class="token string">"lack of time"</span><span class="token punctuation">;</span>
    <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token string">"Not done yet because of {}. Check back in {} hours"</span><span class="token punctuation">,</span> reason<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">not_done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">thread 'main' panicked at 'not yet implemented: Not done yet because of lack of time. Check back in 8 hours', src/main.rs:4:5<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>åœ¨ä¸€ä¸ªå®é‡Œé¢ï¼Œä½ ç”šè‡³å¯ä»¥è°ƒç”¨åŒä¸€ä¸ªå®ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> my_macro <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Let's print this."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">my_macro!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">my_macro!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">my_macro!</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">my_macro!</span><span class="token punctuation">(</span>toheteh<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">my_macro!</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">my_macro!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå¯ä»¥å–<code>()</code>ï¼Œä¹Ÿå¯ä»¥å–ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥å–å¾ˆå¤šè¡¨è¾¾å¼ã€‚ä½†æ˜¯ä¸ç®¡ä½ æ”¾ä»€ä¹ˆè¡¨è¾¾å¼ï¼Œå®ƒéƒ½ä¼šå¿½ç•¥æ‰€æœ‰çš„è¡¨è¾¾å¼ï¼Œåªæ˜¯åœ¨<code>()</code>ä¸Šè°ƒç”¨<code>my_macro!</code>ã€‚æ‰€ä»¥è¾“å‡ºçš„åªæ˜¯<code>Let's print this</code>ï¼Œå››æ¬¡ã€‚</p>
<p>åœ¨<code>dbg!</code>å®ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°åŒæ ·çš„æƒ…å†µï¼Œä¹Ÿæ˜¯è°ƒç”¨è‡ªå·±ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">macro_rules!</span> dbg <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">"[{}:{}]"</span><span class="token punctuation">,</span> <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">file!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">line!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//$crate means the crate that it's in.</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Use of `match` here is intentional because it affects the lifetimes</span>
        <span class="token comment">// of temporaries - https://stackoverflow.com/a/48732525/1063961</span>
        <span class="token keyword">match</span> <span class="token variable">$val</span> <span class="token punctuation">{</span>
            tmp <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">"[{}:{}] {} = {:#?}"</span><span class="token punctuation">,</span>
                    <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">file!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">line!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">stringify!</span><span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                tmp
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// Trailing comma with single argument is ignored</span>
    <span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">dbg!</span><span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">:</span><span class="token fragment-specifier punctuation">expr</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">+</span> $<span class="token punctuation">(</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token variable">$crate</span><span class="token punctuation">::</span><span class="token macro property">dbg!</span><span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">+</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(<code>eprintln!</code>ä¸<code>println!</code>ç›¸åŒï¼Œåªæ‰“å°åˆ°<code>io::stderr</code>è€Œä¸æ˜¯<code>io::stdout</code>ã€‚è¿˜æœ‰<code>eprint!</code>ä¸å¢åŠ ä¸€è¡Œ)ã€‚)</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå·±å»è¯•ä¸€è¯•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">dbg!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ç¬¬ä¸€åˆ†æ”¯ç›¸åŒ¹é…ï¼Œæ‰€ä»¥å®ƒä¼šç”¨<code>file!</code>å’Œ<code>line!</code>å®æ‰“å°æ–‡ä»¶åå’Œè¡Œåã€‚å®ƒæ‰“å°çš„æ˜¯<code>[src/main.rs:2]</code>ã€‚</p>
<p>æˆ‘ä»¬ç”¨è¿™ä¸ªæ¥è¯•è¯•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">dbg!</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†åŒ¹é…ä¸‹ä¸€ä¸ªåˆ†æ”¯ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ç„¶åå®ƒå°†è°ƒç”¨è¾“å…¥<code>tmp</code>å¹¶ä½¿ç”¨è¿™ä¸ªä»£ç ã€‚<code> $crate::eprintln!("[{}:{}] {} = {:#?}", $crate::file!(), $crate::line!(), $crate::stringify!($val), &amp;tmp);</code>. æ‰€ä»¥å®ƒä¼šç”¨<code>file!</code>å’Œ<code>line!</code>æ¥æ‰“å°ï¼Œç„¶åæŠŠ<code>$val</code>åšæˆ<code>String</code>ï¼Œç”¨<code>{:#?}</code>æ¥æ¼‚äº®çš„æ‰“å°<code>tmp</code>ã€‚æ‰€ä»¥å¯¹äºæˆ‘ä»¬çš„è¾“å…¥ï¼Œå®ƒä¼šè¿™æ ·å†™ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">[src/main.rs:2] vec![8, 9, 10] = [
    8,
    9,
    10,
]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œå³ä½¿ä½ å¤šåŠ äº†ä¸€ä¸ªé€—å·ï¼Œå®ƒä¹Ÿåªæ˜¯è‡ªå·±è°ƒç”¨<code>dbg!</code>ã€‚</p>
<p>æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå®æ˜¯éå¸¸å¤æ‚çš„ï¼é€šå¸¸ä½ åªæƒ³è®©ä¸€ä¸ªå®è‡ªåŠ¨å®Œæˆä¸€äº›ç®€å•å‡½æ•°ä¸èƒ½å¾ˆå¥½å®Œæˆçš„äº‹æƒ…ã€‚å­¦ä¹ å®çš„æœ€å¥½æ–¹æ³•æ˜¯çœ‹å…¶ä»–å®çš„ä¾‹å­ã€‚æ²¡æœ‰å¤šå°‘äººèƒ½å¤Ÿå¿«é€Ÿå†™å‡ºå®è€Œä¸å‡ºé—®é¢˜ã€‚æ‰€ä»¥ä¸è¦è®¤ä¸ºä½ éœ€è¦çŸ¥é“å®çš„ä¸€åˆ‡ï¼Œæ‰èƒ½çŸ¥é“å¦‚ä½•åœ¨Rustä¸­å†™ã€‚ä½†å¦‚æœä½ è¯»äº†å…¶ä»–å®ï¼Œå¹¶ç¨åŠ ä¿®æ”¹ï¼Œä½ å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°å€Ÿç”¨å®ƒä»¬çš„åŠ›é‡ã€‚ç„¶åä½ å¯èƒ½ä¼šå¼€å§‹é€‚åº”å†™è‡ªå·±çš„å®ã€‚</p>
<h1 id="ç¬¬2éƒ¨åˆ†-ç”µè„‘ä¸Šçš„Rust"><a href="#ç¬¬2éƒ¨åˆ†-ç”µè„‘ä¸Šçš„Rust" class="headerlink" title="ç¬¬2éƒ¨åˆ† - ç”µè„‘ä¸Šçš„Rust"></a>ç¬¬2éƒ¨åˆ† - ç”µè„‘ä¸Šçš„Rust</h1><p>ä½ çœ‹åˆ°äº†ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥ä½¿ç”¨Playgroundå­¦ä¹ Rustä¸­çš„ä»»ä½•ä¸œè¥¿ã€‚ä½†å¦‚æœä½ åˆ°ç›®å‰ä¸ºæ­¢å·²ç»å­¦äº†è¿™ä¹ˆå¤šï¼Œç°åœ¨ä½ å¯èƒ½ä¼šæƒ³è¦åœ¨ä½ çš„ç”µè„‘ä¸Šä½¿ç”¨Rustã€‚æ€»æœ‰ä¸€äº›äº‹æƒ…æ˜¯ä½ ä¸èƒ½ç”¨Playgroundåšçš„ï¼Œæ¯”å¦‚ä½¿ç”¨æ–‡ä»¶æˆ–ä»£ç åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ã€‚å…¶ä»–å¦‚è¾“å…¥å’Œflagsä¹Ÿéœ€è¦åœ¨ç”µè„‘ä¸Šå®‰è£…Rustã€‚ä½†æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨ä½ çš„ç”µè„‘ä¸Šæœ‰äº†Rustï¼Œä½ å¯ä»¥ä½¿ç”¨Crateã€‚æˆ‘ä»¬å·²ç»äº†è§£äº†crateï¼Œä½†åœ¨playgroundä¸­ä½ åªèƒ½ä½¿ç”¨æœ€æµè¡Œçš„crateã€‚ä½†åœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œä½ å¯ä»¥åœ¨ç¨‹åºä¸­ä½¿ç”¨ä»»ä½•crateã€‚</p>
<h2 id="cargo"><a href="#cargo" class="headerlink" title="cargo"></a>cargo</h2><p><code>rustc</code>çš„æ„æ€æ˜¯Rustç¼–è¯‘å™¨ï¼Œå®é™…çš„ç¼–è¯‘å·¥ä½œç”±å®ƒå®Œæˆã€‚ä¸€ä¸ªrustæ–‡ä»¶çš„ç»“å°¾æ˜¯<code>.rs</code>ã€‚ä½†å¤§å¤šæ•°äººä¸ä¼šå†™å‡ºç±»ä¼¼ <code>rustc main.rs</code> çš„ä¸œè¥¿æ¥ç¼–è¯‘ã€‚ä»–ä»¬ä½¿ç”¨çš„æ˜¯åä¸º <code>cargo</code> çš„ä¸œè¥¿ï¼Œå®ƒæ˜¯ Rust çš„ä¸»åŒ…ç®¡ç†å™¨ã€‚</p>
<p>å…³äºè¿™ä¸ªåå­—çš„ä¸€ä¸ªè¯´æ˜: ä¹‹æ‰€ä»¥å«<code>cargo</code>ï¼Œæ˜¯å› ä¸ºå½“ä½ æŠŠcrateæ”¾åœ¨ä¸€èµ·æ—¶ï¼Œä½ ä¼šå¾—åˆ°cargoã€‚Crateå°±æ˜¯ä½ åœ¨èˆ¹ä¸Šæˆ–å¡è½¦ä¸Šçœ‹åˆ°çš„æœ¨ç®±ï¼Œä½†ä½ è®°ä½ï¼Œæ¯ä¸ªRusté¡¹ç›®ä¹Ÿå«Crateã€‚é‚£ä¹ˆå½“ä½ æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·æ—¶ï¼Œä½ å°±ä¼šå¾—åˆ°æ•´ä¸ªcargoã€‚</p>
<p>å½“ä½ ä½¿ç”¨cargoæ¥è¿è¡Œä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°è¿™ä¸€ç‚¹ã€‚è®©æˆ‘ä»¬ç”¨ <code>rand</code> è¯•è¯•ç®€å•çš„ä¸œè¥¿:æˆ‘ä»¬åªæ˜¯åœ¨å…«ä¸ªå­—æ¯ä¹‹é—´éšæœºé€‰æ‹©ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">rand<span class="token punctuation">::</span>seq<span class="token punctuation">::</span></span><span class="token class-name">SliceRandom</span><span class="token punctuation">;</span> <span class="token comment">// Use this for .choose over slices</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> my_letters <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token char string">'a'</span><span class="token punctuation">,</span> <span class="token char string">'b'</span><span class="token punctuation">,</span> <span class="token char string">'c'</span><span class="token punctuation">,</span> <span class="token char string">'d'</span><span class="token punctuation">,</span> <span class="token char string">'e'</span><span class="token punctuation">,</span> <span class="token char string">'f'</span><span class="token punctuation">,</span> <span class="token char string">'g'</span><span class="token punctuation">,</span> <span class="token char string">'h'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> rng <span class="token operator">=</span> <span class="token namespace">rand<span class="token punctuation">::</span></span><span class="token function">thread_rng</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">6</span> <span class="token punctuation">{</span>
        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> my_letters<span class="token punctuation">.</span><span class="token function">choose</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> rng<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±ä¼šæ‰“å°å‡º<code>b c g h e a</code>è¿™æ ·çš„ä¸œè¥¿ã€‚ä½†æˆ‘ä»¬æƒ³å…ˆçœ‹çœ‹<code>cargo</code>çš„ä½œç”¨ã€‚è¦ä½¿ç”¨ <code>cargo</code> å¹¶è¿è¡Œæˆ‘ä»¬çš„ç¨‹åºï¼Œé€šå¸¸æˆ‘ä»¬è¾“å…¥ <code>cargo run</code>ã€‚è¿™æ ·å°±å¯ä»¥æ„å»ºæˆ‘ä»¬çš„ç¨‹åºï¼Œå¹¶ä¸ºæˆ‘ä»¬è¿è¡Œå®ƒã€‚å½“å®ƒå¼€å§‹ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šåšè¿™æ ·çš„äº‹æƒ…:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">   Compiling getrandom v0.1.14
   Compiling cfg-if v0.1.10
   Compiling ppv-lite86 v0.2.8
   Compiling rand_core v0.5.1
   Compiling rand_chacha v0.2.2
   Compiling rand v0.7.3
   Compiling rust_book v0.1.0 (C:\Users\mithr\OneDrive\Documents\Rust\rust_book)
    Finished dev [unoptimized + debuginfo] target(s) in 13.13s
     Running `C:\Users\mithr\OneDrive\Documents\Rust\rust_book\target\debug\rust_book.exe`
g f c f h b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥çœ‹èµ·æ¥ä¸åªæ˜¯å¼•å…¥äº†<code>rand</code>ï¼Œè¿˜å¼•å…¥äº†ä¸€äº›å…¶ä»–çš„crateã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„crateéœ€è¦<code>rand</code>ï¼Œä½†<code>rand</code>ä¹Ÿæœ‰ä¸€äº›ä»£ç ä¹Ÿéœ€è¦å…¶ä»–crateã€‚æ‰€ä»¥<code>cargo</code>ä¼šæ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰crateï¼Œå¹¶æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œåªæœ‰7ä¸ªï¼Œä½†åœ¨éå¸¸å¤§çš„é¡¹ç›®ä¸­ï¼Œä½ å¯èƒ½ä¼šæœ‰200ä¸ªæˆ–æ›´å¤šçš„crateè¦å¼•å…¥ã€‚</p>
<p>è¿™å°±æ˜¯ä½ å¯ä»¥çœ‹åˆ°Rustçš„æƒè¡¡çš„åœ°æ–¹ã€‚Rustçš„é€Ÿåº¦éå¸¸å¿«ï¼Œå› ä¸ºå®ƒæå‰ç¼–è¯‘ã€‚å®ƒé€šè¿‡æŸ¥çœ‹ä»£ç ï¼Œçœ‹ä½ å†™çš„ä»£ç åˆ°åº•åšäº†ä»€ä¹ˆã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šå†™è¿™æ ·çš„æ³›å‹ä»£ç :</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">print_and_return_thing</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Display</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">T</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You gave me {} and now I will give it back."</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    input
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> my_name <span class="token operator">=</span> <span class="token function">print_and_return_thing</span><span class="token punctuation">(</span><span class="token string">"Windy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> small_number <span class="token operator">=</span> <span class="token function">print_and_return_thing</span><span class="token punctuation">(</span><span class="token number">9.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨ä»»ä½•å®ç°äº†<code>Display</code>çš„ä½œä¸ºå‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™å®ƒä¸€ä¸ª<code>&amp;str</code>ï¼Œæ¥ä¸‹æ¥ç»™å®ƒä¸€ä¸ª<code>f64</code>ï¼Œè¿™å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†æ˜¯ç¼–è¯‘å™¨ä¸çœ‹æ³›å‹ï¼Œå› ä¸ºå®ƒä¸æƒ³åœ¨è¿è¡Œæ—¶åšä»»ä½•äº‹æƒ…ã€‚å®ƒæƒ³æŠŠä¸€ä¸ªèƒ½è¿è¡Œçš„ç¨‹åºå°½å¯èƒ½å¿«åœ°ç»„è£…èµ·æ¥ã€‚æ‰€ä»¥å½“å®ƒçœ‹ç¬¬ä¸€éƒ¨åˆ†çš„<code>"Windy"</code>æ—¶ï¼Œå®ƒæ²¡æœ‰çœ‹åˆ°<code>fn print_and_return_thing&lt;T: Display&gt;(input: T) -&gt; T</code>ï¼Œå®ƒçœ‹åˆ°çš„æ˜¯<code>fn print_and_return_thing(input: &amp;str) -&gt; &amp;str</code>è¿™æ ·çš„ä¸œè¥¿ã€‚è€Œæ¥ä¸‹æ¥å®ƒçœ‹åˆ°çš„æ˜¯<code>fn print_and_return_thing(input: f64) -&gt; f64</code>ã€‚æ‰€æœ‰å…³äºtraitçš„æ£€æŸ¥ç­‰ç­‰éƒ½æ˜¯åœ¨ç¼–è¯‘æ—¶å®Œæˆçš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ³›å‹éœ€è¦æ›´é•¿çš„æ—¶é—´æ¥ç¼–è¯‘ï¼Œå› ä¸ºå®ƒéœ€è¦å¼„æ¸…æ¥šå®ƒä»¬ï¼Œå¹¶ä½¿ä¹‹å…·ä½“åŒ–ã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹:Rust 2020æ­£åœ¨åŠªåŠ›å¤„ç†ç¼–è¯‘æ—¶é—´é—®é¢˜ï¼Œå› ä¸ºè¿™éƒ¨åˆ†éœ€è¦çš„æ—¶é—´æœ€é•¿ã€‚æ¯ä¸€ä¸ªç‰ˆæœ¬çš„Ruståœ¨ç¼–è¯‘æ—¶éƒ½ä¼šå¿«ä¸€ç‚¹ï¼Œè€Œä¸”è¿˜æœ‰ä¸€äº›å…¶ä»–çš„è®¡åˆ’æ¥åŠ å¿«å®ƒçš„é€Ÿåº¦ã€‚ä½†ä¸æ­¤åŒæ—¶ï¼Œä»¥ä¸‹æ˜¯ä½ åº”è¯¥çŸ¥é“çš„:</p>
<ul>
<li><code>cargo build</code>ä¼šæ„å»ºä½ çš„ç¨‹åºï¼Œè¿™æ ·ä½ å°±å¯ä»¥è¿è¡Œå®ƒäº†ã€‚</li>
<li><code>cargo run</code>å°†å»ºç«‹ä½ çš„ç¨‹åºå¹¶è¿è¡Œå®ƒã€‚</li>
<li><code>cargo build --release</code>å’Œ<code>cargo run --release</code>å‘å¸ƒæ¨¡å¼ä¸‹æœ‰åŒæ ·çš„æ•ˆæœã€‚ä»€ä¹ˆæ˜¯å‘å¸ƒæ¨¡å¼ï¼Ÿå½“ä½ çš„ä»£ç æœ€ç»ˆå®Œæˆåå°±å¯ä»¥ç”¨å‘å¸ƒæ¨¡å¼äº†ã€‚Rustä¼šèŠ±æ›´å¤šçš„æ—¶é—´æ¥ç¼–è¯‘ï¼Œä½†å®ƒè¿™æ ·åšæ˜¯å› ä¸ºå®ƒä½¿ç”¨äº†å®ƒæ‰€çŸ¥é“çš„ä¸€åˆ‡ï¼Œæ¥ä½¿ç¼–è¯‘å‡ºçš„ç¨‹åºè¿è¡Œæ›´å¿«ã€‚Releaseæ¨¡å¼å®é™…ä¸Šæ¯”å¸¸è§„æ¨¡å¼<em>å¿«çš„å¤š</em>ï¼Œå¸¸è§„æ¨¡å¼è¢«ç§°ä¸ºdebugæ¨¡å¼ã€‚é‚£æ˜¯å› ä¸ºå®ƒçš„ç¼–è¯‘é€Ÿåº¦æ›´å¿«ï¼Œè€Œä¸”æœ‰æ›´å¤šçš„è°ƒè¯•ä¿¡æ¯ã€‚å¸¸è§„çš„<code>cargo build</code>å«åš â€œdebug buildâ€ï¼Œ<code>cargo build --release</code>å«åš â€œrelease buildâ€ã€‚</li>
<li><code>cargo check</code>æ˜¯ä¸€ç§æ£€æŸ¥ä»£ç çš„æ–¹å¼ã€‚å®ƒå°±åƒç¼–è¯‘ä¸€æ ·ï¼Œåªä¸è¿‡å®ƒä¸ä¼šçœŸæ­£åœ°åˆ›å»ºä½ çš„ç¨‹åºã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ£€æŸ¥ä½ çš„ä»£ç çš„æ–¹æ³•ï¼Œå› ä¸ºå®ƒä¸åƒ<code>build</code>æˆ–<code>run</code>é‚£æ ·éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚</li>
</ul>
<p>å¯¹äº†ï¼Œå‘½ä»¤ä¸­çš„<code>--release</code>éƒ¨åˆ†å«åš<code>flag</code>ã€‚è¿™æ„å‘³ç€å‘½ä»¤ä¸­çš„é¢å¤–ä¿¡æ¯ã€‚</p>
<p>å…¶ä»–ä¸€äº›ä½ éœ€è¦çŸ¥é“çš„äº‹æƒ…æ˜¯:</p>
<ul>
<li><code>cargo new</code>. è¿™æ ·åšæ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ–°çš„Rusté¡¹ç›®ã€‚<code>new</code>ä¹‹åï¼Œå†™ä¸Šé¡¹ç›®çš„åç§°ï¼Œ<code>cargo</code>å°†ä¼šåˆ›å»ºæ‰€æœ‰ä½ éœ€è¦çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚</li>
<li><code>cargo clean</code>. å½“ä½ æŠŠcrateæ·»åŠ åˆ°<code>Cargo.toml</code>æ—¶ï¼Œç”µè„‘ä¼šä¸‹è½½æ‰€æœ‰éœ€è¦çš„æ–‡ä»¶ï¼Œå®ƒä»¬ä¼šå ç”¨å¾ˆå¤šç©ºé—´ã€‚å¦‚æœä½ ä¸æƒ³å†è®©å®ƒä»¬åœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œè¾“å…¥<code>cargo clean</code>ã€‚</li>
</ul>
<p>å…³äºç¼–è¯‘å™¨è¿˜æœ‰ä¸€ç‚¹:åªæœ‰å½“ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨<code>cargo build</code>æˆ–<code>cargo run</code>æ—¶ï¼Œå®ƒæ‰ä¼šèŠ±è´¹æœ€å¤šçš„æ—¶é—´ã€‚ä¹‹åå®ƒå°±ä¼šè®°ä½ï¼Œå®ƒåˆä¼šå¿«é€Ÿç¼–è¯‘ã€‚ä½†å¦‚æœä½ ä½¿ç”¨ <code>cargo clean</code>ï¼Œç„¶åè¿è¡Œ <code>cargo build</code>ï¼Œå®ƒå°†ä¸å¾—ä¸å†æ…¢æ…¢åœ°ç¼–è¯‘ä¸€æ¬¡ã€‚</p>
<h2 id="æ¥å—ç”¨æˆ·è¾“å…¥"><a href="#æ¥å—ç”¨æˆ·è¾“å…¥" class="headerlink" title="æ¥å—ç”¨æˆ·è¾“å…¥"></a>æ¥å—ç”¨æˆ·è¾“å…¥</h2><p>ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ç”¨<code>std::io::stdin</code>æ¥æ¥å—ç”¨æˆ·çš„è¾“å…¥ã€‚è¿™æ„å‘³ç€ â€œæ ‡å‡†è¾“å…¥â€ï¼Œä¹Ÿå°±æ˜¯æ¥è‡ªé”®ç›˜çš„è¾“å…¥ã€‚ç”¨<code>stdin()</code>å¯ä»¥è·å¾—ç”¨æˆ·çš„è¾“å…¥ï¼Œä½†æ˜¯æ¥ä¸‹æ¥ä½ å°±ä¼šæƒ³ç”¨<code>.read_line()</code>æŠŠå®ƒæ”¾åˆ°<code>&amp;mut String</code>ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½†å®ƒæ—¢èƒ½å·¥ä½œï¼Œä¹Ÿä¸èƒ½å·¥ä½œ:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Please type something, or x to escape:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> input_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> input_string <span class="token operator">!=</span> <span class="token string">"x"</span> <span class="token punctuation">{</span> <span class="token comment">// This is the part that doesn't work right</span>
        input_string<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// First clear the String. Otherwise it will keep adding to it</span>
        <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> input_string<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Get the stdin from the user, and put it in read_string</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You wrote {}"</span><span class="token punctuation">,</span> input_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"See you later!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¾“å‡ºè¾“å‡ºçš„æ ·å­ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Please type something, or x to escape:
something
You wrote something

Something else
You wrote Something else

x
You wrote x

x
You wrote x

x
You wrote x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒæ¥å—æˆ‘ä»¬çš„è¾“å…¥ï¼Œç„¶åæŠŠå®ƒè¿˜ç»™æˆ‘ä»¬ï¼Œå®ƒç”šè‡³çŸ¥é“æˆ‘ä»¬è¾“å…¥äº†<code>x</code>ã€‚ä½†å®ƒå¹¶æ²¡æœ‰é€€å‡ºç¨‹åºã€‚å”¯ä¸€çš„åŠæ³•æ˜¯å…³é—­çª—å£ï¼Œæˆ–è€…è¾“å…¥ctrlå’Œcã€‚è®©æˆ‘ä»¬æŠŠ<code>println!</code>ä¸­çš„<code>{}</code>æ”¹ä¸º<code>{:?}</code>ï¼Œä»¥è·å¾—æ›´å¤šçš„ä¿¡æ¯(å¦‚æœä½ å–œæ¬¢é‚£ä¸ªå®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>dbg!(&amp;input_string)</code>)ã€‚ç°åœ¨å®ƒè¯´</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Please type something, or x to escape:
something
You wrote "something\r\n"
Something else
You wrote "Something else\r\n"
x
You wrote "x\r\n"
x
You wrote "x\r\n"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>è¿™æ˜¯å› ä¸ºé”®ç›˜è¾“å…¥å…¶å®ä¸åªæ˜¯<code>something</code>ï¼Œè€Œæ˜¯<code>something</code>å’Œ<code>Enter</code>é”®ã€‚æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå«åš<code>.trim()</code>ï¼Œå®ƒå¯ä»¥æŠŠæ‰€æœ‰çš„ç©ºç™½éƒ½å»æ‰ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œ<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/reference/whitespace.html">è¿™äº›å­—ç¬¦</a>éƒ½æ˜¯ç©ºç™½å­—ç¬¦ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">U+0009 (horizontal tab, '\t')
U+000A (line feed, '\n')
U+000B (vertical tab)
U+000C (form feed)
U+000D (carriage return, '\r')
U+0020 (space, ' ')
U+0085 (next line)
U+200E (left-to-right mark)
U+200F (right-to-left mark)
U+2028 (line separator)
U+2029 (paragraph separator)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·å°±å¯ä»¥æŠŠ<code>x\r\n</code>å˜æˆåªå‰©<code>x</code>äº†ã€‚ç°åœ¨å®ƒå¯ä»¥å·¥ä½œäº†:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Please type something, or x to escape:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> input_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> input_string<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"x"</span> <span class="token punctuation">{</span>
        input_string<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token function">stdin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read_line</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> input_string<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You wrote {}"</span><span class="token punctuation">,</span> input_string<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"See you later!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å¯ä»¥æ‰“å°äº†:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Please type something, or x to escape:
something
You wrote something

Something
You wrote Something

x
You wrote x

See you later!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>è¿˜æœ‰ä¸€ç§ç”¨æˆ·è¾“å…¥å«<code>std::env::Args</code>(envæ˜¯ç¯å¢ƒçš„æ„æ€)ã€‚<code>Args</code>æ˜¯ç”¨æˆ·å¯åŠ¨ç¨‹åºæ—¶è¾“å…¥çš„å†…å®¹ã€‚å…¶å®åœ¨ä¸€ä¸ªç¨‹åºä¸­æ€»æ˜¯è‡³å°‘æœ‰ä¸€ä¸ª<code>Arg</code>ã€‚æˆ‘ä»¬å†™ä¸€ä¸ªç¨‹åºï¼Œåªç”¨<code>std::env::args()</code>æ¥æ‰“å°å®ƒä»¬ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯ä»€ä¹ˆã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span><span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœæˆ‘ä»¬å†™<code>cargo run</code>ï¼Œé‚£ä¹ˆå®ƒçš„æ‰“å°ç»“æœæ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Args { inner: ["target\\debug\\rust_book.exe"] }<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®©æˆ‘ä»¬ç»™å®ƒæ›´å¤šçš„è¾“å…¥ï¼Œçœ‹çœ‹å®ƒçš„ä½œç”¨ã€‚æˆ‘ä»¬è¾“å…¥ <code>cargo run but with some extra words</code> ã€‚ å®ƒç»™æˆ‘ä»¬:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Args { inner: ["target\\debug\\rust_book.exe", "but", "with", "some", "extra", "words"] }<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æœ‰æ„æ€ã€‚è€Œå½“æˆ‘ä»¬æŸ¥çœ‹<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/env/struct.Args.html">Argsçš„é¡µé¢</a>æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒå®ç°äº†<code>IntoIterator</code>ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥.ç”¨æ‰€æœ‰æˆ‘ä»¬çŸ¥é“çš„å…³äºè¿­ä»£å™¨çš„æ–¹æ³•æ¥è¯»å–å’Œæ”¹å˜å®ƒã€‚è®©æˆ‘ä»¬è¯•è¯•è¿™ä¸ª:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span>args<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> input <span class="token operator">=</span> <span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> entry <span class="token keyword">in</span> input <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You entered: {}"</span><span class="token punctuation">,</span> entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°åœ¨å®ƒè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You entered: target\debug\rust_book.exe
You entered: but
You entered: with
You entered: some
You entered: extra
You entered: words<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ€»æ˜¯ç¨‹åºåï¼Œæ‰€ä»¥ä½ ç»å¸¸ä¼šæƒ³è·³è¿‡å®ƒï¼Œæ¯”å¦‚è¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span>args<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> input <span class="token operator">=</span> <span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    input<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>item<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"You wrote {}, which in capital letters is {}"</span><span class="token punctuation">,</span> item<span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token function">to_uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™å°†æ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">You wrote but, which in capital letters is BUT
You wrote with, which in capital letters is WITH
You wrote some, which in capital letters is SOME
You wrote extra, which in capital letters is EXTRA
You wrote words, which in capital letters is WORDS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Args</code>çš„ä¸€ä¸ªå¸¸è§ç”¨é€”æ˜¯ç”¨äºç”¨æˆ·è®¾ç½®ã€‚ä½ å¯ä»¥ç¡®ä¿ç”¨æˆ·å†™å‡ºä½ éœ€è¦çš„è¾“å…¥ï¼Œåªæœ‰åœ¨æ­£ç¡®çš„æƒ…å†µä¸‹æ‰è¿è¡Œç¨‹åºã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå°ç¨‹åºï¼Œå¯ä»¥è®©å­—æ¯å˜å¤§(å¤§å†™)æˆ–å˜å°(å°å†™)ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span>args<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"capital"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"lowercase"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// User needs to write one of these after cargo run</span>
    <span class="token keyword">let</span> input_vec <span class="token operator">=</span> <span class="token function">args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Make a vec of all the args</span>

    <span class="token keyword">if</span> input_vec<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> keywords<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>input_vec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// It must be at least 3 in length, and the user needs to write either "capital" or "lowercase".</span>
                                                                                <span class="token comment">// We use .to_lowercase() so the user can write "Capital" or "CAPITAL", etc.</span>
        <span class="token keyword">if</span> input_vec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"capital"</span> <span class="token punctuation">{</span>
            input_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>word<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> word<span class="token punctuation">.</span><span class="token function">to_uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            input_vec<span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>word<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> word<span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">r#"Please write either "capital" or "lowercase" and then some input."#</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸‹é¢æ˜¯å®ƒç»™å‡ºçš„ä¸€äº›ä¾‹å­ã€‚</p>
<p>è¾“å…¥: <code>cargo run please make capitals</code>:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Please write either "capital" or "lowercase" and then some input.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¾“å…¥:<code>cargo run capital</code>:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Please write either "capital" or "lowercase" and then some input.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¾“å…¥:<code>cargo run capital I think I understand now</code>:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">I
THINK
I
UNDERSTAND
NOW<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¾“å…¥:<code>cargo run LOWERCASE Does this work too?</code></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">does
this
work
too?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<p>é™¤äº†<code>Args</code>ä¸­ç”¨æˆ·ç»™å‡ºçš„<code>std::env</code>ï¼Œè¿˜æœ‰<code>Vars</code>æ˜¯ç³»ç»Ÿå˜é‡ã€‚è¿™äº›éƒ½æ˜¯ç”¨æˆ·æ²¡æœ‰è¾“å…¥çš„ç¨‹åºçš„åŸºæœ¬è®¾ç½®ã€‚ä½ å¯ä»¥ç”¨<code>std::env::vars()</code>æŠŠå®ƒä»¬éƒ½çœ‹æˆä¸€ä¸ª<code>(String, String)</code>ã€‚è¿™ä¸ªæœ‰éå¸¸å¤šï¼Œæ¯”å¦‚è¯´:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token namespace">std<span class="token punctuation">::</span>env<span class="token punctuation">::</span></span><span class="token function">vars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œè¿™æ®µä»£ç ï¼Œå°±èƒ½æ˜¾ç¤ºå‡ºä½ çš„ç”¨æˆ·ä¼šè¯çš„æ‰€æœ‰ä¿¡æ¯ã€‚å®ƒå°†æ˜¾ç¤ºè¿™æ ·çš„ä¿¡æ¯:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">("CARGO", "/playground/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/cargo")
("CARGO_HOME", "/playground/.cargo")
("CARGO_MANIFEST_DIR", "/playground")
("CARGO_PKG_AUTHORS", "The Rust Playground")
("CARGO_PKG_DESCRIPTION", "")
("CARGO_PKG_HOMEPAGE", "")
("CARGO_PKG_NAME", "playground")
("CARGO_PKG_REPOSITORY", "")
("CARGO_PKG_VERSION", "0.0.1")
("CARGO_PKG_VERSION_MAJOR", "0")
("CARGO_PKG_VERSION_MINOR", "0")
("CARGO_PKG_VERSION_PATCH", "1")
("CARGO_PKG_VERSION_PRE", "")
("DEBIAN_FRONTEND", "noninteractive")
("HOME", "/playground")
("HOSTNAME", "f94c15b8134b")
("LD_LIBRARY_PATH", "/playground/target/debug/build/backtrace-sys-3ec4c973f371c302/out:/playground/target/debug/build/libsqlite3-sys-fbddfbb9b241dacb/out:/playground/target/debug/build/ring-cadba5e583648abb/out:/playground/target/debug/deps:/playground/target/debug:/playground/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-gnu/lib:/playground/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib")
("PATH", "/playground/.cargo/bin:/playground/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin")
("PLAYGROUND_EDITION", "2018")
("PLAYGROUND_TIMEOUT", "10")
("PWD", "/playground")
("RUSTUP_HOME", "/playground/.rustup")
("RUSTUP_TOOLCHAIN", "stable-x86_64-unknown-linux-gnu")
("RUST_RECURSION_COUNT", "1")
("SHLVL", "1")
("SSL_CERT_DIR", "/usr/lib/ssl/certs")
("SSL_CERT_FILE", "/usr/lib/ssl/certs/ca-certificates.crt")
("USER", "playground")
("_", "/usr/bin/timeout")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥å¦‚æœä½ éœ€è¦è¿™äº›ä¿¡æ¯ï¼Œ<code>Vars</code>å°±æ˜¯ä½ æƒ³è¦çš„ã€‚</p>
<p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code>env!</code>å®æ¥è·å–å•ä¸ª<code>Var</code>ã€‚ä½ åªè¦æŠŠå˜é‡çš„åå­—æ”¾åœ¨é‡Œé¢å°±å¯ä»¥äº†ã€‚<br> å®ƒå°†ç»™ä½ ä¸€ä¸ª<code>&amp;str</code>ã€‚ä½†å¦‚æœå˜é‡æ˜¯é”™è¯¯çš„ï¼Œå®ƒå°†ä¸ä¼šå·¥ä½œï¼Œæ‰€ä»¥å¦‚æœä½ ä¸ç¡®å®šï¼Œç„¶åä½¿ç”¨<code>option_env!</code>ä»£æ›¿ã€‚å¦‚æœæˆ‘ä»¬åœ¨Playgroundä¸Šå†™è¿™ä¸ª:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token macro property">env!</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token macro property">option_env!</span><span class="token punctuation">(</span><span class="token string">"ROOT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token string">"Didn't work"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token macro property">option_env!</span><span class="token punctuation">(</span><span class="token string">"CARGO"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token string">"Didn't work"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åæˆ‘ä»¬å¾—åˆ°è¾“å‡º:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">playground
Didn't work
/playground/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/cargo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥<code>option_env!</code>æ°¸è¿œæ˜¯æ¯”è¾ƒå®‰å…¨çš„å®ã€‚å¦‚æœä½ çœŸçš„æƒ³è®©ç¨‹åºåœ¨æ‰¾ä¸åˆ°ç¯å¢ƒå˜é‡æ—¶å´©æºƒï¼Œé‚£ä¹ˆ<code>env!</code>ä¼šæ›´å¥½ã€‚</p>
<h2 id="ä½¿ç”¨æ–‡ä»¶"><a href="#ä½¿ç”¨æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨æ–‡ä»¶"></a>ä½¿ç”¨æ–‡ä»¶</h2><p>ç°åœ¨æˆ‘ä»¬åœ¨ç”µè„‘ä¸Šä½¿ç”¨Rustï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¤„ç†æ–‡ä»¶äº†ã€‚ä½ ä¼šæ³¨æ„åˆ°ï¼Œç°åœ¨æˆ‘ä»¬ä¼šå¼€å§‹åœ¨ä»£ç ä¸­è¶Šæ¥è¶Šå¤šçš„çœ‹åˆ°<code>Result</code>ã€‚è¿™æ˜¯å› ä¸ºä¸€æ—¦ä½ å¼€å§‹å¤„ç†æ–‡ä»¶å’Œç±»ä¼¼çš„äº‹æƒ…ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½ä¼šå‡ºé”™ã€‚ä¸€ä¸ªæ–‡ä»¶å¯èƒ½ä¸åœ¨é‚£é‡Œï¼Œæˆ–è€…è®¡ç®—æœºæ— æ³•è¯»å–å®ƒã€‚</p>
<p>ä½ å¯èƒ½è¿˜è®°å¾—ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨<code>?</code>è¿ç®—ç¬¦ï¼Œè°ƒç”¨å®ƒçš„å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ª<code>Result</code>ã€‚å¦‚æœä½ è®°ä¸ä½é”™è¯¯ç±»å‹ï¼Œä½ å¯ä»¥ä»€ä¹ˆéƒ½ä¸ç»™å®ƒï¼Œè®©ç¼–è¯‘å™¨å‘Šè¯‰ä½ ã€‚è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªè¯•å›¾ç”¨<code>.parse()</code>åˆ›å»ºä¸€ä¸ªæ•°å­—çš„å‡½æ•°æ¥è¯•è¯•ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">fn</span> <span class="token function-definition function">give_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"88"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘å™¨å‘Šè¯‰æˆ‘ä»¬åˆ°åº•è¯¥æ€ä¹ˆåšã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0308]: mismatched types
 --&gt; src\main.rs:4:5
  |
3 | fn give_number(input: &amp;str) -&gt; Result&lt;i32, ()&gt; {
  |                                --------------- expected `std::result::Result&lt;i32, ()&gt;` because of return type
4 |     input.parse::&lt;i32&gt;()
  |     ^^^^^^^^^^^^^^^^^^^^ expected `()`, found struct `std::num::ParseIntError`
  |
  = note: expected enum `std::result::Result&lt;_, ()&gt;`
             found enum `std::result::Result&lt;_, std::num::ParseIntError&gt;`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤ªå¥½äº†ï¼æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠå›è½¦æ”¹æˆè¿™æ ·ã€‚ç°åœ¨å®ƒèƒ½å·¥ä½œäº†:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">give_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"88"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¬¬ä¸€ä¸ªä¸èƒ½ç”¨ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªå¯ä»¥ç”¨ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Ok(88)
Ok(5)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æƒ³ç”¨<code>?</code>ï¼Œå¦‚æœèƒ½ç”¨å°±ç›´æ¥ç»™æˆ‘ä»¬æ•°å€¼ï¼Œå¦‚æœä¸èƒ½ç”¨å°±ç»™é”™è¯¯ã€‚ä½†æ˜¯å¦‚ä½•åœ¨<code>fn main()</code>ä¸­åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬å°è¯•åœ¨mainä¸­ä½¿ç”¨<code>?</code>ï¼Œé‚£å°±ä¸è¡Œäº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">give_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"88"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å®ƒè¯´:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">error[E0277]: the `?` operator can only be used in a function that returns `Result` or `Option` (or another type that implements `std::ops::Try`)
  --&gt; src\main.rs:8:22
   |
7  | / fn main() {
8  | |     println!("{:?}", give_number("88")?);
   | |                      ^^^^^^^^^^^^^^^^^^ cannot use the `?` operator in a function that returns `()`
9  | |     println!("{:?}", give_number("5")?);
10 | | }
   | |_- this function should return `Result` or `Option` to accept `?`<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†å®é™…ä¸Š<code>main()</code>å¯ä»¥è¿”å›ä¸€ä¸ª<code>Result</code>ï¼Œå°±åƒå…¶ä»–å‡½æ•°ä¸€æ ·ã€‚å¦‚æœæˆ‘ä»¬çš„å‡½æ•°èƒ½å·¥ä½œï¼Œæˆ‘ä»¬ä¸æƒ³è¿”å›ä»»ä½•ä¸œè¥¿(main()å¹¶æ²¡æœ‰ç»™å…¶ä»–ä»»ä½•ä¸œè¥¿)ã€‚è€Œå¦‚æœå®ƒä¸å·¥ä½œï¼Œæˆ‘ä»¬å°†é”™è¯¯è¿”å›ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">give_number</span><span class="token punctuation">(</span>input<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    input<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"88"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> <span class="token function">give_number</span><span class="token punctuation">(</span><span class="token string">"5"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸è¦å¿˜äº†æœ€åçš„<code>Ok(())</code>:è¿™åœ¨Rustä¸­æ˜¯å¾ˆå¸¸è§çš„ï¼Œå®ƒçš„æ„æ€æ˜¯<code>Ok</code>ï¼Œé‡Œé¢æ˜¯<code>()</code>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è¿”å›å€¼ã€‚ç°åœ¨å®ƒæ‰“å°å‡ºæ¥äº†:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">88
5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<p>åªç”¨<code>.parse()</code>çš„æ—¶å€™ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯ç”¨æ–‡ä»¶å°±å¾ˆæœ‰ç”¨ã€‚è¿™æ˜¯å› ä¸º<code>?</code>ä¹Ÿä¸ºæˆ‘ä»¬æ”¹å˜äº†é”™è¯¯ç±»å‹ã€‚ä¸‹é¢æ˜¯ç”¨ç®€å•è‹±è¯­å†™çš„<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/macro.try.html">?è¿ç®—ç¬¦é¡µé¢</a>:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">If you get an `Err`, it will get the inner error. Then `?` does a conversion using `From`. With that it can change specialized errors to more general ones. The error it gets is then returned.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¦å¤–ï¼ŒRuståœ¨ä½¿ç”¨<code>File</code>så’Œç±»ä¼¼çš„ä¸œè¥¿æ—¶ï¼Œæœ‰ä¸€ä¸ªæ–¹ä¾¿çš„<code>Result</code>ç±»å‹ã€‚å®ƒå«åš<code>std::io::Result</code>ï¼Œå½“ä½ åœ¨ä½¿ç”¨<code>?</code>å¯¹æ–‡ä»¶è¿›è¡Œæ‰“å¼€å’Œæ“ä½œæ—¶ï¼Œé€šå¸¸åœ¨<code>main()</code>ä¸­çœ‹åˆ°çš„å°±æ˜¯è¿™ä¸ªã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªç±»å‹åˆ«åã€‚å®ƒçš„æ ·å­æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">type Result&lt;T&gt; = Result&lt;T, Error&gt;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ª<code>Result&lt;T, Error&gt;</code>ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å†™å‡º<code>Result&lt;T&gt;</code>éƒ¨åˆ†ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬ç¬¬ä¸€æ¬¡å°è¯•ä½¿ç”¨æ–‡ä»¶ã€‚<code>std::fs</code>æ˜¯å¤„ç†æ–‡ä»¶çš„æ–¹æ³•æ‰€åœ¨ï¼Œæœ‰äº†<code>std::io::Write</code>ï¼Œä½ å°±å¯ä»¥å†™ã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨<code>.write_all()</code>æ¥å†™è¿›æ–‡ä»¶ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Write</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> file <span class="token operator">=</span> <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"myfilename.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// Create a file with this name.</span>
                                                        <span class="token comment">// CAREFUL! If you have a file with this name already,</span>
                                                        <span class="token comment">// it will delete it and make a new one.</span>
    file<span class="token punctuation">.</span><span class="token function">write_all</span><span class="token punctuation">(</span><span class="token string">b"Let's put this in the file"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>     <span class="token comment">// Don't forget the b in front of ". That's because files take bytes.</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åå¦‚æœä½ æ‰“å¼€æ–°æ–‡ä»¶<code>myfilename.txt</code>ï¼Œä¼šçœ‹åˆ°å†…å®¹<code>Let's put this in the file</code>ã€‚</p>
<p>ä¸è¿‡æˆ‘ä»¬ä¸éœ€è¦å†™ä¸¤è¡Œï¼Œå› ä¸ºæˆ‘ä»¬æœ‰<code>?</code>æ“ä½œç¬¦ã€‚å¦‚æœæœ‰æ•ˆï¼Œå®ƒå°±ä¼šä¼ é€’æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæœ‰ç‚¹åƒåœ¨è¿­ä»£å™¨ä¸Šå¾ˆå¤šæ–¹æ³•ä¸€æ ·ã€‚è¿™æ—¶å€™<code>?</code>å°±å˜å¾—éå¸¸æ–¹ä¾¿äº†ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Write</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"myfilename.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">write_all</span><span class="token punctuation">(</span><span class="token string">b"Let's put this in the file"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™æ˜¯è¯´ â€œè¯·å°è¯•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦æˆåŠŸã€‚å¦‚æœæˆåŠŸäº†ï¼Œé‚£å°±ä½¿ç”¨<code>.write_all()</code>ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦æˆåŠŸã€‚â€</p>
<p>è€Œäº‹å®ä¸Šï¼Œä¹Ÿæœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥åŒæ—¶å®Œæˆè¿™ä¸¤ä»¶äº‹ã€‚å®ƒçš„åå­—å«<code>std::fs::write</code>ã€‚åœ¨å®ƒé‡Œé¢ï¼Œä½ ç»™å®ƒä½ æƒ³è¦çš„æ–‡ä»¶åï¼Œä»¥åŠä½ æƒ³è¦æ”¾åœ¨é‡Œé¢çš„å†…å®¹ã€‚å†æ¬¡å¼ºè°ƒï¼Œå°å¿ƒ! å¦‚æœæœ‰ç›¸åŒçš„åå­—ï¼Œå®ƒå°±ä¼šåˆ é™¤å·²ç»å­˜åœ¨çš„æ–‡ä»¶ã€‚å¦å¤–ï¼Œå®ƒè®©ä½ å†™ä¸€ä¸ª<code>&amp;str</code>ï¼Œå‰é¢ä¸å†™<code>b</code>ï¼Œå› ä¸ºè¿™ä¸ª:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">write</span><span class="token operator">&lt;</span><span class="token class-name">P</span><span class="token punctuation">:</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token class-name">Path</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">C</span><span class="token punctuation">:</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token class-name">P</span><span class="token punctuation">,</span> contents<span class="token punctuation">:</span> <span class="token class-name">C</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>AsRef&lt;[u8]&gt;</code>å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥ç»™å®ƒä»»ä½•ä¸€ä¸ªã€‚</p>
<p>å¾ˆç®€å•çš„:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">,</span> 
<span class="token string">"Calvin: Dad, how come old photographs are always black and white? Didn't they have color film back then?
Dad: Sure they did. In fact, those photographs *are* in color. It's just the *world* was black and white then.
Calvin: Really?
Dad: Yep. The world didn't turn color until sometimes in the 1930s..."</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€ä»¥è¿™å°±æ˜¯æˆ‘ä»¬è¦ç”¨çš„æ–‡ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªåå«Calvinçš„æ¼«ç”»äººç‰©å’Œä»–çˆ¸çˆ¸çš„å¯¹è¯ï¼Œä»–çˆ¸çˆ¸å¯¹ä»–çš„é—®é¢˜å¹¶ä¸è®¤çœŸã€‚æœ‰äº†è¿™ä¸ªï¼Œæ¯æ¬¡æˆ‘ä»¬éƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥ä½¿ç”¨ã€‚</p>
<p>æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å’Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ä¸€æ ·ç®€å•ã€‚ä½ åªè¦ç”¨<code>open()</code>ä»£æ›¿<code>create()</code>å°±å¯ä»¥äº†ã€‚ä¹‹å(å¦‚æœå®ƒæ‰¾åˆ°äº†ä½ çš„æ–‡ä»¶)ï¼Œä½ å°±å¯ä»¥åš<code>read_to_string()</code>è¿™æ ·çš„äº‹æƒ…ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯å˜çš„ <code>String</code>ï¼Œç„¶åæŠŠæ–‡ä»¶è¯»åˆ°é‚£é‡Œã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Read</span><span class="token punctuation">;</span> <span class="token comment">// this is to use the function .read_to_string()</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
     <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">,</span> 
<span class="token string">"Calvin: Dad, how come old photographs are always black and white? Didn't they have color film back then?
Dad: Sure they did. In fact, those photographs *are* in color. It's just the *world* was black and white then.
Calvin: Really?
Dad: Yep. The world didn't turn color until sometimes in the 1930s..."</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>


    <span class="token keyword">let</span> <span class="token keyword">mut</span> calvin_file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// Open the file we just made</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> calvin_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This String will hold it</span>
    calvin_file<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> calvin_string<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// Read the file into it</span>

    calvin_string<span class="token punctuation">.</span><span class="token function">split_whitespace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for_each</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>word<span class="token closure-punctuation punctuation">|</span></span> <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"{} "</span><span class="token punctuation">,</span> word<span class="token punctuation">.</span><span class="token function">to_uppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Do things with the String now</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¼šæ‰“å°:</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token constant">CALVIN</span><span class="token punctuation">:</span> <span class="token constant">DAD</span><span class="token punctuation">,</span> <span class="token constant">HOW</span> <span class="token constant">COME</span> <span class="token constant">OLD</span> <span class="token constant">PHOTOGRAPHS</span> <span class="token constant">ARE</span> <span class="token constant">ALWAYS</span> <span class="token constant">BLACK</span> <span class="token constant">AND</span> <span class="token constant">WHITE</span><span class="token operator">?</span> <span class="token constant">DIDN</span><span class="token lifetime-annotation symbol">'T</span> <span class="token constant">THEY</span> <span class="token constant">HAVE</span> <span class="token constant">COLOR</span> <span class="token constant">FILM</span> <span class="token constant">BACK</span> <span class="token constant">THEN</span><span class="token operator">?</span> <span class="token constant">DAD</span><span class="token punctuation">:</span> <span class="token constant">SURE</span> <span class="token constant">THEY</span> <span class="token constant">DID</span><span class="token punctuation">.</span> <span class="token constant">IN</span> 
<span class="token constant">FACT</span><span class="token punctuation">,</span> <span class="token constant">THOSE</span> <span class="token constant">PHOTOGRAPHS</span> <span class="token operator">*</span><span class="token constant">ARE</span><span class="token operator">*</span> <span class="token constant">IN</span> <span class="token constant">COLOR</span><span class="token punctuation">.</span> <span class="token constant">IT</span><span class="token lifetime-annotation symbol">'S</span> <span class="token constant">JUST</span> <span class="token constant">THE</span> <span class="token operator">*</span><span class="token constant">WORLD</span><span class="token operator">*</span> <span class="token constant">WAS</span> <span class="token constant">BLACK</span> <span class="token constant">AND</span> <span class="token constant">WHITE</span> <span class="token constant">THEN</span><span class="token punctuation">.</span> <span class="token constant">CALVIN</span><span class="token punctuation">:</span> <span class="token constant">REALLY</span><span class="token operator">?</span> <span class="token constant">DAD</span><span class="token punctuation">:</span> <span class="token constant">YEP</span><span class="token punctuation">.</span> <span class="token constant">THE</span> <span class="token constant">WORLD</span> <span class="token constant">DIDN</span><span class="token lifetime-annotation symbol">'T</span> <span class="token constant">TURN</span> <span class="token constant">COLOR</span> <span class="token constant">UNTIL</span> <span class="token constant">SOMETIMES</span> <span class="token constant">IN</span> <span class="token constant">THE</span> 1930S<span class="token punctuation">...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å¥½å§ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½†å¦‚æœå·²ç»æœ‰å¦ä¸€ä¸ªåŒåçš„æ–‡ä»¶å°±ä¸åšäº†æ€ä¹ˆåŠï¼Ÿä¹Ÿè®¸ä½ ä¸æƒ³ä¸ºäº†åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶è€Œåˆ é™¤å·²ç»å­˜åœ¨çš„å…¶ä»–æ–‡ä»¶ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ‰ä¸€ä¸ªç»“æ„å«<code>OpenOptions</code>ã€‚å…¶å®ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ç”¨<code>OpenOptions</code>ï¼Œå´ä¸çŸ¥é“ã€‚çœ‹çœ‹<code>File::open</code>çš„æºç å§ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">open</span><span class="token operator">&lt;</span><span class="token class-name">P</span><span class="token punctuation">:</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token class-name">Path</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token class-name">P</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">File</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">OpenOptions</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æœ‰æ„æ€ï¼Œè¿™å¥½åƒæ˜¯æˆ‘ä»¬å­¦è¿‡çš„å»ºé€ è€…æ¨¡å¼ã€‚<code>File::create</code>ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">create</span><span class="token operator">&lt;</span><span class="token class-name">P</span><span class="token punctuation">:</span> <span class="token class-name">AsRef</span><span class="token operator">&lt;</span><span class="token class-name">Path</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token class-name">P</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">File</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token class-name">OpenOptions</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">truncate</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœä½ å»<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/fs/struct.OpenOptions.html">OpenOptionsçš„é¡µé¢</a>ï¼Œä½ å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯ä»¥é€‰æ‹©çš„æ–¹æ³•ã€‚å¤§å¤šæ•°é‡‡å–<code>bool</code>ã€‚</p>
<ul>
<li><code>append()</code>: æ„æ€æ˜¯ â€œæ·»åŠ åˆ°å·²ç»å­˜åœ¨çš„å†…å®¹ä¸­ï¼Œè€Œä¸æ˜¯åˆ é™¤â€ã€‚</li>
<li><code>create()</code>: è¿™è®© <code>OpenOptions</code> åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ã€‚</li>
<li><code>create_new()</code>: æ„æ€æ˜¯åªæœ‰åœ¨æ–‡ä»¶ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æ‰ä¼šåˆ›å»ºæ–‡ä»¶ã€‚</li>
<li><code>read()</code>: å¦‚æœä½ æƒ³è®©å®ƒè¯»å–æ–‡ä»¶ï¼Œå°±æŠŠè¿™ä¸ªè®¾ç½®ä¸º <code>true</code>ã€‚</li>
<li><code>truncate()</code>: å¦‚æœä½ æƒ³åœ¨æ‰“å¼€æ–‡ä»¶æ—¶æŠŠæ–‡ä»¶å†…å®¹å‰ªä¸º0(åˆ é™¤å†…å®¹)ï¼Œå°±æŠŠè¿™ä¸ªè®¾ç½®ä¸ºtrueã€‚</li>
<li><code>write()</code>: è¿™å¯ä»¥è®©å®ƒå†™å…¥ä¸€ä¸ªæ–‡ä»¶ã€‚</li>
</ul>
<p>ç„¶ååœ¨æœ€åä½ ç”¨<code>.open()</code>åŠ ä¸Šæ–‡ä»¶åï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ª<code>Result</code>ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// âš ï¸</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">OpenOptions</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
     <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">,</span> 
<span class="token string">"Calvin: Dad, how come old photographs are always black and white? Didn't they have color film back then?
Dad: Sure they did. In fact, those photographs *are* in color. It's just the *world* was black and white then.
Calvin: Really?
Dad: Yep. The world didn't turn color until sometimes in the 1930s..."</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> calvin_file <span class="token operator">=</span> <span class="token class-name">OpenOptions</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create_new</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¦–å…ˆæˆ‘ä»¬ç”¨<code>new</code>åšäº†ä¸€ä¸ª<code>OpenOptions</code>(æ€»æ˜¯ä»¥<code>new</code>å¼€å¤´)ã€‚ç„¶åæˆ‘ä»¬ç»™å®ƒçš„èƒ½åŠ›æ˜¯<code>write</code>ã€‚ä¹‹åæˆ‘ä»¬æŠŠ<code>create_new()</code>è®¾ç½®ä¸º<code>true</code>ï¼Œç„¶åè¯•ç€æ‰“å¼€æˆ‘ä»¬åšçš„æ–‡ä»¶ã€‚æ‰“ä¸å¼€ï¼Œè¿™æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Error: Os { code: 80, kind: AlreadyExists, message: "The file exists." }<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨<code>.append()</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘ä¸€ä¸ªæ–‡ä»¶å†™å…¥ã€‚ä¸ºäº†å†™å…¥æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>.write_all()</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå°è¯•å†™å…¥ä½ ç»™å®ƒçš„ä¸€åˆ‡å†…å®¹çš„æ–¹æ³•ã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>write!</code> å®æ¥åšåŒæ ·çš„äº‹æƒ…ã€‚ä½ ä¼šè®°å¾—è¿™ä¸ªå®ï¼Œæˆ‘ä»¬åœ¨ä¸ºç»“æ„ä½“åš<code>impl Display</code>çš„æ—¶å€™ç”¨åˆ°è¿‡ã€‚è¿™æ¬¡æˆ‘ä»¬æ˜¯åœ¨æ–‡ä»¶ä¸Šä½¿ç”¨å®ƒï¼Œè€Œä¸æ˜¯åœ¨ç¼“å†²åŒºä¸Šã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">OpenOptions</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Write</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">,</span> 
<span class="token string">"Calvin: Dad, how come old photographs are always black and white? Didn't they have color film back then?
Dad: Sure they did. In fact, those photographs *are* in color. It's just the *world* was black and white then.
Calvin: Really?
Dad: Yep. The world didn't turn color until sometimes in the 1930s..."</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> calvin_file <span class="token operator">=</span> <span class="token class-name">OpenOptions</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// Now we can write without deleting it</span>
        <span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    calvin_file<span class="token punctuation">.</span><span class="token function">write_all</span><span class="token punctuation">(</span><span class="token string">b"And it was a pretty grainy color for a while too.\n"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token macro property">write!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> calvin_file<span class="token punctuation">,</span> <span class="token string">"That's really weird.\n"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token macro property">write!</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> calvin_file<span class="token punctuation">,</span> <span class="token string">"Well, truth is stranger than fiction."</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token string">"calvin_with_dad.txt"</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™ä¸ªæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Calvin: Dad, how come old photographs are always black and white? Didn't they have color film back then?
Dad: Sure they did. In fact, those photographs *are* in color. It's just the *world* was black and white then.
Calvin: Really?
Dad: Yep. The world didn't turn color until sometimes in the 1930s...And it was a pretty grainy color for a while too.
That's really weird.
Well, truth is stranger than fiction.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="cargoæ–‡æ¡£"><a href="#cargoæ–‡æ¡£" class="headerlink" title="cargoæ–‡æ¡£"></a>cargoæ–‡æ¡£</h2><p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼ŒRustæ–‡æ¡£çœ‹èµ·æ¥æ€»æ˜¯å‡ ä¹ä¸€æ ·ã€‚åœ¨å·¦è¾¹ä½ å¯ä»¥çœ‹åˆ°<code>struct</code>å’Œ<code>trait</code>ï¼Œä»£ç ä¾‹å­åœ¨å³è¾¹ç­‰ç­‰ã€‚è¿™æ˜¯å› ä¸ºä½ åªè¦è¾“å…¥<code>cargo doc</code>å°±å¯ä»¥è‡ªåŠ¨åˆ›å»ºæ–‡æ¡£ã€‚</p>
<p>å³ä½¿æ˜¯åˆ›å»ºä¸€ä¸ªä»€ä¹ˆéƒ½ä¸åšçš„é¡¹ç›®ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©ä½ äº†è§£Rustä¸­çš„ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªå‡ ä¹ä»€ä¹ˆéƒ½ä¸åšçš„ç»“æ„ä½“ï¼Œä»¥åŠä¸€ä¸ªä¹Ÿä»€ä¹ˆéƒ½ä¸åšçš„<code>fn main()</code>ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">DoesNothing</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">PrintThing</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">PrintThing</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">prints_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>ä½†å¦‚æœä½ è¾“å…¥<code>cargo doc --open</code>ï¼Œä½ å¯ä»¥çœ‹åˆ°æ¯”ä½ æƒ³è±¡ä¸­æ›´å¤šçš„ä¿¡æ¯ã€‚é¦–å…ˆå®ƒç»™ä½ æ˜¾ç¤ºçš„æ˜¯è¿™æ ·çš„:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Crate rust_book

Structs
DoesNothing
PrintThing

Functions
main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯å¦‚æœä½ ç‚¹å‡»å…¶ä¸­çš„ä¸€ä¸ªç»“æ„ï¼Œä¼šè®©ä½ çœ‹åˆ°å¾ˆå¤šä½ æ²¡æœ‰æƒ³åˆ°çš„traitã€‚</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Struct rust_book::DoesNothing
[+] Show declaration
Auto Trait Implementations
impl RefUnwindSafe for DoesNothing
impl Send for DoesNothing
impl Sync for DoesNothing
impl Unpin for DoesNothing
impl UnwindSafe for DoesNothing
Blanket Implementations
impl&lt;T&gt; Any for T
where
    T: 'static + ?Sized,
[src]
[+]
impl&lt;T&gt; Borrow&lt;T&gt; for T
where
    T: ?Sized,
[src]
[+]
impl&lt;T&gt; BorrowMut&lt;T&gt; for T
where
    T: ?Sized,
[src]
[+]
impl&lt;T&gt; From&lt;T&gt; for T
[src]
[+]
impl&lt;T, U&gt; Into&lt;U&gt; for T
where
    U: From&lt;T&gt;,
[src]
[+]
impl&lt;T, U&gt; TryFrom&lt;U&gt; for T
where
    U: Into&lt;T&gt;,
[src]
[+]
impl&lt;T, U&gt; TryInto&lt;U&gt; for T
where
    U: TryFrom&lt;T&gt;,<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ˜¯å› ä¸ºRustè‡ªåŠ¨ä¸ºæ¯ä¸ªç±»å‹å®ç°çš„æ‰€æœ‰traitã€‚</p>
<p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ·»åŠ ä¸€äº›æ–‡æ¡£æ³¨é‡Šï¼Œå½“ä½ è¾“å…¥<code>cargo doc</code>çš„æ—¶å€™å°±å¯ä»¥çœ‹åˆ°ã€‚</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">/// This is a struct that does nothing</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">DoesNothing</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">/// This struct only has one method.</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">PrintThing</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">/// It just prints the same message.</span>
<span class="token keyword">impl</span> <span class="token class-name">PrintThing</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">prints_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"I am printing something"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>ç°åœ¨ä¼šæ‰“å°:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">Crate rust_book
Structs
DoesNothing This is a struct that does nothing
PrintThing  This struct only has one method.
Functions
main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ä½ ä½¿ç”¨å¾ˆå¤šåˆ«äººçš„crateæ—¶ï¼Œ<code>cargo doc</code>æ˜¯éå¸¸å¥½çš„ã€‚å› ä¸ºè¿™äº›crateéƒ½åœ¨ä¸åŒçš„ç½‘ç«™ä¸Šï¼Œå¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥æœç´¢æ‰€æœ‰çš„crateã€‚ä½†å¦‚æœä½ ä½¿ç”¨<code>cargo doc</code>ï¼Œä½ å°±ä¼šæŠŠå®ƒä»¬éƒ½æ”¾åœ¨ä½ ç¡¬ç›˜çš„åŒä¸€ä¸ªåœ°æ–¹ã€‚</p>
<h2 id="ç»“æŸäº†å—ï¼Ÿ"><a href="#ç»“æŸäº†å—ï¼Ÿ" class="headerlink" title="ç»“æŸäº†å—ï¼Ÿ"></a>ç»“æŸäº†å—ï¼Ÿ</h2><p>ç®€å•è‹±è¯­å­¦Rustå°±è¿™æ ·ç»“æŸäº†ã€‚ä½†æ˜¯æˆ‘è¿˜åœ¨è¿™é‡Œï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆé—®é¢˜å¯ä»¥å‘Šè¯‰æˆ‘ã€‚æ¬¢è¿<a target="_blank" rel="noopener" href="https://twitter.com/mithridates">åœ¨Twitterä¸Šè”ç³»æˆ‘</a>æˆ–è€…æ·»åŠ ä¸€ä¸ªpull requestã€issueç­‰ã€‚å¦‚æœæœ‰äº›åœ°æ–¹ä¸å®¹æ˜“ç†è§£ï¼Œä½ ä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚ç®€å•è‹±è¯­å­¦Rustéœ€è¦éå¸¸å®¹æ˜“ç†è§£ï¼Œæ‰€ä»¥è¯·å‘Šè¯‰æˆ‘è‹±è¯­å¤ªéš¾çš„åœ°æ–¹ã€‚å½“ç„¶ï¼ŒRustæœ¬èº«ä¹Ÿå¯èƒ½æ˜¯å¾ˆéš¾ç†è§£çš„ï¼Œä½†æˆ‘ä»¬è‡³å°‘å¯ä»¥ç¡®ä¿è‹±è¯­æ˜¯å®¹æ˜“çš„ã€‚</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        æ–‡ç« ä½œè€…:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Kabirz</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        æ–‡ç« é“¾æ¥:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://kabirz.github.io/2021/03/24/rust_cn/">https://kabirz.github.io/2021/03/24/rust_cn/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        ç‰ˆæƒå£°æ˜:
                    </i>
                </span>
                <span class="reprint-info">
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº
                    <a href="/about" target="_blank">Kabirz</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/rust/">
                                    <span class="chip bg-color">rust</span>
                                </a>
                            
                                <a href="/tags/%E7%BC%96%E7%A8%8B/">
                                    <span class="chip bg-color">ç¼–ç¨‹</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2021/03/30/picture-01/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="å›¾ç‰‡æ¬£èµ">
                        
                        <span class="card-title">å›¾ç‰‡æ¬£èµ</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-03-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Kabirz
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E5%9B%BE%E7%89%87/">
                        <span class="chip bg-color">å›¾ç‰‡</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                æœ¬ç¯‡&nbsp;<i class="far fa-dot-circle"></i>
            </div>
            <div class="card">
                <a href="/2021/03/24/rust_cn/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="è½»æ¾å…¥é—¨å­¦ä¹ rust">
                        
                        <span class="card-title">è½»æ¾å…¥é—¨å­¦ä¹ rust</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AD%A6%E4%B9%A0/" class="post-category">
                                    å­¦ä¹ 
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/rust/">
                        <span class="chip bg-color">rust</span>
                    </a>
                    
                    <a href="/tags/%E7%BC%96%E7%A8%8B/">
                        <span class="chip bg-color">ç¼–ç¨‹</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- ä»£ç å—åŠŸèƒ½ä¾èµ– -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- ä»£ç è¯­è¨€ -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- ä»£ç å—å¤åˆ¶ -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- ä»£ç å—æ”¶ç¼© -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC æ‚¬æµ®æŒ‰é’®. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="kugou"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">Kabirz</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span
                class="white-color">93.9k</span>&nbsp;å­—
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;æ¬¡
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;äºº
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/kabirz" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:jxwazxzhp@126.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--è…¾è®¯å…”å°å·¢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
